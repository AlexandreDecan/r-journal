<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml producer="poppler" version="0.30.0">
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="12" family="Times" color="#000000"/>
	<fontspec id="1" size="9" family="Times" color="#000000"/>
	<fontspec id="2" size="28" family="Times" color="#000000"/>
	<fontspec id="3" size="11" family="Times" color="#000000"/>
	<fontspec id="4" size="11" family="Times" color="#000000"/>
	<fontspec id="5" size="11" family="Times" color="#7282aa"/>
	<fontspec id="6" size="11" family="Times" color="#7282aa"/>
	<fontspec id="7" size="8" family="Times" color="#000000"/>
	<fontspec id="8" size="8" family="Times" color="#000000"/>
	<fontspec id="9" size="5" family="Times" color="#000000"/>
	<fontspec id="10" size="11" family="Times" color="#000000"/>
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">207</text>
<text top="98" left="149" width="448" height="30" font="2"><b>Translating Probability Density</b></text>
<text top="137" left="149" width="531" height="30" font="2"><b>Functions: From R to BUGS and Back</b></text>
<text top="177" left="148" width="86" height="30" font="2"><b>Again</b></text>
<text top="213" left="149" width="369" height="15" font="0">by David S. LeBauer, Michael C. Dietze, Benjamin M. Bolker</text>
<text top="254" left="148" width="52" height="13" font="3"><b>Abstract</b></text>
<text top="254" left="204" width="542" height="13" font="4">The ability to implement statistical models in the BUGS language facilitates Bayesian in-</text>
<text top="270" left="149" width="595" height="13" font="4">ference by automating MCMC algorithms. Software packages that interpret the BUGS language</text>
<text top="286" left="149" width="597" height="13" font="4">include OpenBUGS, WinBUGS, and JAGS. R packages that link BUGS software to the R environment,</text>
<text top="303" left="149" width="58" height="13" font="4">including</text>
<text top="303" left="210" width="30" height="13" font="5"><a href="http://CRAN.R-project.org/package=rjags"><b>rjags</b></a></text>
<text top="303" left="244" width="23" height="13" font="4">and</text>
<text top="303" left="270" width="81" height="13" font="5"><a href="http://CRAN.R-project.org/package=R2WinBUGS"><b>R2WinBUGS</b></a></text>
<text top="303" left="351" width="393" height="13" font="4"><a href="http://CRAN.R-project.org/package=R2WinBUGS">, </a>are widely used in Bayesian analysis. Indeed, many packages in</text>
<text top="319" left="149" width="205" height="13" font="4">the Bayesian task view on CRAN <a href="http://cran.r-project.org/web/views/Bayesian.html">(</a></text>
<text top="320" left="354" width="337" height="11" font="6"><a href="http://cran.r-project.org/web/views/Bayesian.html">http://cran.r-project.org/web/views/Bayesian.html</a></text>
<text top="319" left="691" width="53" height="13" font="4"><a href="http://cran.r-project.org/web/views/Bayesian.html">) </a>depend</text>
<text top="336" left="149" width="595" height="13" font="4">on this integration. However, the R and BUGS languages use different representations of common</text>
<text top="352" left="148" width="598" height="13" font="4">probability density functions, creating a potential for errors to occur in the implementation or interpre-</text>
<text top="369" left="149" width="595" height="13" font="4">tation of analyses that use both languages. Here we review different parameterizations used by the R</text>
<text top="385" left="149" width="597" height="13" font="4">and BUGS languages, describe how to translate between the languages, and provide an R function,</text>
<text top="402" left="149" width="137" height="11" font="4">r2bugs.distributions</text>
<text top="402" left="286" width="405" height="13" font="4">, that transforms parameterizations from R to BUGS and back again.</text>
<text top="440" left="73" width="73" height="13" font="4">Distribution</text>
<text top="440" left="202" width="34" height="13" font="4">Lang.</text>
<text top="440" left="256" width="102" height="13" font="4">Parameterization</text>
<text top="440" left="431" width="23" height="13" font="4">Use</text>
<text top="440" left="675" width="35" height="13" font="4">Notes</text>
<text top="464" left="73" width="46" height="13" font="4">Normal</text>
<text top="489" left="202" width="9" height="13" font="4">R</text>
<text top="485" left="269" width="5" height="10" font="7">1</text>
<text top="488" left="258" width="9" height="13" font="7">√</text>
<text top="498" left="267" width="19" height="10" font="7">2<i>πσ</i></text>
<text top="489" left="290" width="21" height="13" font="4">exp</text>
<text top="479" left="314" width="10" height="6" font="4"></text>
<text top="487" left="324" width="11" height="16" font="0">−</text>
<text top="484" left="337" width="4" height="10" font="7">(</text>
<text top="484" left="342" width="5" height="10" font="7">x</text>
<text top="483" left="347" width="19" height="13" font="7">−<i>µ</i>)</text>
<text top="481" left="367" width="4" height="7" font="9">2</text>
<text top="496" left="346" width="11" height="10" font="7">2<i>σ</i></text>
<text top="495" left="358" width="4" height="7" font="9">2</text>
<text top="479" left="373" width="10" height="6" font="4"></text>
<text top="489" left="431" width="41" height="11" font="4">dnorm(</text>
<text top="488" left="472" width="140" height="13" font="4">x, mean = <i>µ</i>, sd = <i>σ</i>)</text>
<text top="520" left="202" width="36" height="13" font="4">BUGS</text>
<text top="514" left="256" width="13" height="6" font="4">q</text>
<text top="519" left="275" width="5" height="8" font="8"><i>τ</i></text>
<text top="527" left="271" width="12" height="10" font="7">2<i>π</i></text>
<text top="520" left="288" width="21" height="13" font="4">exp</text>
<text top="514" left="312" width="8" height="6" font="4"></text>
<text top="519" left="321" width="19" height="16" font="0">− (</text>
<text top="520" left="340" width="7" height="13" font="4">x</text>
<text top="519" left="350" width="11" height="16" font="0">−</text>
<text top="523" left="364" width="8" height="10" font="10"><i>µ</i></text>
<text top="520" left="372" width="5" height="12" font="0">)</text>
<text top="516" left="377" width="5" height="10" font="7">2</text>
<text top="523" left="386" width="7" height="10" font="10"><i>τ</i></text>
<text top="514" left="394" width="8" height="6" font="4"></text>
<text top="520" left="431" width="208" height="13" font="4">dnorm(mean = <i>µ</i>, precision = <i>τ</i>)</text>
<text top="523" left="675" width="7" height="10" font="10"><i>τ</i></text>
<text top="520" left="686" width="11" height="12" font="0">=</text>
<text top="514" left="701" width="8" height="6" font="4"></text>
<text top="517" left="712" width="5" height="10" font="7">1</text>
<text top="529" left="712" width="6" height="8" font="8"><i>σ</i></text>
<text top="514" left="720" width="8" height="6" font="4"></text>
<text top="511" left="728" width="5" height="10" font="7">2</text>
<text top="548" left="73" width="70" height="13" font="4">log-Normal</text>
<text top="572" left="202" width="9" height="13" font="4">R</text>
<text top="569" left="272" width="5" height="10" font="7">1</text>
<text top="572" left="258" width="9" height="13" font="7">√</text>
<text top="581" left="267" width="25" height="10" font="7">2<i>πσ</i>x</text>
<text top="572" left="296" width="21" height="13" font="4">exp</text>
<text top="562" left="320" width="10" height="6" font="4"></text>
<text top="571" left="330" width="11" height="16" font="0">−</text>
<text top="567" left="343" width="4" height="10" font="7">(</text>
<text top="567" left="347" width="29" height="10" font="7">log(x)</text>
<text top="566" left="377" width="19" height="13" font="7">−<i>µ</i>)</text>
<text top="564" left="396" width="4" height="7" font="9">2</text>
<text top="580" left="359" width="4" height="10" font="7">(</text>
<text top="580" left="364" width="11" height="10" font="7">2<i>σ</i></text>
<text top="579" left="375" width="4" height="7" font="9">2</text>
<text top="580" left="380" width="4" height="10" font="7">)</text>
<text top="562" left="403" width="10" height="6" font="4"></text>
<text top="573" left="431" width="48" height="11" font="4">dlnorm(</text>
<text top="572" left="479" width="140" height="13" font="4">x, mean = <i>µ</i>, sd = <i>σ</i>)</text>
<text top="604" left="202" width="36" height="13" font="4">BUGS</text>
<text top="591" left="258" width="9" height="13" font="7">√</text>
<text top="602" left="267" width="5" height="8" font="8"><i>τ</i></text>
<text top="611" left="263" width="5" height="10" font="7">x</text>
<text top="604" left="277" width="21" height="13" font="4">exp</text>
<text top="594" left="301" width="10" height="6" font="4"></text>
<text top="598" left="313" width="68" height="13" font="7">−<i>τ</i>(log(x)−<i>µ</i>)</text>
<text top="596" left="381" width="4" height="7" font="9">2</text>
<text top="611" left="346" width="5" height="10" font="7">2</text>
<text top="594" left="387" width="10" height="6" font="4"></text>
<text top="605" left="431" width="215" height="13" font="4">dlnorm(mean = <i>µ</i>, precision = <i>τ</i>)</text>
<text top="607" left="675" width="7" height="10" font="10"><i>τ</i></text>
<text top="604" left="686" width="11" height="12" font="0">=</text>
<text top="598" left="701" width="8" height="6" font="4"></text>
<text top="601" left="712" width="5" height="10" font="7">1</text>
<text top="614" left="712" width="6" height="8" font="8"><i>σ</i></text>
<text top="598" left="720" width="8" height="6" font="4"></text>
<text top="595" left="728" width="5" height="10" font="7">2</text>
<text top="636" left="73" width="54" height="13" font="4">Binomial</text>
<text top="636" left="675" width="143" height="13" font="4">reverse parameter order</text>
<text top="654" left="202" width="9" height="13" font="4">R</text>
<text top="654" left="256" width="5" height="12" font="0">(</text>
<text top="650" left="262" width="6" height="10" font="7">n</text>
<text top="660" left="262" width="5" height="10" font="7">x</text>
<text top="654" left="268" width="5" height="12" font="0">)</text>
<text top="654" left="274" width="7" height="13" font="4">p</text>
<text top="651" left="282" width="5" height="10" font="7">x</text>
<text top="654" left="290" width="5" height="12" font="0">(</text>
<text top="654" left="296" width="7" height="13" font="4">1</text>
<text top="652" left="305" width="11" height="16" font="0">−</text>
<text top="654" left="320" width="7" height="13" font="4">p</text>
<text top="654" left="327" width="5" height="12" font="0">)</text>
<text top="649" left="333" width="6" height="10" font="7">n</text>
<text top="649" left="339" width="14" height="13" font="7">−x</text>
<text top="654" left="431" width="48" height="11" font="4">dbinom(</text>
<text top="654" left="479" width="153" height="13" font="4">x, size = n, prob = p)</text>
<text top="670" left="202" width="36" height="13" font="4">BUGS</text>
<text top="670" left="256" width="31" height="13" font="4">same</text>
<text top="671" left="431" width="75" height="11" font="4">dbin(prob =</text>
<text top="670" left="514" width="83" height="13" font="4">p, size = n)</text>
<text top="694" left="73" width="111" height="13" font="4">Negative Binomial</text>
<text top="694" left="675" width="143" height="13" font="4">reverse parameter order</text>
<text top="714" left="202" width="9" height="13" font="4">R</text>
<text top="707" left="258" width="35" height="14" font="7">Γ(x+n)</text>
<text top="719" left="261" width="30" height="14" font="7">Γ(n)x!</text>
<text top="714" left="296" width="7" height="13" font="4">p</text>
<text top="711" left="303" width="6" height="10" font="7">n</text>
<text top="714" left="312" width="5" height="12" font="0">(</text>
<text top="714" left="318" width="7" height="13" font="4">1</text>
<text top="713" left="327" width="11" height="16" font="0">−</text>
<text top="714" left="342" width="7" height="13" font="4">p</text>
<text top="714" left="349" width="5" height="12" font="0">)</text>
<text top="710" left="355" width="5" height="10" font="7">x</text>
<text top="715" left="431" width="55" height="11" font="4">dnbinom(</text>
<text top="714" left="486" width="153" height="13" font="4">x, size = n, prob = p)</text>
<text top="714" left="675" width="125" height="13" font="4">size (n) is continuous</text>
<text top="736" left="202" width="36" height="13" font="4">BUGS</text>
<text top="736" left="256" width="5" height="12" font="0">(</text>
<text top="732" left="262" width="18" height="10" font="7">x+r</text>
<text top="731" left="281" width="14" height="13" font="7">−1</text>
<text top="742" left="275" width="5" height="10" font="7">x</text>
<text top="736" left="295" width="5" height="12" font="0">)</text>
<text top="736" left="301" width="7" height="13" font="4">p</text>
<text top="733" left="308" width="4" height="10" font="7">r</text>
<text top="736" left="316" width="5" height="12" font="0">(</text>
<text top="736" left="321" width="7" height="13" font="4">1</text>
<text top="734" left="331" width="11" height="16" font="0">−</text>
<text top="736" left="345" width="7" height="13" font="4">p</text>
<text top="736" left="352" width="5" height="12" font="0">)</text>
<text top="731" left="358" width="5" height="10" font="7">x</text>
<text top="736" left="431" width="96" height="11" font="4">dnegbin(prob =</text>
<text top="736" left="534" width="81" height="13" font="4">p, size = r)</text>
<text top="736" left="675" width="104" height="13" font="4">size (r) is discrete</text>
<text top="760" left="73" width="46" height="13" font="4">Weibull</text>
<text top="780" left="202" width="9" height="13" font="4">R</text>
<text top="777" left="258" width="5" height="10" font="7">a</text>
<text top="787" left="258" width="5" height="10" font="7">b</text>
<text top="780" left="265" width="5" height="12" font="0">(</text>
<text top="777" left="272" width="5" height="10" font="7">x</text>
<text top="787" left="273" width="5" height="10" font="7">b</text>
<text top="780" left="280" width="5" height="12" font="0">)</text>
<text top="777" left="286" width="5" height="10" font="7">a</text>
<text top="776" left="291" width="14" height="13" font="7">−1</text>
<text top="780" left="307" width="21" height="13" font="4">exp</text>
<text top="774" left="331" width="8" height="6" font="4"></text>
<text top="779" left="340" width="11" height="16" font="0">−</text>
<text top="777" left="362" width="5" height="10" font="7">x</text>
<text top="787" left="362" width="5" height="10" font="7">b</text>
<text top="778" left="369" width="6" height="6" font="4"></text>
<text top="775" left="376" width="5" height="10" font="7">a</text>
<text top="774" left="381" width="8" height="6" font="4"></text>
<text top="781" left="431" width="62" height="11" font="4">dweibull(</text>
<text top="780" left="493" width="164" height="13" font="4">x, shape = a, scale = b)</text>
<text top="805" left="202" width="36" height="13" font="4">BUGS</text>
<text top="808" left="256" width="22" height="10" font="10"><i>νλ</i>x</text>
<text top="805" left="279" width="5" height="8" font="8"><i>ν</i></text>
<text top="802" left="284" width="14" height="13" font="7">−1</text>
<text top="805" left="301" width="21" height="13" font="4">exp</text>
<text top="805" left="325" width="5" height="12" font="0">(</text>
<text top="804" left="331" width="11" height="16" font="0">−</text>
<text top="808" left="342" width="15" height="10" font="10"><i>λ</i>x</text>
<text top="805" left="358" width="5" height="8" font="8"><i>ν</i></text>
<text top="805" left="364" width="5" height="12" font="0">)</text>
<text top="806" left="431" width="194" height="13" font="4">dweib(shape = <i>ν</i>, lambda = <i>λ</i>)</text>
<text top="808" left="675" width="8" height="10" font="10"><i>λ</i></text>
<text top="805" left="687" width="11" height="12" font="0">=</text>
<text top="799" left="702" width="8" height="6" font="4"></text>
<text top="802" left="712" width="5" height="10" font="7">1</text>
<text top="812" left="712" width="5" height="10" font="7">b</text>
<text top="799" left="719" width="8" height="6" font="4"></text>
<text top="796" left="728" width="5" height="10" font="7">a</text>
<text top="833" left="73" width="47" height="13" font="4">Gamma</text>
<text top="833" left="675" width="143" height="13" font="4">reverse parameter order</text>
<text top="851" left="202" width="9" height="13" font="4">R</text>
<text top="847" left="263" width="4" height="10" font="7">r</text>
<text top="846" left="268" width="3" height="7" font="9">a</text>
<text top="856" left="258" width="20" height="14" font="7">Γ(a)</text>
<text top="851" left="280" width="7" height="13" font="4">x</text>
<text top="848" left="287" width="5" height="10" font="7">a</text>
<text top="847" left="292" width="14" height="13" font="7">−1</text>
<text top="851" left="309" width="21" height="13" font="4">exp</text>
<text top="851" left="331" width="5" height="12" font="0">(</text>
<text top="849" left="336" width="11" height="16" font="0">−</text>
<text top="851" left="348" width="12" height="13" font="4">xr</text>
<text top="851" left="361" width="5" height="12" font="0">)</text>
<text top="851" left="431" width="48" height="11" font="4">dgamma(</text>
<text top="851" left="479" width="157" height="13" font="4">x, shape = a, rate = r)</text>
<text top="875" left="202" width="36" height="13" font="4">BUGS</text>
<text top="873" left="258" width="6" height="8" font="8"><i>λ</i></text>
<text top="868" left="264" width="3" height="7" font="9">r</text>
<text top="870" left="268" width="5" height="10" font="7">x</text>
<text top="868" left="274" width="3" height="7" font="9">r</text>
<text top="868" left="277" width="10" height="9" font="9">−1</text>
<text top="870" left="289" width="21" height="10" font="7">exp(</text>
<text top="869" left="311" width="25" height="13" font="7">−<i>λ</i>x)</text>
<text top="880" left="287" width="19" height="14" font="7">Γ(r)</text>
<text top="876" left="431" width="96" height="11" font="4">dgamma(shape =</text>
<text top="875" left="534" width="96" height="13" font="4">r, lambda = <i>λ</i>)</text>
<text top="915" left="148" width="47" height="13" font="3"><b>Table 1:</b></text>
<text top="915" left="199" width="546" height="13" font="4">Summary of different parameterizations of common distributions used by R and BUGS. <b>Note:</b></text>
<text top="932" left="149" width="595" height="13" font="4">For ease of reference, parameterizations follow the JAGS and R documentation; as a result, the table</text>
<text top="948" left="149" width="596" height="13" font="4">includes equivalent equations that appear different, either because JAGS and R use different names for</text>
<text top="965" left="149" width="596" height="13" font="4">the same parameter or because the equation has been rearranged. For example, the shape parameter</text>
<text top="981" left="149" width="595" height="13" font="4">of the Gamma distribution is r in the BUGS documentation and a in the R documentation. For the</text>
<text top="997" left="148" width="596" height="14" font="4">Binomial, Negative Binomial, and Gamma distributions, BUGS and R expect parameters in different order</text>
<text top="1014" left="148" width="596" height="13" font="4">(the order of parameters matters since arguments are assigned based on position in BUGS and may be</text>
<text top="1030" left="149" width="597" height="13" font="4">in R as well). R allows alternate parameterizations for the Negative Binomial and Gamma distributions,</text>
<text top="1047" left="149" width="597" height="13" font="4">but these are not shown here. The variable x is implicit in all of the BUGS “Use” expressions. The Beta,</text>
<text top="1063" left="148" width="568" height="14" font="4">Poisson, Exponential, and Uniform distributions have identical parameterizations in R and BUGS.</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="11" size="15" family="Times" color="#000000"/>
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">208</text>
<text top="100" left="149" width="371" height="17" font="11"><b>Probability density functions in R and BUGS</b></text>
<text top="139" left="149" width="598" height="13" font="4">R and BUGS implement many of the same probability distribution functions, but they often parame-</text>
<text top="155" left="149" width="274" height="13" font="4">terize the same distribution differently (Table</text>
<text top="155" left="426" width="7" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#1">1</a></text>
<text top="155" left="433" width="311" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#1">). </a>Although these probability distribution functions</text>
<text top="172" left="149" width="595" height="13" font="4">are clearly described in the documentation of their respective languages, we were unable to find a</text>
<text top="188" left="149" width="596" height="13" font="4">summary of these differences in one place. The motivation for this article is to document and clarify</text>
<text top="205" left="149" width="359" height="13" font="4">these differences. Our sources are the JAGS documentation <a href="2013-1-lebauer-dietze-bolker.html#3">(</a></text>
<text top="205" left="508" width="56" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">Plummer</a></text>
<text top="205" left="564" width="3" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">,</a></text>
<text top="205" left="571" width="27" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">2010</a></text>
<text top="205" left="598" width="147" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">) </a>and the documentation</text>
<text top="221" left="149" width="152" height="13" font="4">of individual R functions.</text>
<text top="266" left="149" width="261" height="17" font="11"><b>A bilingual translation function</b></text>
<text top="305" left="148" width="596" height="13" font="4">To support the automation of model specification in JAGS with priors computed and stored in R</text>
<text top="321" left="148" width="4" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">(</a></text>
<text top="321" left="153" width="81" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">LeBauer et al.</a></text>
<text top="321" left="234" width="3" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">,</a></text>
<text top="321" left="240" width="27" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">2013</a></text>
<text top="321" left="267" width="478" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">), </a>we developed a function to translate parameterizations of common probability</text>
<text top="338" left="149" width="596" height="13" font="4">distributions from R to BUGS (and back again, by specifying direction = ’bugs2r’). Parameter</text>
<text top="354" left="149" width="559" height="13" font="4">transformations, parameter order, and differences in function names are documented in Table</text>
<text top="354" left="711" width="7" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#1">1</a></text>
<text top="354" left="721" width="23" height="13" font="4">and</text>
<text top="370" left="149" width="326" height="13" font="4">implemented in the R function r2bugs.distributions.</text>
<text top="401" left="149" width="439" height="11" font="4">r2bugs.distributions &lt;- function(priors, direction = ’r2bugs’) {</text>
<text top="417" left="163" width="82" height="11" font="4">priors$distn</text>
<text top="417" left="259" width="199" height="11" font="4">&lt;- as.character(priors$distn)</text>
<text top="434" left="163" width="288" height="11" font="4">priors$parama &lt;- as.numeric(priors$parama)</text>
<text top="450" left="163" width="288" height="11" font="4">priors$paramb &lt;- as.numeric(priors$paramb)</text>
<text top="467" left="163" width="302" height="11" font="4">## index dataframe according to distribution</text>
<text top="483" left="163" width="27" height="11" font="4">norm</text>
<text top="483" left="211" width="268" height="11" font="4">&lt;- priors$distn %in% c(’norm’, ’lnorm’)</text>
<text top="483" left="506" width="185" height="11" font="4"># these have same transform</text>
<text top="500" left="163" width="27" height="11" font="4">weib</text>
<text top="500" left="211" width="206" height="11" font="4">&lt;- grepl(&#34;weib&#34;, priors$distn)</text>
<text top="500" left="506" width="192" height="11" font="4"># matches r and bugs version</text>
<text top="516" left="163" width="34" height="11" font="4">gamma</text>
<text top="516" left="211" width="178" height="11" font="4">&lt;- priors$distn == ’gamma’</text>
<text top="532" left="163" width="27" height="11" font="4">chsq</text>
<text top="532" left="211" width="213" height="11" font="4">&lt;- grepl(&#34;chisq&#34;, priors$distn)</text>
<text top="532" left="506" width="192" height="11" font="4"># matches r and bugs version</text>
<text top="549" left="163" width="21" height="11" font="4">bin</text>
<text top="549" left="211" width="261" height="11" font="4">&lt;- priors$distn %in% c(’binom’, ’bin’)</text>
<text top="549" left="506" width="192" height="11" font="4"># matches r and bugs version</text>
<text top="565" left="163" width="27" height="11" font="4">nbin</text>
<text top="565" left="211" width="487" height="11" font="4">&lt;- priors$distn %in% c(’nbinom’, ’negbin’) # matches r and bugs version</text>
<text top="598" left="163" width="316" height="11" font="4">## Normal, log-Normal: Convert sd to precision</text>
<text top="615" left="163" width="350" height="11" font="4">exponent &lt;- ifelse(direction == &#34;r2bugs&#34;, -2, -0.5)</text>
<text top="631" left="163" width="151" height="11" font="4">priors$paramb[norm] &lt;-</text>
<text top="631" left="327" width="206" height="11" font="4">priors$paramb[norm] ^ exponent</text>
<text top="664" left="163" width="69" height="11" font="4">## Weibull</text>
<text top="680" left="163" width="178" height="11" font="4">if(direction == ’r2bugs’){</text>
<text top="697" left="176" width="439" height="11" font="4">## Convert R parameter b to BUGS parameter lambda by l = (1/b)^a</text>
<text top="713" left="176" width="480" height="11" font="4">priors$paramb[weib] &lt;- (1 / priors$paramb[weib]) ^ priors$parama[weib]</text>
<text top="730" left="163" width="240" height="11" font="4">} else if (direction == ’bugs2r’) {</text>
<text top="746" left="176" width="466" height="11" font="4">## Convert BUGS parameter lambda to BUGS parameter b by b = l^(-1/a)</text>
<text top="763" left="176" width="151" height="11" font="4">priors$paramb[weib] &lt;-</text>
<text top="763" left="341" width="343" height="11" font="4">priors$paramb[weib] ^ (- 1 / priors$parama[weib] )</text>
<text top="779" left="163" width="7" height="11" font="4">}</text>
<text top="812" left="163" width="418" height="11" font="4">## Reverse parameter order for binomial and negative binomial</text>
<text top="828" left="163" width="302" height="11" font="4">priors[bin | nbin, c(’parama’, ’paramb’)] &lt;-</text>
<text top="845" left="176" width="281" height="11" font="4">priors[bin | nbin, c(’paramb’, ’parama’)]</text>
<text top="878" left="163" width="213" height="11" font="4">## Translate distribution names</text>
<text top="894" left="163" width="178" height="11" font="4">if(direction == &#34;r2bugs&#34;){</text>
<text top="910" left="176" width="192" height="11" font="4">priors$distn[weib] &lt;- &#34;weib&#34;</text>
<text top="927" left="176" width="206" height="11" font="4">priors$distn[chsq] &lt;- &#34;chisqr&#34;</text>
<text top="943" left="176" width="117" height="11" font="4">priors$distn[bin]</text>
<text top="943" left="307" width="55" height="11" font="4">&lt;- &#34;bin&#34;</text>
<text top="960" left="176" width="206" height="11" font="4">priors$distn[nbin] &lt;- &#34;negbin&#34;</text>
<text top="976" left="163" width="226" height="11" font="4">} else if(direction == &#34;bugs2r&#34;){</text>
<text top="993" left="176" width="213" height="11" font="4">priors$distn[weib] &lt;- &#34;weibull&#34;</text>
<text top="1009" left="176" width="199" height="11" font="4">priors$distn[chsq] &lt;- &#34;chisq&#34;</text>
<text top="1026" left="176" width="117" height="11" font="4">priors$distn[bin]</text>
<text top="1026" left="307" width="69" height="11" font="4">&lt;- &#34;binom&#34;</text>
<text top="1042" left="176" width="206" height="11" font="4">priors$distn[nbin] &lt;- &#34;nbinom&#34;</text>
<text top="1058" left="163" width="7" height="11" font="4">}</text>
<text top="1075" left="163" width="96" height="11" font="4">return(priors)</text>
<text top="1091" left="149" width="7" height="11" font="4">}</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">209</text>
<text top="100" left="149" width="147" height="17" font="11"><b>A simple example</b></text>
<text top="141" left="148" width="386" height="13" font="4">As an example, we take the R-parameterized prior distribution X</text>
<text top="139" left="539" width="34" height="16" font="0">∼ N (</text>
<text top="144" left="573" width="8" height="10" font="10"><i>µ</i></text>
<text top="141" left="585" width="11" height="12" font="0">=</text>
<text top="141" left="600" width="27" height="13" font="4">10, <i>σ</i></text>
<text top="141" left="631" width="11" height="12" font="0">=</text>
<text top="141" left="646" width="7" height="13" font="4">2</text>
<text top="141" left="653" width="5" height="12" font="0">)</text>
<text top="141" left="662" width="83" height="13" font="4">and convert it</text>
<text top="157" left="149" width="173" height="13" font="4">to BUGS parameterization X</text>
<text top="156" left="327" width="35" height="16" font="0">∼ N (</text>
<text top="160" left="362" width="8" height="10" font="10"><i>µ</i></text>
<text top="157" left="374" width="11" height="12" font="0">=</text>
<text top="157" left="389" width="27" height="13" font="4">10, <i>τ</i></text>
<text top="157" left="420" width="11" height="12" font="0">=</text>
<text top="157" left="435" width="22" height="13" font="4">1/4</text>
<text top="157" left="457" width="5" height="12" font="0">)</text>
<text top="157" left="463" width="281" height="13" font="4">. We specify a model in JAGS that allows us to</text>
<text top="174" left="149" width="584" height="13" font="4">sample directly from a prior distribution. The function works for each of the distributions in Table</text>
<text top="174" left="736" width="7" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#1">1</a></text>
<text top="174" left="743" width="3" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#1">.</a></text>
<text top="190" left="148" width="596" height="13" font="4">This particular example is the JAGS implementation of ‘rnorm(10000,10,2)’ in R. It is presented as</text>
<text top="206" left="149" width="337" height="13" font="4">minimal demonstration; for a non-trivial application, see</text>
<text top="206" left="489" width="81" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">LeBauer et al.</a></text>
<text top="206" left="573" width="4" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">(</a></text>
<text top="206" left="578" width="27" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">2013</a></text>
<text top="206" left="605" width="8" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">).</a></text>
<text top="253" left="149" width="425" height="11" font="4">r.distn &lt;- data.frame(distn = &#34;norm&#34;, parama = 10, paramb = 2)</text>
<text top="270" left="149" width="295" height="11" font="4">bugs.distn &lt;- r2bugs.distributions(r.distn)</text>
<text top="303" left="149" width="521" height="11" font="4">sample.bugs.distn &lt;- function(prior = data.frame(distn = &#34;norm&#34;, parama = 0,</text>
<text top="319" left="368" width="171" height="11" font="4">paramb = 1), n = 10000) {</text>
<text top="336" left="163" width="96" height="11" font="4">require(rjags)</text>
<text top="352" left="163" width="158" height="11" font="4">model.string &lt;- paste0(</text>
<text top="368" left="176" width="185" height="11" font="4">&#34;model{Y ~ d&#34;, prior$distn,</text>
<text top="385" left="176" width="123" height="11" font="4">&#34;(&#34;, prior$parama,</text>
<text top="401" left="176" width="219" height="11" font="4">## chisqr has only one parameter</text>
<text top="418" left="176" width="480" height="11" font="4">ifelse(prior$distn == &#34;chisqr&#34;, &#34;&#34;, paste0(&#34;, &#34;, prior$paramb)), &#34;);&#34;,</text>
<text top="434" left="176" width="62" height="11" font="4">&#34;a &lt;- x}&#34;</text>
<text top="451" left="163" width="7" height="11" font="4">)</text>
<text top="467" left="163" width="268" height="11" font="4">## trick JAGS into running without data</text>
<text top="483" left="163" width="288" height="11" font="4">writeLines(model.string, con = &#34;test.bug&#34;)</text>
<text top="500" left="163" width="48" height="11" font="4">j.model</text>
<text top="500" left="224" width="357" height="11" font="4">&lt;- jags.model(file = &#34;test.bug&#34;, data = list(x = 1))</text>
<text top="516" left="163" width="151" height="11" font="4">mcmc.object &lt;- window(</text>
<text top="533" left="176" width="89" height="11" font="4">coda.samples(</text>
<text top="549" left="190" width="281" height="11" font="4">model = j.model, variable.names = c(’Y’),</text>
<text top="566" left="190" width="178" height="11" font="4">n.iter = n * 4, thin = 2),</text>
<text top="582" left="176" width="69" height="11" font="4">start = n)</text>
<text top="599" left="163" width="302" height="11" font="4">Y &lt;- sample(as.matrix(mcmc.object)[,&#34;Y&#34;], n)</text>
<text top="615" left="149" width="7" height="11" font="4">}</text>
<text top="631" left="149" width="233" height="11" font="4">X &lt;- sample.bugs.distn(bugs.distn)</text>
<text top="676" left="149" width="152" height="17" font="11"><b>Acknowlegements</b></text>
<text top="715" left="148" width="384" height="13" font="4">This collaboration began on the Cross Validated statistical forum <a href="http://stats.stackexchange.com/q/5543/1381">(</a></text>
<text top="715" left="533" width="213" height="11" font="6"><a href="http://stats.stackexchange.com/q/5543/1381">http://stats.stackexchange.com/</a></text>
<text top="732" left="149" width="75" height="11" font="6"><a href="http://stats.stackexchange.com/q/5543/1381">q/5543/1381</a></text>
<text top="731" left="224" width="468" height="13" font="4"><a href="http://stats.stackexchange.com/q/5543/1381">). </a>Funding was provided to DSL and MCD by the Energy Biosciences Institute.</text>
<text top="776" left="149" width="109" height="17" font="11"><b>Bibliography</b></text>
<text top="815" left="149" width="595" height="13" font="4">D. S. LeBauer, D. Wang, K. T. Richter, C. C. Davidson, and M. C. Dietze. Facilitating feedbacks</text>
<text top="831" left="164" width="583" height="13" font="4">between field measurements and ecosystem models. Ecological Monographs, 83(2):133–154, 2013.</text>
<text top="847" left="164" width="28" height="13" font="4">URL</text>
<text top="848" left="195" width="357" height="11" font="6"><a href="http://www.esajournals.org/doi/abs/10.1890/12-0137.1">http://www.esajournals.org/doi/abs/10.1890/12-0137.1</a></text>
<text top="847" left="552" width="21" height="13" font="4"><a href="http://www.esajournals.org/doi/abs/10.1890/12-0137.1">. </a><a href="2013-1-lebauer-dietze-bolker.html#2">[p</a></text>
<text top="847" left="573" width="20" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#2">208</a></text>
<text top="847" left="593" width="3" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#2">,</a></text>
<text top="847" left="600" width="20" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#3">209</a></text>
<text top="847" left="620" width="4" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#3">]</a></text>
<text top="876" left="149" width="341" height="13" font="4">M. Plummer. JAGS Version 3.1.0 user manual, 2010. URL</text>
<text top="876" left="493" width="254" height="11" font="6"><a href="http://sourceforge.net/projects/mcmc-jags/">http://sourceforge.net/projects/mcmc-</a></text>
<text top="893" left="164" width="34" height="11" font="6"><a href="http://sourceforge.net/projects/mcmc-jags/">jags/</a></text>
<text top="892" left="198" width="21" height="13" font="4"><a href="http://sourceforge.net/projects/mcmc-jags/">. </a><a href="2013-1-lebauer-dietze-bolker.html#2">[p</a></text>
<text top="892" left="219" width="20" height="13" font="6"><a href="2013-1-lebauer-dietze-bolker.html#2">208</a></text>
<text top="892" left="239" width="4" height="13" font="4"><a href="2013-1-lebauer-dietze-bolker.html#2">]</a></text>
<text top="936" left="148" width="96" height="13" font="4">David S. LeBauer</text>
<text top="952" left="148" width="154" height="13" font="4">Energy Biosciences Institute</text>
<text top="968" left="148" width="114" height="13" font="4">University of Illinois</text>
<text top="985" left="148" width="28" height="13" font="4">USA</text>
<text top="1002" left="149" width="144" height="11" font="6"><a href="mailto:dlebauer@illinois.edu">dlebauer@illinois.edu</a></text>
<text top="1039" left="149" width="98" height="13" font="4">Michael C. Dietze</text>
<text top="1055" left="148" width="216" height="13" font="4">Department of Earth And Environment</text>
<text top="1072" left="148" width="100" height="13" font="4">Boston University</text>
<text top="1088" left="148" width="28" height="13" font="4">USA</text>
<text top="936" left="454" width="109" height="13" font="4">Benjamin M. Bolker</text>
<text top="952" left="453" width="220" height="13" font="4">Department of Mathematics &amp; Statistics</text>
<text top="968" left="454" width="119" height="13" font="4">McMaster University</text>
<text top="985" left="453" width="41" height="13" font="4">Canada</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
</pdf2xml>
