<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml producer="poppler" version="0.30.0">
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="12" family="Times" color="#000000"/>
	<fontspec id="1" size="9" family="Times" color="#000000"/>
	<fontspec id="2" size="35" family="Times" color="#000000"/>
	<fontspec id="3" size="9" family="Times" color="#00004c"/>
	<fontspec id="4" size="12" family="Times" color="#000000"/>
	<fontspec id="5" size="19" family="Times" color="#000000"/>
	<fontspec id="6" size="12" family="Times" color="#00004c"/>
	<fontspec id="7" size="12" family="Times" color="#00004c"/>
	<fontspec id="8" size="15" family="Times" color="#000000"/>
	<fontspec id="9" size="13" family="Times" color="#000000"/>
	<fontspec id="10" size="6" family="Times" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="798" width="7" height="15" font="0">5</text>
<text top="121" left="82" width="604" height="36" font="2"><b>Solving Differential Equations in R</b></text>
<text top="173" left="82" width="346" height="15" font="0">by Karline Soetaert, Thomas Petzoldt and R. Woodrow</text>
<text top="191" left="82" width="37" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#1">Setzer</a></text>
<text top="188" left="120" width="6" height="11" font="3"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#1">1</a></text>
<text top="223" left="96" width="57" height="15" font="4"><b>Abstract</b></text>
<text top="223" left="163" width="252" height="15" font="0">Although R is still predominantly ap-</text>
<text top="241" left="96" width="319" height="15" font="0">plied for statistical analysis and graphical repre-</text>
<text top="259" left="96" width="319" height="15" font="0">sentation, it is rapidly becoming more suitable</text>
<text top="277" left="96" width="319" height="15" font="0">for mathematical computing. One of the fields</text>
<text top="294" left="96" width="319" height="15" font="0">where considerable progress has been made re-</text>
<text top="312" left="96" width="319" height="15" font="0">cently is the solution of differential equations.</text>
<text top="330" left="96" width="319" height="15" font="0">Here we give a brief overview of differential</text>
<text top="348" left="96" width="258" height="15" font="0">equations that can now be solved by R.</text>
<text top="404" left="82" width="124" height="21" font="5"><b>Introduction</b></text>
<text top="445" left="82" width="346" height="15" font="0">Differential equations describe exchanges of matter,</text>
<text top="463" left="82" width="346" height="15" font="0">energy, information or any other quantities, often as</text>
<text top="481" left="82" width="346" height="15" font="0">they vary in time and/or space. Their thorough ana-</text>
<text top="499" left="82" width="346" height="15" font="0">lytical treatment forms the basis of fundamental the-</text>
<text top="517" left="82" width="346" height="15" font="0">ories in mathematics and physics, and they are in-</text>
<text top="535" left="82" width="346" height="15" font="0">creasingly applied in chemistry, life sciences and eco-</text>
<text top="553" left="82" width="51" height="15" font="0">nomics.</text>
<text top="573" left="105" width="324" height="15" font="0">Differential equations are solved by integration,</text>
<text top="591" left="82" width="346" height="15" font="0">but unfortunately, for many practical applications</text>
<text top="608" left="82" width="346" height="15" font="0">in science and engineering, systems of differential</text>
<text top="626" left="82" width="346" height="15" font="0">equations cannot be integrated to give an analytical</text>
<text top="644" left="82" width="332" height="15" font="0">solution, but rather need to be solved numerically.</text>
<text top="664" left="105" width="324" height="15" font="0">Many advanced numerical algorithms that solve</text>
<text top="682" left="82" width="346" height="15" font="0">differential equations are available as (open-source)</text>
<text top="700" left="82" width="346" height="15" font="0">computer codes, written in programming languages</text>
<text top="718" left="82" width="346" height="15" font="0">like FORTRAN or C and that are available from</text>
<text top="736" left="82" width="163" height="15" font="0">repositories like GAMS <a href="http://gams.nist.gov/">(</a></text>
<text top="737" left="246" width="160" height="12" font="6"><a href="http://gams.nist.gov/">http://gams.nist.gov/</a></text>
<text top="736" left="406" width="23" height="15" font="0"><a href="http://gams.nist.gov/">) </a>or</text>
<text top="754" left="82" width="63" height="15" font="0">NETLIB <a href="http://www.netlib.org">(</a></text>
<text top="755" left="145" width="107" height="12" font="6"><a href="http://www.netlib.org">www.netlib.org</a></text>
<text top="754" left="252" width="9" height="15" font="0"><a href="http://www.netlib.org">).</a></text>
<text top="773" left="105" width="324" height="15" font="0">Depending on the problem, mathematical for-</text>
<text top="791" left="82" width="346" height="15" font="0">malisations may consist of ordinary differential</text>
<text top="809" left="82" width="346" height="15" font="0">equations (ODE), partial differential equations</text>
<text top="827" left="82" width="346" height="15" font="0">(PDE), differential algebraic equations (DAE), or de-</text>
<text top="845" left="82" width="346" height="15" font="0">lay differential equations (DDE). In addition, a dis-</text>
<text top="863" left="82" width="346" height="15" font="0">tinction is made between initial value problems (IVP)</text>
<text top="881" left="82" width="246" height="15" font="0">and boundary value problems (BVP).</text>
<text top="900" left="105" width="324" height="15" font="0">With the introduction of R-package odesolve</text>
<text top="918" left="82" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="918" left="87" width="40" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Setzer</a></text>
<text top="918" left="128" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="918" left="136" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2001</a></text>
<text top="918" left="166" width="205" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>it became possible to use R <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="918" left="371" width="58" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">R Devel-</a></text>
<text top="936" left="82" width="125" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">opment Core Team</a></text>
<text top="936" left="207" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="936" left="214" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="936" left="244" width="185" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>for solving very simple ini-</text>
<text top="954" left="82" width="346" height="15" font="0">tial value problems of systems of ordinary differen-</text>
<text top="972" left="82" width="301" height="15" font="0">tial equations, using the lsoda algorithm of</text>
<text top="972" left="389" width="40" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hind-</a></text>
<text top="990" left="82" width="42" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">marsh</a></text>
<text top="990" left="130" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="990" left="135" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1983</a></text>
<text top="990" left="165" width="37" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>and</text>
<text top="990" left="208" width="50" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Petzold</a></text>
<text top="990" left="264" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="990" left="269" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1983</a></text>
<text top="990" left="299" width="130" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>However, many</text>
<text top="1008" left="82" width="346" height="15" font="0">real-life applications, including physical transport</text>
<text top="1026" left="82" width="346" height="15" font="0">modeling, equilibrium chemistry or the modeling of</text>
<text top="1044" left="82" width="346" height="15" font="0">electrical circuits, could not be solved with this pack-</text>
<text top="1062" left="82" width="27" height="15" font="0">age.</text>
<text top="1081" left="105" width="324" height="15" font="0">Since odesolve, much effort has been made to</text>
<text top="1099" left="82" width="346" height="15" font="0">improve R’s capabilities to handle differential equa-</text>
<text top="1117" left="82" width="346" height="15" font="0">tions, mostly by incorporating published and well</text>
<text top="1135" left="82" width="346" height="15" font="0">tested numerical codes, such that now a much more</text>
<text top="173" left="459" width="346" height="15" font="0">complete repertoire of differential equations can be</text>
<text top="191" left="459" width="130" height="15" font="0">numerically solved.</text>
<text top="209" left="481" width="324" height="15" font="0">More specifically, the following types of differen-</text>
<text top="227" left="459" width="346" height="15" font="0">tial equations can now be handled with add-on pack-</text>
<text top="245" left="459" width="64" height="15" font="0">ages in R:</text>
<text top="269" left="481" width="324" height="19" font="0">• Initial value problems (IVP) of ordinary differ-</text>
<text top="290" left="496" width="251" height="15" font="0">ential equations (ODE), using package</text>
<text top="290" left="751" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="308" left="496" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="308" left="501" width="88" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="308" left="590" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="308" left="597" width="38" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010b</a></text>
<text top="308" left="635" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">).</a></text>
<text top="332" left="481" width="324" height="19" font="0">• Initial value differential algebraic equations</text>
<text top="354" left="496" width="104" height="15" font="0">(DAE), package</text>
<text top="354" left="604" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="354" left="663" width="4" height="15" font="0">.</text>
<text top="378" left="481" width="324" height="19" font="0">• Initial value partial differential equations</text>
<text top="399" left="496" width="43" height="15" font="0">(PDE),</text>
<text top="399" left="555" width="61" height="15" font="0">packages</text>
<text top="399" left="631" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="399" left="701" width="25" height="15" font="0">and</text>
<text top="399" left="742" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="417" left="496" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="417" left="501" width="152" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Meysman</a></text>
<text top="417" left="653" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="417" left="660" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010</a></text>
<text top="417" left="690" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">).</a></text>
<text top="442" left="481" width="324" height="19" font="0">• Boundary value problems (BVP) of ordinary</text>
<text top="463" left="496" width="241" height="15" font="0">differential equations, using package</text>
<text top="463" left="741" width="65" height="15" font="7"><a href="http://cran.r-project.org/package=bvpSolve"><b>bvpSolve</b></a></text>
<text top="481" left="496" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="481" left="501" width="92" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="481" left="593" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="481" left="602" width="37" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010a</a></text>
<text top="481" left="640" width="29" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>or</text>
<text top="481" left="674" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="481" left="742" width="25" height="15" font="0">and</text>
<text top="481" left="773" width="32" height="15" font="7"><a href="http://cran.r-project.org/package=rootSolve"><b>root-</b></a></text>
<text top="499" left="496" width="38" height="15" font="7"><a href="http://cran.r-project.org/package=rootSolve"><b>Solve</b></a></text>
<text top="499" left="538" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="499" left="543" width="53" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert</a></text>
<text top="499" left="597" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="499" left="604" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2009</a></text>
<text top="499" left="634" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">).</a></text>
<text top="523" left="481" width="324" height="19" font="0">• Initial value delay differential equations</text>
<text top="545" left="496" width="156" height="15" font="0">(DDE), using packages</text>
<text top="545" left="658" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="545" left="719" width="14" height="15" font="0">or</text>
<text top="545" left="740" width="66" height="15" font="7"><a href="http://cran.r-project.org/package=PBSddesolve"><b>PBSddes-</b></a></text>
<text top="563" left="496" width="29" height="15" font="7"><a href="http://cran.r-project.org/package=PBSddesolve"><b>olve</b></a></text>
<text top="562" left="529" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="562" left="534" width="119" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Couture-Beil et al.</a></text>
<text top="562" left="653" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="562" left="661" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2010</a></text>
<text top="562" left="691" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="587" left="481" width="324" height="19" font="0">• Stochastic differential equations (SDE), using</text>
<text top="608" left="496" width="61" height="15" font="0">packages</text>
<text top="608" left="564" width="23" height="15" font="7"><a href="http://cran.r-project.org/package=sde"><b>sde</b></a></text>
<text top="608" left="595" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="608" left="600" width="34" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Iacus</a></text>
<text top="608" left="635" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="608" left="646" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="608" left="676" width="38" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>and</text>
<text top="608" left="721" width="40" height="15" font="7"><a href="http://cran.r-project.org/package=pomp"><b>pomp</b></a></text>
<text top="608" left="768" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="608" left="773" width="32" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">King</a></text>
<text top="626" left="496" width="31" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">et al.</a></text>
<text top="626" left="528" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="626" left="535" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="626" left="565" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="654" left="481" width="324" height="15" font="0">In this short overview, we demonstrate how to</text>
<text top="672" left="459" width="346" height="15" font="0">solve the first four types of differential equations</text>
<text top="690" left="459" width="346" height="15" font="0">in R. It is beyond the scope to give an exhaustive</text>
<text top="707" left="459" width="346" height="15" font="0">overview about the vast number of methods to solve</text>
<text top="725" left="459" width="346" height="15" font="0">these differential equations and their theory, so the</text>
<text top="743" left="459" width="346" height="15" font="0">reader is encouraged to consult one of the numer-</text>
<text top="761" left="459" width="129" height="15" font="0">ous textbooks (e.g.,</text>
<text top="761" left="592" width="131" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Ascher and Petzold</a></text>
<text top="761" left="724" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="761" left="732" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1998</a></text>
<text top="761" left="762" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="761" left="771" width="34" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Press</a></text>
<text top="779" left="459" width="33" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">et al.</a></text>
<text top="779" left="492" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="779" left="501" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="779" left="531" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="779" left="541" width="82" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer et al.</a></text>
<text top="779" left="622" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="779" left="631" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="779" left="661" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="779" left="671" width="131" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer and Wanner</a></text>
<text top="779" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="797" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2010</a></text>
<text top="797" left="489" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="797" left="496" width="57" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">LeVeque</a></text>
<text top="797" left="553" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="797" left="561" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="797" left="591" width="128" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">, </a>and many others).</text>
<text top="815" left="481" width="324" height="15" font="0">In addition, a large number of analytical and nu-</text>
<text top="833" left="459" width="346" height="15" font="0">merical methods exists for the analysis of bifurca-</text>
<text top="851" left="459" width="346" height="15" font="0">tions and stability properties of deterministic sys-</text>
<text top="869" left="459" width="346" height="15" font="0">tems, the efficient simulation of stochastic differen-</text>
<text top="887" left="459" width="346" height="15" font="0">tial equations or the estimation of parameters. We</text>
<text top="905" left="459" width="244" height="15" font="0">do not deal with these methods here.</text>
<text top="951" left="459" width="303" height="21" font="5"><b>Types of differential equations</b></text>
<text top="990" left="459" width="259" height="17" font="8"><b>Ordinary differential equations</b></text>
<text top="1021" left="459" width="346" height="15" font="0">Ordinary differential equations describe the change</text>
<text top="1039" left="459" width="346" height="15" font="0">of a state variable y as a function f of one independent</text>
<text top="1056" left="459" width="346" height="15" font="0">variable t (e.g., time or space), of y itself, and, option-</text>
<text top="1074" left="459" width="346" height="15" font="0">ally, a set of other variables p, often called parameters:</text>
<text top="1124" left="570" width="7" height="15" font="0">y</text>
<text top="1120" left="578" width="3" height="11" font="1">0</text>
<text top="1124" left="586" width="12" height="14" font="9">=</text>
<text top="1114" left="604" width="15" height="15" font="0">dy</text>
<text top="1135" left="605" width="13" height="15" font="0">dt</text>
<text top="1124" left="624" width="12" height="14" font="9">=</text>
<text top="1124" left="642" width="4" height="15" font="0">f</text>
<text top="1124" left="649" width="6" height="14" font="9">(</text>
<text top="1124" left="655" width="32" height="15" font="0">t, y, p</text>
<text top="1124" left="688" width="6" height="14" font="9">)</text>
<text top="1159" left="99" width="4" height="9" font="10">1</text>
<text top="1161" left="104" width="701" height="12" font="1">The views expressed in this paper are those of the authors and do not necessarily reflect the views or policies of the U.S. Environmental</text>
<text top="1175" left="82" width="98" height="12" font="1">Protection Agency</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="11" size="12" family="Times" color="#000000"/>
<text top="67" left="82" width="7" height="15" font="0">6</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="105" width="324" height="15" font="0">In many cases, solving differential equations re-</text>
<text top="143" left="82" width="346" height="15" font="0">quires the introduction of extra conditions. In the fol-</text>
<text top="161" left="82" width="346" height="15" font="0">lowing, we concentrate on the numerical treatment</text>
<text top="179" left="82" width="346" height="15" font="0">of two classes of problems, namely initial value prob-</text>
<text top="197" left="82" width="238" height="15" font="0">lems and boundary value problems.</text>
<text top="241" left="82" width="152" height="15" font="4"><b>Initial value problems</b></text>
<text top="271" left="82" width="346" height="15" font="0">If the extra conditions are specified at the initial value</text>
<text top="289" left="82" width="346" height="15" font="0">of the independent variable, the differential equa-</text>
<text top="307" left="82" width="296" height="15" font="0">tions are called <b>initial value problems </b>(IVP).</text>
<text top="326" left="105" width="324" height="15" font="0">There exist two main classes of algorithms to nu-</text>
<text top="344" left="82" width="346" height="15" font="0">merically solve such problems, so-called Runge-Kutta</text>
<text top="361" left="82" width="263" height="15" font="0">formulas and linear multistep formulas <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="361" left="346" width="79" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer et al.</a></text>
<text top="361" left="425" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="379" left="82" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="379" left="112" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="379" left="121" width="129" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer and Wanner</a></text>
<text top="379" left="250" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="379" left="258" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2010</a></text>
<text top="379" left="288" width="141" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>The latter contains</text>
<text top="397" left="82" width="346" height="15" font="0">two important families, the Adams family and the</text>
<text top="415" left="82" width="274" height="15" font="0">backward differentiation formulae (BDF).</text>
<text top="434" left="105" width="324" height="15" font="0">Another important distinction is between explicit</text>
<text top="452" left="82" width="346" height="15" font="0">and implicit methods, where the latter methods can</text>
<text top="470" left="82" width="346" height="15" font="0">solve a particular class of equations (so-called “stiff”</text>
<text top="488" left="82" width="346" height="15" font="0">equations) where explicit methods have problems</text>
<text top="506" left="82" width="346" height="15" font="0">with stability and efficiency. Stiffness occurs for in-</text>
<text top="524" left="82" width="346" height="15" font="0">stance if a problem has components with different</text>
<text top="541" left="82" width="346" height="15" font="0">rates of variation according to the independent vari-</text>
<text top="559" left="82" width="346" height="15" font="0">able. Very often there will be a tradeoff between us-</text>
<text top="577" left="82" width="346" height="15" font="0">ing explicit methods that require little work per inte-</text>
<text top="595" left="82" width="346" height="15" font="0">gration step and implicit methods which are able to</text>
<text top="613" left="82" width="346" height="15" font="0">take larger integration steps, but need (much) more</text>
<text top="631" left="82" width="120" height="15" font="0">work for one step.</text>
<text top="650" left="105" width="324" height="15" font="0">In R, initial value problems can be solved with</text>
<text top="668" left="82" width="166" height="15" font="0">functions from package</text>
<text top="668" left="257" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="668" left="321" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="668" left="326" width="99" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="668" left="425" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="686" left="82" width="38" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010b</a></text>
<text top="686" left="121" width="308" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>which implements many solvers from ODE-</text>
<text top="704" left="82" width="54" height="15" font="0">PACK <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="704" left="136" width="76" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hindmarsh</a></text>
<text top="704" left="213" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="704" left="225" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1983</a></text>
<text top="704" left="255" width="130" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>the code vode <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="704" left="385" width="44" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Brown</a></text>
<text top="721" left="82" width="31" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">et al.</a></text>
<text top="721" left="114" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="721" left="121" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1989</a></text>
<text top="721" left="151" width="278" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>the differential algebraic equation solver</text>
<text top="741" left="82" width="38" height="12" font="0">daspk</text>
<text top="739" left="124" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="739" left="129" width="82" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Brenan et al.</a></text>
<text top="739" left="211" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="739" left="218" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1996</a></text>
<text top="739" left="248" width="181" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>all belonging to the linear</text>
<text top="757" left="82" width="346" height="15" font="0">multistep methods, and comprising Adams meth-</text>
<text top="775" left="82" width="346" height="15" font="0">ods as well as backward differentiation formulae.</text>
<text top="793" left="82" width="346" height="15" font="0">The former methods are explicit, the latter implicit.</text>
<text top="811" left="82" width="346" height="15" font="0">In addition, this package contains a de-novo imple-</text>
<text top="829" left="82" width="346" height="15" font="0">mentation of a rather general Runge-Kutta solver</text>
<text top="847" left="82" width="62" height="15" font="0">based on</text>
<text top="847" left="152" width="145" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Dormand and Prince</a></text>
<text top="847" left="304" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="847" left="309" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1980</a></text>
<text top="847" left="339" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">);</a></text>
<text top="847" left="355" width="74" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Prince and</a></text>
<text top="865" left="82" width="64" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Dormand</a></text>
<text top="865" left="150" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="865" left="155" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1981</a></text>
<text top="865" left="184" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">);</a></text>
<text top="865" left="196" width="150" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Bogacki and Shampine</a></text>
<text top="865" left="349" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="865" left="354" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1989</a></text>
<text top="865" left="384" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">);</a></text>
<text top="865" left="396" width="33" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Cash</a></text>
<text top="883" left="82" width="62" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">and Karp</a></text>
<text top="883" left="148" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="883" left="153" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1990</a></text>
<text top="883" left="183" width="148" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>and using ideas from</text>
<text top="883" left="334" width="51" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Butcher</a></text>
<text top="883" left="389" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="883" left="394" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1987</a></text>
<text top="883" left="424" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">)</a></text>
<text top="901" left="82" width="25" height="15" font="0">and</text>
<text top="901" left="113" width="73" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Press et al.</a></text>
<text top="901" left="191" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="901" left="196" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="901" left="226" width="203" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>Finally, the implicit Runge-</text>
<text top="919" left="82" width="151" height="15" font="0">Kutta method radau <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="919" left="233" width="84" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer et al.</a></text>
<text top="919" left="317" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="919" left="327" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="919" left="357" width="72" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>has been</text>
<text top="937" left="82" width="101" height="15" font="0">added recently.</text>
<text top="981" left="82" width="177" height="15" font="4"><b>Boundary value problems</b></text>
<text top="1011" left="82" width="346" height="15" font="0">If the extra conditions are specified at different</text>
<text top="1029" left="82" width="346" height="15" font="0">values of the independent variable, the differen-</text>
<text top="1047" left="82" width="346" height="15" font="0">tial equations are called <b>boundary value problems</b></text>
<text top="1065" left="82" width="296" height="15" font="0">(BVP). A standard textbook on this subject is</text>
<text top="1065" left="383" width="46" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Ascher</a></text>
<text top="1083" left="82" width="31" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">et al.</a></text>
<text top="1083" left="118" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="1083" left="123" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1995</a></text>
<text top="1083" left="152" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="1101" left="105" width="54" height="15" font="0">Package</text>
<text top="1101" left="164" width="65" height="15" font="7"><a href="http://cran.r-project.org/package=bvpSolve"><b>bvpSolve</b></a></text>
<text top="1101" left="234" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="1101" left="239" width="91" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="1101" left="330" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1101" left="339" width="37" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010a</a></text>
<text top="1101" left="376" width="53" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>imple-</text>
<text top="1119" left="82" width="346" height="15" font="0">ments three methods to solve boundary value prob-</text>
<text top="1137" left="82" width="35" height="15" font="0">lems.</text>
<text top="1137" left="132" width="296" height="15" font="0">The simplest solution method is the single</text>
<text top="1155" left="82" width="346" height="15" font="0">shooting method, which combines initial value prob-</text>
<text top="1173" left="82" width="346" height="15" font="0">lem integration with a nonlinear root finding algo-</text>
<text top="125" left="459" width="49" height="15" font="0">rithm <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="125" left="508" width="77" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Press et al.</a></text>
<text top="125" left="585" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="125" left="596" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="125" left="626" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="125" left="650" width="156" height="15" font="0">Two more stable solu-</text>
<text top="143" left="459" width="346" height="15" font="0">tion methods implement a mono implicit Runge-</text>
<text top="161" left="459" width="346" height="15" font="0">Kutta (MIRK) code, based on the FORTRAN code</text>
<text top="180" left="459" width="53" height="12" font="0">twpbvpC</text>
<text top="179" left="515" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="179" left="520" width="113" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Cash and Mazzia</a></text>
<text top="179" left="633" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="179" left="640" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2005</a></text>
<text top="179" left="670" width="136" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>and the collocation</text>
<text top="197" left="459" width="308" height="15" font="0">method, based on the FORTRAN code colnew <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="197" left="767" width="39" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Bader</a></text>
<text top="215" left="459" width="77" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">and Ascher</a></text>
<text top="215" left="535" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="215" left="544" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1987</a></text>
<text top="215" left="574" width="231" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>Some boundary value problems</text>
<text top="233" left="459" width="319" height="15" font="0">can also be solved with functions from packages</text>
<text top="233" left="782" width="23" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>Re-</b></a></text>
<text top="251" left="459" width="45" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>acTran</b></a></text>
<text top="251" left="507" width="25" height="15" font="0">and</text>
<text top="251" left="536" width="66" height="15" font="7"><a href="http://cran.r-project.org/package=rootSolve"><b>rootSolve</b></a></text>
<text top="251" left="606" width="78" height="15" font="0">(see below).</text>
<text top="292" left="459" width="237" height="17" font="8"><b>Partial differential equations</b></text>
<text top="322" left="459" width="346" height="15" font="0">In contrast to ODEs where there is only one indepen-</text>
<text top="340" left="459" width="346" height="15" font="0">dent variable, partial differential equations (PDE)</text>
<text top="358" left="459" width="346" height="15" font="0">contain partial derivatives with respect to more than</text>
<text top="376" left="459" width="346" height="15" font="0">one independent variable, for instance t (time) and</text>
<text top="394" left="459" width="165" height="15" font="0">x (a spatial dimension).</text>
<text top="394" left="639" width="166" height="15" font="0">To distinguish this type</text>
<text top="412" left="459" width="346" height="15" font="0">of equations from ODEs, the derivatives are repre-</text>
<text top="430" left="459" width="196" height="15" font="0">sented with the <i>∂ </i>symbol, e.g.</text>
<text top="461" left="569" width="15" height="11" font="11"><i>∂</i>y</text>
<text top="481" left="570" width="13" height="11" font="11"><i>∂</i>t</text>
<text top="467" left="589" width="12" height="14" font="9">=</text>
<text top="467" left="607" width="4" height="15" font="0">f</text>
<text top="467" left="614" width="6" height="14" font="9">(</text>
<text top="467" left="620" width="36" height="15" font="0">t, x, y,</text>
<text top="461" left="660" width="15" height="11" font="11"><i>∂</i>y</text>
<text top="481" left="659" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="467" left="677" width="14" height="15" font="0">, p</text>
<text top="467" left="691" width="6" height="14" font="9">)</text>
<text top="501" left="459" width="346" height="15" font="0">Partial differential equations can be solved by sub-</text>
<text top="519" left="459" width="346" height="15" font="0">dividing one or more of the continuous independent</text>
<text top="537" left="459" width="346" height="15" font="0">variables in a number of grid cells, and replacing the</text>
<text top="555" left="459" width="346" height="15" font="0">derivatives by discrete, algebraic approximate equa-</text>
<text top="573" left="459" width="242" height="15" font="0">tions, so-called finite differences (cf.</text>
<text top="573" left="706" width="57" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">LeVeque</a></text>
<text top="573" left="763" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="573" left="772" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="573" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="591" left="459" width="167" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hundsdorfer and Verwer</a></text>
<text top="591" left="626" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="591" left="634" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2003</a></text>
<text top="591" left="664" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="609" left="481" width="324" height="15" font="0">For time-varying cases, it is customary to discre-</text>
<text top="627" left="459" width="346" height="15" font="0">tise the spatial coordinate(s) only, while time is left in</text>
<text top="645" left="459" width="346" height="15" font="0">continuous form. This is called the method-of-lines,</text>
<text top="663" left="459" width="346" height="15" font="0">and in this way, one PDE is translated into a large</text>
<text top="680" left="459" width="346" height="15" font="0">number of coupled ordinary differential equations,</text>
<text top="698" left="459" width="346" height="15" font="0">that can be solved with the usual initial value prob-</text>
<text top="716" left="459" width="102" height="15" font="0">lem solvers (cf.</text>
<text top="716" left="566" width="84" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hamdi et al.</a></text>
<text top="716" left="650" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="716" left="659" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="716" left="689" width="117" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>This applies to</text>
<text top="734" left="459" width="346" height="15" font="0">parabolic PDEs such as the heat equation, and to hy-</text>
<text top="752" left="459" width="275" height="15" font="0">perbolic PDEs such as the wave equation.</text>
<text top="770" left="481" width="324" height="15" font="0">For time-invariant problems, usually all indepen-</text>
<text top="788" left="459" width="346" height="15" font="0">dent variables are discretised, and the derivatives ap-</text>
<text top="806" left="459" width="346" height="15" font="0">proximated by algebraic equations, which are solved</text>
<text top="824" left="459" width="346" height="15" font="0">by root-finding techniques. This technique applies to</text>
<text top="842" left="459" width="89" height="15" font="0">elliptic PDEs.</text>
<text top="860" left="481" width="69" height="15" font="0">R-package</text>
<text top="860" left="554" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="860" left="620" width="185" height="15" font="0">provides functions to gener-</text>
<text top="878" left="459" width="346" height="15" font="0">ate finite differences on a structured grid. After that,</text>
<text top="896" left="459" width="346" height="15" font="0">the resulting time-varying cases can be solved with</text>
<text top="914" left="459" width="284" height="15" font="0">specially-designed functions from package</text>
<text top="914" left="747" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="914" left="802" width="4" height="15" font="0"><a href="http://cran.r-project.org/package=deSolve">,</a></text>
<text top="932" left="459" width="346" height="15" font="0">while time-invariant cases can be solved with root-</text>
<text top="949" left="459" width="204" height="15" font="0">solving methods from package</text>
<text top="950" left="666" width="66" height="15" font="7"><a href="http://cran.r-project.org/package=rootSolve"><b>rootSolve</b></a></text>
<text top="949" left="736" width="4" height="15" font="0">.</text>
<text top="990" left="459" width="262" height="17" font="8"><b>Differential algebraic equations</b></text>
<text top="1021" left="459" width="346" height="15" font="0">Differential-algebraic equations (DAE) contain a</text>
<text top="1039" left="459" width="346" height="15" font="0">mixture of differential ( f ) and algebraic equations</text>
<text top="1057" left="459" width="346" height="15" font="0">(g), the latter e.g. for maintaining mass-balance con-</text>
<text top="1075" left="459" width="50" height="15" font="0">ditions:</text>
<text top="1104" left="590" width="7" height="15" font="0">y</text>
<text top="1099" left="597" width="3" height="11" font="1">0</text>
<text top="1104" left="605" width="12" height="14" font="9">=</text>
<text top="1104" left="623" width="4" height="15" font="0">f</text>
<text top="1104" left="629" width="6" height="14" font="9">(</text>
<text top="1104" left="636" width="32" height="15" font="0">t, y, p</text>
<text top="1104" left="668" width="6" height="14" font="9">)</text>
<text top="1126" left="594" width="7" height="15" font="0">0</text>
<text top="1126" left="605" width="12" height="14" font="9">=</text>
<text top="1126" left="621" width="7" height="15" font="0">g</text>
<text top="1126" left="629" width="6" height="14" font="9">(</text>
<text top="1126" left="636" width="32" height="15" font="0">t, y, p</text>
<text top="1126" left="668" width="6" height="14" font="9">)</text>
<text top="1155" left="459" width="346" height="15" font="0">Important for the solution of a DAE is its index.</text>
<text top="1173" left="459" width="346" height="15" font="0">The index of a DAE is the number of differentiations</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="12" size="11" family="Times" color="#000000"/>
	<fontspec id="13" size="7" family="Times" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="798" width="7" height="15" font="0">7</text>
<text top="125" left="82" width="346" height="15" font="0">needed until a system consisting only of ODEs is ob-</text>
<text top="143" left="82" width="45" height="15" font="0">tained.</text>
<text top="163" left="105" width="114" height="15" font="0">Function daspk <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="163" left="218" width="86" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Brenan et al.</a></text>
<text top="163" left="304" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="163" left="314" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1996</a></text>
<text top="163" left="344" width="85" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>from pack-</text>
<text top="181" left="82" width="23" height="15" font="0">age</text>
<text top="181" left="109" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="181" left="167" width="262" height="15" font="0">solves (relatively simple) DAEs of index</text>
<text top="199" left="82" width="222" height="15" font="0">at most 1, while function radau <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="199" left="305" width="81" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer et al.</a></text>
<text top="199" left="385" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="199" left="394" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="199" left="424" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">)</a></text>
<text top="217" left="82" width="194" height="15" font="0">solves DAEs of index up to 3.</text>
<text top="275" left="82" width="230" height="21" font="5"><b>Implementation details</b></text>
<text top="318" left="82" width="346" height="15" font="0">The implemented solver functions are explained by</text>
<text top="336" left="82" width="346" height="15" font="0">means of the ode-function, used for the solution of</text>
<text top="354" left="82" width="346" height="15" font="0">initial value problems. The interfaces to the other</text>
<text top="372" left="82" width="246" height="15" font="0">solvers have an analogous definition:</text>
<text top="414" left="89" width="316" height="10" font="12">ode(y, times, func, parms, method = c(&#34;lsoda&#34;,</text>
<text top="430" left="117" width="192" height="10" font="12">&#34;lsode&#34;, &#34;lsodes&#34;, &#34;lsodar&#34;,</text>
<text top="447" left="117" width="219" height="10" font="12">&#34;vode&#34;, &#34;daspk&#34;, &#34;euler&#34;, &#34;rk4&#34;,</text>
<text top="463" left="117" width="226" height="10" font="12">&#34;ode23&#34;, &#34;ode45&#34;, &#34;radau&#34;, &#34;bdf&#34;,</text>
<text top="480" left="117" width="199" height="10" font="12">&#34;bdf_d&#34;, &#34;adams&#34;, &#34;impAdams&#34;,</text>
<text top="496" left="117" width="130" height="10" font="12">&#34;impAdams_d&#34;), ...)</text>
<text top="535" left="105" width="324" height="15" font="0">To use this, the system of differential equations</text>
<text top="553" left="82" width="346" height="15" font="0">can be defined as an R-function (func) that computes</text>
<text top="571" left="82" width="346" height="15" font="0">derivatives in the ODE system (the model definition)</text>
<text top="589" left="82" width="346" height="15" font="0">according to the independent variable (e.g. time t).</text>
<text top="608" left="82" width="30" height="12" font="0">func</text>
<text top="607" left="117" width="312" height="15" font="0">can also be a function in a dynamically loaded</text>
<text top="625" left="82" width="100" height="15" font="0">shared library <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="625" left="182" width="87" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="625" left="270" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="625" left="276" width="37" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010c</a></text>
<text top="625" left="313" width="116" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>and, in addition,</text>
<text top="643" left="82" width="346" height="15" font="0">some solvers support also the supply of an analyti-</text>
<text top="661" left="82" width="346" height="15" font="0">cally derived function of partial derivatives (Jacobian</text>
<text top="678" left="82" width="52" height="15" font="0">matrix).</text>
<text top="699" left="105" width="301" height="15" font="0">If func is an R-function, it must be defined as:</text>
<text top="720" left="105" width="259" height="12" font="0">func &lt;- function(t, y, parms, ...)</text>
<text top="739" left="82" width="346" height="15" font="0">where t is the actual value of the independent vari-</text>
<text top="756" left="82" width="346" height="15" font="0">able (e.g. the current time point in the integration),</text>
<text top="776" left="82" width="8" height="12" font="0">y</text>
<text top="774" left="95" width="334" height="15" font="0">is the current estimate of the variables in the ODE</text>
<text top="792" left="82" width="346" height="15" font="0">system, parms is the parameter vector and ... can be</text>
<text top="810" left="82" width="332" height="15" font="0">used to pass additional arguments to the function.</text>
<text top="830" left="105" width="324" height="15" font="0">The return value of func should be a list, whose</text>
<text top="848" left="82" width="346" height="15" font="0">first element is a vector containing the derivatives</text>
<text top="866" left="82" width="346" height="15" font="0">of y with respect to t, and whose next elements are</text>
<text top="884" left="82" width="346" height="15" font="0">optional global values that can be recorded at each</text>
<text top="902" left="82" width="346" height="15" font="0">point in times. The derivatives must be specified in</text>
<text top="920" left="82" width="253" height="15" font="0">the same order as the state variables y.</text>
<text top="940" left="105" width="324" height="15" font="0">Depending on the algorithm specified in argu-</text>
<text top="958" left="82" width="346" height="15" font="0">ment method, numerical simulation proceeds either</text>
<text top="976" left="82" width="346" height="15" font="0">exactly at the time steps specified in times, or us-</text>
<text top="994" left="82" width="346" height="15" font="0">ing time steps that are independent from times and</text>
<text top="1012" left="82" width="346" height="15" font="0">where the output is generated by interpolation. With</text>
<text top="1030" left="82" width="346" height="15" font="0">the exception of method euler and several fixed-step</text>
<text top="1048" left="82" width="346" height="15" font="0">Runge-Kutta methods all algorithms have automatic</text>
<text top="1065" left="82" width="346" height="15" font="0">time stepping, which can be controlled by setting ac-</text>
<text top="1083" left="82" width="346" height="15" font="0">curacy requirements (see below) or by using optional</text>
<text top="1101" left="82" width="346" height="15" font="0">arguments like hini (initial time step), hmin (minimal</text>
<text top="1119" left="82" width="346" height="15" font="0">time step) and hmax (maximum time step). Specific</text>
<text top="1137" left="82" width="346" height="15" font="0">details, e.g. about the applied interpolation methods</text>
<text top="1155" left="82" width="346" height="15" font="0">can be found in the manual pages and the original</text>
<text top="1173" left="82" width="138" height="15" font="0">literature cited there.</text>
<text top="121" left="459" width="193" height="21" font="5"><b>Numerical accuracy</b></text>
<text top="160" left="459" width="346" height="15" font="0">Numerical solution of a system of differential equa-</text>
<text top="178" left="459" width="346" height="15" font="0">tions is an approximation and therefore prone to nu-</text>
<text top="196" left="459" width="316" height="15" font="0">merical errors, originating from several sources:</text>
<text top="227" left="478" width="298" height="15" font="0">1. time step and accuracy order of the solver,</text>
<text top="256" left="478" width="190" height="15" font="0">2. floating point arithmetics,</text>
<text top="286" left="478" width="328" height="15" font="0">3. properties of the differential system and stabil-</text>
<text top="304" left="496" width="189" height="15" font="0">ity of the solution algorithm.</text>
<text top="335" left="481" width="324" height="15" font="0">For methods with automatic stepsize selection,</text>
<text top="353" left="459" width="346" height="15" font="0">accuracy of the computation can be adjusted us-</text>
<text top="371" left="459" width="346" height="15" font="0">ing the non-negative arguments atol (absolute tol-</text>
<text top="389" left="459" width="346" height="15" font="0">erance) and rtol (relative tolerance), which control</text>
<text top="407" left="459" width="220" height="15" font="0">the local errors of the integration.</text>
<text top="425" left="481" width="324" height="15" font="0">Like R itself, all solvers use double-precision</text>
<text top="443" left="459" width="265" height="15" font="0">floating-point arithmetics according to</text>
<text top="443" left="732" width="74" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">IEEE Stan-</a></text>
<text top="461" left="459" width="59" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">dard 754</a></text>
<text top="461" left="524" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="461" left="529" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="461" left="559" width="246" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>which means that it can represent</text>
<text top="479" left="459" width="176" height="15" font="0">numbers between approx.</text>
<text top="478" left="645" width="12" height="15" font="9">±</text>
<text top="479" left="657" width="47" height="15" font="0">2.25 10</text>
<text top="475" left="704" width="26" height="12" font="1">−308</text>
<text top="479" left="736" width="69" height="15" font="0">to approx.</text>
<text top="496" left="459" width="12" height="15" font="9">±</text>
<text top="496" left="471" width="38" height="15" font="0">1.8 10</text>
<text top="494" left="509" width="17" height="11" font="1">308</text>
<text top="496" left="532" width="274" height="15" font="0">and with 16 significant digits. It is there-</text>
<text top="514" left="459" width="248" height="15" font="0">fore not advisable to set <b>rtol </b>below 10</text>
<text top="511" left="707" width="21" height="12" font="1">−16</text>
<text top="514" left="729" width="77" height="15" font="0">, except set-</text>
<text top="532" left="459" width="346" height="15" font="0">ting it to zero with the intention to use absolute tol-</text>
<text top="550" left="459" width="123" height="15" font="0">erance exclusively.</text>
<text top="568" left="481" width="324" height="15" font="0">The solvers provided by the packages presented</text>
<text top="586" left="459" width="346" height="15" font="0">below have proven to be quite robust in most prac-</text>
<text top="604" left="459" width="346" height="15" font="0">tical cases, however users should always be aware</text>
<text top="622" left="459" width="346" height="15" font="0">about the problems and limitations of numerical</text>
<text top="640" left="459" width="346" height="15" font="0">methods and carefully check results for plausibil-</text>
<text top="658" left="459" width="346" height="15" font="0">ity. The section “Troubleshooting” in the package vi-</text>
<text top="676" left="459" width="50" height="15" font="0">gnette <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="676" left="509" width="89" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="676" left="598" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="676" left="606" width="39" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010d</a></text>
<text top="676" left="645" width="160" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>should be consulted as</text>
<text top="694" left="459" width="277" height="15" font="0">a first source for solving typical problems.</text>
<text top="740" left="459" width="94" height="21" font="5"><b>Examples</b></text>
<text top="780" left="459" width="174" height="17" font="8"><b>An initial value ODE</b></text>
<text top="810" left="459" width="295" height="15" font="0">Consider the famous van der Pol equation <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="810" left="754" width="52" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">van der</a></text>
<text top="828" left="459" width="151" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Pol and van der Mark</a></text>
<text top="828" left="610" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="828" left="619" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">1927</a></text>
<text top="828" left="649" width="156" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>that describes a non-</text>
<text top="846" left="459" width="346" height="15" font="0">conservative oscillator with non-linear damping and</text>
<text top="864" left="459" width="346" height="15" font="0">which was originally developed for electrical cir-</text>
<text top="882" left="459" width="346" height="15" font="0">cuits employing vacuum tubes. The oscillation is de-</text>
<text top="900" left="459" width="154" height="15" font="0">scribed by means of a 2</text>
<text top="897" left="613" width="12" height="11" font="1">nd</text>
<text top="900" left="630" width="76" height="15" font="0">order ODE:</text>
<text top="933" left="554" width="7" height="15" font="0">z</text>
<text top="929" left="561" width="7" height="11" font="1">00</text>
<text top="932" left="571" width="12" height="15" font="9">−</text>
<text top="937" left="587" width="9" height="11" font="11"><i>µ</i></text>
<text top="933" left="596" width="6" height="14" font="9">(</text>
<text top="933" left="602" width="7" height="15" font="0">1</text>
<text top="932" left="613" width="12" height="15" font="9">−</text>
<text top="933" left="628" width="7" height="15" font="0">z</text>
<text top="930" left="635" width="6" height="11" font="1">2</text>
<text top="933" left="641" width="6" height="14" font="9">)</text>
<text top="933" left="648" width="7" height="15" font="0">z</text>
<text top="929" left="655" width="3" height="11" font="1">0</text>
<text top="933" left="662" width="12" height="14" font="9">+</text>
<text top="933" left="677" width="7" height="15" font="0">z</text>
<text top="933" left="688" width="12" height="14" font="9">=</text>
<text top="933" left="703" width="7" height="15" font="0">0</text>
<text top="965" left="459" width="346" height="15" font="0">Such a system can be routinely rewritten as a system</text>
<text top="983" left="459" width="52" height="15" font="0">of two 1</text>
<text top="980" left="511" width="8" height="11" font="1">st</text>
<text top="983" left="524" width="195" height="15" font="0">order ODEs, if we substitute z</text>
<text top="979" left="719" width="7" height="11" font="1">00</text>
<text top="983" left="729" width="41" height="15" font="0">with y</text>
<text top="979" left="771" width="3" height="11" font="1">0</text>
<text top="990" left="771" width="6" height="11" font="1">1</text>
<text top="983" left="780" width="25" height="15" font="0">and</text>
<text top="1000" left="459" width="7" height="15" font="0">z</text>
<text top="997" left="466" width="3" height="11" font="1">0</text>
<text top="1001" left="474" width="42" height="15" font="0">with y</text>
<text top="1006" left="516" width="6" height="11" font="1">2</text>
<text top="1001" left="522" width="4" height="15" font="0">:</text>
<text top="1032" left="547" width="7" height="15" font="0">y</text>
<text top="1028" left="555" width="3" height="11" font="1">0</text>
<text top="1039" left="555" width="6" height="11" font="1">1</text>
<text top="1032" left="565" width="12" height="14" font="9">=</text>
<text top="1032" left="581" width="7" height="15" font="0">y</text>
<text top="1037" left="589" width="6" height="11" font="1">2</text>
<text top="1057" left="547" width="7" height="15" font="0">y</text>
<text top="1053" left="555" width="3" height="11" font="1">0</text>
<text top="1064" left="555" width="6" height="11" font="1">2</text>
<text top="1057" left="565" width="12" height="14" font="9">=</text>
<text top="1061" left="581" width="9" height="11" font="11"><i>µ</i></text>
<text top="1056" left="593" width="14" height="15" font="9">· (</text>
<text top="1057" left="607" width="7" height="15" font="0">1</text>
<text top="1056" left="617" width="12" height="15" font="9">−</text>
<text top="1057" left="633" width="7" height="15" font="0">y</text>
<text top="1063" left="640" width="6" height="11" font="1">1</text>
<text top="1054" left="647" width="6" height="11" font="1">2</text>
<text top="1057" left="653" width="14" height="14" font="9">) ·</text>
<text top="1057" left="670" width="7" height="15" font="0">y</text>
<text top="1063" left="678" width="6" height="11" font="1">2</text>
<text top="1056" left="687" width="12" height="15" font="9">−</text>
<text top="1057" left="703" width="7" height="15" font="0">y</text>
<text top="1063" left="710" width="6" height="11" font="1">1</text>
<text top="1089" left="481" width="324" height="15" font="0">There is one parameter, <i>µ</i>, and two differential</text>
<text top="1107" left="459" width="75" height="15" font="0">variables, y</text>
<text top="1112" left="534" width="6" height="11" font="1">1</text>
<text top="1107" left="544" width="37" height="15" font="0">and y</text>
<text top="1112" left="581" width="6" height="11" font="1">2</text>
<text top="1107" left="591" width="149" height="15" font="0">with initial values (at t</text>
<text top="1107" left="744" width="12" height="14" font="9">=</text>
<text top="1107" left="759" width="16" height="15" font="0">0):</text>
<text top="1138" left="600" width="7" height="15" font="0">y</text>
<text top="1144" left="608" width="6" height="11" font="1">1</text>
<text top="1148" left="613" width="4" height="8" font="13">(</text>
<text top="1148" left="617" width="3" height="9" font="10">t</text>
<text top="1148" left="621" width="7" height="8" font="13">=</text>
<text top="1148" left="628" width="4" height="9" font="10">0</text>
<text top="1148" left="633" width="4" height="8" font="13">)</text>
<text top="1138" left="641" width="12" height="14" font="9">=</text>
<text top="1138" left="657" width="7" height="15" font="0">2</text>
<text top="1165" left="600" width="7" height="15" font="0">y</text>
<text top="1170" left="608" width="6" height="11" font="1">2</text>
<text top="1175" left="613" width="4" height="8" font="13">(</text>
<text top="1175" left="617" width="3" height="9" font="10">t</text>
<text top="1175" left="621" width="7" height="8" font="13">=</text>
<text top="1175" left="628" width="4" height="9" font="10">0</text>
<text top="1175" left="633" width="4" height="8" font="13">)</text>
<text top="1165" left="641" width="12" height="14" font="9">=</text>
<text top="1165" left="657" width="7" height="15" font="0">0</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="14" size="7" family="Helvetica" color="#000000"/>
	<fontspec id="15" size="7" family="Helvetica" color="#000000"/>
	<fontspec id="16" size="9" family="Helvetica" color="#000000"/>
<text top="67" left="82" width="7" height="15" font="0">8</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="105" width="324" height="15" font="0">The van der Pol equation is often used as a test</text>
<text top="143" left="82" width="346" height="15" font="0">problem for ODE solvers, as, for large <i>µ</i>, its dy-</text>
<text top="161" left="82" width="346" height="15" font="0">namics consists of parts where the solution changes</text>
<text top="179" left="82" width="346" height="15" font="0">very slowly, alternating with regions of very sharp</text>
<text top="197" left="82" width="346" height="15" font="0">changes. This “stiffness” makes the equation quite</text>
<text top="215" left="82" width="136" height="15" font="0">challenging to solve.</text>
<text top="235" left="105" width="324" height="15" font="0">In R, this model is implemented as a function</text>
<text top="252" left="82" width="346" height="15" font="0">(vdpol) whose inputs are the current time (t), the val-</text>
<text top="270" left="82" width="346" height="15" font="0">ues of the state variables (y), and the parameters (mu);</text>
<text top="288" left="82" width="346" height="15" font="0">the function returns a list with as first element the</text>
<text top="306" left="82" width="172" height="15" font="0">derivatives, concatenated.</text>
<text top="347" left="89" width="206" height="10" font="12">vdpol &lt;- function (t, y, mu) {</text>
<text top="364" left="103" width="48" height="10" font="12">list(c(</text>
<text top="380" left="117" width="34" height="10" font="12">y[2],</text>
<text top="397" left="117" width="213" height="10" font="12">mu * (1 - y[1]^2) * y[2] - y[1]</text>
<text top="413" left="103" width="14" height="10" font="12">))</text>
<text top="430" left="89" width="7" height="10" font="12">}</text>
<text top="468" left="105" width="324" height="15" font="0">After defining the initial condition of the state</text>
<text top="486" left="82" width="346" height="15" font="0">variables (yini), the model is solved, and output</text>
<text top="504" left="82" width="318" height="15" font="0">written at selected time points (times), using</text>
<text top="504" left="407" width="22" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>de-</b></a></text>
<text top="522" left="82" width="38" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>Solve</b></a></text>
<text top="522" left="121" width="308" height="15" font="0"><a href="http://cran.r-project.org/package=deSolve">’s </a>integration function ode. The default rou-</text>
<text top="540" left="82" width="346" height="15" font="0">tine lsoda, which is invoked by ode automatically</text>
<text top="557" left="82" width="346" height="15" font="0">switches between stiff and non-stiff methods, de-</text>
<text top="575" left="82" width="169" height="15" font="0">pending on the problem <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="575" left="251" width="50" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Petzold</a></text>
<text top="575" left="301" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="575" left="309" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1983</a></text>
<text top="575" left="339" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="595" left="105" width="324" height="15" font="0">We run the model for a typically stiff (mu = 1000)</text>
<text top="613" left="82" width="205" height="15" font="0">and nonstiff (mu = 1) situation:</text>
<text top="654" left="89" width="110" height="10" font="12">library(deSolve)</text>
<text top="671" left="89" width="171" height="10" font="12">yini &lt;- c(y1 = 2, y2 = 0)</text>
<text top="687" left="89" width="247" height="10" font="12">stiff &lt;- ode(y = yini, func = vdpol,</text>
<text top="704" left="117" width="199" height="10" font="12">times = 0:3000, parms = 1000)</text>
<text top="741" left="89" width="268" height="10" font="12">nonstiff &lt;- ode(y = yini, func = vdpol,</text>
<text top="757" left="117" width="206" height="10" font="12">times = seq(0, 30, by = 0.01),</text>
<text top="774" left="117" width="69" height="10" font="12">parms = 1)</text>
<text top="812" left="105" width="324" height="15" font="0">The model returns a matrix, of class deSolve,</text>
<text top="830" left="82" width="346" height="15" font="0">with in its first column the time values, followed by</text>
<text top="848" left="82" width="210" height="15" font="0">the values of the state variables:</text>
<text top="889" left="89" width="123" height="10" font="12">head(stiff, n = 3)</text>
<text top="926" left="117" width="27" height="10" font="12">time</text>
<text top="926" left="192" width="14" height="10" font="12">y1</text>
<text top="926" left="288" width="14" height="10" font="12">y2</text>
<text top="942" left="82" width="27" height="10" font="12">[1,]</text>
<text top="942" left="137" width="69" height="10" font="12">0 2.000000</text>
<text top="942" left="220" width="82" height="10" font="12">0.0000000000</text>
<text top="959" left="82" width="27" height="10" font="12">[2,]</text>
<text top="959" left="137" width="165" height="10" font="12">1 1.999333 -0.0006670373</text>
<text top="975" left="82" width="27" height="10" font="12">[3,]</text>
<text top="975" left="137" width="165" height="10" font="12">2 1.998666 -0.0006674088</text>
<text top="1013" left="105" width="324" height="15" font="0">Figures are generated using the S3 plot method</text>
<text top="1031" left="82" width="180" height="15" font="0">for objects of class deSolve:</text>
<text top="1073" left="89" width="254" height="10" font="12">plot(stiff, type = &#34;l&#34;, which = &#34;y1&#34;,</text>
<text top="1089" left="103" width="137" height="10" font="12">lwd = 2, ylab = &#34;y&#34;,</text>
<text top="1105" left="103" width="165" height="10" font="12">main = &#34;IVP ODE, stiff&#34;)</text>
<text top="1142" left="89" width="274" height="10" font="12">plot(nonstiff, type = &#34;l&#34;, which = &#34;y1&#34;,</text>
<text top="1159" left="103" width="137" height="10" font="12">lwd = 2, ylab = &#34;y&#34;,</text>
<text top="1175" left="103" width="185" height="10" font="12">main = &#34;IVP ODE, nonstiff&#34;)</text>
<text top="307" left="514" width="5" height="9" font="14">0</text>
<text top="307" left="551" width="16" height="9" font="14">500</text>
<text top="307" left="591" width="21" height="9" font="14">1000</text>
<text top="307" left="633" width="21" height="9" font="14">1500</text>
<text top="307" left="675" width="21" height="9" font="14">2000</text>
<text top="307" left="718" width="21" height="9" font="14">2500</text>
<text top="307" left="760" width="21" height="9" font="14">3000</text>
<text top="287" left="492" width="0" height="9" font="15">−2</text>
<text top="258" left="492" width="0" height="9" font="15">−1</text>
<text top="226" left="492" width="0" height="9" font="15">0</text>
<text top="197" left="492" width="0" height="9" font="15">1</text>
<text top="169" left="492" width="0" height="9" font="15">2</text>
<text top="140" left="607" width="72" height="10" font="16"><b>IVP ODE, stiff</b></text>
<text top="330" left="635" width="18" height="9" font="14">time</text>
<text top="226" left="469" width="0" height="9" font="15">y</text>
<text top="374" left="459" width="346" height="15" font="0">Figure 1: Solution of the van der Pol equation, an</text>
<text top="392" left="459" width="346" height="15" font="0">initial value ordinary differential equation, stiff case,</text>
<text top="413" left="459" width="9" height="11" font="11"><i>µ</i></text>
<text top="410" left="471" width="12" height="14" font="9">=</text>
<text top="410" left="487" width="34" height="15" font="0">1000.</text>
<text top="635" left="514" width="5" height="9" font="14">0</text>
<text top="635" left="556" width="5" height="9" font="14">5</text>
<text top="635" left="596" width="11" height="9" font="14">10</text>
<text top="635" left="638" width="11" height="9" font="14">15</text>
<text top="635" left="681" width="11" height="9" font="14">20</text>
<text top="635" left="723" width="11" height="9" font="14">25</text>
<text top="635" left="766" width="11" height="9" font="14">30</text>
<text top="615" left="492" width="0" height="9" font="15">−2</text>
<text top="586" left="492" width="0" height="9" font="15">−1</text>
<text top="555" left="492" width="0" height="9" font="15">0</text>
<text top="526" left="492" width="0" height="9" font="15">1</text>
<text top="497" left="492" width="0" height="9" font="15">2</text>
<text top="469" left="597" width="93" height="10" font="16"><b>IVP ODE, nonstiff</b></text>
<text top="658" left="635" width="18" height="9" font="14">time</text>
<text top="555" left="469" width="0" height="9" font="15">y</text>
<text top="702" left="459" width="346" height="15" font="0">Figure 2: Solution of the van der Pol equation, an</text>
<text top="720" left="459" width="346" height="15" font="0">initial value ordinary differential equation, non-stiff</text>
<text top="738" left="459" width="44" height="15" font="0">case, <i>µ</i></text>
<text top="738" left="507" width="12" height="14" font="9">=</text>
<text top="738" left="522" width="11" height="15" font="0">1.</text>
<text top="785" left="544" width="40" height="15" font="0">solver</text>
<text top="785" left="605" width="56" height="15" font="0">non-stiff</text>
<text top="785" left="679" width="25" height="15" font="0">stiff</text>
<text top="811" left="544" width="39" height="15" font="0">ode23</text>
<text top="811" left="605" width="26" height="15" font="0">0.37</text>
<text top="811" left="679" width="41" height="15" font="0">271.19</text>
<text top="829" left="544" width="35" height="15" font="0">lsoda</text>
<text top="829" left="605" width="26" height="15" font="0">0.26</text>
<text top="829" left="679" width="26" height="15" font="0">0.23</text>
<text top="847" left="544" width="44" height="15" font="0">adams</text>
<text top="847" left="605" width="26" height="15" font="0">0.13</text>
<text top="847" left="679" width="41" height="15" font="0">616.13</text>
<text top="865" left="544" width="22" height="15" font="0">bdf</text>
<text top="865" left="605" width="26" height="15" font="0">0.15</text>
<text top="865" left="679" width="26" height="15" font="0">0.22</text>
<text top="883" left="544" width="39" height="15" font="0">radau</text>
<text top="883" left="605" width="26" height="15" font="0">0.53</text>
<text top="883" left="679" width="26" height="15" font="0">0.72</text>
<text top="919" left="459" width="346" height="15" font="0">Table 1: Comparison of solvers for a stiff and a</text>
<text top="937" left="459" width="346" height="15" font="0">non-stiff parametrisation of the van der Pol equation</text>
<text top="955" left="459" width="346" height="15" font="0">(time in seconds, mean values of ten simulations on</text>
<text top="973" left="459" width="193" height="15" font="0">an AMD AM2 X2 3000 CPU).</text>
<text top="1012" left="481" width="324" height="15" font="0">A comparison of timings for two explicit solvers,</text>
<text top="1030" left="459" width="346" height="15" font="0">the Runge-Kutta method (ode23) and the adams</text>
<text top="1048" left="459" width="346" height="15" font="0">method, with the implicit multistep solver (bdf,</text>
<text top="1065" left="459" width="346" height="15" font="0">backward differentiation formula) shows a clear ad-</text>
<text top="1083" left="459" width="295" height="15" font="0">vantage for the latter in the stiff case (Figure</text>
<text top="1083" left="758" width="7" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#4">1</a></text>
<text top="1083" left="765" width="40" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#4">). </a>The</text>
<text top="1101" left="459" width="346" height="15" font="0">default solver (lsoda) is not necessarily the fastest,</text>
<text top="1119" left="459" width="346" height="15" font="0">but shows robust behavior due to automatic stiff-</text>
<text top="1137" left="459" width="346" height="15" font="0">ness detection. It uses the explicit multistep Adams</text>
<text top="1155" left="459" width="346" height="15" font="0">method for the non-stiff case and the BDF method</text>
<text top="1173" left="459" width="346" height="15" font="0">for the stiff case. The accuracy is comparable for all</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="17" size="7" family="Symbol" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="798" width="7" height="15" font="0">9</text>
<text top="125" left="82" width="116" height="15" font="0">solvers with atol</text>
<text top="125" left="202" width="12" height="14" font="9">=</text>
<text top="127" left="218" width="31" height="12" font="0">rtol</text>
<text top="125" left="252" width="12" height="14" font="9">=</text>
<text top="125" left="268" width="15" height="15" font="0">10</text>
<text top="121" left="283" width="15" height="12" font="1">−6</text>
<text top="125" left="299" width="83" height="15" font="0">, the default.</text>
<text top="167" left="82" width="193" height="17" font="8"><b>A boundary value ODE</b></text>
<text top="197" left="82" width="173" height="15" font="0">The webpage of Jeff Cash <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="197" left="255" width="33" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Cash</a></text>
<text top="197" left="288" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="197" left="295" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2009</a></text>
<text top="197" left="325" width="104" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>contains many</text>
<text top="215" left="82" width="346" height="15" font="0">test cases, including their analytical solution (see be-</text>
<text top="233" left="82" width="346" height="15" font="0">low), that BVP solvers should be able to solve. We</text>
<text top="251" left="82" width="346" height="15" font="0">use equation no. 14 from this webpage as an exam-</text>
<text top="269" left="82" width="24" height="15" font="0">ple:</text>
<text top="306" left="156" width="15" height="11" font="11"><i>ξ</i>y</text>
<text top="299" left="172" width="7" height="11" font="1">00</text>
<text top="302" left="182" width="12" height="15" font="9">−</text>
<text top="303" left="198" width="7" height="15" font="0">y</text>
<text top="303" left="209" width="34" height="14" font="9">= −(</text>
<text top="306" left="244" width="18" height="11" font="11"><i>ξπ</i></text>
<text top="299" left="262" width="6" height="11" font="1">2</text>
<text top="303" left="272" width="12" height="14" font="9">+</text>
<text top="303" left="287" width="7" height="15" font="0">1</text>
<text top="303" left="295" width="6" height="14" font="9">)</text>
<text top="303" left="302" width="21" height="15" font="0">cos</text>
<text top="303" left="324" width="6" height="14" font="9">(</text>
<text top="306" left="330" width="19" height="11" font="11"><i>π</i>x</text>
<text top="303" left="349" width="6" height="14" font="9">)</text>
<text top="335" left="82" width="99" height="15" font="0">on the interval</text>
<text top="335" left="187" width="17" height="14" font="9">[−</text>
<text top="335" left="204" width="20" height="15" font="0">1, 1</text>
<text top="335" left="225" width="4" height="14" font="9">]</text>
<text top="335" left="229" width="200" height="15" font="0">, and subject to the boundary</text>
<text top="353" left="82" width="73" height="15" font="0">conditions:</text>
<text top="386" left="218" width="7" height="15" font="0">y</text>
<text top="392" left="226" width="40" height="11" font="1">(x=−1)</text>
<text top="386" left="271" width="12" height="14" font="9">=</text>
<text top="386" left="286" width="7" height="15" font="0">0</text>
<text top="411" left="218" width="7" height="15" font="0">y</text>
<text top="417" left="226" width="40" height="11" font="1">(x=+1)</text>
<text top="411" left="271" width="12" height="14" font="9">=</text>
<text top="411" left="286" width="7" height="15" font="0">0</text>
<text top="443" left="82" width="346" height="15" font="0">The second-order equation first is rewritten as two</text>
<text top="461" left="82" width="139" height="15" font="0">first-order equations:</text>
<text top="494" left="140" width="7" height="15" font="0">y</text>
<text top="489" left="148" width="3" height="11" font="1">0</text>
<text top="500" left="147" width="6" height="11" font="1">1</text>
<text top="493" left="157" width="12" height="14" font="9">=</text>
<text top="494" left="173" width="7" height="15" font="0">y</text>
<text top="499" left="181" width="6" height="11" font="1">2</text>
<text top="519" left="140" width="7" height="15" font="0">y</text>
<text top="515" left="148" width="3" height="11" font="1">0</text>
<text top="525" left="147" width="6" height="11" font="1">2</text>
<text top="519" left="157" width="12" height="14" font="9">=</text>
<text top="519" left="173" width="24" height="15" font="0">1/<i>ξ</i></text>
<text top="518" left="201" width="14" height="15" font="9">· (</text>
<text top="519" left="215" width="7" height="15" font="0">y</text>
<text top="524" left="222" width="6" height="11" font="1">1</text>
<text top="518" left="232" width="21" height="15" font="9">− (</text>
<text top="522" left="254" width="18" height="11" font="11"><i>ξπ</i></text>
<text top="515" left="272" width="6" height="11" font="1">2</text>
<text top="519" left="282" width="12" height="14" font="9">+</text>
<text top="519" left="297" width="7" height="15" font="0">1</text>
<text top="519" left="305" width="6" height="14" font="9">)</text>
<text top="519" left="312" width="21" height="15" font="0">cos</text>
<text top="519" left="334" width="6" height="14" font="9">(</text>
<text top="522" left="340" width="19" height="11" font="11"><i>π</i>x</text>
<text top="519" left="359" width="12" height="14" font="9">))</text>
<text top="574" left="82" width="168" height="15" font="0">It is implemented in R as:</text>
<text top="607" left="89" width="192" height="10" font="12">Prob14 &lt;- function(x, y, xi)</text>
<text top="607" left="295" width="7" height="10" font="12">{</text>
<text top="623" left="103" width="48" height="10" font="12">list(c(</text>
<text top="640" left="117" width="34" height="10" font="12">y[2],</text>
<text top="656" left="117" width="274" height="10" font="12">1/xi * (y[1] - (xi*pi*pi+1) * cos(pi*x))</text>
<text top="673" left="103" width="14" height="10" font="12">))</text>
<text top="689" left="89" width="7" height="10" font="12">}</text>
<text top="719" left="82" width="346" height="15" font="0">With decreasing values of <i>ξ</i>, this problem becomes</text>
<text top="737" left="82" width="206" height="15" font="0">increasingly difficult to solve.</text>
<text top="737" left="304" width="124" height="15" font="0">We use three val-</text>
<text top="755" left="82" width="346" height="15" font="0">ues of <i>ξ</i>, and solve the problem with the shooting,</text>
<text top="773" left="82" width="260" height="15" font="0">the MIRK and the collocation method <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="773" left="343" width="82" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Ascher et al.</a></text>
<text top="773" left="425" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="791" left="82" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1995</a></text>
<text top="791" left="112" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="809" left="105" width="324" height="15" font="0">Note how the initial conditions yini and the con-</text>
<text top="827" left="82" width="346" height="15" font="0">ditions at the end of the integration interval yend</text>
<text top="845" left="82" width="346" height="15" font="0">are specified, where NA denotes that the value is not</text>
<text top="863" left="82" width="346" height="15" font="0">known. The independent variable is called x here</text>
<text top="881" left="82" width="172" height="15" font="0">(rather than times in ode).</text>
<text top="914" left="89" width="117" height="10" font="12">library(bvpSolve)</text>
<text top="930" left="89" width="178" height="10" font="12">x &lt;- seq(-1, 1, by = 0.01)</text>
<text top="947" left="89" width="233" height="10" font="12">shoot &lt;- bvpshoot(yini = c(0, NA),</text>
<text top="963" left="117" width="254" height="10" font="12">yend = c(0, NA), x = x, parms = 0.01,</text>
<text top="980" left="117" width="96" height="10" font="12">func = Prob14)</text>
<text top="1010" left="89" width="288" height="10" font="12">twp &lt;- bvptwp(yini = c(0, NA), yend = c(0,</text>
<text top="1027" left="117" width="185" height="10" font="12">NA), x = x, parms = 0.0025,</text>
<text top="1043" left="117" width="96" height="10" font="12">func = Prob14)</text>
<text top="1074" left="89" width="213" height="10" font="12">coll &lt;- bvpcol(yini = c(0, NA),</text>
<text top="1091" left="117" width="261" height="10" font="12">yend = c(0, NA), x = x, parms = 1e-04,</text>
<text top="1107" left="117" width="96" height="10" font="12">func = Prob14)</text>
<text top="1137" left="82" width="346" height="15" font="0">The numerical approximation generated by bvptwp</text>
<text top="1155" left="82" width="329" height="15" font="0">is very close to the analytical solution, e.g. for <i>ξ</i></text>
<text top="1155" left="417" width="12" height="14" font="9">=</text>
<text top="1173" left="82" width="45" height="15" font="0">0.0025:</text>
<text top="127" left="466" width="82" height="10" font="12">xi &lt;- 0.0025</text>
<text top="144" left="466" width="233" height="10" font="12">analytic &lt;- cos(pi * x) + exp((x -</text>
<text top="160" left="493" width="254" height="10" font="12">1)/sqrt(xi)) + exp(-(x + 1)/sqrt(xi))</text>
<text top="177" left="466" width="199" height="10" font="12">max(abs(analytic - twp[, 2]))</text>
<text top="208" left="459" width="110" height="10" font="12">[1] 7.788209e-10</text>
<text top="239" left="481" width="191" height="15" font="0">A similar low discrepancy (4</text>
<text top="238" left="676" width="4" height="15" font="9">·</text>
<text top="239" left="683" width="15" height="15" font="0">10</text>
<text top="235" left="698" width="21" height="12" font="1">−11</text>
<text top="239" left="720" width="85" height="15" font="0">) is noted for</text>
<text top="257" left="459" width="35" height="15" font="0">the <i>ξ</i></text>
<text top="257" left="500" width="12" height="14" font="9">=</text>
<text top="257" left="518" width="288" height="15" font="0">0.0001 as solved by bvpcol; the shooting</text>
<text top="275" left="459" width="271" height="15" font="0">method is considerably less precise (1.4</text>
<text top="274" left="734" width="4" height="15" font="9">·</text>
<text top="275" left="742" width="15" height="15" font="0">10</text>
<text top="271" left="757" width="15" height="12" font="1">−5</text>
<text top="275" left="773" width="32" height="15" font="0">), al-</text>
<text top="293" left="459" width="221" height="15" font="0">though the same tolerance (atol</text>
<text top="293" left="684" width="12" height="14" font="9">=</text>
<text top="293" left="701" width="15" height="15" font="0">10</text>
<text top="289" left="716" width="15" height="12" font="1">−8</text>
<text top="293" left="732" width="74" height="15" font="0">) was used</text>
<text top="311" left="459" width="76" height="15" font="0">for all runs.</text>
<text top="329" left="481" width="324" height="15" font="0">The plot shows how the shape of the solution</text>
<text top="347" left="459" width="346" height="15" font="0">is affected by the parameter <i>ξ</i>, becoming more and</text>
<text top="364" left="459" width="346" height="15" font="0">more steep near the boundaries, and therefore more</text>
<text top="382" left="459" width="292" height="15" font="0">and more difficult to solve, as <i>ξ </i>gets smaller.</text>
<text top="416" left="466" width="336" height="10" font="12">plot(shoot[, 1], shoot[, 2], type = &#34;l&#34;, lwd = 2,</text>
<text top="433" left="479" width="206" height="10" font="12">ylim = c(-1, 1), col = &#34;blue&#34;,</text>
<text top="449" left="479" width="281" height="10" font="12">xlab = &#34;x&#34;, ylab = &#34;y&#34;, main = &#34;BVP ODE&#34;)</text>
<text top="466" left="466" width="322" height="10" font="12">lines(twp[, 1], twp[, 2], col = &#34;red&#34;, lwd = 2)</text>
<text top="482" left="466" width="350" height="10" font="12">lines(coll[, 1], coll[, 2], col = &#34;green&#34;, lwd = 2)</text>
<text top="498" left="466" width="322" height="10" font="12">legend(&#34;topright&#34;, legend = c(&#34;0.01&#34;, &#34;0.0025&#34;,</text>
<text top="515" left="479" width="295" height="10" font="12">&#34;0.0001&#34;), col = c(&#34;blue&#34;, &#34;red&#34;, &#34;green&#34;),</text>
<text top="531" left="479" width="219" height="10" font="12">title = expression(xi), lwd = 2)</text>
<text top="860" left="507" width="19" height="9" font="14">−1.0</text>
<text top="860" left="571" width="19" height="9" font="14">−0.5</text>
<text top="860" left="637" width="13" height="9" font="14">0.0</text>
<text top="860" left="701" width="13" height="9" font="14">0.5</text>
<text top="860" left="764" width="13" height="9" font="14">1.0</text>
<text top="840" left="492" width="0" height="9" font="15">−1.0</text>
<text top="784" left="492" width="0" height="9" font="15">−0.5</text>
<text top="726" left="492" width="0" height="9" font="15">0.0</text>
<text top="670" left="492" width="0" height="9" font="15">0.5</text>
<text top="614" left="492" width="0" height="9" font="15">1.0</text>
<text top="578" left="618" width="51" height="10" font="16"><b>BVP ODE</b></text>
<text top="883" left="641" width="5" height="9" font="14">x</text>
<text top="721" left="469" width="0" height="9" font="15">y</text>
<text top="605" left="744" width="5" height="13" font="17">ξ</text>
<text top="625" left="747" width="19" height="9" font="14">0.01</text>
<text top="637" left="747" width="29" height="9" font="14">0.0025</text>
<text top="648" left="747" width="29" height="9" font="14">0.0001</text>
<text top="927" left="459" width="346" height="15" font="0">Figure 3: Solution of the BVP ODE problem, for dif-</text>
<text top="945" left="459" width="189" height="15" font="0">ferent values of parameter <i>ξ</i>.</text>
<text top="985" left="459" width="262" height="17" font="8"><b>Differential algebraic equations</b></text>
<text top="1015" left="459" width="346" height="15" font="0">The so called “Rober problem” describes an auto-</text>
<text top="1033" left="459" width="128" height="15" font="0">catalytic reaction <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="1033" left="587" width="68" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Robertson</a></text>
<text top="1033" left="655" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1033" left="666" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">1966</a></text>
<text top="1033" left="696" width="110" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>between three</text>
<text top="1051" left="459" width="126" height="15" font="0">chemical species, y</text>
<text top="1056" left="585" width="6" height="11" font="1">1</text>
<text top="1051" left="591" width="16" height="15" font="0">, y</text>
<text top="1056" left="608" width="6" height="11" font="1">2</text>
<text top="1051" left="618" width="37" height="15" font="0">and y</text>
<text top="1056" left="656" width="6" height="11" font="1">3</text>
<text top="1051" left="662" width="143" height="15" font="0">. The problem can be</text>
<text top="1069" left="459" width="194" height="15" font="0">formulated either as an ODE <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="1069" left="653" width="149" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Mazzia and Magherini</a></text>
<text top="1069" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="1087" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="1087" left="489" width="95" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">), </a>or as a DAE:</text>
<text top="1120" left="531" width="7" height="15" font="0">y</text>
<text top="1115" left="538" width="3" height="11" font="1">0</text>
<text top="1127" left="538" width="6" height="11" font="1">1</text>
<text top="1120" left="548" width="28" height="14" font="9">= −</text>
<text top="1120" left="576" width="34" height="15" font="0">0.04y</text>
<text top="1125" left="610" width="6" height="11" font="1">1</text>
<text top="1120" left="620" width="12" height="14" font="9">+</text>
<text top="1120" left="635" width="15" height="15" font="0">10</text>
<text top="1116" left="650" width="6" height="11" font="1">4</text>
<text top="1120" left="657" width="7" height="15" font="0">y</text>
<text top="1125" left="664" width="6" height="11" font="1">2</text>
<text top="1120" left="671" width="7" height="15" font="0">y</text>
<text top="1125" left="678" width="6" height="11" font="1">3</text>
<text top="1145" left="531" width="7" height="15" font="0">y</text>
<text top="1141" left="538" width="3" height="11" font="1">0</text>
<text top="1152" left="538" width="6" height="11" font="1">2</text>
<text top="1145" left="548" width="12" height="14" font="9">=</text>
<text top="1145" left="564" width="34" height="15" font="0">0.04y</text>
<text top="1151" left="598" width="6" height="11" font="1">1</text>
<text top="1144" left="607" width="12" height="15" font="9">−</text>
<text top="1145" left="622" width="15" height="15" font="0">10</text>
<text top="1142" left="637" width="6" height="11" font="1">4</text>
<text top="1145" left="644" width="7" height="15" font="0">y</text>
<text top="1150" left="652" width="6" height="11" font="1">2</text>
<text top="1145" left="658" width="7" height="15" font="0">y</text>
<text top="1150" left="666" width="6" height="11" font="1">3</text>
<text top="1144" left="675" width="12" height="15" font="9">−</text>
<text top="1145" left="691" width="22" height="15" font="0">310</text>
<text top="1142" left="713" width="6" height="11" font="1">7</text>
<text top="1145" left="720" width="7" height="15" font="0">y</text>
<text top="1142" left="727" width="6" height="11" font="1">2</text>
<text top="1152" left="727" width="6" height="11" font="1">2</text>
<text top="1168" left="537" width="7" height="15" font="0">1</text>
<text top="1168" left="548" width="12" height="14" font="9">=</text>
<text top="1168" left="564" width="7" height="15" font="0">y</text>
<text top="1173" left="572" width="6" height="11" font="1">1</text>
<text top="1168" left="581" width="12" height="14" font="9">+</text>
<text top="1168" left="597" width="7" height="15" font="0">y</text>
<text top="1173" left="604" width="6" height="11" font="1">2</text>
<text top="1168" left="614" width="12" height="14" font="9">+</text>
<text top="1168" left="629" width="7" height="15" font="0">y</text>
<text top="1173" left="637" width="6" height="11" font="1">3</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="18" size="6" family="Helvetica" color="#000000"/>
	<fontspec id="19" size="6" family="Helvetica" color="#000000"/>
	<fontspec id="20" size="7" family="Helvetica" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">10</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="105" width="324" height="15" font="0">where the first two equations are differential</text>
<text top="143" left="82" width="346" height="15" font="0">equations that specify the dynamics of chemical</text>
<text top="161" left="82" width="59" height="15" font="0">species y</text>
<text top="166" left="141" width="6" height="11" font="1">1</text>
<text top="161" left="152" width="37" height="15" font="0">and y</text>
<text top="166" left="189" width="6" height="11" font="1">2</text>
<text top="161" left="196" width="233" height="15" font="0">, while the third algebraic equation</text>
<text top="179" left="82" width="346" height="15" font="0">ensures that the summed concentration of the three</text>
<text top="197" left="82" width="118" height="15" font="0">species remains 1.</text>
<text top="215" left="105" width="324" height="15" font="0">The DAE has to be specified by the residual func-</text>
<text top="233" left="82" width="311" height="15" font="0">tion instead of the rates of change (as in ODEs).</text>
<text top="268" left="131" width="6" height="15" font="0">r</text>
<text top="273" left="137" width="6" height="11" font="1">1</text>
<text top="268" left="147" width="28" height="14" font="9">= −</text>
<text top="268" left="175" width="7" height="15" font="0">y</text>
<text top="263" left="183" width="3" height="11" font="1">0</text>
<text top="274" left="182" width="6" height="11" font="1">1</text>
<text top="267" left="192" width="12" height="15" font="9">−</text>
<text top="268" left="207" width="34" height="15" font="0">0.04y</text>
<text top="273" left="241" width="6" height="11" font="1">1</text>
<text top="268" left="251" width="12" height="14" font="9">+</text>
<text top="268" left="266" width="15" height="15" font="0">10</text>
<text top="264" left="281" width="6" height="11" font="1">4</text>
<text top="268" left="287" width="7" height="15" font="0">y</text>
<text top="273" left="295" width="6" height="11" font="1">2</text>
<text top="268" left="302" width="7" height="15" font="0">y</text>
<text top="273" left="309" width="6" height="11" font="1">3</text>
<text top="293" left="131" width="6" height="15" font="0">r</text>
<text top="298" left="137" width="6" height="11" font="1">2</text>
<text top="293" left="147" width="28" height="14" font="9">= −</text>
<text top="293" left="175" width="7" height="15" font="0">y</text>
<text top="289" left="183" width="3" height="11" font="1">0</text>
<text top="300" left="182" width="6" height="11" font="1">2</text>
<text top="293" left="192" width="12" height="14" font="9">+</text>
<text top="293" left="207" width="34" height="15" font="0">0.04y</text>
<text top="298" left="241" width="6" height="11" font="1">1</text>
<text top="292" left="251" width="12" height="15" font="9">−</text>
<text top="293" left="266" width="15" height="15" font="0">10</text>
<text top="289" left="281" width="6" height="11" font="1">4</text>
<text top="293" left="287" width="7" height="15" font="0">y</text>
<text top="298" left="295" width="6" height="11" font="1">2</text>
<text top="293" left="302" width="7" height="15" font="0">y</text>
<text top="298" left="309" width="6" height="11" font="1">3</text>
<text top="292" left="319" width="12" height="15" font="9">−</text>
<text top="293" left="334" width="26" height="15" font="0">3 10</text>
<text top="289" left="360" width="6" height="11" font="1">7</text>
<text top="293" left="367" width="7" height="15" font="0">y</text>
<text top="289" left="374" width="6" height="11" font="1">2</text>
<text top="300" left="374" width="6" height="11" font="1">2</text>
<text top="315" left="131" width="6" height="15" font="0">r</text>
<text top="321" left="137" width="6" height="11" font="1">3</text>
<text top="315" left="147" width="28" height="14" font="9">= −</text>
<text top="315" left="175" width="7" height="15" font="0">1</text>
<text top="315" left="185" width="12" height="14" font="9">+</text>
<text top="315" left="201" width="7" height="15" font="0">y</text>
<text top="321" left="208" width="6" height="11" font="1">1</text>
<text top="315" left="218" width="12" height="14" font="9">+</text>
<text top="315" left="233" width="7" height="15" font="0">y</text>
<text top="321" left="241" width="6" height="11" font="1">2</text>
<text top="315" left="250" width="12" height="14" font="9">+</text>
<text top="315" left="266" width="7" height="15" font="0">y</text>
<text top="321" left="273" width="6" height="11" font="1">3</text>
<text top="349" left="105" width="212" height="15" font="0">Implemented in R this becomes:</text>
<text top="383" left="89" width="240" height="10" font="12">daefun&lt;-function(t, y, dy, parms) {</text>
<text top="399" left="117" width="213" height="10" font="12">res1 &lt;- - dy[1] - 0.04 * y[1] +</text>
<text top="415" left="185" width="117" height="10" font="12">1e4 * y[2] * y[3]</text>
<text top="432" left="117" width="213" height="10" font="12">res2 &lt;- - dy[2] + 0.04 * y[1] -</text>
<text top="448" left="185" width="219" height="10" font="12">1e4 * y[2] * y[3] - 3e7 * y[2]^2</text>
<text top="465" left="117" width="206" height="10" font="12">res3 &lt;- y[1] + y[2] + y[3] - 1</text>
<text top="481" left="117" width="171" height="10" font="12">list(c(res1, res2, res3),</text>
<text top="498" left="151" width="288" height="10" font="12">error = as.vector(y[1] + y[2] + y[3]) - 1)</text>
<text top="514" left="89" width="7" height="10" font="12">}</text>
<text top="546" left="89" width="27" height="10" font="12">yini</text>
<text top="546" left="131" width="192" height="10" font="12">&lt;- c(y1 = 1, y2 = 0, y3 = 0)</text>
<text top="562" left="89" width="178" height="10" font="12">dyini &lt;- c(-0.04, 0.04, 0)</text>
<text top="579" left="89" width="185" height="10" font="12">times &lt;- 10 ^ seq(-6,6,0.1)</text>
<text top="610" left="105" width="324" height="15" font="0">The input arguments of function daefun are the</text>
<text top="627" left="82" width="346" height="15" font="0">current time (t), the values of the state variables and</text>
<text top="645" left="82" width="346" height="15" font="0">their derivatives (y, dy) and the parameters (parms).</text>
<text top="663" left="82" width="346" height="15" font="0">It returns the residuals, concatenated and an output</text>
<text top="681" left="82" width="346" height="15" font="0">variable, the error in the algebraic equation. The lat-</text>
<text top="699" left="82" width="346" height="15" font="0">ter is added to check upon the accuracy of the results.</text>
<text top="717" left="105" width="324" height="15" font="0">For DAEs solved with daspk, both the state vari-</text>
<text top="735" left="82" width="346" height="15" font="0">ables and their derivatives need to be initialised (y</text>
<text top="753" left="82" width="346" height="15" font="0">and dy). Here we make sure that the initial condi-</text>
<text top="771" left="82" width="346" height="15" font="0">tions for y obey the algebraic constraint, while also</text>
<text top="789" left="82" width="346" height="15" font="0">the initial condition of the derivatives is consistent</text>
<text top="807" left="82" width="126" height="15" font="0">with the dynamics.</text>
<text top="841" left="89" width="110" height="10" font="12">library(deSolve)</text>
<text top="857" left="89" width="268" height="10" font="12">print(system.time(out &lt;-daspk(y = yini,</text>
<text top="874" left="103" width="274" height="10" font="12">dy = dyini, times = times, res = daefun,</text>
<text top="890" left="103" width="103" height="10" font="12">parms = NULL)))</text>
<text top="922" left="103" width="27" height="10" font="12">user</text>
<text top="922" left="144" width="96" height="10" font="12">system elapsed</text>
<text top="938" left="103" width="27" height="10" font="12">0.07</text>
<text top="938" left="158" width="27" height="10" font="12">0.00</text>
<text top="938" left="213" width="27" height="10" font="12">0.11</text>
<text top="969" left="105" width="324" height="15" font="0">An S3 plot method can be used to plot all vari-</text>
<text top="987" left="82" width="88" height="15" font="0">ables at once:</text>
<text top="1021" left="89" width="274" height="10" font="12">plot(out, ylab = &#34;conc.&#34;, xlab = &#34;time&#34;,</text>
<text top="1038" left="103" width="213" height="10" font="12">type = &#34;l&#34;, lwd = 2, log = &#34;x&#34;)</text>
<text top="1054" left="89" width="274" height="10" font="12">mtext(&#34;IVP DAE&#34;, side = 3, outer = TRUE,</text>
<text top="1070" left="103" width="69" height="10" font="12">line = -1)</text>
<text top="1101" left="105" width="324" height="15" font="0">There is a very fast initial change in concentra-</text>
<text top="1119" left="82" width="340" height="15" font="0">tions, mainly due to the quick reaction between y</text>
<text top="1125" left="423" width="6" height="11" font="1">1</text>
<text top="1137" left="82" width="37" height="15" font="0">and y</text>
<text top="1142" left="120" width="6" height="11" font="1">2</text>
<text top="1137" left="130" width="98" height="15" font="0">and amongst y</text>
<text top="1142" left="228" width="6" height="11" font="1">2</text>
<text top="1137" left="235" width="194" height="15" font="0">. After that, the slow reaction</text>
<text top="1155" left="82" width="24" height="15" font="0">of y</text>
<text top="1160" left="107" width="6" height="11" font="1">1</text>
<text top="1155" left="116" width="41" height="15" font="0">with y</text>
<text top="1160" left="158" width="6" height="11" font="1">2</text>
<text top="1155" left="168" width="261" height="15" font="0">causes the system to change much more</text>
<text top="1173" left="82" width="282" height="15" font="0">smoothly. This is typical for stiff problems.</text>
<text top="257" left="491" width="23" height="7" font="18">1e−06</text>
<text top="257" left="544" width="23" height="7" font="18">1e+00</text>
<text top="257" left="596" width="23" height="7" font="18">1e+06</text>
<text top="242" left="487" width="0" height="7" font="19">0.0</text>
<text top="210" left="487" width="0" height="7" font="19">0.4</text>
<text top="179" left="487" width="0" height="7" font="19">0.8</text>
<text top="137" left="550" width="11" height="9" font="20"><b>y1</b></text>
<text top="276" left="547" width="15" height="7" font="18">time</text>
<text top="206" left="467" width="0" height="7" font="19">conc.</text>
<text top="257" left="664" width="23" height="7" font="18">1e−06</text>
<text top="257" left="717" width="23" height="7" font="18">1e+00</text>
<text top="257" left="770" width="23" height="7" font="18">1e+06</text>
<text top="247" left="660" width="0" height="7" font="19">0e+00</text>
<text top="204" left="660" width="0" height="7" font="19">2e−05</text>
<text top="137" left="723" width="11" height="9" font="20"><b>y2</b></text>
<text top="276" left="721" width="15" height="7" font="18">time</text>
<text top="206" left="641" width="0" height="7" font="19">conc.</text>
<text top="430" left="491" width="23" height="7" font="18">1e−06</text>
<text top="430" left="544" width="23" height="7" font="18">1e+00</text>
<text top="430" left="596" width="23" height="7" font="18">1e+06</text>
<text top="415" left="487" width="0" height="7" font="19">0.0</text>
<text top="383" left="487" width="0" height="7" font="19">0.4</text>
<text top="352" left="487" width="0" height="7" font="19">0.8</text>
<text top="310" left="550" width="11" height="9" font="20"><b>y3</b></text>
<text top="449" left="547" width="15" height="7" font="18">time</text>
<text top="380" left="467" width="0" height="7" font="19">conc.</text>
<text top="430" left="664" width="23" height="7" font="18">1e−06</text>
<text top="430" left="717" width="23" height="7" font="18">1e+00</text>
<text top="430" left="770" width="23" height="7" font="18">1e+06</text>
<text top="420" left="660" width="0" height="7" font="19">−5e−09</text>
<text top="382" left="660" width="0" height="7" font="19">−2e−09</text>
<text top="342" left="660" width="0" height="7" font="19">1e−09</text>
<text top="310" left="717" width="22" height="9" font="20"><b>error</b></text>
<text top="449" left="721" width="15" height="7" font="18">time</text>
<text top="380" left="641" width="0" height="7" font="19">conc.</text>
<text top="122" left="613" width="38" height="9" font="14">IVP DAE</text>
<text top="489" left="459" width="346" height="15" font="0">Figure 4: Solution of the DAE problem for the sub-</text>
<text top="507" left="459" width="59" height="15" font="0">stances y</text>
<text top="513" left="518" width="6" height="11" font="1">1</text>
<text top="507" left="524" width="13" height="15" font="0">, y</text>
<text top="513" left="538" width="6" height="11" font="1">2</text>
<text top="507" left="544" width="13" height="15" font="0">, y</text>
<text top="513" left="557" width="6" height="11" font="1">3</text>
<text top="507" left="564" width="242" height="15" font="0">; mass balance error: deviation of to-</text>
<text top="525" left="459" width="116" height="15" font="0">tal sum from one.</text>
<text top="565" left="459" width="237" height="17" font="8"><b>Partial differential equations</b></text>
<text top="598" left="459" width="346" height="15" font="0">In <b>partial differential equations </b>(PDE), the func-</text>
<text top="615" left="459" width="346" height="15" font="0">tion has several independent variables (e.g. time and</text>
<text top="633" left="459" width="295" height="15" font="0">depth) and contains their partial derivatives.</text>
<text top="652" left="481" width="324" height="15" font="0">Many partial differential equations can be solved</text>
<text top="670" left="459" width="346" height="15" font="0">by numerical approximation (finite differencing) af-</text>
<text top="688" left="459" width="277" height="15" font="0">ter rewriting them as a set of ODEs (see</text>
<text top="688" left="741" width="60" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Schiesser</a></text>
<text top="688" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="706" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">1991</a></text>
<text top="706" left="489" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">;</a></text>
<text top="706" left="503" width="57" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">LeVeque</a></text>
<text top="706" left="561" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="706" left="575" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="706" left="605" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="706" left="620" width="182" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hundsdorfer and Verwer</a></text>
<text top="706" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="724" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2003</a></text>
<text top="724" left="489" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="743" left="481" width="324" height="15" font="0">Functions tran.1D, tran.2D, and tran.3D from</text>
<text top="761" left="459" width="70" height="15" font="0">R package</text>
<text top="761" left="534" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="761" left="602" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="761" left="607" width="155" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Meysman</a></text>
<text top="761" left="761" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="761" left="770" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010</a></text>
<text top="761" left="800" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">)</a></text>
<text top="778" left="459" width="346" height="15" font="0">implement finite difference approximations of the</text>
<text top="796" left="459" width="346" height="15" font="0">diffusive-advective transport equation which, for the</text>
<text top="814" left="459" width="77" height="15" font="0">1-D case, is:</text>
<text top="856" left="486" width="12" height="15" font="9">−</text>
<text top="846" left="506" width="7" height="15" font="0">1</text>
<text top="867" left="502" width="11" height="15" font="0">A</text>
<text top="872" left="513" width="6" height="11" font="1">x</text>
<text top="856" left="524" width="4" height="15" font="9">·</text>
<text top="846" left="532" width="8" height="7" font="0"></text>
<text top="850" left="546" width="7" height="11" font="11"><i>∂</i></text>
<text top="870" left="542" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="856" left="560" width="11" height="15" font="0">A</text>
<text top="861" left="572" width="6" height="11" font="1">x</text>
<text top="846" left="580" width="11" height="7" font="0"></text>
<text top="856" left="592" width="12" height="15" font="9">−</text>
<text top="856" left="604" width="12" height="15" font="0">D</text>
<text top="856" left="620" width="4" height="15" font="9">·</text>
<text top="850" left="629" width="18" height="11" font="11"><i>∂</i>C</text>
<text top="870" left="630" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="846" left="649" width="11" height="7" font="0"></text>
<text top="856" left="663" width="12" height="15" font="9">−</text>
<text top="850" left="684" width="7" height="11" font="11"><i>∂</i></text>
<text top="870" left="680" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="856" left="698" width="6" height="14" font="9">(</text>
<text top="856" left="705" width="11" height="15" font="0">A</text>
<text top="861" left="716" width="6" height="11" font="1">x</text>
<text top="856" left="726" width="4" height="15" font="9">·</text>
<text top="856" left="734" width="8" height="15" font="0">u</text>
<text top="856" left="745" width="4" height="15" font="9">·</text>
<text top="856" left="753" width="10" height="15" font="0">C</text>
<text top="856" left="763" width="6" height="14" font="9">)</text>
<text top="846" left="770" width="8" height="7" font="0"></text>
<text top="900" left="459" width="346" height="15" font="0">Here D is the “diffusion coefficient”, u is the “advec-</text>
<text top="918" left="459" width="109" height="15" font="0">tion rate”, and A</text>
<text top="922" left="568" width="6" height="11" font="1">x</text>
<text top="918" left="578" width="227" height="15" font="0">is some property (e.g. surface area)</text>
<text top="935" left="459" width="296" height="15" font="0">that depends on the independent variable, x.</text>
<text top="954" left="481" width="324" height="15" font="0">It should be noted that the accuracy of the finite</text>
<text top="972" left="459" width="346" height="15" font="0">difference approximations can not be specified in the</text>
<text top="990" left="459" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="990" left="526" width="280" height="15" font="0">functions. It is up to the user to make sure</text>
<text top="1008" left="459" width="346" height="15" font="0">that the solutions are sufficiently accurate, e.g. by in-</text>
<text top="1026" left="459" width="169" height="15" font="0">cluding more grid points.</text>
<text top="1071" left="459" width="153" height="15" font="4"><b>One dimensional PDE</b></text>
<text top="1101" left="459" width="346" height="15" font="0">Diffusion-reaction models are a fundamental class of</text>
<text top="1119" left="459" width="346" height="15" font="0">models which describe how concentration of matter,</text>
<text top="1137" left="459" width="346" height="15" font="0">energy, information, etc. evolves in space and time</text>
<text top="1155" left="459" width="346" height="15" font="0">under the influence of diffusive transport and trans-</text>
<text top="1173" left="459" width="74" height="15" font="0">formation <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="1173" left="533" width="141" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Herman</a></text>
<text top="1173" left="674" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1173" left="682" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2009</a></text>
<text top="1173" left="712" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">).</a></text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">11</text>
<text top="125" left="105" width="324" height="15" font="0">As an example, consider the 1-D diffusion-</text>
<text top="143" left="82" width="115" height="15" font="0">reaction model in</text>
<text top="143" left="202" width="4" height="14" font="9">[</text>
<text top="143" left="206" width="28" height="15" font="0">0, 10</text>
<text top="143" left="234" width="4" height="14" font="9">]</text>
<text top="143" left="239" width="4" height="15" font="0">:</text>
<text top="179" left="178" width="18" height="11" font="11"><i>∂</i>C</text>
<text top="199" left="180" width="13" height="11" font="11"><i>∂</i>t</text>
<text top="186" left="201" width="12" height="14" font="9">=</text>
<text top="179" left="223" width="7" height="11" font="11"><i>∂</i></text>
<text top="199" left="219" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="175" left="238" width="11" height="7" font="0"></text>
<text top="186" left="250" width="12" height="15" font="0">D</text>
<text top="185" left="265" width="4" height="15" font="9">·</text>
<text top="179" left="274" width="18" height="11" font="11"><i>∂</i>C</text>
<text top="199" left="275" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="175" left="294" width="11" height="7" font="0"></text>
<text top="185" left="308" width="12" height="15" font="9">−</text>
<text top="186" left="324" width="12" height="15" font="0">Q</text>
<text top="228" left="82" width="346" height="15" font="0">with C the concentration, t the time, x the distance</text>
<text top="246" left="82" width="346" height="15" font="0">from the origin, Q, the consumption rate, and with</text>
<text top="264" left="82" width="326" height="15" font="0">boundary conditions (values at the model edges):</text>
<text top="300" left="213" width="18" height="11" font="11"><i>∂</i>C</text>
<text top="320" left="214" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="320" left="233" width="21" height="11" font="1">x=0</text>
<text top="306" left="259" width="12" height="14" font="9">=</text>
<text top="306" left="274" width="7" height="15" font="0">0</text>
<text top="336" left="218" width="10" height="15" font="0">C</text>
<text top="341" left="228" width="27" height="11" font="1">x=10</text>
<text top="336" left="259" width="12" height="14" font="9">=</text>
<text top="336" left="274" width="10" height="15" font="0">C</text>
<text top="341" left="284" width="15" height="11" font="1">ext</text>
<text top="369" left="82" width="346" height="15" font="0">To solve this model in R, first the 1-D model Grid is</text>
<text top="387" left="82" width="312" height="15" font="0">defined; it divides 10 cm (L) into 1000 boxes (N).</text>
<text top="423" left="89" width="117" height="10" font="12">library(ReacTran)</text>
<text top="439" left="89" width="268" height="10" font="12">Grid &lt;- setup.grid.1D(N = 1000, L = 10)</text>
<text top="471" left="105" width="324" height="15" font="0">The model equation includes a transport term,</text>
<text top="489" left="82" width="118" height="15" font="0">approximated by</text>
<text top="489" left="208" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="489" left="279" width="150" height="15" font="0">function tran.1D and</text>
<text top="507" left="82" width="346" height="15" font="0">a consumption term (Q). The downstream bound-</text>
<text top="525" left="82" width="346" height="15" font="0">ary condition, prescribed as a concentration (C.down)</text>
<text top="543" left="82" width="346" height="15" font="0">needs to be specified, the zero-gradient at the up-</text>
<text top="561" left="82" width="207" height="15" font="0">stream boundary is the default:</text>
<text top="596" left="89" width="199" height="10" font="12">pde1D &lt;-function(t, C, parms)</text>
<text top="596" left="302" width="7" height="10" font="12">{</text>
<text top="612" left="103" width="199" height="10" font="12">tran &lt;- tran.1D(C = C, D = D,</text>
<text top="629" left="213" width="192" height="10" font="12">C.down = Cext, dx = Grid)$dC</text>
<text top="645" left="103" width="96" height="10" font="12">list(tran - Q)</text>
<text top="645" left="213" width="206" height="10" font="12"># return value: rate of change</text>
<text top="662" left="89" width="7" height="10" font="12">}</text>
<text top="694" left="105" width="177" height="15" font="0">The model parameters are:</text>
<text top="729" left="89" width="7" height="10" font="12">D</text>
<text top="729" left="124" width="27" height="10" font="12">&lt;- 1</text>
<text top="729" left="179" width="137" height="10" font="12"># diffusion constant</text>
<text top="745" left="89" width="7" height="10" font="12">Q</text>
<text top="745" left="124" width="27" height="10" font="12">&lt;- 1</text>
<text top="745" left="179" width="89" height="10" font="12"># uptake rate</text>
<text top="762" left="89" width="69" height="10" font="12">Cext &lt;- 20</text>
<text top="794" left="105" width="324" height="15" font="0">In a first application, the model is solved to</text>
<text top="812" left="82" width="346" height="15" font="0">steady-state, which retrieves the condition where the</text>
<text top="830" left="82" width="188" height="15" font="0">concentrations are invariant:</text>
<text top="869" left="183" width="7" height="15" font="0">0</text>
<text top="869" left="194" width="12" height="14" font="9">=</text>
<text top="862" left="216" width="7" height="11" font="11"><i>∂</i></text>
<text top="883" left="212" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="858" left="231" width="11" height="7" font="0"></text>
<text top="869" left="243" width="12" height="15" font="0">D</text>
<text top="868" left="258" width="4" height="15" font="9">·</text>
<text top="862" left="267" width="18" height="11" font="11"><i>∂</i>C</text>
<text top="883" left="268" width="15" height="11" font="11"><i>∂</i>x</text>
<text top="858" left="287" width="11" height="7" font="0"></text>
<text top="868" left="301" width="12" height="15" font="9">−</text>
<text top="869" left="317" width="12" height="15" font="0">Q</text>
<text top="911" left="82" width="346" height="15" font="0">In R, steady-state conditions can be estimated using</text>
<text top="929" left="82" width="156" height="15" font="0">functions from package</text>
<text top="929" left="243" width="66" height="15" font="7"><a href="http://cran.r-project.org/package=rootSolve"><b>rootSolve</b></a></text>
<text top="929" left="312" width="117" height="15" font="0">which implement</text>
<text top="947" left="82" width="312" height="15" font="0">amongst others a Newton-Raphson algorithm <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="947" left="394" width="34" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Press</a></text>
<text top="965" left="82" width="31" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">et al.</a></text>
<text top="965" left="114" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="965" left="122" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="965" left="151" width="277" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>For 1-dimensional models, steady.1D is</text>
<text top="983" left="82" width="346" height="15" font="0">most efficient. The initial “guess” of the steady-state</text>
<text top="1001" left="82" width="346" height="15" font="0">solution (y) is unimportant; here we take simply N</text>
<text top="1019" left="82" width="346" height="15" font="0">random numbers. Argument nspec = 1 informs the</text>
<text top="1037" left="82" width="295" height="15" font="0">solver that only one component is described.</text>
<text top="1055" left="105" width="324" height="15" font="0">Although a system of 1000 equations needs to be</text>
<text top="1073" left="82" width="294" height="15" font="0">solved, this takes only a fraction of a second:</text>
<text top="1108" left="89" width="123" height="10" font="12">library(rootSolve)</text>
<text top="1124" left="89" width="123" height="10" font="12">print(system.time(</text>
<text top="1141" left="89" width="21" height="10" font="12">std</text>
<text top="1141" left="131" width="213" height="10" font="12">&lt;- steady.1D(y = runif(Grid$N),</text>
<text top="1157" left="103" width="261" height="10" font="12">func = pde1D, parms = NULL, nspec = 1)</text>
<text top="1174" left="89" width="14" height="10" font="12">))</text>
<text top="127" left="479" width="27" height="10" font="12">user</text>
<text top="127" left="521" width="96" height="10" font="12">system elapsed</text>
<text top="144" left="479" width="27" height="10" font="12">0.02</text>
<text top="144" left="534" width="27" height="10" font="12">0.00</text>
<text top="144" left="589" width="27" height="10" font="12">0.02</text>
<text top="177" left="481" width="324" height="15" font="0">The values of the state-variables (y) are plotted</text>
<text top="195" left="459" width="346" height="15" font="0">against the distance, in the middle of the grid cells</text>
<text top="213" left="459" width="90" height="15" font="0">(Grid$x.mid).</text>
<text top="249" left="466" width="247" height="10" font="12">plot (Grid$x.mid, std$y, type = &#34;l&#34;,</text>
<text top="265" left="479" width="240" height="10" font="12">lwd = 2, main = &#34;steady-state PDE&#34;,</text>
<text top="282" left="479" width="247" height="10" font="12">xlab = &#34;x&#34;, ylab = &#34;C&#34;, col = &#34;red&#34;)</text>
<text top="497" left="514" width="5" height="9" font="14">0</text>
<text top="497" left="565" width="5" height="9" font="14">2</text>
<text top="497" left="615" width="5" height="9" font="14">4</text>
<text top="497" left="666" width="5" height="9" font="14">6</text>
<text top="497" left="717" width="5" height="9" font="14">8</text>
<text top="497" left="766" width="11" height="9" font="14">10</text>
<text top="480" left="492" width="0" height="9" font="15">−30</text>
<text top="433" left="492" width="0" height="9" font="15">−10</text>
<text top="405" left="492" width="0" height="9" font="15">0</text>
<text top="384" left="492" width="0" height="9" font="15">10</text>
<text top="361" left="492" width="0" height="9" font="15">20</text>
<text top="330" left="596" width="94" height="10" font="16"><b>steady−state PDE</b></text>
<text top="520" left="641" width="5" height="9" font="14">x</text>
<text top="417" left="469" width="0" height="9" font="15">C</text>
<text top="564" left="459" width="346" height="15" font="0">Figure 5: Steady-state solution of the 1-D diffusion-</text>
<text top="582" left="459" width="102" height="15" font="0">reaction model.</text>
<text top="613" left="481" width="324" height="15" font="0">The analytical solution compares well with the</text>
<text top="631" left="459" width="172" height="15" font="0">numerical approximation:</text>
<text top="667" left="466" width="329" height="10" font="12">analytical &lt;- Q/2/D*(Grid$x.mid^2 - 10^2) + Cext</text>
<text top="684" left="466" width="192" height="10" font="12">max(abs(analytical - std$y))</text>
<text top="717" left="459" width="110" height="10" font="12">[1] 1.250003e-05</text>
<text top="750" left="481" width="324" height="15" font="0">Next the model is run dynamically for 100 time</text>
<text top="768" left="459" width="77" height="15" font="0">units using</text>
<text top="768" left="542" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="768" left="604" width="201" height="15" font="0">function ode.1D, and starting</text>
<text top="786" left="459" width="197" height="15" font="0">with a uniform concentration:</text>
<text top="822" left="466" width="110" height="10" font="12">require(deSolve)</text>
<text top="838" left="466" width="192" height="10" font="12">times &lt;- seq(0, 100, by = 1)</text>
<text top="855" left="466" width="82" height="10" font="12">system.time(</text>
<text top="871" left="479" width="226" height="10" font="12">out &lt;- ode.1D(y = rep(1, Grid$N),</text>
<text top="887" left="493" width="192" height="10" font="12">times = times, func = pde1D,</text>
<text top="904" left="493" width="165" height="10" font="12">parms = NULL, nspec = 1)</text>
<text top="920" left="466" width="7" height="10" font="12">)</text>
<text top="954" left="479" width="27" height="10" font="12">user</text>
<text top="954" left="521" width="96" height="10" font="12">system elapsed</text>
<text top="970" left="479" width="27" height="10" font="12">0.61</text>
<text top="970" left="534" width="27" height="10" font="12">0.02</text>
<text top="970" left="589" width="27" height="10" font="12">0.63</text>
<text top="1003" left="481" width="201" height="15" font="0">Here, out is a matrix, whose 1</text>
<text top="1000" left="682" width="8" height="11" font="1">st</text>
<text top="1003" left="696" width="110" height="15" font="0">column contains</text>
<text top="1021" left="459" width="346" height="15" font="0">the output times, and the next columns the values of</text>
<text top="1039" left="459" width="346" height="15" font="0">the state variables in the different boxes; we print the</text>
<text top="1057" left="459" width="324" height="15" font="0">first columns of the last three rows of this matrix:</text>
<text top="1093" left="466" width="158" height="10" font="12">tail(out[, 1:4], n = 3)</text>
<text top="1126" left="507" width="27" height="10" font="12">time</text>
<text top="1126" left="596" width="7" height="10" font="12">1</text>
<text top="1126" left="665" width="7" height="10" font="12">2</text>
<text top="1126" left="733" width="7" height="10" font="12">3</text>
<text top="1142" left="459" width="34" height="10" font="12">[99,]</text>
<text top="1142" left="521" width="219" height="10" font="12">98 -27.55783 -27.55773 -27.55754</text>
<text top="1159" left="459" width="41" height="10" font="12">[100,]</text>
<text top="1159" left="521" width="219" height="10" font="12">99 -27.61735 -27.61725 -27.61706</text>
<text top="1175" left="459" width="41" height="10" font="12">[101,]</text>
<text top="1175" left="514" width="226" height="10" font="12">100 -27.67542 -27.67532 -27.67513</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="21" size="3" family="Helvetica" color="#000000"/>
	<fontspec id="22" size="3" family="Helvetica" color="#000000"/>
	<fontspec id="23" size="3" family="Helvetica" color="#000000"/>
	<fontspec id="24" size="3" family="Helvetica" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">12</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="105" width="324" height="15" font="0">We plot the result using a blue-yellow-red color</text>
<text top="143" left="82" width="346" height="15" font="0">scheme, and using deSolve’s S3 method image. Fig-</text>
<text top="161" left="82" width="22" height="15" font="0">ure</text>
<text top="161" left="107" width="7" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">6</a></text>
<text top="161" left="118" width="311" height="15" font="0">shows that, as time proceeds, gradients develop</text>
<text top="179" left="82" width="346" height="15" font="0">from the uniform distribution, until the system al-</text>
<text top="197" left="82" width="346" height="15" font="0">most reaches steady-state at the end of the simula-</text>
<text top="215" left="82" width="30" height="15" font="0">tion.</text>
<text top="252" left="89" width="213" height="10" font="12">image(out, xlab = &#34;time, days&#34;,</text>
<text top="269" left="131" width="151" height="10" font="12">ylab = &#34;Distance, cm&#34;,</text>
<text top="285" left="131" width="226" height="10" font="12">main = &#34;PDE&#34;, add.contour = TRUE)</text>
<text top="617" left="129" width="5" height="9" font="14">0</text>
<text top="617" left="180" width="11" height="9" font="14">20</text>
<text top="617" left="235" width="11" height="9" font="14">40</text>
<text top="617" left="289" width="11" height="9" font="14">60</text>
<text top="617" left="344" width="11" height="9" font="14">80</text>
<text top="617" left="395" width="16" height="9" font="14">100</text>
<text top="603" left="116" width="0" height="9" font="15">0.0</text>
<text top="555" left="116" width="0" height="9" font="15">0.2</text>
<text top="507" left="116" width="0" height="9" font="15">0.4</text>
<text top="459" left="116" width="0" height="9" font="15">0.6</text>
<text top="411" left="116" width="0" height="9" font="15">0.8</text>
<text top="363" left="116" width="0" height="9" font="15">1.0</text>
<text top="336" left="256" width="23" height="10" font="16"><b>PDE</b></text>
<text top="640" left="246" width="43" height="9" font="14">time, days</text>
<text top="504" left="93" width="0" height="9" font="15">Distance</text>
<text top="467" left="93" width="0" height="9" font="15">, cm</text>
<text top="547" left="391" width="12" height="5" font="21"> −25 </text>
<text top="506" left="388" width="13" height="5" font="22"> −20 </text>
<text top="478" left="390" width="13" height="5" font="22"> −15 </text>
<text top="455" left="388" width="13" height="5" font="22"> −10 </text>
<text top="436" left="393" width="10" height="5" font="22"> −5 </text>
<text top="418" left="396" width="6" height="5" font="23"> 0 </text>
<text top="402" left="397" width="6" height="5" font="23"> 5 </text>
<text top="388" left="394" width="9" height="5" font="24"> 10 </text>
<text top="374" left="388" width="9" height="5" font="24"> 15 </text>
<text top="685" left="82" width="346" height="15" font="0">Figure 6: Dynamic solution of the 1-D diffusion-</text>
<text top="702" left="82" width="102" height="15" font="0">reaction model.</text>
<text top="734" left="105" width="324" height="15" font="0">It should be noted that the steady-state model is</text>
<text top="752" left="82" width="346" height="15" font="0">effectively a boundary value problem, while the tran-</text>
<text top="770" left="82" width="346" height="15" font="0">sient model is a prototype of a “parabolic” partial dif-</text>
<text top="788" left="82" width="125" height="15" font="0">ferential equation <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="788" left="208" width="57" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">LeVeque</a></text>
<text top="788" left="265" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="788" left="272" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2007</a></text>
<text top="788" left="302" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="807" left="105" width="324" height="15" font="0">Whereas R can also solve the other two main</text>
<text top="825" left="82" width="346" height="15" font="0">classes of PDEs, i.e. of the “hyperbolic” and “ellip-</text>
<text top="843" left="82" width="346" height="15" font="0">tic” type, it is well beyond the scope of this paper to</text>
<text top="861" left="82" width="115" height="15" font="0">elaborate on that.</text>
<text top="913" left="82" width="109" height="21" font="5"><b>Discussion</b></text>
<text top="954" left="82" width="346" height="15" font="0">Although R is still predominantly applied for statis-</text>
<text top="972" left="82" width="346" height="15" font="0">tical analysis and graphical representation, it is more</text>
<text top="990" left="82" width="346" height="15" font="0">and more suitable for mathematical computing, e.g.</text>
<text top="1008" left="82" width="209" height="15" font="0">in the field of matrix algebra <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="1008" left="292" width="134" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Bates and Maechler</a></text>
<text top="1008" left="425" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="1026" left="82" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="1026" left="112" width="317" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">). </a>Thanks to the differential equation solvers, R</text>
<text top="1044" left="82" width="346" height="15" font="0">is also emerging as a powerful environment for dy-</text>
<text top="1062" left="82" width="130" height="15" font="0">namic simulations <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="1062" left="212" width="55" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Petzoldt</a></text>
<text top="1062" left="268" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="1062" left="275" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2003</a></text>
<text top="1062" left="305" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">;</a></text>
<text top="1062" left="312" width="117" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Her-</a></text>
<text top="1079" left="82" width="29" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">man</a></text>
<text top="1079" left="112" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1079" left="119" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2009</a></text>
<text top="1079" left="149" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">;</a></text>
<text top="1079" left="157" width="51" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Stevens</a></text>
<text top="1079" left="207" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1079" left="215" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2009</a></text>
<text top="1079" left="245" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">).</a></text>
<text top="1098" left="105" width="121" height="15" font="0">The new package</text>
<text top="1099" left="233" width="55" height="15" font="7"><a href="http://cran.r-project.org/package=deSolve"><b>deSolve</b></a></text>
<text top="1098" left="295" width="134" height="15" font="0">has retained all the</text>
<text top="1116" left="82" width="220" height="15" font="0">funtionalities of its predecessor</text>
<text top="1116" left="311" width="61" height="15" font="7"><a href="http://cran.r-project.org/package=odesolve"><b>odesolve</b></a></text>
<text top="1116" left="380" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="1116" left="385" width="40" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Setzer</a></text>
<text top="1116" left="425" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="1134" left="82" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2001</a></text>
<text top="1134" left="112" width="317" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>such as the potential to define models both in</text>
<text top="125" left="459" width="346" height="15" font="0">R code, or in compiled languages. However, com-</text>
<text top="143" left="459" width="57" height="15" font="0">pared to</text>
<text top="143" left="521" width="61" height="15" font="7"><a href="http://cran.r-project.org/package=odesolve"><b>odesolve</b></a></text>
<text top="143" left="582" width="223" height="15" font="0"><a href="http://cran.r-project.org/package=odesolve">, </a>it includes a more complete set</text>
<text top="161" left="459" width="346" height="15" font="0">of integrators, and a more extensive set of options to</text>
<text top="179" left="459" width="346" height="15" font="0">tune the integration routines, it provides more com-</text>
<text top="197" left="459" width="346" height="15" font="0">plete output, and has extended the applicability do-</text>
<text top="215" left="459" width="295" height="15" font="0">main to include also DDEs, DAEs and PDEs.</text>
<text top="233" left="481" width="236" height="15" font="0">Thanks to the DAE solvers daspk <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="233" left="717" width="85" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Brenan et al.</a></text>
<text top="233" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="251" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">1996</a></text>
<text top="251" left="489" width="85" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>and radau <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="251" left="574" width="128" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Hairer and Wanner</a></text>
<text top="251" left="702" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="251" left="709" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2010</a></text>
<text top="251" left="739" width="66" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">) </a>it is now</text>
<text top="269" left="459" width="346" height="15" font="0">also possible to model electronic circuits or equilib-</text>
<text top="287" left="459" width="346" height="15" font="0">rium chemical systems. These problems are often of</text>
<text top="305" left="459" width="37" height="15" font="0">index</text>
<text top="304" left="502" width="12" height="15" font="9">≤</text>
<text top="305" left="519" width="286" height="15" font="0">1. In many mechanical systems, physical</text>
<text top="323" left="459" width="346" height="15" font="0">constraints lead to DAEs of index up to 3, and these</text>
<text top="341" left="459" width="333" height="15" font="0">more complex problems can be solved with radau.</text>
<text top="360" left="481" width="324" height="15" font="0">The inclusion of BVP and PDE solvers have</text>
<text top="378" left="459" width="346" height="15" font="0">opened up the application area to the field of re-</text>
<text top="396" left="459" width="188" height="15" font="0">active transport modelling <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="396" left="647" width="154" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Meysman</a></text>
<text top="396" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="414" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010</a></text>
<text top="414" left="489" width="317" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">), </a>such that R can now be used to describe quan-</text>
<text top="432" left="459" width="346" height="15" font="0">tities that change not only in time, but also along</text>
<text top="449" left="459" width="346" height="15" font="0">one or more spatial axes. We use it to model how</text>
<text top="467" left="459" width="346" height="15" font="0">ecosystems change along rivers, or in sediments, but</text>
<text top="485" left="459" width="346" height="15" font="0">it could equally serve to model the growth of a tu-</text>
<text top="503" left="459" width="346" height="15" font="0">mor in human brains, or the dispersion of toxicants</text>
<text top="521" left="459" width="116" height="15" font="0">in human tissues.</text>
<text top="540" left="481" width="324" height="15" font="0">The open source matrix language R has great po-</text>
<text top="558" left="459" width="346" height="15" font="0">tential for dynamic modelling, and the tools cur-</text>
<text top="576" left="459" width="346" height="15" font="0">rently available are suitable for solving a wide va-</text>
<text top="594" left="459" width="346" height="15" font="0">riety of practical and scientific problems. The perfor-</text>
<text top="612" left="459" width="346" height="15" font="0">mance is sufficient even for larger systems, especially</text>
<text top="630" left="459" width="346" height="15" font="0">when models can be formulated using matrix alge-</text>
<text top="648" left="459" width="346" height="15" font="0">bra or are implemented in compiled languages like</text>
<text top="666" left="459" width="96" height="15" font="0">C or Fortran <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="666" left="555" width="93" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert et al.</a></text>
<text top="666" left="648" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="666" left="658" width="38" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010b</a></text>
<text top="666" left="696" width="110" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">). </a>Indeed, there</text>
<text top="683" left="459" width="346" height="15" font="0">is emerging interest in performing statistical analysis</text>
<text top="701" left="459" width="273" height="15" font="0">on differential equations, e.g. in package</text>
<text top="701" left="736" width="69" height="15" font="7"><a href="http://cran.r-project.org/package=nlmeODE"><b>nlmeODE</b></a></text>
<text top="719" left="459" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="719" left="464" width="89" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Tornøe et al.</a></text>
<text top="719" left="553" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="719" left="565" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2004</a></text>
<text top="719" left="595" width="211" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>for fitting non-linear mixed-</text>
<text top="737" left="459" width="346" height="15" font="0">effects models using differential equations, pack-</text>
<text top="755" left="459" width="23" height="15" font="0">age</text>
<text top="755" left="487" width="32" height="15" font="7"><a href="http://cran.r-project.org/package=FME"><b>FME</b></a></text>
<text top="755" left="525" width="5" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="755" left="530" width="145" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Soetaert and Petzoldt</a></text>
<text top="755" left="675" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="755" left="685" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">2010</a></text>
<text top="755" left="715" width="91" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>for sensitiv-</text>
<text top="773" left="459" width="346" height="15" font="0">ity analysis, parameter estimation and Markov chain</text>
<text top="791" left="459" width="216" height="15" font="0">Monte-Carlo analysis or package</text>
<text top="791" left="678" width="41" height="15" font="7"><a href="http://cran.r-project.org/package=ccems"><b>ccems</b></a></text>
<text top="791" left="721" width="84" height="15" font="0">for combina-</text>
<text top="809" left="459" width="311" height="15" font="0">torially complex equilibrium model selection <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">(</a></text>
<text top="809" left="769" width="36" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">Radi-</a></text>
<text top="827" left="459" width="65" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">voyevitch</a></text>
<text top="827" left="524" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">,</a></text>
<text top="827" left="531" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">2008</a></text>
<text top="827" left="561" width="9" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#9">).</a></text>
<text top="846" left="481" width="324" height="15" font="0">However, there is ample room for extensions</text>
<text top="864" left="459" width="346" height="15" font="0">and improvements. For instance, the PDE solvers</text>
<text top="882" left="459" width="346" height="15" font="0">are quite memory intensive, and could benefit from</text>
<text top="899" left="459" width="346" height="15" font="0">the implementation of sparse matrix solvers that are</text>
<text top="917" left="459" width="186" height="15" font="0">more efficient in this r<a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">espect</a></text>
<text top="915" left="645" width="6" height="11" font="3"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">2</a></text>
<text top="917" left="652" width="154" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">. </a>In addition, the meth-</text>
<text top="935" left="459" width="134" height="15" font="0">ods implemented in</text>
<text top="935" left="597" width="63" height="15" font="7"><a href="http://cran.r-project.org/package=ReacTran"><b>ReacTran</b></a></text>
<text top="935" left="665" width="140" height="15" font="0">handle equations de-</text>
<text top="953" left="459" width="346" height="15" font="0">fined on very simple shapes only. Extending the</text>
<text top="971" left="459" width="239" height="15" font="0">PDE approach to finite elements <a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">(</a></text>
<text top="971" left="698" width="103" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">Strang and Fix</a></text>
<text top="971" left="802" width="4" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">,</a></text>
<text top="989" left="459" width="30" height="15" font="6"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">1973</a></text>
<text top="989" left="489" width="317" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#10">) </a>would open up the application domain of R to</text>
<text top="1007" left="459" width="346" height="15" font="0">any irregular geometry. Other spatial discretisation</text>
<text top="1025" left="459" width="346" height="15" font="0">schemes could be added, e.g. for use in fluid dynam-</text>
<text top="1043" left="459" width="21" height="15" font="0">ics.</text>
<text top="1062" left="481" width="324" height="15" font="0">Our models are often applied to derive unknown</text>
<text top="1080" left="459" width="346" height="15" font="0">parameters by fitting them against data; this relies on</text>
<text top="1098" left="459" width="335" height="15" font="0">the availability of apt parameter fitting algorithms.</text>
<text top="1116" left="481" width="324" height="15" font="0">Discussion of these items is highly welcomed, in</text>
<text top="1134" left="459" width="346" height="15" font="0">the new special interest group about dynamic mod-</text>
<text top="1158" left="99" width="4" height="9" font="10">2</text>
<text top="1160" left="104" width="464" height="12" font="1">for instance, the “preconditioned Krylov” part of the daspk method is not yet supported</text>
<text top="1173" left="99" width="4" height="9" font="10">3</text>
<text top="1176" left="107" width="356" height="9" font="3"><a href="https://stat.ethz.ch/mailman/listinfo/r-sig-dynamic-models">https://stat.ethz.ch/mailman/listinfo/r-sig-dynamic-models</a></text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">13</text>
<text top="125" left="82" width="18" height="15" font="0"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">els</a></text>
<text top="122" left="100" width="6" height="11" font="3"><a href="2010-2-RJournal_2010-2_Soetaert~et~al.html#8">3</a></text>
<text top="125" left="110" width="31" height="15" font="0">in R.</text>
<text top="175" left="82" width="130" height="21" font="5"><b>Bibliography</b></text>
<text top="215" left="82" width="346" height="15" font="0">U. Ascher, R. Mattheij, and R. Russell. Numerical So-</text>
<text top="232" left="97" width="332" height="15" font="0">lution of Boundary Value Problems for Ordinary Dif-</text>
<text top="250" left="97" width="275" height="15" font="0">ferential Equations. Philadelphia, PA, 1995.</text>
<text top="283" left="82" width="346" height="15" font="0">U. M. Ascher and L. R. Petzold. Computer Methods</text>
<text top="301" left="97" width="332" height="15" font="0">for Ordinary Differential Equations and Differential-</text>
<text top="319" left="97" width="303" height="15" font="0">Algebraic Equations. SIAM, Philadelphia, 1998.</text>
<text top="351" left="82" width="346" height="15" font="0">G. Bader and U. Ascher. A new basis implementa-</text>
<text top="369" left="97" width="332" height="15" font="0">tion for a mixed order boundary value ODE solver.</text>
<text top="387" left="97" width="297" height="15" font="0">SIAM J. Scient. Stat. Comput., 8:483–500, 1987.</text>
<text top="419" left="82" width="346" height="15" font="0">D. Bates and M. Maechler. <b>Matrix</b>: A Matrix Package</text>
<text top="437" left="97" width="274" height="15" font="0">for R, 2008. R package version 0.999375-9.</text>
<text top="470" left="82" width="346" height="15" font="0">P. Bogacki and L. Shampine. A 3(2) pair of Runge-</text>
<text top="487" left="97" width="297" height="15" font="0">Kutta formulas. Appl. Math. Lett., 2:1–9, 1989.</text>
<text top="520" left="82" width="346" height="15" font="0">K. E. Brenan, S. L. Campbell, and L. R. Pet-</text>
<text top="538" left="97" width="332" height="15" font="0">zold. Numerical Solution of Initial-Value Problems in</text>
<text top="556" left="97" width="332" height="15" font="0">Differential-Algebraic Equations. SIAM Classics in</text>
<text top="574" left="97" width="185" height="15" font="0">Applied Mathematics, 1996.</text>
<text top="606" left="82" width="346" height="15" font="0">P. N. Brown, G. D. Byrne, and A. C. Hindmarsh.</text>
<text top="624" left="97" width="46" height="15" font="4"><b>VODE</b></text>
<text top="624" left="143" width="286" height="15" font="0">, a variable-coefficient ode solver. SIAM J.</text>
<text top="642" left="97" width="246" height="15" font="0">Sci. Stat. Comput., 10:1038–1051, 1989.</text>
<text top="674" left="82" width="346" height="15" font="0">J. C. Butcher. The Numerical Analysis of Ordinary Dif-</text>
<text top="692" left="97" width="332" height="15" font="0">ferential Equations, Runge-Kutta and General Linear</text>
<text top="710" left="97" width="290" height="15" font="0">Methods. Wiley, Chichester, New York, 1987.</text>
<text top="742" left="82" width="346" height="15" font="0">J. R. Cash. 35 Test Problems for Two Way Point Bound-</text>
<text top="760" left="97" width="198" height="15" font="0">ary Value Problems, 2009. URL</text>
<text top="762" left="299" width="130" height="12" font="6"><a href="http://www.ma.ic.ac.uk/~jcash/BVP_software/PROBLEMS.PDF">http://www.ma.ic.</a></text>
<text top="780" left="97" width="290" height="12" font="6"><a href="http://www.ma.ic.ac.uk/~jcash/BVP_software/PROBLEMS.PDF">ac.uk/~jcash/BVP_software/PROBLEMS.PDF</a></text>
<text top="778" left="387" width="4" height="15" font="0"><a href="http://www.ma.ic.ac.uk/~jcash/BVP_software/PROBLEMS.PDF">.</a></text>
<text top="811" left="82" width="204" height="15" font="0">J. R. Cash and A. H. Karp.</text>
<text top="811" left="310" width="119" height="15" font="0">A variable order</text>
<text top="829" left="97" width="332" height="15" font="0">Runge-Kutta method for initial value problems</text>
<text top="846" left="97" width="332" height="15" font="0">with rapidly varying right-hand sides. ACM Trans-</text>
<text top="864" left="97" width="324" height="15" font="0">actions on Mathematical Software, 16:201–222, 1990.</text>
<text top="897" left="82" width="178" height="15" font="0">J. R. Cash and F. Mazzia.</text>
<text top="897" left="275" width="154" height="15" font="0">A new mesh selection</text>
<text top="915" left="97" width="332" height="15" font="0">algorithm, based on conditioning, for two-point</text>
<text top="933" left="97" width="332" height="15" font="0">boundary value codes. J. Comput. Appl. Math., 184:</text>
<text top="951" left="97" width="93" height="15" font="0">362–381, 2005.</text>
<text top="983" left="82" width="346" height="15" font="0">A. Couture-Beil, J. T. Schnute, and R. Haigh. <b>PB-</b></text>
<text top="1001" left="97" width="328" height="15" font="4"><b>Sddesolve</b>: Solver for Delay Differential Equations</text>
<text top="1001" left="425" width="4" height="15" font="0">,</text>
<text top="1019" left="97" width="212" height="15" font="0">2010. R package version 1.08.11.</text>
<text top="1051" left="82" width="346" height="15" font="0">J. R. Dormand and P. J. Prince. A family of embed-</text>
<text top="1069" left="97" width="332" height="15" font="0">ded Runge-Kutta formulae. J. Comput. Appl. Math.,</text>
<text top="1087" left="97" width="90" height="15" font="0">6:19–26, 1980.</text>
<text top="1119" left="82" width="346" height="15" font="0">E. Hairer and G. Wanner. Solving Ordinary Differen-</text>
<text top="1137" left="97" width="332" height="15" font="0">tial Equations II: Stiff and Differential-Algebraic Prob-</text>
<text top="1155" left="97" width="332" height="15" font="0">lems. Second Revised Edition. Springer-Verlag, Hei-</text>
<text top="1173" left="97" width="91" height="15" font="0">delberg, 2010.</text>
<text top="125" left="459" width="346" height="15" font="0">E. Hairer, S. P. Noørsett, and G. Wanner. Solving Ordi-</text>
<text top="143" left="474" width="332" height="15" font="0">nary Differential Equations I: Nonstiff Problems. Sec-</text>
<text top="161" left="474" width="332" height="15" font="0">ond Revised Edition. Springer-Verlag, Heidelberg,</text>
<text top="179" left="474" width="34" height="15" font="0">2009.</text>
<text top="209" left="459" width="346" height="15" font="0">S. Hamdi, W. E. Schiesser, and G. W. Griffiths.</text>
<text top="227" left="474" width="297" height="15" font="0">Method of lines. Scholarpedia, 2(7):2859, 2007.</text>
<text top="257" left="459" width="346" height="15" font="0">A. C. Hindmarsh. <b>ODEPACK</b>, a systematized collec-</text>
<text top="275" left="474" width="332" height="15" font="0">tion of ODE solvers. In R. Stepleman, editor, Scien-</text>
<text top="293" left="474" width="332" height="15" font="0">tific Computing, Vol. 1 of IMACS Transactions on Sci-</text>
<text top="311" left="474" width="332" height="15" font="0">entific Computation, pages 55–64. IMACS / North-</text>
<text top="329" left="474" width="182" height="15" font="0">Holland, Amsterdam, 1983.</text>
<text top="359" left="459" width="346" height="15" font="0">W. Hundsdorfer and J. Verwer. Numerical Solution of</text>
<text top="376" left="474" width="332" height="15" font="0">Time-Dependent Advection-Diffusion-Reaction Equa-</text>
<text top="394" left="474" width="332" height="15" font="0">tions. Springer Series in Computational Mathematics.</text>
<text top="412" left="474" width="192" height="15" font="0">Springer-Verlag, Berlin, 2003.</text>
<text top="442" left="459" width="346" height="15" font="0">S. M. Iacus. <b>sde</b>: Simulation and Inference for Stochas-</text>
<text top="460" left="474" width="332" height="15" font="0">tic Differential Equations, 2008. R package version</text>
<text top="478" left="474" width="34" height="15" font="0">2.0.3.</text>
<text top="508" left="459" width="346" height="15" font="0">IEEE Standard 754. Ieee standard for floating-point</text>
<text top="526" left="474" width="141" height="15" font="0">arithmetic, Aug 2008.</text>
<text top="556" left="459" width="346" height="15" font="0">A. A. King, E. L. Ionides, and C. M. Breto. <b>pomp</b>: Sta-</text>
<text top="574" left="474" width="332" height="15" font="0">tistical Inference for Partially Observed Markov Pro-</text>
<text top="592" left="474" width="249" height="15" font="0">cesses, 2008. R package version 0.21-3.</text>
<text top="622" left="459" width="346" height="15" font="0">R. J. LeVeque. Finite Difference Methods for Ordinary</text>
<text top="640" left="474" width="332" height="15" font="0">and Partial Differential Equations, Steady State and</text>
<text top="658" left="474" width="247" height="15" font="0">Time Dependent Problems. SIAM, 2007.</text>
<text top="688" left="459" width="346" height="15" font="0">F. Mazzia and C. Magherini. Test Set for Initial Value</text>
<text top="706" left="474" width="332" height="15" font="0">Problem Solvers, release 2.4. Department of Mathe-</text>
<text top="724" left="474" width="275" height="15" font="0">matics, University of Bari, Italy, 2008. URL</text>
<text top="725" left="752" width="53" height="12" font="6"><a href="http://pitagora.dm.uniba.it/~testset">http://</a></text>
<text top="743" left="474" width="221" height="12" font="6"><a href="http://pitagora.dm.uniba.it/~testset">pitagora.dm.uniba.it/~testset</a></text>
<text top="742" left="695" width="108" height="15" font="0"><a href="http://pitagora.dm.uniba.it/~testset">. </a>Report 4/2008.</text>
<text top="772" left="459" width="346" height="15" font="0">L. R. Petzold. Automatic selection of methods for</text>
<text top="790" left="474" width="332" height="15" font="0">solving stiff and nonstiff systems of ordinary dif-</text>
<text top="808" left="474" width="332" height="15" font="0">ferential equations. SIAM J. Sci. Stat. Comput., 4:</text>
<text top="826" left="474" width="93" height="15" font="0">136–148, 1983.</text>
<text top="856" left="459" width="346" height="15" font="0">T. Petzoldt. R as a simulation platform in ecological</text>
<text top="874" left="474" width="232" height="15" font="0">modelling. R News, 3(3):8–16, 2003.</text>
<text top="904" left="459" width="346" height="15" font="0">W. H. Press, S. A. Teukolsky, W. T. Vetterling, and</text>
<text top="922" left="474" width="332" height="15" font="0">B. P. Flannery. Numerical Recipes: The Art of Scien-</text>
<text top="939" left="474" width="332" height="15" font="0">tific Computing. Cambridge University Press, 3rd</text>
<text top="957" left="474" width="88" height="15" font="0">edition, 2007.</text>
<text top="987" left="459" width="346" height="15" font="0">P. J. Prince and J. R. Dormand. High order embed-</text>
<text top="1005" left="474" width="332" height="15" font="0">ded Runge-Kutta formulae. J. Comput. Appl. Math.,</text>
<text top="1023" left="474" width="90" height="15" font="0">7:67–75, 1981.</text>
<text top="1053" left="459" width="346" height="15" font="0">R Development Core Team. R: A Language and Envi-</text>
<text top="1071" left="474" width="332" height="15" font="0">ronment for Statistical Computing. R Foundation for</text>
<text top="1089" left="474" width="332" height="15" font="0">Statistical Computing, Vienna, Austria, 2009. URL</text>
<text top="1109" left="474" width="184" height="12" font="6"><a href="http://www.R-project.org">http://www.R-project.org</a></text>
<text top="1107" left="657" width="141" height="15" font="0"><a href="http://www.R-project.org">. </a>ISBN 3-900051-07-0.</text>
<text top="1137" left="459" width="121" height="15" font="0">T. Radivoyevitch.</text>
<text top="1137" left="603" width="202" height="15" font="0">Equilibrium model selection:</text>
<text top="1155" left="474" width="332" height="15" font="0">dTTP induced R1 dimerization. BMC Systems Bi-</text>
<text top="1173" left="474" width="107" height="15" font="0">ology, 2:15, 2008.</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="10" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="82" width="15" height="15" font="0">14</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="82" width="346" height="15" font="0">H. H. Robertson. The solution of a set of reaction rate</text>
<text top="143" left="97" width="332" height="15" font="0">equations. In J. Walsh, editor, Numerical Analysis:</text>
<text top="161" left="97" width="332" height="15" font="0">An Introduction, pages 178–182. Academic Press,</text>
<text top="179" left="97" width="93" height="15" font="0">London, 1966.</text>
<text top="213" left="82" width="346" height="15" font="0">W. E. Schiesser. The Numerical Method of Lines: In-</text>
<text top="231" left="97" width="332" height="15" font="0">tegration of Partial Differential Equations. Academic</text>
<text top="249" left="97" width="150" height="15" font="0">Press, San Diego, 1991.</text>
<text top="282" left="82" width="346" height="15" font="0">R. W. Setzer. The <b>odesolve </b>Package: Solvers for Ordi-</text>
<text top="300" left="97" width="332" height="15" font="0">nary Differential Equations, 2001. R package version</text>
<text top="318" left="97" width="35" height="15" font="0">0.1-1.</text>
<text top="352" left="82" width="346" height="15" font="0">K. Soetaert. <b>rootSolve</b>: Nonlinear Root Finding, Equi-</text>
<text top="370" left="97" width="332" height="15" font="0">librium and Steady-State Analysis of Ordinary Differ-</text>
<text top="388" left="97" width="292" height="15" font="0">ential Equations, 2009. R package version 1.6.</text>
<text top="422" left="82" width="346" height="15" font="0">K. Soetaert and P. M. J. Herman. A Practical Guide</text>
<text top="440" left="97" width="332" height="15" font="0">to Ecological Modelling. Using R as a Simulation Plat-</text>
<text top="458" left="97" width="299" height="15" font="0">form. Springer, 2009. ISBN 978-1-4020-8623-6.</text>
<text top="492" left="82" width="201" height="15" font="0">K. Soetaert and F. Meysman.</text>
<text top="492" left="300" width="129" height="15" font="4"><b>ReacTran</b>: Reactive</text>
<text top="509" left="97" width="332" height="15" font="0">Transport Modelling in 1D, 2D and 3D, 2010. R pack-</text>
<text top="528" left="97" width="102" height="15" font="0">age version 1.2.</text>
<text top="561" left="82" width="346" height="15" font="0">K. Soetaert and T. Petzoldt. Inverse modelling, sensi-</text>
<text top="579" left="97" width="332" height="15" font="0">tivity and Monte Carlo analysis in R using package</text>
<text top="597" left="97" width="32" height="15" font="4"><b>FME</b></text>
<text top="597" left="130" width="299" height="15" font="0">. Journal of Statistical Software, 33(3):1–28, 2010.</text>
<text top="615" left="97" width="31" height="15" font="0">URL</text>
<text top="617" left="132" width="252" height="12" font="6"><a href="http://www.jstatsoft.org/v33/i03/">http://www.jstatsoft.org/v33/i03/</a></text>
<text top="615" left="383" width="4" height="15" font="0"><a href="http://www.jstatsoft.org/v33/i03/">.</a></text>
<text top="649" left="82" width="346" height="15" font="0">K. Soetaert, J. R. Cash, and F. Mazzia. <b>bvpSolve</b>:</text>
<text top="667" left="97" width="332" height="15" font="0">Solvers for Boundary Value Problems of Ordinary Dif-</text>
<text top="685" left="97" width="315" height="15" font="0">ferential Equations, 2010a. R package version 1.2.</text>
<text top="719" left="82" width="346" height="15" font="0">K. Soetaert, T. Petzoldt, and R. W. Setzer. Solving dif-</text>
<text top="737" left="97" width="332" height="15" font="0">ferential equations in R: Package <b>deSolve</b>. Journal</text>
<text top="755" left="97" width="332" height="15" font="0">of Statistical Software, 33(9):1–25, 2010b. ISSN 1548-</text>
<text top="773" left="97" width="70" height="15" font="0">7660. URL</text>
<text top="774" left="171" width="244" height="12" font="6"><a href="http://www.jstatsoft.org/v33/i09">http://www.jstatsoft.org/v33/i09</a></text>
<text top="773" left="415" width="4" height="15" font="0"><a href="http://www.jstatsoft.org/v33/i09">.</a></text>
<text top="806" left="82" width="346" height="15" font="0">K. Soetaert, T. Petzoldt, and R. W. Setzer. R Pack-</text>
<text top="824" left="97" width="332" height="15" font="0">age <b>deSolve</b>: Writing Code in Compiled Languages,</text>
<text top="842" left="97" width="317" height="15" font="0">2010c. <b>deSolve </b>vignette - R package version 1.8.</text>
<text top="876" left="82" width="346" height="15" font="0">K. Soetaert, T. Petzoldt, and R. W. Setzer. R Package</text>
<text top="894" left="97" width="328" height="15" font="4"><b>deSolve</b>: Solving Initial Value Differential Equations</text>
<text top="894" left="425" width="4" height="15" font="0">,</text>
<text top="912" left="97" width="320" height="15" font="0">2010d. <b>deSolve </b>vignette - R package version 1.8.</text>
<text top="946" left="82" width="346" height="15" font="0">M. H. H. Stevens. A Primer of Ecology with R. Use R</text>
<text top="964" left="97" width="311" height="15" font="0">Series. Springer, 2009. ISBN: 978-0-387-89881-0.</text>
<text top="998" left="82" width="346" height="15" font="0">G. Strang and G. Fix. An Analysis of The Finite Element</text>
<text top="1016" left="97" width="183" height="15" font="0">Method. Prentice Hall, 1973.</text>
<text top="1050" left="82" width="346" height="15" font="0">C. W. Tornøe, H. Agersø, E. N. Jonsson, H. Mad-</text>
<text top="1067" left="97" width="332" height="15" font="0">sen, and H. A. Nielsen. Non-linear mixed-effects</text>
<text top="1085" left="97" width="332" height="15" font="0">pharmacokinetic/pharmacodynamic modelling in</text>
<text top="1103" left="97" width="332" height="15" font="0">nlme using differential equations. Computer Meth-</text>
<text top="1121" left="97" width="306" height="15" font="0">ods and Programs in Biomedicine, 76:31–40, 2004.</text>
<text top="1155" left="82" width="346" height="15" font="0">B. van der Pol and J. van der Mark. Frequency de-</text>
<text top="1173" left="97" width="273" height="15" font="0">multiplication. Nature, 120:363–364, 1927.</text>
<text top="143" left="459" width="98" height="15" font="0">Karline Soetaert</text>
<text top="161" left="459" width="196" height="15" font="0">Netherlands Institute of Ecology</text>
<text top="180" left="459" width="175" height="12" font="6"><a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a></text>
<text top="215" left="459" width="101" height="15" font="0">Thomas Petzoldt</text>
<text top="233" left="459" width="192" height="15" font="0">Technische Universität Dresden</text>
<text top="252" left="459" width="221" height="12" font="6"><a href="mailto:Thomas.Petzoldt@tu-dresden.de">Thomas.Petzoldt@tu-dresden.de</a></text>
<text top="286" left="459" width="116" height="15" font="0">R. Woodrow Setzer</text>
<text top="304" left="459" width="230" height="15" font="0">US Environmental Protection Agency</text>
<text top="324" left="459" width="229" height="12" font="6"><a href="mailto:Setzer.Woodrow@epamail.epa.gov">Setzer.Woodrow@epamail.epa.gov</a></text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="11" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">15</text>
<text top="186" left="204" width="480" height="15" font="0">Table 2: Summary of the main functions that solve differential equations.</text>
<text top="210" left="101" width="59" height="15" font="0">Function</text>
<text top="210" left="227" width="54" height="15" font="0">Package</text>
<text top="210" left="353" width="77" height="15" font="0">Description</text>
<text top="237" left="101" width="23" height="12" font="0">ode</text>
<text top="237" left="227" width="53" height="12" font="0">deSolve</text>
<text top="236" left="353" width="357" height="15" font="0">IVP of ODEs, full, banded or arbitrary sparse Jacobian</text>
<text top="255" left="101" width="46" height="12" font="0">ode.1D</text>
<text top="255" left="227" width="53" height="12" font="0">deSolve</text>
<text top="253" left="353" width="399" height="15" font="0">IVP of ODEs resulting from 1-D reaction-transport problems</text>
<text top="273" left="101" width="46" height="12" font="0">ode.2D</text>
<text top="273" left="227" width="53" height="12" font="0">deSolve</text>
<text top="271" left="353" width="399" height="15" font="0">IVP of ODEs resulting from 2-D reaction-transport problems</text>
<text top="291" left="101" width="46" height="12" font="0">ode.3D</text>
<text top="291" left="227" width="53" height="12" font="0">deSolve</text>
<text top="289" left="353" width="399" height="15" font="0">IVP of ODEs resulting from 3-D reaction-transport problems</text>
<text top="309" left="101" width="38" height="12" font="0">daspk</text>
<text top="309" left="227" width="53" height="12" font="0">deSolve</text>
<text top="307" left="353" width="142" height="15" font="0">IVP of DAEs of index</text>
<text top="306" left="499" width="12" height="15" font="9">≤</text>
<text top="307" left="515" width="169" height="15" font="0">1, full or banded Jacobian</text>
<text top="327" left="101" width="38" height="12" font="0">radau</text>
<text top="327" left="227" width="53" height="12" font="0">deSolve</text>
<text top="325" left="353" width="142" height="15" font="0">IVP of DAEs of index</text>
<text top="324" left="499" width="12" height="15" font="9">≤</text>
<text top="325" left="515" width="169" height="15" font="0">3, full or banded Jacobian</text>
<text top="344" left="101" width="23" height="12" font="0">dde</text>
<text top="344" left="227" width="84" height="12" font="0">PBSddesolve</text>
<text top="343" left="353" width="434" height="15" font="0">IVP of delay differential equations, based on Runge-Kutta formu-</text>
<text top="361" left="353" width="19" height="15" font="0">lae</text>
<text top="380" left="101" width="30" height="12" font="0">dede</text>
<text top="380" left="227" width="53" height="12" font="0">deSolve</text>
<text top="379" left="353" width="434" height="15" font="0">IVP of delay differential equations, based on Adams and BDF for-</text>
<text top="397" left="353" width="41" height="15" font="0">mulae</text>
<text top="416" left="101" width="61" height="12" font="0">bvpshoot</text>
<text top="416" left="227" width="61" height="12" font="0">bvpSolve</text>
<text top="415" left="353" width="233" height="15" font="0">BVP of ODEs; the shooting method</text>
<text top="434" left="101" width="46" height="12" font="0">bvptwp</text>
<text top="434" left="227" width="61" height="12" font="0">bvpSolve</text>
<text top="433" left="353" width="336" height="15" font="0">BVP of ODEs; mono-implicit Runge-Kutta formula</text>
<text top="452" left="101" width="46" height="12" font="0">bvpcol</text>
<text top="452" left="227" width="61" height="12" font="0">bvpSolve</text>
<text top="451" left="353" width="224" height="15" font="0">BVP of ODEs; collocation formula</text>
<text top="470" left="101" width="46" height="12" font="0">steady</text>
<text top="470" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="469" left="353" width="411" height="15" font="0">steady-state of ODEs; full, banded or arbitrary sparse Jacobian</text>
<text top="488" left="101" width="69" height="12" font="0">steady.1D</text>
<text top="488" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="487" left="353" width="434" height="15" font="0">steady-state of ODEs resulting from 1-D reaction-transport prob-</text>
<text top="505" left="353" width="31" height="15" font="0">lems</text>
<text top="524" left="101" width="69" height="12" font="0">steady.2D</text>
<text top="524" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="522" left="353" width="434" height="15" font="0">steady-state of ODEs resulting from 2-D reaction-transport prob-</text>
<text top="540" left="353" width="31" height="15" font="0">lems</text>
<text top="560" left="101" width="69" height="12" font="0">steady.3D</text>
<text top="560" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="558" left="353" width="434" height="15" font="0">steady-state of ODEs resulting from 3-D reaction-transport prob-</text>
<text top="576" left="353" width="31" height="15" font="0">lems</text>
<text top="596" left="101" width="53" height="12" font="0">tran.1D</text>
<text top="596" left="227" width="61" height="12" font="0">ReacTran</text>
<text top="594" left="353" width="434" height="15" font="0">numerical approximation of 1-D advective-diffusive transport</text>
<text top="612" left="353" width="62" height="15" font="0">problems</text>
<text top="631" left="101" width="53" height="12" font="0">tran.2D</text>
<text top="631" left="227" width="61" height="12" font="0">ReacTran</text>
<text top="630" left="353" width="434" height="15" font="0">numerical approximation of 2-D advective-diffusive transport</text>
<text top="648" left="353" width="62" height="15" font="0">problems</text>
<text top="667" left="101" width="53" height="12" font="0">tran.3D</text>
<text top="667" left="227" width="61" height="12" font="0">ReacTran</text>
<text top="666" left="353" width="434" height="15" font="0">numerical approximation of 3-D advective-diffusive transport</text>
<text top="684" left="353" width="62" height="15" font="0">problems</text>
<text top="831" left="189" width="510" height="15" font="0">Table 3: Summary of the auxilliary functions that solve differential equations.</text>
<text top="855" left="101" width="59" height="15" font="0">Function</text>
<text top="855" left="227" width="54" height="15" font="0">Package</text>
<text top="855" left="353" width="77" height="15" font="0">Description</text>
<text top="882" left="101" width="38" height="12" font="0">lsoda</text>
<text top="882" left="227" width="53" height="12" font="0">deSolve</text>
<text top="881" left="353" width="434" height="15" font="0">IVP ODEs, full or banded Jacobian, automatic choice for stiff or</text>
<text top="899" left="353" width="111" height="15" font="0">non-stiff method</text>
<text top="918" left="101" width="46" height="12" font="0">lsodar</text>
<text top="918" left="227" width="53" height="12" font="0">deSolve</text>
<text top="916" left="353" width="353" height="15" font="0">same as lsoda, but includes a root-solving procedure.</text>
<text top="936" left="101" width="38" height="12" font="0">lsode</text>
<text top="934" left="139" width="38" height="15" font="0">, vode</text>
<text top="936" left="227" width="53" height="12" font="0">deSolve</text>
<text top="934" left="353" width="434" height="15" font="0">IVP ODEs, full or banded Jacobian, user specifies if stiff or non-</text>
<text top="952" left="353" width="25" height="15" font="0">stiff</text>
<text top="972" left="101" width="46" height="12" font="0">lsodes</text>
<text top="972" left="227" width="53" height="12" font="0">deSolve</text>
<text top="970" left="353" width="327" height="15" font="0">IVP ODEs, arbitrary sparse Jacobian, stiff method</text>
<text top="990" left="101" width="107" height="12" font="0">rk4, rk, euler</text>
<text top="990" left="227" width="53" height="12" font="0">deSolve</text>
<text top="988" left="353" width="330" height="15" font="0">IVP ODEs, using Runge-Kutta and Euler methods</text>
<text top="1007" left="101" width="38" height="12" font="0">zvode</text>
<text top="1007" left="227" width="53" height="12" font="0">deSolve</text>
<text top="1006" left="353" width="337" height="15" font="0">IVP ODEs, same as vode, but for complex variables</text>
<text top="1025" left="101" width="69" height="12" font="0">runsteady</text>
<text top="1025" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="1024" left="353" width="434" height="15" font="0">steady-state ODEs by dynamically running, full or banded Jaco-</text>
<text top="1042" left="353" width="29" height="15" font="0">bian</text>
<text top="1061" left="101" width="38" height="12" font="0">stode</text>
<text top="1061" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="1060" left="353" width="434" height="15" font="0">steady-state ODEs by Newton-Raphson method, full or banded</text>
<text top="1078" left="353" width="56" height="15" font="0">Jacobian</text>
<text top="1097" left="101" width="46" height="12" font="0">stodes</text>
<text top="1097" left="227" width="69" height="12" font="0">rootSolve</text>
<text top="1096" left="353" width="434" height="15" font="0">steady-state ODEs by Newton-Raphson method, arbitrary sparse</text>
<text top="1114" left="353" width="56" height="15" font="0">Jacobian</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 2/2, December 2010</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
</pdf2xml>
