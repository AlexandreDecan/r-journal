<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml producer="poppler" version="0.30.0">
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="12" family="Times" color="#000000"/>
	<fontspec id="1" size="9" family="Times" color="#000000"/>
	<fontspec id="2" size="35" family="Times" color="#000000"/>
	<fontspec id="3" size="12" family="Times" color="#000000"/>
	<fontspec id="4" size="19" family="Times" color="#000000"/>
	<fontspec id="5" size="12" family="Times" color="#00004c"/>
	<fontspec id="6" size="12" family="Times" color="#00004c"/>
<text top="67" left="82" width="15" height="15" font="0">48</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="121" left="82" width="547" height="36" font="2"><b>The crs Package: Nonparametric</b></text>
<text top="166" left="82" width="667" height="36" font="2"><b>Regression Splines for Continuous and</b></text>
<text top="211" left="82" width="373" height="36" font="2"><b>Categorical Predictors</b></text>
<text top="262" left="82" width="229" height="15" font="0">by Zhenghua Nie and Jeffrey S Racine</text>
<text top="297" left="96" width="57" height="15" font="3"><b>Abstract</b></text>
<text top="297" left="165" width="250" height="15" font="0">A new package <b>crs </b>is introduced for</text>
<text top="315" left="96" width="319" height="15" font="0">computing nonparametric regression (and quan-</text>
<text top="333" left="96" width="319" height="15" font="0">tile) splines in the presence of both continuous</text>
<text top="351" left="96" width="182" height="15" font="0">and categorical predictors.</text>
<text top="351" left="294" width="121" height="15" font="0">B-splines are em-</text>
<text top="369" left="96" width="319" height="15" font="0">ployed in the regression model for the contin-</text>
<text top="387" left="96" width="319" height="15" font="0">uous predictors and kernel weighting is em-</text>
<text top="405" left="96" width="319" height="15" font="0">ployed for the categorical predictors. We also de-</text>
<text top="423" left="96" width="319" height="15" font="0">velop a simple R interface to NOMAD, which is</text>
<text top="441" left="96" width="319" height="15" font="0">a mixed integer optimization solver used to com-</text>
<text top="459" left="96" width="268" height="15" font="0">pute optimal regression spline solutions.</text>
<text top="505" left="82" width="124" height="21" font="4"><b>Introduction</b></text>
<text top="545" left="82" width="346" height="15" font="0">Regression splines constitute a popular approach for</text>
<text top="563" left="82" width="346" height="15" font="0">the nonparametric estimation of regression functions</text>
<text top="580" left="82" width="346" height="15" font="0">though they are restricted to continuous predictors</text>
<text top="598" left="82" width="346" height="15" font="0">as are smoothing splines (see e.g. smooth.spline</text>
<text top="616" left="82" width="346" height="15" font="0">which is limited to one numeric predictor) and</text>
<text top="634" left="82" width="346" height="15" font="0">locally weighted scatterplot smoothing (see loess</text>
<text top="652" left="82" width="346" height="15" font="0">which is limited to four numeric predictors). How-</text>
<text top="670" left="82" width="346" height="15" font="0">ever, it is not uncommon to encounter relationships</text>
<text top="688" left="82" width="346" height="15" font="0">involving a mix of numeric and categorical predic-</text>
<text top="706" left="82" width="88" height="15" font="0">tors, and the</text>
<text top="706" left="177" width="19" height="15" font="5"><a href="http://cran.r-project.org/package=crs"><b>crs</b></a></text>
<text top="706" left="202" width="227" height="15" font="0">package implements a regression</text>
<text top="724" left="82" width="302" height="15" font="0">spline framework for accomplishing this task.</text>
<text top="742" left="105" width="324" height="15" font="0">The <b>crs </b>package implements the approaches de-</text>
<text top="760" left="82" width="65" height="15" font="0">scribed in</text>
<text top="760" left="151" width="57" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Ma et al.</a></text>
<text top="760" left="213" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="760" left="218" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2012</a></text>
<text top="760" left="247" width="34" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>and</text>
<text top="760" left="286" width="99" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Ma and Racine</a></text>
<text top="760" left="389" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="760" left="394" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2012</a></text>
<text top="760" left="424" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)</a></text>
<text top="778" left="82" width="346" height="15" font="0">when the option kernel=TRUE is selected (default)</text>
<text top="796" left="82" width="346" height="15" font="0">as described below. The categorical predictors can</text>
<text top="814" left="82" width="346" height="15" font="0">be handled in two ways, (i) using kernel weighting</text>
<text top="832" left="82" width="346" height="15" font="0">where the kernel functions are tailored to the dis-</text>
<text top="850" left="82" width="302" height="15" font="0">crete support of the categorical predictors <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="850" left="385" width="44" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Racine</a></text>
<text top="868" left="82" width="46" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">and Li</a></text>
<text top="868" left="128" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="868" left="139" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2004</a></text>
<text top="868" left="169" width="260" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">), </a>and (ii) using indicator basis func-</text>
<text top="886" left="82" width="346" height="15" font="0">tions. The fundamental difference between these two</text>
<text top="904" left="82" width="346" height="15" font="0">approaches is that the use of indicator basis func-</text>
<text top="922" left="82" width="346" height="15" font="0">tions consumes degrees of freedom via the number</text>
<text top="940" left="82" width="346" height="15" font="0">of columns in the basis matrix, while kernel weight-</text>
<text top="957" left="82" width="346" height="15" font="0">ing does not. As well, this package implements a</text>
<text top="975" left="82" width="346" height="15" font="0">range of related methods and provides options that</text>
<text top="993" left="82" width="346" height="15" font="0">we hope will make it appealing for applied projects,</text>
<text top="1011" left="82" width="275" height="15" font="0">research, and pedagogical purposes alike.</text>
<text top="1030" left="105" width="31" height="15" font="0">Both</text>
<text top="1030" left="151" width="103" height="15" font="0">semiparametric</text>
<text top="1030" left="270" width="55" height="15" font="0">additive</text>
<text top="1030" left="340" width="48" height="15" font="0">models</text>
<text top="1030" left="404" width="25" height="15" font="0">and</text>
<text top="1048" left="82" width="346" height="15" font="0">fully nonparametric models are implemented.</text>
<text top="1065" left="82" width="346" height="15" font="0">Data-driven methods can be used for selecting</text>
<text top="1083" left="82" width="346" height="15" font="0">the spline degree, number of segments/knots,</text>
<text top="1101" left="82" width="120" height="15" font="0">and bandwidths:</text>
<text top="1101" left="222" width="207" height="15" font="0">leave-one-out cross-validation</text>
<text top="1119" left="82" width="153" height="15" font="0">(cv.func = &#34;cv.ls&#34;) <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1119" left="235" width="37" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Stone</a></text>
<text top="1119" left="272" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1119" left="284" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1974</a></text>
<text top="1119" left="314" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1119" left="327" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1977</a></text>
<text top="1119" left="357" width="72" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">), </a>general-</text>
<text top="1137" left="82" width="298" height="15" font="0">ized cross-validation (cv.func=&#34;cv.gcv&#34;) <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1137" left="381" width="48" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Craven</a></text>
<text top="1155" left="82" width="76" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">and Wahba</a></text>
<text top="1155" left="158" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1155" left="167" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1979</a></text>
<text top="1155" left="197" width="232" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">), </a>and the information-based crite-</text>
<text top="1173" left="82" width="251" height="15" font="0">rion (cv.func=&#34;cv.aic&#34;) proposed by</text>
<text top="1173" left="337" width="92" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Hurvich et al.</a></text>
<text top="262" left="459" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="262" left="464" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1998</a></text>
<text top="262" left="494" width="312" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">). </a>Derivatives of arbitrary order can readily be</text>
<text top="280" left="459" width="346" height="15" font="0">constructed. One of the computational challenges</text>
<text top="298" left="459" width="346" height="15" font="0">encountered is to obtain the optimal spline degree</text>
<text top="316" left="459" width="346" height="15" font="0">(non-negative integer), number of segments/knots</text>
<text top="334" left="459" width="346" height="15" font="0">(positive integer), and bandwidth (bounded and</text>
<text top="352" left="459" width="346" height="15" font="0">real-valued) for each predictor. We overcome this</text>
<text top="370" left="459" width="346" height="15" font="0">challenge by providing an interface to NOMAD</text>
<text top="388" left="459" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="388" left="464" width="105" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Abramson et al.</a></text>
<text top="388" left="569" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="388" left="576" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="388" left="606" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">;</a></text>
<text top="388" left="613" width="71" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Le Digabel</a></text>
<text top="388" left="685" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="388" left="692" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="388" left="722" width="9" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">).</a></text>
<text top="406" left="481" width="42" height="15" font="0">Before</text>
<text top="406" left="539" width="74" height="15" font="0">proceeding</text>
<text top="406" left="628" width="20" height="15" font="0">we</text>
<text top="406" left="663" width="43" height="15" font="0">briefly</text>
<text top="406" left="722" width="52" height="15" font="0">provide</text>
<text top="406" left="789" width="16" height="15" font="0">an</text>
<text top="424" left="459" width="346" height="15" font="0">overview of some important implementation details:</text>
<text top="457" left="478" width="328" height="15" font="0">1. The degree of the spline and number of seg-</text>
<text top="475" left="496" width="309" height="15" font="0">ments (i.e. knots minus one) for each contin-</text>
<text top="493" left="496" width="309" height="15" font="0">uous predictor can be set manually as can the</text>
<text top="511" left="496" width="309" height="15" font="0">bandwidths for each categorical predictor (if</text>
<text top="529" left="496" width="87" height="15" font="0">appropriate).</text>
<text top="559" left="478" width="328" height="15" font="0">2. Alternatively, any of the data-driven criteria</text>
<text top="577" left="496" width="309" height="15" font="0">(i.e. cv.func=&#34;...&#34;) could be used to select ei-</text>
<text top="595" left="496" width="309" height="15" font="0">ther the degree of the spline (holding the num-</text>
<text top="613" left="496" width="309" height="15" font="0">ber of segments/knots fixed at any user-set</text>
<text top="631" left="496" width="309" height="15" font="0">value) and bandwidths for the categorical pre-</text>
<text top="649" left="496" width="309" height="15" font="0">dictors (if appropriate), or the number of seg-</text>
<text top="667" left="496" width="309" height="15" font="0">ments (holding the degree of the spline fixed at</text>
<text top="685" left="496" width="309" height="15" font="0">any user-set value) and bandwidths for the cat-</text>
<text top="703" left="496" width="309" height="15" font="0">egorical predictors (if appropriate), or the num-</text>
<text top="721" left="496" width="309" height="15" font="0">ber of segments and the degree of the spline for</text>
<text top="739" left="496" width="309" height="15" font="0">each continuous predictor and bandwidths for</text>
<text top="756" left="496" width="278" height="15" font="0">each categorical predictor (if appropriate).</text>
<text top="787" left="478" width="328" height="15" font="0">3. When indicator basis functions are used in-</text>
<text top="805" left="496" width="309" height="15" font="0">stead of kernel smoothing, whether to in-</text>
<text top="823" left="496" width="309" height="15" font="0">clude each categorical predictor or not can be</text>
<text top="841" left="496" width="309" height="15" font="0">specified manually or chosen via any cv.func</text>
<text top="858" left="496" width="55" height="15" font="0">method.</text>
<text top="889" left="478" width="328" height="15" font="0">4. We allow the degree of the spline for each con-</text>
<text top="907" left="496" width="309" height="15" font="0">tinuous predictor to include zero, the inclu-</text>
<text top="925" left="496" width="309" height="15" font="0">sion indicator for each categorical predictor to</text>
<text top="943" left="496" width="309" height="15" font="0">equal zero, and the bandwidth for each cate-</text>
<text top="960" left="496" width="309" height="15" font="0">gorical predictor to equal one, and when the</text>
<text top="978" left="496" width="309" height="15" font="0">degree/inclusion indicator is zero or the band-</text>
<text top="996" left="496" width="309" height="15" font="0">width is one, the variable is thereby removed</text>
<text top="1014" left="496" width="309" height="15" font="0">from the regression: in this manner, irrele-</text>
<text top="1032" left="496" width="309" height="15" font="0">vant predictors can be automatically removed</text>
<text top="1050" left="496" width="309" height="15" font="0">by any cv.func method negating the need for</text>
<text top="1068" left="496" width="277" height="15" font="0">pre-testing (mirroring findings detailed in</text>
<text top="1068" left="777" width="29" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Hall</a></text>
<text top="1086" left="496" width="31" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">et al.</a></text>
<text top="1086" left="531" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1086" left="536" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2004</a></text>
<text top="1086" left="566" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1086" left="574" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2007</a></text>
<text top="1086" left="603" width="153" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>for kernel regression).</text>
<text top="1119" left="481" width="324" height="15" font="0">The design philosophy underlying the <b>crs </b>pack-</text>
<text top="1137" left="459" width="346" height="15" font="0">age aims to closely mimic the behaviour of the lm</text>
<text top="1155" left="459" width="346" height="15" font="0">function. Indeed, the implementation relies on lm</text>
<text top="1173" left="459" width="346" height="15" font="0">and its supporting functions for computation of the</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="7" size="15" family="Times" color="#000000"/>
	<fontspec id="8" size="12" family="Times" color="#000000"/>
	<fontspec id="9" size="13" family="Times" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">49</text>
<text top="125" left="82" width="346" height="15" font="0">spline coefficients, delete-one residuals, fitted values,</text>
<text top="143" left="82" width="346" height="15" font="0">prediction and the like. 95% confidence bounds for</text>
<text top="161" left="82" width="346" height="15" font="0">the fit and derivatives are constructed from asymp-</text>
<text top="179" left="82" width="346" height="15" font="0">totic formulae and automatically generated. Below</text>
<text top="197" left="82" width="346" height="15" font="0">we describe in more detail the specifics of the im-</text>
<text top="215" left="82" width="346" height="15" font="0">plementation for the interested reader. Others may</text>
<text top="233" left="82" width="346" height="15" font="0">wish to jump to the illustrative example that appears</text>
<text top="251" left="82" width="346" height="15" font="0">towards the end of this article or simply install and</text>
<text top="268" left="82" width="267" height="15" font="0">load the package and run example(crs).</text>
<text top="309" left="82" width="346" height="17" font="7"><b>Differences between existing spline meth-</b></text>
<text top="330" left="82" width="263" height="17" font="7"><b>ods and those in the crs package</b></text>
<text top="361" left="82" width="346" height="15" font="0">Readers familiar with existing R-functions and pack-</text>
<text top="379" left="82" width="346" height="15" font="0">ages for spline modelling will naturally be wonder-</text>
<text top="396" left="82" width="346" height="15" font="0">ing what the difference is between the <b>crs </b>package</text>
<text top="414" left="82" width="297" height="15" font="0">and existing spline-based procedures such as</text>
<text top="442" left="103" width="179" height="15" font="0">• smooth.spline in R base</text>
<text top="470" left="103" width="81" height="15" font="0">• spm in the</text>
<text top="470" left="188" width="57" height="15" font="5"><a href="http://cran.r-project.org/package=SemiPar"><b>SemiPar</b></a></text>
<text top="470" left="249" width="63" height="15" font="0">package <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="470" left="312" width="39" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Wand</a></text>
<text top="470" left="351" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="470" left="358" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2010</a></text>
<text top="470" left="388" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)</a></text>
<text top="498" left="103" width="81" height="15" font="0">• gam in the</text>
<text top="498" left="188" width="37" height="15" font="5"><a href="http://cran.r-project.org/package=mgcv"><b>mgcv</b></a></text>
<text top="498" left="228" width="63" height="15" font="0">package <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="498" left="291" width="39" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Wood</a></text>
<text top="498" left="330" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="498" left="338" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2006</a></text>
<text top="498" left="367" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)</a></text>
<text top="526" left="103" width="111" height="15" font="0">• ssanova in the</text>
<text top="526" left="218" width="22" height="15" font="5"><a href="http://cran.r-project.org/package=gss"><b>gss</b></a></text>
<text top="526" left="243" width="63" height="15" font="0">package <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="526" left="307" width="20" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Gu</a></text>
<text top="526" left="327" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="526" left="334" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2012</a></text>
<text top="526" left="364" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)</a></text>
<text top="554" left="103" width="81" height="15" font="0">• gam in the</text>
<text top="554" left="188" width="29" height="15" font="5"><a href="http://cran.r-project.org/package=gam"><b>gam</b></a></text>
<text top="554" left="220" width="63" height="15" font="0">package <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="554" left="284" width="43" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Hastie</a></text>
<text top="554" left="326" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="554" left="334" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="554" left="364" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)</a></text>
<text top="581" left="105" width="324" height="15" font="0">First we note that the functions smooth.spline</text>
<text top="599" left="82" width="346" height="15" font="0">and ssanova are based on smoothing spline method-</text>
<text top="617" left="82" width="346" height="15" font="0">ology, while spm uses penalized splines but gam in the</text>
<text top="635" left="82" width="29" height="15" font="3"><b>gam</b></text>
<text top="635" left="112" width="317" height="15" font="0">/<b>mgcv </b>packages allows for smoothing splines,</text>
<text top="653" left="82" width="346" height="15" font="0">penalized splines, and regression splines. The <b>crs</b></text>
<text top="671" left="82" width="346" height="15" font="0">package is restricted to ‘regression splines’ which</text>
<text top="689" left="82" width="346" height="15" font="0">differs in a number of ways from ‘smoothing splines’</text>
<text top="707" left="82" width="346" height="15" font="0">and ‘penalized splines’, the fundamental difference</text>
<text top="725" left="82" width="346" height="15" font="0">being that smoothing/penalized splines use the data</text>
<text top="743" left="82" width="346" height="15" font="0">points themselves as potential knots and penalize</text>
<text top="761" left="82" width="346" height="15" font="0">‘roughness’ (typically the second derivative of the</text>
<text top="779" left="82" width="346" height="15" font="0">estimate) while regression splines place knots at</text>
<text top="796" left="82" width="346" height="15" font="0">equidistant/equiquantile points and do not explic-</text>
<text top="814" left="82" width="346" height="15" font="0">itly penalize roughness, rather, they rely on vari-</text>
<text top="832" left="82" width="346" height="15" font="0">ous cross-validatory approaches for model selection.</text>
<text top="850" left="82" width="226" height="15" font="0">We direct the interested reader to</text>
<text top="850" left="314" width="45" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Wahba</a></text>
<text top="850" left="365" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="850" left="370" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1990</a></text>
<text top="850" left="400" width="29" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>for</text>
<text top="868" left="82" width="346" height="15" font="0">a treatment of smoothing splines. The <b>crs </b>package</text>
<text top="886" left="82" width="346" height="15" font="0">is one of the few packages devoted to regression</text>
<text top="904" left="82" width="346" height="15" font="0">spline techniques. We also provide quantile regres-</text>
<text top="922" left="82" width="232" height="15" font="0">sion splines via the option tau=<i>τ </i>(<i>τ</i></text>
<text top="921" left="319" width="20" height="15" font="9">∈ (</text>
<text top="922" left="339" width="20" height="15" font="0">0, 1</text>
<text top="922" left="360" width="6" height="14" font="9">)</text>
<text top="922" left="366" width="9" height="15" font="0">).</text>
<text top="940" left="105" width="324" height="15" font="0">Second, many of the aforementioned smoothing</text>
<text top="958" left="82" width="346" height="15" font="0">spline implementations are semiparametric in na-</text>
<text top="976" left="82" width="346" height="15" font="0">ture, the semiparametric additive model being par-</text>
<text top="994" left="82" width="119" height="15" font="0">ticularly popular.</text>
<text top="994" left="221" width="208" height="15" font="0">Though semiparametric mod-</text>
<text top="1012" left="82" width="346" height="15" font="0">els exist to circumvent the curse of dimensionality,</text>
<text top="1030" left="82" width="215" height="15" font="0">it does not come without cost.</text>
<text top="1030" left="313" width="116" height="15" font="0">That is, the bur-</text>
<text top="1048" left="82" width="346" height="15" font="0">den of determining whether semiparametric or non-</text>
<text top="1065" left="82" width="346" height="15" font="0">parametric approaches would be warranted in any</text>
<text top="1083" left="82" width="346" height="15" font="0">given situation is placed squarely on the researcher’s</text>
<text top="1101" left="82" width="346" height="15" font="0">shoulder. Unlike many existing spline methods in</text>
<text top="1119" left="82" width="346" height="15" font="0">R, the implementation in the <b>crs </b>package is de-</text>
<text top="1137" left="82" width="346" height="15" font="0">signed so that every parameter that must be cho-</text>
<text top="1155" left="82" width="346" height="15" font="0">sen by the researcher can be data-driven (via cross-</text>
<text top="1173" left="82" width="346" height="15" font="0">validation) so that such choices adapt to the data</text>
<text top="125" left="459" width="346" height="15" font="0">at hand including whether to use a semiparamet-</text>
<text top="143" left="459" width="346" height="15" font="0">ric or nonparametric model. This is accomplished</text>
<text top="161" left="459" width="346" height="15" font="0">using options such as basis=&#34;auto&#34;, knots=&#34;auto&#34;,</text>
<text top="179" left="459" width="346" height="15" font="0">and complexity=&#34;degree-knots&#34; (basis=&#34;auto&#34; de-</text>
<text top="197" left="459" width="346" height="15" font="0">ciding whether to use an additive basis or tensor</text>
<text top="215" left="459" width="346" height="15" font="0">product basis in multivariate settings, knots=&#34;auto&#34;</text>
<text top="233" left="459" width="346" height="15" font="0">whether to use equispaced knots or quantile knots,</text>
<text top="251" left="459" width="346" height="15" font="0">and complexity=&#34;degree-knots&#34; determining both</text>
<text top="268" left="459" width="270" height="15" font="0">the spline degrees and number of knots).</text>
<text top="286" left="481" width="324" height="15" font="0">Generally speaking, almost all of these exist-</text>
<text top="304" left="459" width="346" height="15" font="0">ing smoothing spline approaches can handle mixed</text>
<text top="322" left="459" width="346" height="15" font="0">datatypes though their approaches to the treatment</text>
<text top="340" left="459" width="346" height="15" font="0">of categorical variables often differ (none use cate-</text>
<text top="358" left="459" width="313" height="15" font="0">gorical kernel smoothing as in the <b>crs </b>package).</text>
<text top="399" left="459" width="184" height="17" font="7"><b>The underlying model</b></text>
<text top="429" left="459" width="346" height="15" font="0">Regression spline methods can be limited in their po-</text>
<text top="447" left="459" width="346" height="15" font="0">tential applicability as they are based on continuous</text>
<text top="465" left="459" width="346" height="15" font="0">predictors. However, in applied settings we often</text>
<text top="483" left="459" width="346" height="15" font="0">encounter categorical predictors such as strength of</text>
<text top="501" left="459" width="346" height="15" font="0">preference (“strongly prefer”, “weakly prefer”, “in-</text>
<text top="519" left="459" width="156" height="15" font="0">different”) and so forth.</text>
<text top="537" left="481" width="324" height="15" font="0">We wish to model the unknown conditional mean</text>
<text top="555" left="459" width="248" height="15" font="0">in the following location-scale model,</text>
<text top="583" left="553" width="10" height="15" font="0">Y</text>
<text top="583" left="567" width="12" height="14" font="9">=</text>
<text top="583" left="583" width="7" height="15" font="0">g</text>
<text top="583" left="593" width="6" height="14" font="9">(</text>
<text top="583" left="599" width="10" height="15" font="3"><b>X</b></text>
<text top="583" left="609" width="16" height="15" font="0">, <b>Z</b></text>
<text top="583" left="625" width="21" height="14" font="9">) +</text>
<text top="586" left="650" width="8" height="11" font="8"><i>σ</i></text>
<text top="583" left="661" width="6" height="14" font="9">(</text>
<text top="583" left="667" width="10" height="15" font="3"><b>X</b></text>
<text top="583" left="677" width="16" height="15" font="0">, <b>Z</b></text>
<text top="583" left="693" width="6" height="14" font="9">)</text>
<text top="586" left="701" width="6" height="11" font="8"><i>ε</i></text>
<text top="583" left="707" width="4" height="15" font="0">,</text>
<text top="614" left="459" width="52" height="15" font="0">where g</text>
<text top="614" left="511" width="17" height="14" font="9">(·)</text>
<text top="614" left="531" width="172" height="15" font="0">is an unknown function, <b>X</b></text>
<text top="614" left="707" width="12" height="14" font="9">=</text>
<text top="614" left="728" width="11" height="15" font="0">X</text>
<text top="620" left="739" width="6" height="11" font="1">1</text>
<text top="614" left="746" width="39" height="15" font="0">, . . . , X</text>
<text top="619" left="785" width="5" height="11" font="1">q</text>
<text top="612" left="791" width="7" height="7" font="0"></text>
<text top="609" left="798" width="7" height="11" font="1">T</text>
<text top="632" left="459" width="346" height="15" font="0">is a q-dimensional vector of continuous predictors,</text>
<text top="653" left="459" width="10" height="15" font="3"><b>Z</b></text>
<text top="653" left="474" width="23" height="14" font="9">= (</text>
<text top="653" left="498" width="10" height="15" font="0">Z</text>
<text top="658" left="507" width="6" height="11" font="1">1</text>
<text top="653" left="514" width="38" height="15" font="0">, . . . , Z</text>
<text top="658" left="552" width="4" height="11" font="1">r</text>
<text top="653" left="558" width="6" height="14" font="9">)</text>
<text top="648" left="564" width="7" height="11" font="1">T</text>
<text top="653" left="578" width="228" height="15" font="0">is an r-dimensional vector of cat-</text>
<text top="671" left="459" width="175" height="15" font="0">egorical predictors, and <i>σ</i></text>
<text top="668" left="634" width="6" height="11" font="1">2</text>
<text top="671" left="643" width="6" height="14" font="9">(</text>
<text top="671" left="649" width="10" height="15" font="3"><b>X</b></text>
<text top="671" left="659" width="16" height="15" font="0">, <b>Z</b></text>
<text top="671" left="675" width="6" height="14" font="9">)</text>
<text top="671" left="687" width="118" height="15" font="0">is the conditional</text>
<text top="689" left="459" width="275" height="15" font="0">variance of Y given <b>X </b>and <b>Z</b>. Letting <b>z</b></text>
<text top="689" left="739" width="23" height="14" font="9">= (</text>
<text top="689" left="762" width="7" height="15" font="0">z</text>
<text top="694" left="769" width="4" height="11" font="1">s</text>
<text top="689" left="775" width="6" height="14" font="9">)</text>
<text top="684" left="781" width="4" height="11" font="1">r</text>
<text top="696" left="781" width="20" height="11" font="1">s=1</text>
<text top="689" left="802" width="4" height="15" font="0">,</text>
<text top="707" left="459" width="132" height="15" font="0">we assume that z</text>
<text top="712" left="591" width="4" height="11" font="1">s</text>
<text top="707" left="607" width="50" height="15" font="0">takes c</text>
<text top="712" left="657" width="4" height="11" font="1">s</text>
<text top="707" left="673" width="133" height="15" font="0">different values in</text>
<text top="725" left="459" width="12" height="15" font="0">D</text>
<text top="729" left="471" width="4" height="11" font="1">s</text>
<text top="724" left="481" width="25" height="15" font="9">≡ {</text>
<text top="725" left="506" width="55" height="15" font="0">0, 1, . . . , c</text>
<text top="729" left="561" width="4" height="11" font="1">s</text>
<text top="724" left="570" width="12" height="15" font="9">−</text>
<text top="725" left="585" width="7" height="15" font="0">1</text>
<text top="724" left="593" width="8" height="15" font="9">}</text>
<text top="725" left="601" width="16" height="15" font="0">, s</text>
<text top="725" left="622" width="12" height="14" font="9">=</text>
<text top="725" left="639" width="90" height="15" font="0">1, . . . , r, and c</text>
<text top="729" left="729" width="4" height="11" font="1">s</text>
<text top="725" left="741" width="65" height="15" font="0">is a finite</text>
<text top="743" left="459" width="116" height="15" font="0">positive constant.</text>
<text top="761" left="481" width="324" height="15" font="0">For the continuous predictors the regression</text>
<text top="779" left="459" width="346" height="15" font="0">spline model employs the B-spline routines in the</text>
<text top="796" left="459" width="170" height="15" font="0">GNU Scientific Library <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="796" left="629" width="89" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Galassi et al.</a></text>
<text top="796" left="717" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="796" left="728" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2009</a></text>
<text top="796" left="758" width="48" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">). </a>The</text>
<text top="814" left="459" width="346" height="15" font="0">B-spline function is the maximally differentiable in-</text>
<text top="832" left="459" width="346" height="15" font="0">terpolative basis function (B-spline stands for ‘basis-</text>
<text top="850" left="459" width="53" height="15" font="0">spline’).</text>
<text top="868" left="481" width="324" height="15" font="0">Heuristically, we conduct linear (in parameter)</text>
<text top="886" left="459" width="346" height="15" font="0">regression using the R function lm, however, we re-</text>
<text top="904" left="459" width="346" height="15" font="0">place the continuous predictors with B-splines of po-</text>
<text top="922" left="459" width="346" height="15" font="0">tentially differing order and number of segments</text>
<text top="940" left="459" width="346" height="15" font="0">for each continuous predictor. For the tensor prod-</text>
<text top="958" left="459" width="346" height="15" font="0">uct bases we set intercept=TRUE for each univariate</text>
<text top="976" left="459" width="346" height="15" font="0">spline basis, while for the additive spline bases we</text>
<text top="994" left="459" width="346" height="15" font="0">adopt the intercept=FALSE variants and include an</text>
<text top="1012" left="459" width="346" height="15" font="0">intercept term in the model (the B-splines will there-</text>
<text top="1030" left="459" width="346" height="15" font="0">fore not sum to one, i.e. an order m B-spline with one</text>
<text top="1048" left="459" width="262" height="15" font="0">segment (two knots/breakpoints) has m</text>
<text top="1047" left="724" width="12" height="14" font="9">+</text>
<text top="1048" left="738" width="67" height="15" font="0">1 columns</text>
<text top="1065" left="459" width="346" height="15" font="0">and we drop the first as is often done, though see</text>
<text top="1083" left="459" width="111" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Zhou and Wolfe</a></text>
<text top="1083" left="575" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1083" left="580" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2000</a></text>
<text top="1083" left="610" width="195" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>for an alternative approach</text>
<text top="1101" left="459" width="346" height="15" font="0">based upon shrinkage methods). This allows multi-</text>
<text top="1119" left="459" width="346" height="15" font="0">ple bases to coexist when there is more than one con-</text>
<text top="1137" left="459" width="346" height="15" font="0">tinuous predictor. The tensor product basis is given</text>
<text top="1155" left="459" width="17" height="15" font="0">by</text>
<text top="1173" left="570" width="9" height="15" font="0">B</text>
<text top="1178" left="579" width="6" height="11" font="1">1</text>
<text top="1172" left="589" width="12" height="15" font="9">⊗</text>
<text top="1173" left="604" width="9" height="15" font="0">B</text>
<text top="1178" left="613" width="6" height="11" font="1">2</text>
<text top="1172" left="623" width="48" height="15" font="9">⊗ · · · ⊗</text>
<text top="1173" left="674" width="9" height="15" font="0">B</text>
<text top="1178" left="684" width="6" height="11" font="1">p</text>
<text top="1173" left="691" width="4" height="15" font="0">,</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="10" size="9" family="Times" color="#000000"/>
	<fontspec id="11" size="9" family="Times" color="#000000"/>
	<fontspec id="12" size="6" family="Times" color="#000000"/>
	<fontspec id="13" size="6" family="Times" color="#000000"/>
	<fontspec id="14" size="18" family="Times" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">50</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="82" width="41" height="15" font="0">where</text>
<text top="124" left="129" width="12" height="15" font="9">⊗</text>
<text top="125" left="147" width="282" height="15" font="0">is the Kronecker product where the prod-</text>
<text top="143" left="82" width="216" height="15" font="0">ucts operate column-wise and B</text>
<text top="148" left="298" width="3" height="11" font="1">j</text>
<text top="143" left="307" width="122" height="15" font="0">is the basis matrix</text>
<text top="161" left="82" width="346" height="15" font="0">for predictor j as outlined above. We also support</text>
<text top="179" left="82" width="346" height="15" font="0">a ‘generalized’ polynomial B-spline basis that con-</text>
<text top="197" left="82" width="346" height="15" font="0">sists of a varying-order polynomial with appropriate</text>
<text top="215" left="82" width="346" height="15" font="0">interactions. When additive B-spline bases are em-</text>
<text top="233" left="82" width="346" height="15" font="0">ployed we have a semiparametric ‘additive’ spline</text>
<text top="251" left="82" width="346" height="15" font="0">model (no interaction among variables unless explic-</text>
<text top="268" left="82" width="346" height="15" font="0">itly specified). When the tensor product or general-</text>
<text top="286" left="82" width="346" height="15" font="0">ized polynomial is employed we have a fully non-</text>
<text top="304" left="82" width="346" height="15" font="0">parametric model (interaction among all variables).</text>
<text top="322" left="82" width="346" height="15" font="0">Whether to use the additive, tensor product, or gen-</text>
<text top="340" left="82" width="346" height="15" font="0">eralized polynomial bases can be pre-specified or au-</text>
<text top="358" left="82" width="346" height="15" font="0">tomatically determined via any cv.func method (see</text>
<text top="376" left="82" width="206" height="15" font="0">the options for basis= in ?crs).</text>
<text top="394" left="105" width="324" height="15" font="0">We offer the default option to use categorical</text>
<text top="412" left="82" width="346" height="15" font="0">kernel weighting (lm(...,weights=L)) to handle the</text>
<text top="430" left="82" width="346" height="15" font="0">presence of categorical predictors (see below for a de-</text>
<text top="448" left="82" width="346" height="15" font="0">scription of L). We also offer the option of using indi-</text>
<text top="466" left="82" width="332" height="15" font="0">cator basis functions for the categorical predictors.</text>
<text top="507" left="82" width="346" height="17" font="7"><b>Weighted least-squares estimation of the</b></text>
<text top="528" left="82" width="148" height="17" font="7"><b>underlying model</b></text>
<text top="558" left="82" width="163" height="15" font="0">The unknown function g</text>
<text top="558" left="248" width="6" height="14" font="9">(</text>
<text top="558" left="254" width="10" height="15" font="3"><b>X</b></text>
<text top="558" left="264" width="16" height="15" font="0">, <b>Z</b></text>
<text top="558" left="280" width="6" height="14" font="9">)</text>
<text top="558" left="290" width="139" height="15" font="0">can be approximated</text>
<text top="579" left="82" width="17" height="15" font="0">by</text>
<text top="578" left="103" width="19" height="15" font="9">B (</text>
<text top="579" left="122" width="10" height="15" font="3"><b>X</b></text>
<text top="579" left="132" width="6" height="14" font="9">)</text>
<text top="574" left="138" width="7" height="11" font="1">T</text>
<text top="582" left="148" width="8" height="11" font="8"><i>β</i></text>
<text top="579" left="158" width="6" height="14" font="9">(</text>
<text top="579" left="165" width="10" height="15" font="3"><b>Z</b></text>
<text top="579" left="175" width="6" height="14" font="9">)</text>
<text top="579" left="181" width="60" height="15" font="0">, where <i>β</i></text>
<text top="579" left="243" width="6" height="14" font="9">(</text>
<text top="579" left="250" width="10" height="15" font="3"><b>Z</b></text>
<text top="579" left="260" width="6" height="14" font="9">)</text>
<text top="579" left="270" width="159" height="15" font="0">is a vector of coefficients</text>
<text top="597" left="82" width="25" height="15" font="0">and</text>
<text top="596" left="112" width="19" height="15" font="9">B (</text>
<text top="597" left="131" width="10" height="15" font="3"><b>X</b></text>
<text top="597" left="141" width="6" height="14" font="9">)</text>
<text top="597" left="151" width="277" height="15" font="0">the B-spline basis matrix described above.</text>
<text top="615" left="105" width="98" height="15" font="0">We estimate <i>β</i></text>
<text top="615" left="205" width="6" height="14" font="9">(</text>
<text top="615" left="211" width="7" height="15" font="3"><b>z</b></text>
<text top="615" left="219" width="6" height="14" font="9">)</text>
<text top="615" left="232" width="197" height="15" font="0">by minimizing the following</text>
<text top="633" left="82" width="214" height="15" font="0">weighted least squares criterion,</text>
<text top="678" left="88" width="8" height="7" font="0">b</text>
<text top="676" left="87" width="8" height="11" font="8"><i>β</i></text>
<text top="672" left="97" width="6" height="14" font="9">(</text>
<text top="672" left="104" width="7" height="15" font="3"><b>z</b></text>
<text top="672" left="112" width="22" height="14" font="9">) =</text>
<text top="672" left="141" width="46" height="15" font="0">argmin</text>
<text top="693" left="137" width="30" height="9" font="10"><i>β</i>(<b>z</b>)∈</text>
<text top="688" left="168" width="9" height="15" font="11"><b>R</b></text>
<text top="689" left="177" width="12" height="10" font="12"><b>K</b>n</text>
<text top="658" left="199" width="6" height="11" font="1">n</text>
<text top="666" left="194" width="16" height="27" font="14">∑</text>
<text top="691" left="192" width="19" height="11" font="1">i=1</text>
<text top="666" left="213" width="10" height="7" font="0">n</text>
<text top="672" left="223" width="10" height="15" font="0">Y</text>
<text top="677" left="232" width="3" height="11" font="1">i</text>
<text top="671" left="239" width="34" height="15" font="9">− B (</text>
<text top="672" left="273" width="10" height="15" font="3"><b>X</b></text>
<text top="677" left="284" width="3" height="11" font="1">i</text>
<text top="672" left="288" width="6" height="14" font="9">)</text>
<text top="667" left="294" width="7" height="11" font="1">T</text>
<text top="676" left="304" width="8" height="11" font="8"><i>β</i></text>
<text top="672" left="314" width="6" height="14" font="9">(</text>
<text top="672" left="321" width="7" height="15" font="3"><b>z</b></text>
<text top="672" left="329" width="6" height="14" font="9">)</text>
<text top="666" left="335" width="10" height="7" font="0">o</text>
<text top="662" left="345" width="6" height="11" font="1">2</text>
<text top="672" left="354" width="8" height="15" font="0">L</text>
<text top="672" left="364" width="6" height="14" font="9">(</text>
<text top="672" left="371" width="10" height="15" font="3"><b>Z</b></text>
<text top="677" left="381" width="3" height="11" font="1">i</text>
<text top="672" left="385" width="28" height="15" font="0">, <b>z</b>, <i>λ</i></text>
<text top="672" left="413" width="6" height="14" font="9">)</text>
<text top="672" left="421" width="4" height="15" font="0">.</text>
<text top="727" left="82" width="156" height="17" font="7"><b>Placement of knots</b></text>
<text top="758" left="82" width="346" height="15" font="0">The user can determine where knots are to be placed</text>
<text top="776" left="82" width="176" height="15" font="0">using one of two methods:</text>
<text top="804" left="101" width="328" height="15" font="0">1. knots can be placed at equally spaced quantiles</text>
<text top="822" left="120" width="309" height="15" font="0">whereby an equal number of observations lie</text>
<text top="840" left="120" width="226" height="15" font="0">in each segment (‘quantile knots’).</text>
<text top="868" left="101" width="328" height="15" font="0">2. knots can be placed at equally spaced intervals</text>
<text top="886" left="120" width="116" height="15" font="0">(‘uniform knots’).</text>
<text top="915" left="82" width="346" height="15" font="0">If preferred, this can be determined automatically us-</text>
<text top="933" left="82" width="192" height="15" font="0">ing the option knots=&#34;auto&#34;.</text>
<text top="973" left="82" width="144" height="17" font="7"><b>Kernel weighting</b></text>
<text top="1004" left="82" width="42" height="15" font="0">Let Z</text>
<text top="1009" left="124" width="3" height="11" font="1">i</text>
<text top="1004" left="139" width="290" height="15" font="0">be an r-dimensional vector of categori-</text>
<text top="1022" left="82" width="220" height="15" font="0">cal/discrete predictors. We use z</text>
<text top="1027" left="302" width="4" height="11" font="1">s</text>
<text top="1022" left="312" width="117" height="15" font="0">to denote the s-th</text>
<text top="1040" left="82" width="226" height="15" font="0">component of z, we assume that z</text>
<text top="1045" left="308" width="4" height="11" font="1">s</text>
<text top="1040" left="318" width="45" height="15" font="0">takes c</text>
<text top="1045" left="363" width="4" height="11" font="1">s</text>
<text top="1040" left="372" width="57" height="15" font="0">different</text>
<text top="1058" left="82" width="79" height="15" font="0">values in D</text>
<text top="1062" left="162" width="4" height="11" font="1">s</text>
<text top="1057" left="172" width="25" height="15" font="9">≡ {</text>
<text top="1058" left="197" width="55" height="15" font="0">0, 1, . . . , c</text>
<text top="1062" left="252" width="4" height="11" font="1">s</text>
<text top="1057" left="261" width="12" height="15" font="9">−</text>
<text top="1058" left="277" width="7" height="15" font="0">1</text>
<text top="1057" left="284" width="8" height="15" font="9">}</text>
<text top="1058" left="292" width="16" height="15" font="0">, s</text>
<text top="1058" left="313" width="12" height="14" font="9">=</text>
<text top="1058" left="330" width="99" height="15" font="0">1, . . . , r, and let</text>
<text top="1076" left="83" width="6" height="15" font="0">c</text>
<text top="1080" left="89" width="4" height="11" font="1">s</text>
<text top="1075" left="98" width="12" height="15" font="9">≥</text>
<text top="1076" left="114" width="195" height="15" font="0">2 be a finite positive constant.</text>
<text top="1094" left="105" width="324" height="15" font="0">For an unordered categorical predictor, we use a</text>
<text top="1112" left="82" width="278" height="15" font="0">variant of the kernel function outlined in</text>
<text top="1112" left="365" width="64" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Aitchison</a></text>
<text top="1129" left="82" width="74" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">and Aitken</a></text>
<text top="1129" left="160" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1129" left="165" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1976</a></text>
<text top="1129" left="195" width="77" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>defined as</text>
<text top="1166" left="128" width="4" height="15" font="0">l</text>
<text top="1166" left="133" width="6" height="14" font="9">(</text>
<text top="1166" left="140" width="10" height="15" font="0">Z</text>
<text top="1172" left="150" width="8" height="11" font="1">is</text>
<text top="1166" left="159" width="12" height="15" font="0">, z</text>
<text top="1171" left="171" width="4" height="11" font="1">s</text>
<text top="1166" left="177" width="15" height="15" font="0">, <i>λ</i></text>
<text top="1171" left="192" width="4" height="11" font="1">s</text>
<text top="1166" left="197" width="22" height="14" font="9">) =</text>
<text top="1155" left="223" width="11" height="7" font="0"></text>
<text top="1157" left="241" width="11" height="15" font="0">1,</text>
<text top="1157" left="279" width="51" height="15" font="0">when Z</text>
<text top="1163" left="330" width="8" height="11" font="1">is</text>
<text top="1157" left="342" width="12" height="14" font="9">=</text>
<text top="1157" left="358" width="7" height="15" font="0">z</text>
<text top="1162" left="365" width="4" height="11" font="1">s</text>
<text top="1157" left="370" width="4" height="15" font="0">,</text>
<text top="1179" left="242" width="9" height="11" font="8"><i>λ</i></text>
<text top="1180" left="251" width="4" height="11" font="1">s</text>
<text top="1175" left="256" width="4" height="15" font="0">,</text>
<text top="1175" left="279" width="69" height="15" font="0">otherwise.</text>
<text top="1166" left="412" width="17" height="15" font="0">(1)</text>
<text top="125" left="459" width="33" height="15" font="0">Let <b>1</b></text>
<text top="125" left="492" width="6" height="14" font="9">(</text>
<text top="125" left="500" width="11" height="15" font="0">A</text>
<text top="125" left="511" width="6" height="14" font="9">)</text>
<text top="125" left="521" width="284" height="15" font="0">denote the usual indicator function, which</text>
<text top="143" left="459" width="346" height="15" font="0">assumes the value one if A holds true, zero other-</text>
<text top="161" left="459" width="93" height="15" font="0">wise. Using <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">(</a></text>
<text top="161" left="552" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">1</a></text>
<text top="161" left="559" width="246" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">), </a>we can construct a product kernel</text>
<text top="179" left="459" width="166" height="15" font="0">weight function given by</text>
<text top="221" left="489" width="8" height="15" font="0">L</text>
<text top="221" left="500" width="6" height="14" font="9">(</text>
<text top="221" left="506" width="10" height="15" font="3"><b>Z</b></text>
<text top="226" left="516" width="3" height="11" font="1">i</text>
<text top="221" left="521" width="28" height="15" font="0">, <b>z</b>, <i>λ</i></text>
<text top="221" left="549" width="22" height="14" font="9">) =</text>
<text top="207" left="582" width="4" height="11" font="1">r</text>
<text top="215" left="575" width="18" height="27" font="14">∏</text>
<text top="239" left="574" width="20" height="11" font="1">s=1</text>
<text top="221" left="596" width="4" height="15" font="0">l</text>
<text top="221" left="601" width="6" height="14" font="9">(</text>
<text top="221" left="607" width="10" height="15" font="0">Z</text>
<text top="226" left="617" width="8" height="11" font="1">is</text>
<text top="221" left="626" width="12" height="15" font="0">, z</text>
<text top="225" left="639" width="4" height="11" font="1">s</text>
<text top="221" left="644" width="15" height="15" font="0">, <i>λ</i></text>
<text top="225" left="659" width="4" height="11" font="1">s</text>
<text top="221" left="664" width="22" height="14" font="9">) =</text>
<text top="207" left="697" width="4" height="11" font="1">r</text>
<text top="215" left="690" width="18" height="27" font="14">∏</text>
<text top="239" left="690" width="20" height="11" font="1">s=1</text>
<text top="224" left="711" width="9" height="11" font="8"><i>λ</i></text>
<text top="215" left="721" width="19" height="11" font="11"><b>1</b>(Z</text>
<text top="219" left="739" width="6" height="9" font="13">is</text>
<text top="214" left="747" width="15" height="12" font="1">6=z</text>
<text top="218" left="762" width="3" height="9" font="13">s</text>
<text top="215" left="766" width="5" height="11" font="1">)</text>
<text top="226" left="721" width="4" height="11" font="1">s</text>
<text top="221" left="772" width="4" height="15" font="0">,</text>
<text top="264" left="459" width="346" height="15" font="0">while for an ordered categorical we use the function</text>
<text top="282" left="459" width="71" height="15" font="0">defined by</text>
<text top="313" left="560" width="5" height="18" font="0">˜l</text>
<text top="317" left="564" width="6" height="14" font="9">(</text>
<text top="317" left="571" width="10" height="15" font="0">Z</text>
<text top="323" left="581" width="8" height="11" font="1">is</text>
<text top="317" left="590" width="12" height="15" font="0">, z</text>
<text top="322" left="602" width="4" height="11" font="1">s</text>
<text top="317" left="608" width="15" height="15" font="0">, <i>λ</i></text>
<text top="322" left="623" width="4" height="11" font="1">s</text>
<text top="317" left="628" width="22" height="14" font="9">) =</text>
<text top="321" left="654" width="9" height="11" font="8"><i>λ</i></text>
<text top="311" left="663" width="11" height="12" font="1">|Z</text>
<text top="316" left="674" width="6" height="9" font="13">is</text>
<text top="311" left="681" width="15" height="12" font="1">−z</text>
<text top="315" left="696" width="3" height="9" font="13">s</text>
<text top="311" left="701" width="3" height="11" font="1">|</text>
<text top="322" left="663" width="4" height="11" font="1">s</text>
<text top="348" left="459" width="346" height="15" font="0">and modify the product kernel function appropri-</text>
<text top="366" left="459" width="346" height="15" font="0">ately. When Z contains a mix of ordered and un-</text>
<text top="384" left="459" width="346" height="15" font="0">ordered variables we select the appropriate kernel</text>
<text top="402" left="459" width="346" height="15" font="0">for each variable’s type when constructing the prod-</text>
<text top="420" left="459" width="79" height="15" font="0">uct kernel L</text>
<text top="420" left="539" width="6" height="14" font="9">(</text>
<text top="420" left="546" width="10" height="15" font="3"><b>Z</b></text>
<text top="425" left="556" width="3" height="11" font="1">i</text>
<text top="420" left="560" width="28" height="15" font="0">, <b>z</b>, <i>λ</i></text>
<text top="420" left="588" width="6" height="14" font="9">)</text>
<text top="420" left="595" width="4" height="15" font="0">.</text>
<text top="438" left="481" width="135" height="15" font="0">Note that when <i>λ</i></text>
<text top="443" left="616" width="4" height="11" font="1">s</text>
<text top="438" left="628" width="12" height="14" font="9">=</text>
<text top="438" left="647" width="158" height="15" font="0">1 all observations are</text>
<text top="456" left="459" width="346" height="15" font="0">‘pooled’ over categorical predictor s hence the vari-</text>
<text top="474" left="459" width="38" height="15" font="0">able z</text>
<text top="478" left="497" width="4" height="11" font="1">s</text>
<text top="474" left="506" width="299" height="15" font="0">is removed from the resulting estimate, while</text>
<text top="492" left="459" width="51" height="15" font="0">when <i>λ</i></text>
<text top="496" left="510" width="4" height="11" font="1">s</text>
<text top="491" left="520" width="12" height="14" font="9">=</text>
<text top="492" left="536" width="269" height="15" font="0">0 only observations lying in a given cell</text>
<text top="510" left="459" width="196" height="15" font="0">are used to form the estimate.</text>
<text top="551" left="459" width="240" height="17" font="7"><b>Additional estimation details</b></text>
<text top="581" left="459" width="346" height="15" font="0">Estimating the model requires construction of the</text>
<text top="599" left="459" width="346" height="15" font="0">spline bases and their tensor product (if specified)</text>
<text top="617" left="459" width="346" height="15" font="0">along with the categorical kernel weighting func-</text>
<text top="635" left="459" width="346" height="15" font="0">tion. Then, for a given degree and number of seg-</text>
<text top="653" left="459" width="346" height="15" font="0">ments for each continuous predictor and bandwidth</text>
<text top="671" left="459" width="346" height="15" font="0">for each categorical predictor (or indicator bases if</text>
<text top="690" left="459" width="91" height="12" font="0">kernel=FALSE</text>
<text top="689" left="550" width="228" height="15" font="0">), the model is fit via least-squares.</text>
<text top="707" left="481" width="324" height="15" font="0">All smoothing parameters can be set manually</text>
<text top="725" left="459" width="346" height="15" font="0">by the user if so desired, however be forewarned</text>
<text top="743" left="459" width="346" height="15" font="0">that you must use the option cv=&#34;none&#34; otherwise</text>
<text top="761" left="459" width="346" height="15" font="0">the values specified manually will become the start-</text>
<text top="779" left="459" width="346" height="15" font="0">ing points for search when cv=&#34;nomad&#34; (‘nonsmooth</text>
<text top="796" left="459" width="291" height="15" font="0">mesh adaptive direct search (NOMAD)’, see</text>
<text top="796" left="754" width="51" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Abram-</a></text>
<text top="814" left="459" width="57" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">son et al.</a></text>
<text top="814" left="518" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="814" left="523" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="814" left="553" width="33" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>and</text>
<text top="814" left="589" width="71" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Le Digabel</a></text>
<text top="814" left="663" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="814" left="668" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="814" left="698" width="107" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)). </a>Currently, we</text>
<text top="832" left="459" width="346" height="15" font="0">provide a simple R interface to NOMAD (see the sec-</text>
<text top="850" left="459" width="346" height="15" font="0">tion below) in the <b>crs </b>package which also can be ap-</text>
<text top="868" left="459" width="346" height="15" font="0">plied to solve other mixed integer optimization prob-</text>
<text top="886" left="459" width="35" height="15" font="0">lems.</text>
<text top="904" left="481" width="324" height="15" font="0">The degree, segment, and bandwidth vectors can</text>
<text top="922" left="459" width="346" height="15" font="0">be jointly determined via any cv.func method by</text>
<text top="940" left="459" width="346" height="15" font="0">setting the option cv=&#34;nomad&#34; or cv=&#34;exhaustive&#34;</text>
<text top="958" left="459" width="346" height="15" font="0">(exhaustive search). Here we have to solve nonlin-</text>
<text top="976" left="459" width="346" height="15" font="0">ear non-convex and non-differentiable mixed integer</text>
<text top="994" left="459" width="346" height="15" font="0">constrained optimization problems to obtain the op-</text>
<text top="1012" left="459" width="346" height="15" font="0">timal degree, number of segments, and bandwidth</text>
<text top="1030" left="459" width="120" height="15" font="0">for each predictor.</text>
<text top="1048" left="481" width="324" height="15" font="0">Setting the option cv=&#34;nomad&#34; (default) computes</text>
<text top="1065" left="459" width="346" height="15" font="0">NOMAD-based cross-validation directed search</text>
<text top="1083" left="459" width="346" height="15" font="0">while setting cv=&#34;exhaustive&#34; computes exhaus-</text>
<text top="1101" left="459" width="346" height="15" font="0">tive cross-validation directed search for each unique</text>
<text top="1119" left="459" width="346" height="15" font="0">combination of the degree and segment vector for</text>
<text top="1137" left="459" width="346" height="15" font="0">each continuous predictor from degree=degree.min</text>
<text top="1155" left="459" width="346" height="15" font="0">through degree=degree.max (default 0 and 10,</text>
<text top="1173" left="459" width="84" height="15" font="0">respectively)</text>
<text top="1173" left="558" width="25" height="15" font="0">and</text>
<text top="1173" left="598" width="32" height="15" font="0">from</text>
<text top="1174" left="645" width="160" height="12" font="0">segments=segments.min</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">51</text>
<text top="125" left="82" width="346" height="15" font="0">through segments=segments.max (default 1 and 10,</text>
<text top="143" left="82" width="88" height="15" font="0">respectively).</text>
<text top="162" left="105" width="324" height="15" font="0">When kernel=TRUE (default) setting the option</text>
<text top="181" left="82" width="114" height="12" font="0">cv=&#34;exhaustive&#34;</text>
<text top="179" left="200" width="156" height="15" font="0">computes bandwidths (</text>
<text top="178" left="356" width="18" height="15" font="9">∈ [</text>
<text top="179" left="374" width="20" height="15" font="0">0, 1</text>
<text top="179" left="395" width="4" height="14" font="9">]</text>
<text top="179" left="399" width="30" height="15" font="0">) ob-</text>
<text top="197" left="82" width="346" height="15" font="0">tained via numerical minimization (using optim) for</text>
<text top="215" left="82" width="346" height="15" font="0">each unique combination of the degree and segment</text>
<text top="233" left="82" width="346" height="15" font="0">vectors (restarting can be conducted via restarts=).</text>
<text top="251" left="82" width="346" height="15" font="0">When setting cv=&#34;nomad&#34; the number of multiple</text>
<text top="269" left="82" width="346" height="15" font="0">starts can be controlled by nmulti= (default is 5). The</text>
<text top="287" left="82" width="346" height="15" font="0">model possessing the lowest criterion function value</text>
<text top="305" left="82" width="346" height="15" font="0">over the nmulti restarts is then selected as the final</text>
<text top="323" left="82" width="46" height="15" font="0">model.</text>
<text top="342" left="105" width="324" height="15" font="0">Note that cv=&#34;exhaustive&#34; is often unfeasible</text>
<text top="359" left="82" width="346" height="15" font="0">(this combinatoric problem can become impossibly</text>
<text top="377" left="82" width="346" height="15" font="0">large to compute in finite time) hence cv=&#34;nomad&#34; is</text>
<text top="395" left="82" width="346" height="15" font="0">the default. However, with cv=&#34;nomad&#34; one should</text>
<text top="413" left="82" width="346" height="15" font="0">set nmulti= to some sensible value greater than zero</text>
<text top="431" left="82" width="346" height="15" font="0">to avoid becoming trapped in local minima (default</text>
<text top="450" left="82" width="61" height="12" font="0">nmulti=5</text>
<text top="449" left="143" width="9" height="15" font="0">).</text>
<text top="494" left="82" width="340" height="17" font="7"><b>Data-driven smoothing parameter criteria</b></text>
<text top="526" left="82" width="346" height="15" font="0">We incorporate three popular approaches for setting</text>
<text top="544" left="82" width="346" height="15" font="0">the smoothing parameters of the regression spline</text>
<text top="562" left="82" width="346" height="15" font="0">model, namely least-squares cross-validation, gen-</text>
<text top="580" left="82" width="346" height="15" font="0">eralized cross-validation, and an AIC method cor-</text>
<text top="598" left="82" width="266" height="15" font="0">rected for use in nonparametric settings.</text>
<text top="616" left="105" width="324" height="15" font="0">Let the fitted value from the regression spline</text>
<text top="634" left="82" width="136" height="15" font="0">model be denoted ˆ</text>
<text top="634" left="210" width="10" height="15" font="0">Y</text>
<text top="640" left="219" width="3" height="11" font="1">i</text>
<text top="634" left="227" width="12" height="14" font="9">=</text>
<text top="634" left="244" width="9" height="15" font="0">B</text>
<text top="639" left="253" width="9" height="11" font="1">m</text>
<text top="634" left="263" width="6" height="14" font="9">(</text>
<text top="634" left="270" width="11" height="15" font="0">X</text>
<text top="640" left="281" width="3" height="11" font="1">i</text>
<text top="634" left="285" width="6" height="14" font="9">)</text>
<text top="631" left="292" width="7" height="11" font="1">T</text>
<text top="631" left="303" width="6" height="18" font="0">ˆ<i>β</i></text>
<text top="634" left="309" width="6" height="14" font="9">(</text>
<text top="634" left="315" width="10" height="15" font="0">Z</text>
<text top="640" left="325" width="3" height="11" font="1">i</text>
<text top="634" left="330" width="6" height="14" font="9">)</text>
<text top="634" left="336" width="72" height="15" font="0">. Letting ˆ<i>ε</i></text>
<text top="640" left="408" width="3" height="11" font="1">i</text>
<text top="634" left="417" width="12" height="14" font="9">=</text>
<text top="652" left="82" width="10" height="15" font="0">Y</text>
<text top="658" left="91" width="3" height="11" font="1">i</text>
<text top="651" left="100" width="12" height="15" font="9">−</text>
<text top="649" left="120" width="5" height="15" font="0">ˆ</text>
<text top="652" left="116" width="10" height="15" font="0">Y</text>
<text top="658" left="125" width="3" height="11" font="1">i</text>
<text top="652" left="137" width="292" height="15" font="0">denote the ith residual from the categori-</text>
<text top="670" left="82" width="346" height="15" font="0">cal regression spline model, the least-squares cross-</text>
<text top="688" left="82" width="202" height="15" font="0">validation function is given by</text>
<text top="734" left="186" width="21" height="15" font="0">CV</text>
<text top="734" left="212" width="12" height="14" font="9">=</text>
<text top="724" left="230" width="7" height="15" font="0">1</text>
<text top="744" left="229" width="8" height="15" font="0">n</text>
<text top="721" left="247" width="6" height="11" font="1">n</text>
<text top="728" left="242" width="16" height="27" font="14">∑</text>
<text top="753" left="241" width="19" height="11" font="1">i=1</text>
<text top="723" left="288" width="5" height="15" font="0">ˆ<i>ε</i></text>
<text top="720" left="293" width="6" height="11" font="1">2</text>
<text top="731" left="294" width="3" height="11" font="1">i</text>
<text top="745" left="263" width="6" height="14" font="9">(</text>
<text top="745" left="270" width="7" height="15" font="0">1</text>
<text top="744" left="280" width="12" height="15" font="9">−</text>
<text top="745" left="296" width="7" height="15" font="0">h</text>
<text top="750" left="303" width="7" height="11" font="1">ii</text>
<text top="745" left="311" width="6" height="14" font="9">)</text>
<text top="743" left="317" width="6" height="11" font="1">2</text>
<text top="781" left="82" width="346" height="15" font="0">and this computation can be done with effectively</text>
<text top="799" left="82" width="280" height="15" font="0">one pass through the data set, where h</text>
<text top="804" left="362" width="7" height="11" font="1">ii</text>
<text top="799" left="377" width="52" height="15" font="0">denotes</text>
<text top="817" left="82" width="346" height="15" font="0">the ith diagonal element of the spline basis projec-</text>
<text top="834" left="82" width="286" height="15" font="0">tion matrix (see below for details). Since h</text>
<text top="840" left="368" width="7" height="11" font="1">ii</text>
<text top="834" left="381" width="48" height="15" font="0">is com-</text>
<text top="852" left="82" width="346" height="15" font="0">puted routinely for robust diagnostics in R, this can</text>
<text top="870" left="82" width="346" height="15" font="0">be computed along with (and hence as cheaply as)</text>
<text top="888" left="82" width="346" height="15" font="0">the vector of spline coefficients themselves. Thus</text>
<text top="906" left="82" width="346" height="15" font="0">least-squares cross-validation is computationally ap-</text>
<text top="924" left="82" width="259" height="15" font="0">pealing, particularly for large data sets.</text>
<text top="943" left="105" width="120" height="15" font="0">Let H denote the n</text>
<text top="942" left="227" width="12" height="15" font="9">×</text>
<text top="943" left="242" width="187" height="15" font="0">n weighting matrix such that</text>
<text top="957" left="86" width="5" height="15" font="0">ˆ</text>
<text top="961" left="82" width="10" height="15" font="0">Y</text>
<text top="961" left="97" width="12" height="14" font="9">=</text>
<text top="961" left="115" width="307" height="15" font="0">HY with its ith diagonal element given by H</text>
<text top="966" left="421" width="7" height="11" font="1">ii</text>
<text top="979" left="82" width="57" height="15" font="0">where tr</text>
<text top="978" left="139" width="6" height="14" font="9">(</text>
<text top="978" left="146" width="12" height="15" font="0">H</text>
<text top="978" left="159" width="6" height="14" font="9">)</text>
<text top="979" left="169" width="260" height="15" font="0">means the trace of H which is equal to</text>
<text top="994" left="83" width="11" height="19" font="0">∑</text>
<text top="993" left="94" width="6" height="11" font="1">n</text>
<text top="1003" left="94" width="19" height="11" font="1">i=1</text>
<text top="996" left="116" width="7" height="15" font="0">h</text>
<text top="1002" left="123" width="7" height="11" font="1">ii</text>
<text top="997" left="131" width="298" height="15" font="0">. The matrix H is often called the ‘hat matrix’</text>
<text top="1014" left="82" width="346" height="15" font="0">or ‘smoother matrix’ and depends on X but not on</text>
<text top="1032" left="82" width="347" height="15" font="0">Y. The ‘generalized’ cross-validation function is ob-</text>
<text top="1050" left="82" width="141" height="15" font="0">tained by replacing h</text>
<text top="1056" left="223" width="7" height="11" font="1">ii</text>
<text top="1050" left="235" width="194" height="15" font="0">in the above formula with its</text>
<text top="1068" left="82" width="164" height="15" font="0">average value denoted tr</text>
<text top="1068" left="247" width="6" height="14" font="9">(</text>
<text top="1068" left="254" width="12" height="15" font="0">H</text>
<text top="1068" left="266" width="6" height="14" font="9">)</text>
<text top="1068" left="273" width="26" height="15" font="0">/n <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1068" left="299" width="126" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Craven and Wahba</a></text>
<text top="1068" left="425" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1086" left="82" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1979</a></text>
<text top="1086" left="112" width="9" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">).</a></text>
<text top="1105" left="105" width="324" height="15" font="0">The information-based criterion proposed by</text>
<text top="1123" left="82" width="91" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Hurvich et al.</a></text>
<text top="1123" left="177" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1123" left="182" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">1998</a></text>
<text top="1123" left="212" width="80" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>is given by</text>
<text top="1166" left="137" width="27" height="15" font="0">AIC</text>
<text top="1171" left="164" width="5" height="11" font="1">c</text>
<text top="1166" left="173" width="12" height="14" font="9">=</text>
<text top="1166" left="189" width="13" height="15" font="0">ln</text>
<text top="1166" left="202" width="6" height="14" font="9">(</text>
<text top="1166" left="210" width="7" height="15" font="0">ˆ<i>σ</i></text>
<text top="1163" left="217" width="6" height="11" font="1">2</text>
<text top="1166" left="224" width="21" height="14" font="9">) +</text>
<text top="1156" left="271" width="7" height="15" font="0">1</text>
<text top="1156" left="282" width="12" height="14" font="9">+</text>
<text top="1156" left="297" width="11" height="15" font="0">tr</text>
<text top="1156" left="308" width="6" height="14" font="9">(</text>
<text top="1156" left="315" width="12" height="15" font="0">H</text>
<text top="1156" left="327" width="6" height="14" font="9">)</text>
<text top="1156" left="334" width="18" height="15" font="0">/n</text>
<text top="1177" left="250" width="7" height="15" font="0">1</text>
<text top="1176" left="261" width="23" height="15" font="9">− {</text>
<text top="1177" left="284" width="11" height="15" font="0">tr</text>
<text top="1177" left="295" width="6" height="14" font="9">(</text>
<text top="1177" left="302" width="12" height="15" font="0">H</text>
<text top="1177" left="314" width="21" height="14" font="9">) +</text>
<text top="1177" left="339" width="7" height="15" font="0">2</text>
<text top="1176" left="347" width="8" height="15" font="9">}</text>
<text top="1177" left="355" width="18" height="15" font="0">/n</text>
<text top="125" left="459" width="41" height="15" font="0">where</text>
<text top="164" left="507" width="7" height="15" font="0">ˆ<i>σ</i></text>
<text top="161" left="515" width="6" height="11" font="1">2</text>
<text top="164" left="524" width="12" height="14" font="9">=</text>
<text top="154" left="543" width="7" height="15" font="0">1</text>
<text top="174" left="542" width="8" height="15" font="0">n</text>
<text top="151" left="560" width="6" height="11" font="1">n</text>
<text top="158" left="555" width="16" height="27" font="14">∑</text>
<text top="183" left="554" width="19" height="11" font="1">i=1</text>
<text top="164" left="575" width="5" height="15" font="0">ˆ<i>ε</i></text>
<text top="161" left="580" width="6" height="11" font="1">2</text>
<text top="171" left="581" width="3" height="11" font="1">i</text>
<text top="164" left="590" width="12" height="14" font="9">=</text>
<text top="164" left="606" width="10" height="15" font="0">Y</text>
<text top="160" left="616" width="3" height="11" font="1">0</text>
<text top="164" left="621" width="6" height="14" font="9">(</text>
<text top="164" left="628" width="5" height="15" font="0">I</text>
<text top="163" left="637" width="12" height="15" font="9">−</text>
<text top="164" left="653" width="12" height="15" font="0">H</text>
<text top="164" left="665" width="6" height="14" font="9">)</text>
<text top="160" left="671" width="3" height="11" font="1">0</text>
<text top="164" left="676" width="6" height="14" font="9">(</text>
<text top="164" left="683" width="5" height="15" font="0">I</text>
<text top="163" left="692" width="12" height="15" font="9">−</text>
<text top="164" left="708" width="12" height="15" font="0">H</text>
<text top="164" left="720" width="6" height="14" font="9">)</text>
<text top="164" left="726" width="32" height="15" font="0">Y/n.</text>
<text top="209" left="459" width="346" height="15" font="0">Each of these criterion functions can be minimized</text>
<text top="227" left="459" width="346" height="15" font="0">with respect to the unknown smoothing parameters</text>
<text top="245" left="459" width="346" height="15" font="0">either by numerical optimization procedures or by</text>
<text top="263" left="459" width="121" height="15" font="0">exhaustive search.</text>
<text top="280" left="481" width="324" height="15" font="0">Though each of the above criteria are asymptoti-</text>
<text top="298" left="459" width="346" height="15" font="0">cally equivalent in terms of the bandwidths they de-</text>
<text top="316" left="459" width="52" height="15" font="0">liver (tr</text>
<text top="316" left="511" width="6" height="14" font="9">(</text>
<text top="316" left="518" width="12" height="15" font="0">H</text>
<text top="316" left="531" width="6" height="14" font="9">)</text>
<text top="316" left="537" width="18" height="15" font="0">/n</text>
<text top="315" left="560" width="16" height="15" font="9">→</text>
<text top="316" left="581" width="43" height="15" font="0">0 as n</text>
<text top="315" left="629" width="16" height="15" font="9">→</text>
<text top="313" left="650" width="156" height="19" font="0">∞), they may differ in</text>
<text top="334" left="459" width="346" height="15" font="0">finite-sample settings for a small smoothing parame-</text>
<text top="352" left="459" width="73" height="15" font="0">ter (large tr</text>
<text top="352" left="532" width="6" height="14" font="9">(</text>
<text top="352" left="539" width="12" height="15" font="0">H</text>
<text top="352" left="551" width="6" height="14" font="9">)</text>
<text top="352" left="557" width="110" height="15" font="0">/n) with the AIC</text>
<text top="357" left="668" width="5" height="11" font="1">c</text>
<text top="352" left="676" width="129" height="15" font="0">criterion penalizing</text>
<text top="370" left="459" width="346" height="15" font="0">more heavily when undersmoothing than either the</text>
<text top="388" left="459" width="346" height="15" font="0">least-squares cross-validation or generalized cross-</text>
<text top="406" left="459" width="181" height="15" font="0">validation criteria (the AIC</text>
<text top="411" left="640" width="5" height="11" font="1">c</text>
<text top="406" left="650" width="155" height="15" font="0">criterion effectively ap-</text>
<text top="424" left="459" width="193" height="15" font="0">plies an infinite penalty for tr</text>
<text top="424" left="652" width="6" height="14" font="9">(</text>
<text top="424" left="659" width="12" height="15" font="0">H</text>
<text top="424" left="671" width="6" height="14" font="9">)</text>
<text top="424" left="678" width="18" height="15" font="0">/n</text>
<text top="423" left="699" width="12" height="15" font="9">≥</text>
<text top="424" left="715" width="33" height="15" font="0">1/2).</text>
<text top="465" left="459" width="67" height="17" font="7"><b>Pruning</b></text>
<text top="496" left="459" width="346" height="15" font="0">Once a model has been selected via cross-validation</text>
<text top="514" left="459" width="346" height="15" font="0">(i.e. degree, segments, include or lambda have</text>
<text top="532" left="459" width="346" height="15" font="0">been selected), there is the opportunity to (poten-</text>
<text top="550" left="459" width="346" height="15" font="0">tially) further refine the model by adding the option</text>
<text top="569" left="459" width="76" height="12" font="0">prune=TRUE</text>
<text top="568" left="541" width="265" height="15" font="0">to the crs function call. Pruning is ac-</text>
<text top="586" left="459" width="346" height="15" font="0">complished by conducting stepwise cross-validated</text>
<text top="604" left="459" width="346" height="15" font="0">variable selection using a modified version of the</text>
<text top="623" left="459" width="53" height="12" font="0">stepAIC</text>
<text top="621" left="516" width="112" height="15" font="0">function in the R</text>
<text top="622" left="632" width="45" height="15" font="5"><a href="http://cran.r-project.org/package=MASS"><b>MASS</b></a></text>
<text top="621" left="681" width="124" height="15" font="0">package where the</text>
<text top="639" left="459" width="346" height="15" font="0">function extractAIC is replaced with the function</text>
<text top="659" left="459" width="69" height="12" font="0">extractCV</text>
<text top="657" left="532" width="274" height="15" font="0">with additional modifications where nec-</text>
<text top="675" left="459" width="346" height="15" font="0">essary. Pruning of potentially superfluous bases is</text>
<text top="693" left="459" width="346" height="15" font="0">undertaken, however, the pruned model (potentially</text>
<text top="711" left="459" width="346" height="15" font="0">containing a subset of the bases) is returned only if</text>
<text top="729" left="459" width="346" height="15" font="0">its cross-validation score improves upon the model being</text>
<text top="747" left="459" width="346" height="15" font="0">pruned. When this is not the case a warning is is-</text>
<text top="765" left="459" width="346" height="15" font="0">sued to this effect. A final pruning stage is com-</text>
<text top="783" left="459" width="346" height="15" font="0">monplace in spline frameworks and may positively</text>
<text top="801" left="459" width="346" height="15" font="0">impact on the finite-sample efficiency of the result-</text>
<text top="819" left="459" width="346" height="15" font="0">ing estimator depending on the rank of the model</text>
<text top="837" left="459" width="346" height="15" font="0">being pruned. Note that this option can only be ap-</text>
<text top="855" left="459" width="346" height="15" font="0">plied when kernel=FALSE (or when there exist only</text>
<text top="873" left="459" width="135" height="15" font="0">numeric predictors).</text>
<text top="919" left="459" width="323" height="21" font="4"><b>A simple R interface to NOMAD</b></text>
<text top="958" left="459" width="346" height="15" font="0">The <b>crs </b>package has included a simple R interface</text>
<text top="976" left="459" width="346" height="15" font="0">to the NOMAD optimization solver called snomadr.</text>
<text top="995" left="459" width="53" height="12" font="0">snomadr</text>
<text top="994" left="518" width="287" height="15" font="0">implements the NOMAD library which is</text>
<text top="1012" left="459" width="346" height="15" font="0">an open source C++ implementation of the Mesh</text>
<text top="1030" left="459" width="346" height="15" font="0">Adaptive Direct Search (MADS) algorithm designed</text>
<text top="1048" left="459" width="346" height="15" font="0">for constrained optimization of blackbox functions</text>
<text top="1065" left="459" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="1065" left="464" width="108" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Abramson et al.</a></text>
<text top="1065" left="572" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1065" left="581" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="1065" left="611" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">;</a></text>
<text top="1065" left="621" width="73" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Le Digabel</a></text>
<text top="1065" left="694" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="1065" left="703" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="1065" left="733" width="72" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">). </a>snomadr</text>
<text top="1083" left="459" width="346" height="15" font="0">can be seen as a standalone interface to this opti-</text>
<text top="1101" left="459" width="346" height="15" font="0">mization solver, though we would like to point out</text>
<text top="1119" left="459" width="346" height="15" font="0">that the authors of NOMAD are currently working on an</text>
<text top="1137" left="459" width="346" height="15" font="0">R package for NOMAD that we expect to be much</text>
<text top="1155" left="459" width="346" height="15" font="0">more comprehensive than the simple interface pro-</text>
<text top="1173" left="459" width="346" height="15" font="0">vided here. The principle behind developing our in-</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="15" size="11" family="Times" color="#000000"/>
	<fontspec id="16" size="9" family="Times" color="#00004c"/>
	<fontspec id="17" size="12" family="Times" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">52</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="82" width="346" height="15" font="0">terface is simply to shield the user from setting up the</text>
<text top="143" left="82" width="346" height="15" font="0">optimization model underlying our regression spline</text>
<text top="161" left="82" width="346" height="15" font="0">implementation. For what follows we will not dis-</text>
<text top="179" left="82" width="346" height="15" font="0">cuss the performance of the solver NOMAD, rather</text>
<text top="197" left="82" width="230" height="15" font="0">we direct the interested reader to</text>
<text top="197" left="319" width="110" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Abramson et al.</a></text>
<text top="215" left="82" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="215" left="87" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="215" left="117" width="9" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">);</a></text>
<text top="215" left="130" width="71" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Le Digabel</a></text>
<text top="215" left="205" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="215" left="210" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2011</a></text>
<text top="215" left="240" width="183" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">) </a>and the references therein.</text>
<text top="233" left="105" width="324" height="15" font="0">The structure of the snomadr interface is simi-</text>
<text top="251" left="82" width="308" height="15" font="0">lar to the interface in the R package <b>ipoptr </b><a href="http://www.ucl.ac.uk/~uctpjyy/ipoptr.html">(</a></text>
<text top="252" left="391" width="38" height="12" font="6"><a href="http://www.ucl.ac.uk/~uctpjyy/ipoptr.html">http:</a></text>
<text top="270" left="82" width="274" height="12" font="6"><a href="http://www.ucl.ac.uk/~uctpjyy/ipoptr.html">//www.ucl.ac.uk/~uctpjyy/ipoptr.html</a></text>
<text top="268" left="357" width="72" height="15" font="0"><a href="http://www.ucl.ac.uk/~uctpjyy/ipoptr.html">) </a>which ex-</text>
<text top="286" left="82" width="346" height="15" font="0">ports the R interface to the optimization solver</text>
<text top="304" left="82" width="55" height="15" font="0">IPOPT <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="304" left="138" width="140" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Wächter and Biegler</a></text>
<text top="304" left="278" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="304" left="289" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2006</a></text>
<text top="304" left="318" width="110" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">). </a>The interface</text>
<text top="322" left="82" width="346" height="15" font="0">is split into two major portions, one is the R code</text>
<text top="340" left="82" width="51" height="15" font="0">called ‘</text>
<text top="341" left="133" width="65" height="12" font="15">snomadr.R</text>
<text top="340" left="198" width="231" height="15" font="0">’ and another is a C++ program</text>
<text top="358" left="82" width="48" height="15" font="0">called ‘</text>
<text top="359" left="130" width="77" height="12" font="15">snomadr.cpp</text>
<text top="358" left="207" width="96" height="15" font="0">’. The role of ‘</text>
<text top="359" left="304" width="65" height="12" font="15">snomadr.R</text>
<text top="358" left="369" width="60" height="15" font="0">’ is to set</text>
<text top="376" left="82" width="346" height="15" font="0">up the optimization model, define options and then</text>
<text top="394" left="82" width="346" height="15" font="0">call the C++ code to solve the optimization problem.</text>
<text top="412" left="82" width="4" height="15" font="0">‘</text>
<text top="413" left="87" width="77" height="12" font="15">snomadr.cpp</text>
<text top="412" left="164" width="265" height="15" font="0">’ will receive arguments from the R code</text>
<text top="430" left="82" width="346" height="15" font="0">and then call the NOMAD library functions to solve</text>
<text top="448" left="82" width="231" height="15" font="0">the problem and return results to ‘</text>
<text top="449" left="313" width="65" height="12" font="15">snomadr.R</text>
<text top="448" left="378" width="50" height="15" font="0">’. .Call</text>
<text top="466" left="82" width="346" height="15" font="0">is used to transfer arguments and results between</text>
<text top="484" left="82" width="346" height="15" font="0">the R and C++ languages. For further details see</text>
<text top="503" left="82" width="61" height="12" font="0">?snomadr</text>
<text top="502" left="143" width="4" height="15" font="0">.</text>
<text top="548" left="82" width="197" height="21" font="4"><b>Illustrative example</b></text>
<text top="586" left="82" width="346" height="15" font="0">By way of illustration we consider a simple simu-</text>
<text top="604" left="82" width="346" height="15" font="0">lated example involving one continuous and one cat-</text>
<text top="622" left="82" width="120" height="15" font="0">egorical predictor.</text>
<text top="652" left="82" width="91" height="12" font="0">set.seed(42)</text>
<text top="670" left="82" width="69" height="12" font="0">n &lt;- 1000</text>
<text top="688" left="82" width="99" height="12" font="0">x &lt;- runif(n)</text>
<text top="706" left="82" width="160" height="12" font="0">z &lt;- rbinom(n, 1, .5)</text>
<text top="724" left="82" width="335" height="12" font="0">y &lt;- cos(2 * pi * x) + z + rnorm(n, sd=0.25)</text>
<text top="742" left="82" width="107" height="12" font="0">z &lt;- factor(z)</text>
<text top="760" left="82" width="175" height="12" font="0">model &lt;- crs(y ~ x + z)</text>
<text top="778" left="82" width="107" height="12" font="0">summary(model)</text>
<text top="813" left="82" width="38" height="12" font="0">Call:</text>
<text top="831" left="82" width="244" height="12" font="0">crs.formula(formula = y ~ x + z)</text>
<text top="867" left="82" width="320" height="12" font="0">Kernel Weighting/B-spline Bases Regression</text>
<text top="885" left="105" width="46" height="12" font="0">Spline</text>
<text top="921" left="82" width="236" height="12" font="0">There is 1 continuous predictor</text>
<text top="939" left="82" width="244" height="12" font="0">There is 1 categorical predictor</text>
<text top="957" left="82" width="328" height="12" font="0">Spline degree/number of segments for x: 3/4</text>
<text top="975" left="82" width="221" height="12" font="0">Bandwidth for z: 0.0008551836</text>
<text top="993" left="82" width="274" height="12" font="0">Model complexity proxy: degree-knots</text>
<text top="1011" left="82" width="152" height="12" font="0">Knot type: quantiles</text>
<text top="1029" left="82" width="206" height="12" font="0">Training observations: 1000</text>
<text top="1047" left="82" width="213" height="12" font="0">Trace of smoother matrix: 14</text>
<text top="1064" left="82" width="290" height="12" font="0">Residual standard error: 0.2453 on 993</text>
<text top="1082" left="113" width="137" height="12" font="0">degrees of freedom</text>
<text top="1100" left="82" width="198" height="12" font="0">Multiple R-squared: 0.927,</text>
<text top="1118" left="113" width="198" height="12" font="0">Adjusted R-squared: 0.9265</text>
<text top="1136" left="82" width="274" height="12" font="0">F-statistic: 962.9 on 13 and 986 DF,</text>
<text top="126" left="489" width="76" height="12" font="0">p-value: 0</text>
<text top="144" left="459" width="267" height="12" font="0">Cross-validation score: 0.061491531</text>
<text top="162" left="459" width="183" height="12" font="0">Number of multistarts: 5</text>
<text top="201" left="481" width="324" height="15" font="0">The function crs() called in this example re-</text>
<text top="218" left="459" width="346" height="15" font="0">turns a &#34;crs&#34; object. The generic functions fitted</text>
<text top="236" left="459" width="346" height="15" font="0">and residuals extract (or generate) estimated values</text>
<text top="254" left="459" width="346" height="15" font="0">and residuals. Furthermore, the functions summary,</text>
<text top="274" left="459" width="53" height="12" font="0">predict</text>
<text top="272" left="512" width="293" height="15" font="0">, and plot (options mean=FALSE, deriv=i,</text>
<text top="292" left="459" width="61" height="12" font="0">ci=FALSE</text>
<text top="290" left="520" width="286" height="15" font="0">, plot.behavior = c(&#34;plot&#34;, &#34;plot-data&#34;,</text>
<text top="309" left="459" width="53" height="12" font="0">&#34;data&#34;)</text>
<text top="308" left="512" width="293" height="15" font="0">, where i is a positive integer) support objects</text>
<text top="326" left="459" width="78" height="15" font="0">of this type.</text>
<text top="346" left="481" width="43" height="15" font="0">Figure</text>
<text top="346" left="530" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">1</a></text>
<text top="346" left="544" width="261" height="15" font="0">presents summary output in the form</text>
<text top="364" left="459" width="346" height="15" font="0">of partial regression surfaces (predictors not appear-</text>
<text top="382" left="459" width="346" height="15" font="0">ing on the axes are held constant at their medi-</text>
<text top="400" left="459" width="84" height="15" font="0">ans/modes).</text>
<text top="400" left="561" width="244" height="15" font="0">Note that for this simple example</text>
<text top="417" left="459" width="346" height="15" font="0">we used the option plot(model,mean=TRUE) which</text>
<text top="435" left="459" width="222" height="15" font="0">presents ‘partial regression <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">plots’.</a></text>
<text top="433" left="681" width="6" height="11" font="16"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">1</a></text>
<text top="645" left="529" width="20" height="11" font="0">0.0</text>
<text top="645" left="573" width="20" height="11" font="0">0.2</text>
<text top="645" left="617" width="20" height="11" font="0">0.4</text>
<text top="645" left="662" width="20" height="11" font="0">0.6</text>
<text top="645" left="706" width="20" height="11" font="0">0.8</text>
<text top="645" left="750" width="20" height="11" font="0">1.0</text>
<text top="624" left="509" width="0" height="11" font="17">−1.0</text>
<text top="575" left="509" width="0" height="11" font="17">0.5</text>
<text top="529" left="509" width="0" height="11" font="17">2.0</text>
<text top="680" left="646" width="7" height="11" font="0">x</text>
<text top="620" left="474" width="0" height="11" font="17">Conditional Mean</text>
<text top="905" left="590" width="8" height="11" font="0">0</text>
<text top="905" left="701" width="8" height="11" font="0">1</text>
<text top="884" left="509" width="0" height="11" font="17">−1.0</text>
<text top="834" left="509" width="0" height="11" font="17">0.5</text>
<text top="789" left="509" width="0" height="11" font="17">2.0</text>
<text top="940" left="646" width="7" height="11" font="0">z</text>
<text top="880" left="474" width="0" height="11" font="17">Conditional Mean</text>
<text top="990" left="459" width="346" height="15" font="0">Figure 1: The partial regression plot for one categor-</text>
<text top="1008" left="459" width="224" height="15" font="0">ical and one continuous predictor.</text>
<text top="1045" left="481" width="324" height="15" font="0">Next we plot the first partial derivative (which</text>
<text top="1063" left="459" width="346" height="15" font="0">plots the partial derivative with respect to the con-</text>
<text top="1081" left="459" width="346" height="15" font="0">tinuous predictor holding the categorical predictor</text>
<text top="1099" left="459" width="346" height="15" font="0">at its modal value and next the difference between</text>
<text top="1117" left="459" width="346" height="15" font="0">the regression function when the categorical predic-</text>
<text top="1135" left="459" width="346" height="15" font="0">tor equals 0 and 1 holding the continuous predictor</text>
<text top="1159" left="99" width="4" height="9" font="13">1</text>
<text top="1161" left="104" width="453" height="12" font="1">A ‘partial regression plot’ is simply a 2D plot of the outcome y versus one predictor x</text>
<text top="1165" left="558" width="2" height="9" font="13">j</text>
<text top="1161" left="564" width="241" height="12" font="1">when all other predictors are held constant at</text>
<text top="1175" left="82" width="351" height="12" font="1">their respective medians/modes (this can be changed by the user).</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="18" size="11" family="Times" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">53</text>
<text top="125" left="82" width="259" height="15" font="0">at its median) for this model in Figure</text>
<text top="125" left="346" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#6">2</a></text>
<text top="125" left="353" width="75" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#6">. </a>Note that</text>
<text top="143" left="82" width="311" height="15" font="0">here we used the option plot(model,deriv=1).</text>
<text top="352" left="152" width="20" height="11" font="0">0.0</text>
<text top="352" left="197" width="20" height="11" font="0">0.2</text>
<text top="352" left="241" width="20" height="11" font="0">0.4</text>
<text top="352" left="285" width="20" height="11" font="0">0.6</text>
<text top="352" left="330" width="20" height="11" font="0">0.8</text>
<text top="352" left="374" width="20" height="11" font="0">1.0</text>
<text top="324" left="133" width="0" height="11" font="17">−6</text>
<text top="293" left="133" width="0" height="11" font="17">−2</text>
<text top="258" left="133" width="0" height="11" font="17">2</text>
<text top="228" left="133" width="0" height="11" font="17">6</text>
<text top="387" left="269" width="7" height="11" font="0">x</text>
<text top="330" left="98" width="0" height="11" font="17">Order 1 Der</text>
<text top="253" left="98" width="0" height="11" font="17">iv</text>
<text top="243" left="98" width="0" height="11" font="17">ativ</text>
<text top="221" left="98" width="0" height="11" font="17">e</text>
<text top="612" left="214" width="8" height="11" font="0">0</text>
<text top="612" left="324" width="8" height="11" font="0">1</text>
<text top="584" left="133" width="0" height="11" font="17">−6</text>
<text top="553" left="133" width="0" height="11" font="17">−2</text>
<text top="518" left="133" width="0" height="11" font="17">2</text>
<text top="488" left="133" width="0" height="11" font="17">6</text>
<text top="647" left="269" width="7" height="11" font="0">z</text>
<text top="594" left="98" width="0" height="11" font="17">Diff</text>
<text top="573" left="98" width="0" height="11" font="17">erence in Le</text>
<text top="494" left="98" width="0" height="11" font="17">v</text>
<text top="487" left="98" width="0" height="11" font="17">els</text>
<text top="697" left="82" width="346" height="15" font="0">Figure 2: The partial gradient plot for one categorical</text>
<text top="715" left="82" width="198" height="15" font="0">and one continuous predictor.</text>
<text top="764" left="82" width="346" height="21" font="4"><b>Comparison with existing spline</b></text>
<text top="791" left="82" width="85" height="21" font="4"><b>methods</b></text>
<text top="832" left="82" width="346" height="15" font="0">We now compare and contrast some existing spline</text>
<text top="850" left="82" width="346" height="15" font="0">implementations in R with the regression spline im-</text>
<text top="867" left="82" width="346" height="15" font="0">plementation contained in the <b>crs </b>package via two</text>
<text top="885" left="82" width="243" height="15" font="0">illustrative Monte Carlo simulations.</text>
<text top="934" left="82" width="346" height="17" font="7"><b>The bivariate one continuous predictor</b></text>
<text top="955" left="82" width="34" height="17" font="7"><b>case</b></text>
<text top="987" left="82" width="346" height="15" font="0">We first consider the simple and popular case of non-</text>
<text top="1005" left="82" width="346" height="15" font="0">parametrically modeling the relationship between a</text>
<text top="1023" left="82" width="346" height="15" font="0">response Y and univariate predictor X. Here the pur-</text>
<text top="1041" left="82" width="346" height="15" font="0">pose is to help the reader assess the performance</text>
<text top="1059" left="82" width="346" height="15" font="0">of regression splines versus smoothing splines. We</text>
<text top="1077" left="82" width="346" height="15" font="0">consider four data generating processes (DGPs), the</text>
<text top="1095" left="82" width="346" height="15" font="0">sine and cosine functions, the absolute value func-</text>
<text top="1113" left="82" width="262" height="15" font="0">tion, and the Doppler function given by</text>
<text top="1162" left="117" width="7" height="15" font="0">g</text>
<text top="1162" left="124" width="6" height="14" font="9">(</text>
<text top="1162" left="131" width="7" height="15" font="0">x</text>
<text top="1162" left="139" width="22" height="14" font="9">) =</text>
<text top="1154" left="165" width="15" height="7" font="0">q</text>
<text top="1162" left="180" width="7" height="15" font="0">x</text>
<text top="1162" left="188" width="6" height="14" font="9">(</text>
<text top="1162" left="194" width="7" height="15" font="0">1</text>
<text top="1161" left="205" width="12" height="15" font="9">−</text>
<text top="1162" left="221" width="7" height="15" font="0">x</text>
<text top="1162" left="229" width="21" height="14" font="9">) ×</text>
<text top="1162" left="253" width="19" height="15" font="0">sin</text>
<text top="1146" left="274" width="12" height="7" font="0"> </text>
<text top="1152" left="288" width="18" height="15" font="0">2<i>π</i></text>
<text top="1152" left="307" width="6" height="14" font="9">(</text>
<text top="1152" left="313" width="7" height="15" font="0">1</text>
<text top="1152" left="324" width="12" height="14" font="9">+</text>
<text top="1152" left="339" width="7" height="15" font="0">2</text>
<text top="1148" left="346" width="28" height="12" font="1">−7/5</text>
<text top="1152" left="375" width="6" height="14" font="9">)</text>
<text top="1173" left="304" width="7" height="15" font="0">x</text>
<text top="1173" left="315" width="12" height="14" font="9">+</text>
<text top="1173" left="330" width="7" height="15" font="0">2</text>
<text top="1170" left="338" width="28" height="12" font="1">−7/5</text>
<text top="1146" left="383" width="12" height="7" font="0">!</text>
<text top="125" left="459" width="346" height="15" font="0">For the sine, cosine, and Doppler functions X is</text>
<text top="143" left="459" width="12" height="15" font="0">U</text>
<text top="143" left="471" width="4" height="14" font="9">[</text>
<text top="143" left="476" width="20" height="15" font="0">0, 1</text>
<text top="143" left="496" width="4" height="14" font="9">]</text>
<text top="143" left="501" width="305" height="15" font="0">, while for the absolute value function X is</text>
<text top="161" left="459" width="12" height="15" font="0">U</text>
<text top="161" left="471" width="17" height="14" font="9">[−</text>
<text top="161" left="488" width="20" height="15" font="0">1, 1</text>
<text top="161" left="509" width="4" height="14" font="9">]</text>
<text top="161" left="513" width="292" height="15" font="0">. We vary the signal/noise ratio by standard-</text>
<text top="179" left="459" width="346" height="15" font="0">izing the DGP to have mean zero and unit variance</text>
<text top="197" left="459" width="346" height="15" font="0">and setting <i>σ </i>for the Gaussian noise to 1/4, 1/2, 1, 2</text>
<text top="215" left="459" width="321" height="15" font="0">which produces expected in-sample fits of R</text>
<text top="212" left="780" width="6" height="11" font="1">2</text>
<text top="215" left="793" width="12" height="14" font="9">=</text>
<text top="233" left="459" width="346" height="15" font="0">0.95, 0.80, 0.50, 0.20 for the oracle estimator (i.e. one</text>
<text top="251" left="459" width="222" height="15" font="0">that uses knowledge of the DGP).</text>
<text top="275" left="481" width="324" height="15" font="0">We compare crs-based regression splines with</text>
<text top="293" left="459" width="346" height="15" font="0">smoothing spline methods gam in the <b>mgcv </b>package,</text>
<text top="312" left="459" width="23" height="12" font="0">spm</text>
<text top="311" left="485" width="320" height="15" font="0">in the <b>SemiPar </b>package, ssanova in the <b>gss </b>pack-</text>
<text top="329" left="459" width="346" height="15" font="0">age, and loess in base R. All methods in this first</text>
<text top="347" left="459" width="206" height="15" font="0">simulation use default settings.</text>
<text top="371" left="481" width="78" height="15" font="0">We draw M</text>
<text top="371" left="563" width="12" height="14" font="9">=</text>
<text top="371" left="578" width="173" height="15" font="0">1, 000 replications of size n</text>
<text top="371" left="755" width="12" height="14" font="9">=</text>
<text top="371" left="770" width="35" height="15" font="0">1, 000</text>
<text top="389" left="459" width="346" height="15" font="0">from each DGP, compute the mean square error</text>
<text top="407" left="459" width="346" height="15" font="0">(MSE) for each model, and report the median value</text>
<text top="425" left="459" width="346" height="15" font="0">of each model’s MSE relative to that for crs over the</text>
<text top="443" left="460" width="14" height="15" font="0">M</text>
<text top="443" left="479" width="12" height="14" font="9">=</text>
<text top="443" left="496" width="179" height="15" font="0">1, 000 replications in Table</text>
<text top="443" left="681" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#6">1</a></text>
<text top="443" left="695" width="110" height="15" font="0">below (numbers</text>
<text top="461" left="459" width="346" height="15" font="0">less than one indicate that a method is more efficient</text>
<text top="479" left="459" width="65" height="15" font="0">than crs).</text>
<text top="502" left="459" width="346" height="15" font="0">Table 1: MSE efficiency of the various methods rela-</text>
<text top="520" left="459" width="346" height="15" font="0">tive to crs (numbers less than one indicate more effi-</text>
<text top="538" left="459" width="100" height="15" font="0">cient than crs).</text>
<text top="571" left="499" width="17" height="13" font="15">sin</text>
<text top="571" left="517" width="5" height="12" font="0">(</text>
<text top="571" left="522" width="24" height="13" font="15">2<i>π</i>x</text>
<text top="571" left="547" width="5" height="12" font="0">)</text>
<text top="571" left="579" width="26" height="13" font="15">gam</text>
<text top="571" left="626" width="26" height="13" font="15">spm</text>
<text top="571" left="669" width="48" height="13" font="15">ssanova</text>
<text top="571" left="739" width="29" height="13" font="15">loess</text>
<text top="598" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="595" left="512" width="11" height="12" font="0">=</text>
<text top="595" left="526" width="24" height="13" font="15">0.25</text>
<text top="595" left="581" width="24" height="13" font="15">0.97</text>
<text top="595" left="627" width="24" height="13" font="15">1.24</text>
<text top="595" left="681" width="24" height="13" font="15">1.02</text>
<text top="595" left="741" width="24" height="13" font="15">8.06</text>
<text top="615" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="612" left="512" width="11" height="12" font="0">=</text>
<text top="612" left="526" width="24" height="13" font="15">0.50</text>
<text top="612" left="581" width="24" height="13" font="15">0.80</text>
<text top="612" left="627" width="24" height="13" font="15">0.89</text>
<text top="612" left="681" width="24" height="13" font="15">0.81</text>
<text top="612" left="741" width="24" height="13" font="15">2.15</text>
<text top="631" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="628" left="512" width="11" height="12" font="0">=</text>
<text top="628" left="526" width="24" height="13" font="15">1.00</text>
<text top="628" left="581" width="24" height="13" font="15">0.78</text>
<text top="628" left="627" width="24" height="13" font="15">0.78</text>
<text top="628" left="681" width="24" height="13" font="15">0.78</text>
<text top="628" left="741" width="24" height="13" font="15">0.92</text>
<text top="648" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="644" left="512" width="11" height="12" font="0">=</text>
<text top="644" left="526" width="24" height="13" font="15">2.00</text>
<text top="644" left="581" width="24" height="13" font="15">0.84</text>
<text top="644" left="627" width="24" height="13" font="15">0.79</text>
<text top="644" left="681" width="24" height="13" font="15">0.83</text>
<text top="644" left="741" width="24" height="13" font="15">0.71</text>
<text top="677" left="499" width="17" height="13" font="15">sin</text>
<text top="677" left="517" width="5" height="12" font="0">(</text>
<text top="677" left="522" width="24" height="13" font="15">4<i>π</i>x</text>
<text top="677" left="547" width="5" height="12" font="0">)</text>
<text top="677" left="579" width="26" height="13" font="15">gam</text>
<text top="677" left="626" width="26" height="13" font="15">spm</text>
<text top="677" left="669" width="48" height="13" font="15">ssanova</text>
<text top="677" left="739" width="29" height="13" font="15">loess</text>
<text top="705" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="702" left="512" width="11" height="12" font="0">=</text>
<text top="702" left="526" width="24" height="13" font="15">0.25</text>
<text top="702" left="581" width="24" height="13" font="15">0.89</text>
<text top="702" left="627" width="24" height="13" font="15">1.43</text>
<text top="702" left="681" width="24" height="13" font="15">1.11</text>
<text top="702" left="735" width="37" height="13" font="15">507.85</text>
<text top="721" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="718" left="512" width="11" height="12" font="0">=</text>
<text top="718" left="526" width="24" height="13" font="15">0.50</text>
<text top="718" left="581" width="24" height="13" font="15">0.78</text>
<text top="718" left="627" width="24" height="13" font="15">1.15</text>
<text top="718" left="681" width="24" height="13" font="15">0.98</text>
<text top="718" left="735" width="37" height="13" font="15">129.41</text>
<text top="738" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="734" left="512" width="11" height="12" font="0">=</text>
<text top="734" left="526" width="24" height="13" font="15">1.00</text>
<text top="734" left="581" width="24" height="13" font="15">0.81</text>
<text top="734" left="627" width="24" height="13" font="15">1.01</text>
<text top="734" left="681" width="24" height="13" font="15">0.95</text>
<text top="734" left="738" width="30" height="13" font="15">36.72</text>
<text top="754" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="751" left="512" width="11" height="12" font="0">=</text>
<text top="751" left="526" width="24" height="13" font="15">2.00</text>
<text top="751" left="581" width="24" height="13" font="15">0.77</text>
<text top="751" left="627" width="24" height="13" font="15">0.84</text>
<text top="751" left="681" width="24" height="13" font="15">0.85</text>
<text top="751" left="741" width="24" height="13" font="15">9.89</text>
<text top="784" left="498" width="19" height="13" font="15">cos</text>
<text top="784" left="518" width="5" height="12" font="0">(</text>
<text top="784" left="523" width="24" height="13" font="15">2<i>π</i>x</text>
<text top="784" left="547" width="5" height="12" font="0">)</text>
<text top="784" left="579" width="26" height="13" font="15">gam</text>
<text top="784" left="626" width="26" height="13" font="15">spm</text>
<text top="784" left="669" width="48" height="13" font="15">ssanova</text>
<text top="784" left="739" width="29" height="13" font="15">loess</text>
<text top="811" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="808" left="512" width="11" height="12" font="0">=</text>
<text top="808" left="526" width="24" height="13" font="15">0.25</text>
<text top="808" left="581" width="24" height="13" font="15">1.13</text>
<text top="808" left="627" width="24" height="13" font="15">1.17</text>
<text top="808" left="681" width="24" height="13" font="15">1.17</text>
<text top="808" left="738" width="30" height="13" font="15">39.39</text>
<text top="828" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="824" left="512" width="11" height="12" font="0">=</text>
<text top="824" left="526" width="24" height="13" font="15">0.50</text>
<text top="824" left="581" width="24" height="13" font="15">0.99</text>
<text top="824" left="627" width="24" height="13" font="15">1.00</text>
<text top="824" left="681" width="24" height="13" font="15">1.04</text>
<text top="824" left="738" width="30" height="13" font="15">11.18</text>
<text top="844" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="841" left="512" width="11" height="12" font="0">=</text>
<text top="841" left="526" width="24" height="13" font="15">1.00</text>
<text top="841" left="581" width="24" height="13" font="15">0.98</text>
<text top="841" left="627" width="24" height="13" font="15">0.93</text>
<text top="841" left="681" width="24" height="13" font="15">1.00</text>
<text top="841" left="741" width="24" height="13" font="15">3.67</text>
<text top="861" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="857" left="512" width="11" height="12" font="0">=</text>
<text top="857" left="526" width="24" height="13" font="15">2.00</text>
<text top="857" left="581" width="24" height="13" font="15">0.89</text>
<text top="857" left="627" width="24" height="13" font="15">0.82</text>
<text top="857" left="681" width="24" height="13" font="15">0.91</text>
<text top="857" left="741" width="24" height="13" font="15">1.38</text>
<text top="890" left="498" width="19" height="13" font="15">cos</text>
<text top="890" left="518" width="5" height="12" font="0">(</text>
<text top="890" left="523" width="24" height="13" font="15">4<i>π</i>x</text>
<text top="890" left="547" width="5" height="12" font="0">)</text>
<text top="890" left="579" width="26" height="13" font="15">gam</text>
<text top="890" left="626" width="26" height="13" font="15">spm</text>
<text top="890" left="669" width="48" height="13" font="15">ssanova</text>
<text top="890" left="739" width="29" height="13" font="15">loess</text>
<text top="918" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="914" left="512" width="11" height="12" font="0">=</text>
<text top="914" left="526" width="24" height="13" font="15">0.25</text>
<text top="914" left="581" width="24" height="13" font="15">2.78</text>
<text top="914" left="627" width="24" height="13" font="15">1.54</text>
<text top="914" left="681" width="24" height="13" font="15">1.30</text>
<text top="914" left="735" width="37" height="13" font="15">299.88</text>
<text top="934" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="931" left="512" width="11" height="12" font="0">=</text>
<text top="931" left="526" width="24" height="13" font="15">0.50</text>
<text top="931" left="581" width="24" height="13" font="15">1.31</text>
<text top="931" left="627" width="24" height="13" font="15">1.25</text>
<text top="931" left="681" width="24" height="13" font="15">1.12</text>
<text top="931" left="738" width="30" height="13" font="15">79.85</text>
<text top="951" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="947" left="512" width="11" height="12" font="0">=</text>
<text top="947" left="526" width="24" height="13" font="15">1.00</text>
<text top="947" left="581" width="24" height="13" font="15">0.93</text>
<text top="947" left="627" width="24" height="13" font="15">1.02</text>
<text top="947" left="681" width="24" height="13" font="15">0.97</text>
<text top="947" left="738" width="30" height="13" font="15">21.42</text>
<text top="967" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="964" left="512" width="11" height="12" font="0">=</text>
<text top="964" left="526" width="24" height="13" font="15">2.00</text>
<text top="964" left="581" width="24" height="13" font="15">0.82</text>
<text top="964" left="627" width="24" height="13" font="15">0.89</text>
<text top="964" left="681" width="24" height="13" font="15">0.87</text>
<text top="964" left="741" width="24" height="13" font="15">6.09</text>
<text top="997" left="506" width="20" height="13" font="15">abs</text>
<text top="997" left="526" width="5" height="12" font="0">(</text>
<text top="997" left="532" width="7" height="13" font="15">x</text>
<text top="997" left="539" width="5" height="12" font="0">)</text>
<text top="997" left="579" width="26" height="13" font="15">gam</text>
<text top="997" left="626" width="26" height="13" font="15">spm</text>
<text top="997" left="669" width="48" height="13" font="15">ssanova</text>
<text top="997" left="739" width="29" height="13" font="15">loess</text>
<text top="1024" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1021" left="512" width="11" height="12" font="0">=</text>
<text top="1021" left="526" width="24" height="13" font="15">0.25</text>
<text top="1021" left="581" width="24" height="13" font="15">1.55</text>
<text top="1021" left="627" width="24" height="13" font="15">0.91</text>
<text top="1021" left="681" width="24" height="13" font="15">0.98</text>
<text top="1021" left="738" width="30" height="13" font="15">14.59</text>
<text top="1041" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1037" left="512" width="11" height="12" font="0">=</text>
<text top="1037" left="526" width="24" height="13" font="15">0.50</text>
<text top="1037" left="581" width="24" height="13" font="15">1.20</text>
<text top="1037" left="627" width="24" height="13" font="15">1.05</text>
<text top="1037" left="681" width="24" height="13" font="15">1.11</text>
<text top="1037" left="741" width="24" height="13" font="15">5.97</text>
<text top="1057" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1054" left="512" width="11" height="12" font="0">=</text>
<text top="1054" left="526" width="24" height="13" font="15">1.00</text>
<text top="1054" left="581" width="24" height="13" font="15">1.23</text>
<text top="1054" left="627" width="24" height="13" font="15">1.18</text>
<text top="1054" left="681" width="24" height="13" font="15">1.26</text>
<text top="1054" left="741" width="24" height="13" font="15">2.73</text>
<text top="1073" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1070" left="512" width="11" height="12" font="0">=</text>
<text top="1070" left="526" width="24" height="13" font="15">2.00</text>
<text top="1070" left="581" width="24" height="13" font="15">1.41</text>
<text top="1070" left="627" width="24" height="13" font="15">1.36</text>
<text top="1070" left="681" width="24" height="13" font="15">1.43</text>
<text top="1070" left="741" width="24" height="13" font="15">1.61</text>
<text top="1103" left="492" width="47" height="13" font="15">doppler</text>
<text top="1103" left="540" width="5" height="12" font="0">(</text>
<text top="1103" left="546" width="7" height="13" font="15">x</text>
<text top="1103" left="553" width="5" height="12" font="0">)</text>
<text top="1103" left="579" width="26" height="13" font="15">gam</text>
<text top="1103" left="626" width="26" height="13" font="15">spm</text>
<text top="1103" left="669" width="48" height="13" font="15">ssanova</text>
<text top="1103" left="739" width="29" height="13" font="15">loess</text>
<text top="1131" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1127" left="512" width="11" height="12" font="0">=</text>
<text top="1127" left="526" width="24" height="13" font="15">0.25</text>
<text top="1127" left="577" width="30" height="13" font="15">65.45</text>
<text top="1127" left="627" width="24" height="13" font="15">1.67</text>
<text top="1127" left="681" width="24" height="13" font="15">1.68</text>
<text top="1127" left="735" width="37" height="13" font="15">359.63</text>
<text top="1147" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1144" left="512" width="11" height="12" font="0">=</text>
<text top="1144" left="526" width="24" height="13" font="15">0.50</text>
<text top="1144" left="577" width="30" height="13" font="15">18.53</text>
<text top="1144" left="627" width="24" height="13" font="15">1.39</text>
<text top="1144" left="681" width="24" height="13" font="15">1.42</text>
<text top="1144" left="738" width="30" height="13" font="15">99.51</text>
<text top="1163" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1160" left="512" width="11" height="12" font="0">=</text>
<text top="1160" left="526" width="24" height="13" font="15">1.00</text>
<text top="1160" left="581" width="24" height="13" font="15">5.15</text>
<text top="1160" left="627" width="24" height="13" font="15">1.14</text>
<text top="1160" left="681" width="24" height="13" font="15">1.19</text>
<text top="1160" left="738" width="30" height="13" font="15">25.40</text>
<text top="1180" left="501" width="8" height="10" font="18"><i>σ</i></text>
<text top="1177" left="512" width="11" height="12" font="0">=</text>
<text top="1177" left="526" width="24" height="13" font="15">2.00</text>
<text top="1177" left="581" width="24" height="13" font="15">1.78</text>
<text top="1177" left="627" width="24" height="13" font="15">1.03</text>
<text top="1177" left="681" width="24" height="13" font="15">1.04</text>
<text top="1177" left="741" width="24" height="13" font="15">6.81</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="19" size="8" family="Times" color="#000000"/>
	<fontspec id="20" size="8" family="Times" color="#000000"/>
	<fontspec id="21" size="5" family="Times" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">54</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="105" width="35" height="15" font="0">Table</text>
<text top="125" left="150" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#6">1</a></text>
<text top="125" left="167" width="217" height="15" font="0">reveals some general patterns.</text>
<text top="125" left="407" width="22" height="15" font="0">For</text>
<text top="143" left="82" width="346" height="15" font="0">smooth low frequency DGPs such as the sine and</text>
<text top="161" left="82" width="346" height="15" font="0">cosine, gam, spm, and ssanova turn in similar perfor-</text>
<text top="179" left="82" width="346" height="15" font="0">mances depending on the signal/noise ratio. How-</text>
<text top="197" left="82" width="346" height="15" font="0">ever, loess does not do well with these DGPs. For</text>
<text top="215" left="82" width="346" height="15" font="0">the absolute value and Doppler DGPs gam, spm,</text>
<text top="234" left="82" width="53" height="12" font="0">ssanova</text>
<text top="233" left="141" width="288" height="15" font="0">and loess on balance perform worse than</text>
<text top="252" left="82" width="23" height="12" font="0">crs</text>
<text top="251" left="105" width="324" height="15" font="0">. From a minimax perspective, the regression</text>
<text top="268" left="82" width="346" height="15" font="0">spline implementation in the <b>crs </b>package performs</text>
<text top="286" left="82" width="346" height="15" font="0">relatively well overall. Naturally by modifying tun-</text>
<text top="304" left="82" width="346" height="15" font="0">ing parameters one could expect to improve the</text>
<text top="322" left="82" width="346" height="15" font="0">performance of the smoothing spline methods (this</text>
<text top="340" left="82" width="346" height="15" font="0">would apply to crs as well as default settings are</text>
<text top="358" left="82" width="346" height="15" font="0">used throughout). The point to be made is simply</text>
<text top="376" left="82" width="346" height="15" font="0">that the regression spline implementation in <b>crs </b>ap-</text>
<text top="394" left="82" width="346" height="15" font="0">pears to adapt fairly well to the underlying DGP and</text>
<text top="412" left="82" width="254" height="15" font="0">may therefore be of interest to readers.</text>
<text top="458" left="82" width="346" height="17" font="7"><b>The multivariate case, mixed predictor</b></text>
<text top="479" left="82" width="44" height="17" font="7"><b>types</b></text>
<text top="511" left="82" width="346" height="15" font="0">Next we consider mixed predictor multivariate</text>
<text top="529" left="82" width="346" height="15" font="0">DGPs with additive and multiplicative features. The</text>
<text top="547" left="82" width="182" height="15" font="0">additive DGP is of the form</text>
<text top="581" left="82" width="107" height="12" font="0">x1 &lt;- runif(n)</text>
<text top="599" left="82" width="107" height="12" font="0">x2 &lt;- runif(n)</text>
<text top="617" left="82" width="160" height="12" font="0">z &lt;- rbinom(n, 1, .5)</text>
<text top="635" left="82" width="290" height="12" font="0">dgp &lt;- cos(2*pi*x1) + sin(2*pi*x2) + z</text>
<text top="653" left="82" width="244" height="12" font="0">dgp &lt;- (dgp - mean(dgp))/sd(dgp)</text>
<text top="671" left="82" width="221" height="12" font="0">y &lt;- dgp + rnorm(n, sd=sigma)</text>
<text top="689" left="82" width="107" height="12" font="0">z &lt;- factor(z)</text>
<text top="720" left="82" width="301" height="15" font="0">while the multiplicative DGPs are of the form</text>
<text top="754" left="82" width="107" height="12" font="0">x1 &lt;- runif(n)</text>
<text top="772" left="82" width="107" height="12" font="0">x2 &lt;- runif(n)</text>
<text top="790" left="82" width="160" height="12" font="0">z &lt;- rbinom(n, 1, .5)</text>
<text top="808" left="82" width="290" height="12" font="0">dgp &lt;- cos(2*pi*x1) * sin(2*pi*x2) * z</text>
<text top="826" left="82" width="244" height="12" font="0">dgp &lt;- (dgp - mean(dgp))/sd(dgp)</text>
<text top="844" left="82" width="221" height="12" font="0">y &lt;- dgp + rnorm(n, sd=sigma)</text>
<text top="862" left="82" width="107" height="12" font="0">z &lt;- factor(z)</text>
<text top="893" left="82" width="212" height="15" font="0">and the radial function given by</text>
<text top="927" left="82" width="160" height="12" font="0">x1 &lt;- runif(n, -5, 5)</text>
<text top="945" left="82" width="160" height="12" font="0">x2 &lt;- runif(n, -5, 5)</text>
<text top="963" left="82" width="160" height="12" font="0">z &lt;- rbinom(n, 1, .5)</text>
<text top="981" left="82" width="259" height="12" font="0">dgp &lt;- sin(sqrt(x1^2 + x2^2 + z))/</text>
<text top="999" left="136" width="160" height="12" font="0">sqrt(x1^2 + x2^2 + z)</text>
<text top="1017" left="82" width="244" height="12" font="0">dgp &lt;- (dgp - mean(dgp))/sd(dgp)</text>
<text top="1035" left="82" width="221" height="12" font="0">y &lt;- dgp + rnorm(n, sd=sigma)</text>
<text top="1053" left="82" width="107" height="12" font="0">z &lt;- factor(z)</text>
<text top="1083" left="82" width="346" height="15" font="0">We again vary the signal/noise ratio by standardiz-</text>
<text top="1101" left="82" width="346" height="15" font="0">ing the DGP and setting <i>σ </i>for the Gaussian noise to</text>
<text top="1119" left="82" width="346" height="15" font="0">1/4, 1/2, 1, 2 which produces expected in-sample fits</text>
<text top="1137" left="82" width="30" height="15" font="0">of R</text>
<text top="1134" left="113" width="6" height="11" font="1">2</text>
<text top="1137" left="124" width="12" height="14" font="9">=</text>
<text top="1137" left="141" width="288" height="15" font="0">0.95, 0.80, 0.50, 0.20 for the oracle estimator</text>
<text top="1155" left="82" width="346" height="15" font="0">(i.e. one that uses knowledge of the DGP). We esti-</text>
<text top="1173" left="82" width="218" height="15" font="0">mate the following eight models,</text>
<text top="126" left="459" width="221" height="12" font="0">model &lt;- crs(y ~ x1 + x2 + z)</text>
<text top="144" left="459" width="160" height="12" font="0"># gam (mgcv) additive</text>
<text top="162" left="459" width="267" height="12" font="0">model &lt;- gam(y ~ s(x1) + s(x2) + z)</text>
<text top="180" left="459" width="312" height="12" font="0"># gam (mgcv) tensor to admit interactions</text>
<text top="198" left="459" width="282" height="12" font="0">model &lt;- gam(y ~ t2(x1, x2, k=k) + z)</text>
<text top="216" left="459" width="328" height="12" font="0"># gam (mgcv) tensor with smooth for every z</text>
<text top="234" left="459" width="328" height="12" font="0">model &lt;- gam(y ~ t2(x1, x2, k=k, by=z) + z)</text>
<text top="252" left="459" width="183" height="12" font="0"># spm (SemiPar) additive</text>
<text top="270" left="459" width="267" height="12" font="0">model &lt;- spm(y ~ f(x1) + f(x2) + z)</text>
<text top="288" left="459" width="229" height="12" font="0"># spm (SemiPar) tensor product</text>
<text top="306" left="459" width="236" height="12" font="0">model &lt;- spm(y ~ f(x1, x2) + z)</text>
<text top="324" left="459" width="183" height="12" font="0"># ssanova (gss) additive</text>
<text top="342" left="459" width="252" height="12" font="0">model &lt;- ssanova(y ~ x1 + x2 + z)</text>
<text top="360" left="459" width="229" height="12" font="0"># ssanova (gss) tensor product</text>
<text top="377" left="459" width="252" height="12" font="0">model &lt;- ssanova(y ~ x1 * x2 + z)</text>
<text top="404" left="459" width="77" height="15" font="0">We draw M</text>
<text top="404" left="539" width="12" height="14" font="9">=</text>
<text top="404" left="555" width="167" height="15" font="0">1000 replications of size n</text>
<text top="404" left="725" width="12" height="14" font="9">=</text>
<text top="404" left="740" width="65" height="15" font="0">1000 from</text>
<text top="422" left="459" width="346" height="15" font="0">each DGP, compute the MSE for each model, and re-</text>
<text top="440" left="459" width="346" height="15" font="0">port the median value of each model’s MSE relative</text>
<text top="458" left="459" width="310" height="15" font="0">to that for crs over the M replications in Table</text>
<text top="458" left="773" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="458" left="785" width="20" height="15" font="0">be-</text>
<text top="476" left="459" width="27" height="15" font="0">low.</text>
<text top="490" left="459" width="346" height="15" font="0">Table 2: MSE efficiency of the various methods rela-</text>
<text top="508" left="459" width="346" height="15" font="0">tive to crs (numbers less than one indicate more effi-</text>
<text top="526" left="459" width="100" height="15" font="0">cient than crs).</text>
<text top="559" left="555" width="110" height="10" font="19">Additive DGP (cos(2<i>π</i>x</text>
<text top="563" left="665" width="4" height="7" font="21">1</text>
<text top="559" left="670" width="54" height="11" font="19">) + sin(2<i>π</i>x</text>
<text top="563" left="723" width="4" height="7" font="21">2</text>
<text top="559" left="728" width="26" height="11" font="19">) + z)</text>
<text top="571" left="550" width="20" height="10" font="19">gam</text>
<text top="571" left="662" width="20" height="10" font="19">spm</text>
<text top="571" left="747" width="37" height="10" font="19">ssanova</text>
<text top="586" left="474" width="6" height="8" font="20"><i>σ</i></text>
<text top="583" left="507" width="25" height="10" font="19">(add)</text>
<text top="583" left="556" width="20" height="10" font="19">(int)</text>
<text top="583" left="598" width="19" height="10" font="19">(by)</text>
<text top="583" left="636" width="25" height="10" font="19">(add)</text>
<text top="583" left="688" width="15" height="10" font="19">(te)</text>
<text top="583" left="730" width="25" height="10" font="19">(add)</text>
<text top="583" left="781" width="15" height="10" font="19">(te)</text>
<text top="603" left="468" width="18" height="10" font="19">0.25</text>
<text top="603" left="510" width="18" height="10" font="19">0.60</text>
<text top="603" left="557" width="18" height="10" font="19">1.57</text>
<text top="603" left="598" width="18" height="10" font="19">2.11</text>
<text top="603" left="640" width="18" height="10" font="19">0.64</text>
<text top="603" left="686" width="18" height="10" font="19">1.71</text>
<text top="603" left="733" width="18" height="10" font="19">0.62</text>
<text top="603" left="780" width="18" height="10" font="19">0.70</text>
<text top="615" left="468" width="18" height="10" font="19">0.50</text>
<text top="615" left="510" width="18" height="10" font="19">0.57</text>
<text top="615" left="557" width="18" height="10" font="19">0.94</text>
<text top="615" left="598" width="18" height="10" font="19">1.56</text>
<text top="615" left="640" width="18" height="10" font="19">0.57</text>
<text top="615" left="686" width="18" height="10" font="19">1.24</text>
<text top="615" left="733" width="18" height="10" font="19">0.57</text>
<text top="615" left="780" width="18" height="10" font="19">0.65</text>
<text top="627" left="468" width="18" height="10" font="19">1.00</text>
<text top="627" left="510" width="18" height="10" font="19">0.55</text>
<text top="627" left="557" width="18" height="10" font="19">0.83</text>
<text top="627" left="598" width="18" height="10" font="19">1.44</text>
<text top="627" left="640" width="18" height="10" font="19">0.51</text>
<text top="627" left="686" width="18" height="10" font="19">0.95</text>
<text top="627" left="733" width="18" height="10" font="19">0.54</text>
<text top="627" left="780" width="18" height="10" font="19">0.65</text>
<text top="639" left="468" width="18" height="10" font="19">2.00</text>
<text top="639" left="510" width="18" height="10" font="19">0.52</text>
<text top="639" left="557" width="18" height="10" font="19">0.75</text>
<text top="639" left="598" width="18" height="10" font="19">1.35</text>
<text top="639" left="640" width="18" height="10" font="19">0.49</text>
<text top="639" left="686" width="18" height="10" font="19">0.72</text>
<text top="639" left="733" width="18" height="10" font="19">0.51</text>
<text top="639" left="780" width="18" height="10" font="19">0.60</text>
<text top="663" left="553" width="110" height="10" font="19">Additive DGP (cos(4<i>π</i>x</text>
<text top="667" left="663" width="4" height="7" font="21">1</text>
<text top="663" left="668" width="54" height="11" font="19">) + sin(4<i>π</i>x</text>
<text top="667" left="722" width="4" height="7" font="21">2</text>
<text top="663" left="726" width="29" height="11" font="19">) + z))</text>
<text top="675" left="550" width="20" height="10" font="19">gam</text>
<text top="675" left="662" width="20" height="10" font="19">spm</text>
<text top="675" left="747" width="37" height="10" font="19">ssanova</text>
<text top="689" left="474" width="6" height="8" font="20"><i>σ</i></text>
<text top="687" left="507" width="25" height="10" font="19">(add)</text>
<text top="687" left="556" width="20" height="10" font="19">(int)</text>
<text top="687" left="598" width="19" height="10" font="19">(by)</text>
<text top="687" left="636" width="25" height="10" font="19">(add)</text>
<text top="687" left="688" width="15" height="10" font="19">(te)</text>
<text top="687" left="730" width="25" height="10" font="19">(add)</text>
<text top="687" left="781" width="15" height="10" font="19">(te)</text>
<text top="707" left="468" width="18" height="10" font="19">0.25</text>
<text top="707" left="510" width="18" height="10" font="19">0.72</text>
<text top="707" left="557" width="18" height="10" font="19">1.07</text>
<text top="707" left="598" width="18" height="10" font="19">1.88</text>
<text top="707" left="640" width="18" height="10" font="19">0.77</text>
<text top="707" left="686" width="18" height="10" font="19">5.76</text>
<text top="707" left="733" width="18" height="10" font="19">0.65</text>
<text top="707" left="780" width="18" height="10" font="19">0.72</text>
<text top="719" left="468" width="18" height="10" font="19">0.50</text>
<text top="719" left="510" width="18" height="10" font="19">0.54</text>
<text top="719" left="557" width="18" height="10" font="19">0.94</text>
<text top="719" left="598" width="18" height="10" font="19">1.70</text>
<text top="719" left="640" width="18" height="10" font="19">0.63</text>
<text top="719" left="686" width="18" height="10" font="19">2.50</text>
<text top="719" left="733" width="18" height="10" font="19">0.58</text>
<text top="719" left="780" width="18" height="10" font="19">0.65</text>
<text top="730" left="468" width="18" height="10" font="19">1.00</text>
<text top="730" left="510" width="18" height="10" font="19">0.52</text>
<text top="730" left="557" width="18" height="10" font="19">0.90</text>
<text top="730" left="598" width="18" height="10" font="19">1.65</text>
<text top="730" left="640" width="18" height="10" font="19">0.57</text>
<text top="730" left="686" width="18" height="10" font="19">1.53</text>
<text top="730" left="733" width="18" height="10" font="19">0.57</text>
<text top="730" left="780" width="18" height="10" font="19">0.62</text>
<text top="742" left="468" width="18" height="10" font="19">2.00</text>
<text top="742" left="510" width="18" height="10" font="19">0.53</text>
<text top="742" left="557" width="18" height="10" font="19">0.90</text>
<text top="742" left="598" width="18" height="10" font="19">1.64</text>
<text top="742" left="640" width="18" height="10" font="19">0.56</text>
<text top="742" left="686" width="18" height="10" font="19">1.17</text>
<text top="742" left="733" width="18" height="10" font="19">0.55</text>
<text top="742" left="780" width="18" height="10" font="19">0.63</text>
<text top="766" left="543" width="134" height="10" font="19">Multiplicative DGP (cos(2<i>π</i>x</text>
<text top="770" left="677" width="4" height="7" font="21">1</text>
<text top="766" left="682" width="54" height="11" font="19">) × sin(2<i>π</i>x</text>
<text top="770" left="735" width="4" height="7" font="21">2</text>
<text top="766" left="740" width="26" height="11" font="19">) × z)</text>
<text top="778" left="550" width="20" height="10" font="19">gam</text>
<text top="778" left="662" width="20" height="10" font="19">spm</text>
<text top="778" left="747" width="37" height="10" font="19">ssanova</text>
<text top="793" left="474" width="6" height="8" font="20"><i>σ</i></text>
<text top="790" left="507" width="25" height="10" font="19">(add)</text>
<text top="790" left="556" width="20" height="10" font="19">(int)</text>
<text top="790" left="598" width="19" height="10" font="19">(by)</text>
<text top="790" left="636" width="25" height="10" font="19">(add)</text>
<text top="790" left="688" width="15" height="10" font="19">(te)</text>
<text top="790" left="730" width="25" height="10" font="19">(add)</text>
<text top="790" left="781" width="15" height="10" font="19">(te)</text>
<text top="810" left="468" width="18" height="10" font="19">0.25</text>
<text top="810" left="505" width="29" height="10" font="19">228.82</text>
<text top="810" left="551" width="29" height="10" font="19">111.54</text>
<text top="810" left="598" width="18" height="10" font="19">0.78</text>
<text top="810" left="635" width="29" height="10" font="19">229.05</text>
<text top="810" left="681" width="29" height="10" font="19">111.41</text>
<text top="810" left="728" width="29" height="10" font="19">229.17</text>
<text top="810" left="775" width="29" height="10" font="19">112.97</text>
<text top="822" left="468" width="18" height="10" font="19">0.50</text>
<text top="822" left="507" width="24" height="10" font="19">95.18</text>
<text top="822" left="554" width="24" height="10" font="19">46.93</text>
<text top="822" left="598" width="18" height="10" font="19">1.09</text>
<text top="822" left="637" width="24" height="10" font="19">95.26</text>
<text top="822" left="684" width="24" height="10" font="19">46.81</text>
<text top="822" left="731" width="24" height="10" font="19">95.31</text>
<text top="822" left="777" width="24" height="10" font="19">47.46</text>
<text top="834" left="468" width="18" height="10" font="19">1.00</text>
<text top="834" left="507" width="24" height="10" font="19">30.23</text>
<text top="834" left="554" width="24" height="10" font="19">15.50</text>
<text top="834" left="598" width="18" height="10" font="19">1.16</text>
<text top="834" left="637" width="24" height="10" font="19">30.25</text>
<text top="834" left="684" width="24" height="10" font="19">15.55</text>
<text top="834" left="731" width="24" height="10" font="19">30.25</text>
<text top="834" left="777" width="24" height="10" font="19">15.60</text>
<text top="846" left="468" width="18" height="10" font="19">2.00</text>
<text top="846" left="510" width="18" height="10" font="19">9.61</text>
<text top="846" left="557" width="18" height="10" font="19">5.39</text>
<text top="846" left="598" width="18" height="10" font="19">1.14</text>
<text top="846" left="640" width="18" height="10" font="19">9.60</text>
<text top="846" left="686" width="18" height="10" font="19">5.49</text>
<text top="846" left="733" width="18" height="10" font="19">9.59</text>
<text top="846" left="780" width="18" height="10" font="19">5.32</text>
<text top="870" left="543" width="134" height="10" font="19">Multiplicative DGP (cos(4<i>π</i>x</text>
<text top="874" left="677" width="4" height="7" font="21">1</text>
<text top="870" left="682" width="54" height="11" font="19">) × sin(4<i>π</i>x</text>
<text top="874" left="735" width="4" height="7" font="21">2</text>
<text top="870" left="740" width="26" height="11" font="19">) × z)</text>
<text top="882" left="550" width="20" height="10" font="19">gam</text>
<text top="882" left="662" width="20" height="10" font="19">spm</text>
<text top="882" left="747" width="37" height="10" font="19">ssanova</text>
<text top="896" left="474" width="6" height="8" font="20"><i>σ</i></text>
<text top="894" left="507" width="25" height="10" font="19">(add)</text>
<text top="894" left="556" width="20" height="10" font="19">(int)</text>
<text top="894" left="598" width="19" height="10" font="19">(by)</text>
<text top="894" left="636" width="25" height="10" font="19">(add)</text>
<text top="894" left="688" width="15" height="10" font="19">(te)</text>
<text top="894" left="730" width="25" height="10" font="19">(add)</text>
<text top="894" left="781" width="15" height="10" font="19">(te)</text>
<text top="913" left="468" width="18" height="10" font="19">0.25</text>
<text top="913" left="507" width="24" height="10" font="19">93.39</text>
<text top="913" left="554" width="24" height="10" font="19">44.36</text>
<text top="913" left="598" width="18" height="10" font="19">0.62</text>
<text top="913" left="637" width="24" height="10" font="19">93.52</text>
<text top="913" left="684" width="24" height="10" font="19">51.31</text>
<text top="913" left="731" width="24" height="10" font="19">93.58</text>
<text top="913" left="777" width="24" height="10" font="19">54.14</text>
<text top="925" left="468" width="18" height="10" font="19">0.50</text>
<text top="925" left="507" width="24" height="10" font="19">30.05</text>
<text top="925" left="554" width="24" height="10" font="19">14.66</text>
<text top="925" left="598" width="18" height="10" font="19">0.64</text>
<text top="925" left="637" width="24" height="10" font="19">30.09</text>
<text top="925" left="684" width="24" height="10" font="19">16.85</text>
<text top="925" left="731" width="24" height="10" font="19">30.11</text>
<text top="925" left="777" width="24" height="10" font="19">17.71</text>
<text top="937" left="468" width="18" height="10" font="19">1.00</text>
<text top="937" left="510" width="18" height="10" font="19">9.92</text>
<text top="937" left="557" width="18" height="10" font="19">5.28</text>
<text top="937" left="598" width="18" height="10" font="19">0.74</text>
<text top="937" left="640" width="18" height="10" font="19">9.93</text>
<text top="937" left="686" width="18" height="10" font="19">5.92</text>
<text top="937" left="733" width="18" height="10" font="19">9.94</text>
<text top="937" left="780" width="18" height="10" font="19">6.56</text>
<text top="949" left="468" width="18" height="10" font="19">2.00</text>
<text top="949" left="510" width="18" height="10" font="19">3.40</text>
<text top="949" left="557" width="18" height="10" font="19">2.26</text>
<text top="949" left="598" width="18" height="10" font="19">0.86</text>
<text top="949" left="640" width="18" height="10" font="19">3.39</text>
<text top="949" left="686" width="18" height="10" font="19">2.50</text>
<text top="949" left="733" width="18" height="10" font="19">3.39</text>
<text top="949" left="780" width="18" height="10" font="19">3.37</text>
<text top="973" left="591" width="127" height="10" font="19">Multiplicative DGP (radial)</text>
<text top="985" left="550" width="20" height="10" font="19">gam</text>
<text top="985" left="662" width="20" height="10" font="19">spm</text>
<text top="985" left="747" width="37" height="10" font="19">ssanova</text>
<text top="1000" left="474" width="6" height="8" font="20"><i>σ</i></text>
<text top="997" left="507" width="25" height="10" font="19">(add)</text>
<text top="997" left="556" width="20" height="10" font="19">(int)</text>
<text top="997" left="598" width="19" height="10" font="19">(by)</text>
<text top="997" left="636" width="25" height="10" font="19">(add)</text>
<text top="997" left="688" width="15" height="10" font="19">(te)</text>
<text top="997" left="730" width="25" height="10" font="19">(add)</text>
<text top="997" left="781" width="15" height="10" font="19">(te)</text>
<text top="1017" left="468" width="18" height="10" font="19">0.25</text>
<text top="1017" left="507" width="24" height="10" font="19">89.66</text>
<text top="1017" left="557" width="18" height="10" font="19">2.18</text>
<text top="1017" left="598" width="18" height="10" font="19">1.16</text>
<text top="1017" left="637" width="24" height="10" font="19">89.07</text>
<text top="1017" left="686" width="18" height="10" font="19">2.29</text>
<text top="1017" left="731" width="24" height="10" font="19">89.60</text>
<text top="1017" left="780" width="18" height="10" font="19">2.21</text>
<text top="1029" left="468" width="18" height="10" font="19">0.50</text>
<text top="1029" left="507" width="24" height="10" font="19">31.35</text>
<text top="1029" left="557" width="18" height="10" font="19">1.27</text>
<text top="1029" left="598" width="18" height="10" font="19">1.30</text>
<text top="1029" left="637" width="24" height="10" font="19">31.18</text>
<text top="1029" left="686" width="18" height="10" font="19">1.29</text>
<text top="1029" left="731" width="24" height="10" font="19">31.35</text>
<text top="1029" left="780" width="18" height="10" font="19">1.21</text>
<text top="1041" left="468" width="18" height="10" font="19">1.00</text>
<text top="1041" left="507" width="24" height="10" font="19">12.65</text>
<text top="1041" left="557" width="18" height="10" font="19">1.19</text>
<text top="1041" left="598" width="18" height="10" font="19">1.72</text>
<text top="1041" left="637" width="24" height="10" font="19">12.56</text>
<text top="1041" left="686" width="18" height="10" font="19">1.09</text>
<text top="1041" left="731" width="24" height="10" font="19">12.68</text>
<text top="1041" left="780" width="18" height="10" font="19">1.08</text>
<text top="1053" left="468" width="18" height="10" font="19">2.00</text>
<text top="1053" left="510" width="18" height="10" font="19">4.49</text>
<text top="1053" left="557" width="18" height="10" font="19">1.10</text>
<text top="1053" left="598" width="18" height="10" font="19">1.82</text>
<text top="1053" left="640" width="18" height="10" font="19">4.44</text>
<text top="1053" left="686" width="18" height="10" font="19">0.88</text>
<text top="1053" left="733" width="18" height="10" font="19">4.51</text>
<text top="1053" left="780" width="18" height="10" font="19">0.99</text>
<text top="1083" left="481" width="324" height="15" font="0">For the <b>mgcv </b>routine gam, a referee noted that</text>
<text top="1103" left="459" width="69" height="12" font="0">?choose.k</text>
<text top="1101" left="532" width="273" height="15" font="0">could be consulted where it suggests us-</text>
<text top="1119" left="459" width="346" height="15" font="0">ing gam.check() to help guide the appropriate num-</text>
<text top="1137" left="459" width="346" height="15" font="0">ber of knots and suggested non-stochastic values of</text>
<text top="1156" left="459" width="23" height="12" font="0">k=5</text>
<text top="1155" left="487" width="318" height="15" font="0">for the additive DGP with 2<i>π </i>and k=10 for the</text>
<text top="1173" left="459" width="334" height="15" font="0">remaining DGPs (these values were used in Table</text>
<text top="1173" left="798" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">55</text>
<text top="125" left="82" width="346" height="15" font="0">for gam via the argument k=k rather than the default</text>
<text top="143" left="82" width="346" height="15" font="0">values, while crs uses stochastic values for the basis</text>
<text top="161" left="82" width="207" height="15" font="0">and all smoothing parameters).</text>
<text top="183" left="105" width="324" height="15" font="0">When the DGP is additive, it is clear that the</text>
<text top="201" left="82" width="346" height="15" font="0">smoothing splines that presume additivity are more</text>
<text top="219" left="82" width="346" height="15" font="0">efficient than crs for this DGP. Note that this is</text>
<text top="237" left="82" width="346" height="15" font="0">an oracle type of property in the sense that the</text>
<text top="255" left="82" width="346" height="15" font="0">user does not in general have knowledge of the</text>
<text top="272" left="82" width="346" height="15" font="0">true DGP, but if they did and used this information</text>
<text top="290" left="82" width="346" height="15" font="0">their model would naturally be more efficient than</text>
<text top="308" left="82" width="346" height="15" font="0">a method that did not (we elaborate further on this</text>
<text top="326" left="82" width="346" height="15" font="0">below). The regression spline implementation in the</text>
<text top="344" left="82" width="19" height="15" font="3"><b>crs</b></text>
<text top="344" left="106" width="323" height="15" font="0">package does not presume this knowledge when</text>
<text top="363" left="82" width="91" height="12" font="0">basis=&#34;auto&#34;</text>
<text top="362" left="179" width="250" height="15" font="0">is used (the default) though it allows</text>
<text top="380" left="82" width="346" height="15" font="0">for the possibility. However, were one to use the in-</text>
<text top="398" left="82" width="346" height="15" font="0">correct smoothing spline model when the DGP is ad-</text>
<text top="416" left="82" width="346" height="15" font="0">ditive (e.g. assume interaction when it is not present),</text>
<text top="434" left="82" width="332" height="15" font="0">one could do worse than crs as can be seen in Table</text>
<text top="434" left="418" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="434" left="425" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">.</a></text>
<text top="452" left="82" width="346" height="15" font="0">But note that when the DGP is non-additive, crs ap-</text>
<text top="470" left="82" width="346" height="15" font="0">pears to be more efficient than the smoothing spline</text>
<text top="488" left="82" width="346" height="15" font="0">approaches even when they employ, say, tensor ba-</text>
<text top="506" left="82" width="346" height="15" font="0">sis functions to model the non-additive relationship</text>
<text top="524" left="82" width="346" height="15" font="0">and are adapted to admit the presence of the binary</text>
<text top="541" left="82" width="346" height="15" font="0">factor predictor (except gam which, as noted above,</text>
<text top="559" left="82" width="346" height="15" font="0">uses a number of knots k that is optimized for these</text>
<text top="577" left="82" width="346" height="15" font="0">DGPs, rather than the defaults which were used for</text>
<text top="595" left="82" width="346" height="15" font="0">all other methods). From a minimax perspective, the</text>
<text top="613" left="82" width="346" height="15" font="0">regression spline implementation in the <b>crs </b>package</text>
<text top="631" left="82" width="346" height="15" font="0">performs relatively well overall. Apart from select-</text>
<text top="649" left="82" width="346" height="15" font="0">ing the number of knots for gam as described above,</text>
<text top="667" left="82" width="346" height="15" font="0">default settings were used throughout and therefore</text>
<text top="685" left="82" width="346" height="15" font="0">it is likely that efficiency could be improved in some</text>
<text top="703" left="82" width="346" height="15" font="0">cases by further tuning (this would apply to crs as</text>
<text top="721" left="82" width="105" height="15" font="0">well, naturally).</text>
<text top="743" left="105" width="324" height="15" font="0">To elaborate further on the issue of tuning and ef-</text>
<text top="761" left="82" width="346" height="15" font="0">ficiency, if instead of using defaults for crs we were</text>
<text top="779" left="82" width="346" height="15" font="0">to assume additivity as done for its peers in columns</text>
<text top="796" left="82" width="139" height="15" font="0">2, 5, and 7 in Table</text>
<text top="796" left="228" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="796" left="242" width="187" height="15" font="0">(options basis=&#34;additive&#34;,</text>
<text top="816" left="82" width="91" height="12" font="0">kernel=FALSE</text>
<text top="814" left="174" width="255" height="15" font="0">), then for the additive DGP in Ta-</text>
<text top="832" left="82" width="20" height="15" font="0">ble</text>
<text top="832" left="111" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="832" left="127" width="302" height="15" font="0">the first row would instead be 0.94, 2.43,</text>
<text top="850" left="82" width="346" height="15" font="0">3.29, 1.00, 2.69, 0.98, and 1.08, and we observe that</text>
<text top="868" left="82" width="346" height="15" font="0">the efficiency of crs improves substantially even</text>
<text top="886" left="82" width="346" height="15" font="0">when using a stochastic choice of the B-spline de-</text>
<text top="904" left="82" width="346" height="15" font="0">gree and number of knots, while the other meth-</text>
<text top="922" left="82" width="346" height="15" font="0">ods use non-stochastic choices for the number of</text>
<text top="940" left="82" width="239" height="15" font="0">knots that are constant over all M</text>
<text top="940" left="327" width="12" height="14" font="9">=</text>
<text top="940" left="344" width="85" height="15" font="0">1, 000 Monte</text>
<text top="958" left="82" width="346" height="15" font="0">Carlo replications. And if we followed the lead of</text>
<text top="976" left="82" width="346" height="15" font="0">the anonymous referee who kindly suggested us-</text>
<text top="994" left="82" width="346" height="15" font="0">ing non-stochastic values for the number of knots</text>
<text top="1012" left="82" width="346" height="15" font="0">(i.e. k=5) for gam in <b>mgcv </b>based on replications from</text>
<text top="1030" left="82" width="300" height="15" font="0">the additive DGP used for row 1 of Table</text>
<text top="1030" left="390" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="1030" left="397" width="32" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">, </a>we</text>
<text top="1048" left="82" width="346" height="15" font="0">might choose non-stochastic values degree=c(4,4)</text>
<text top="1065" left="82" width="346" height="15" font="0">and segments=c(3,3) based on cross-validation and</text>
<text top="1083" left="82" width="142" height="15" font="0">the first row of Table</text>
<text top="1083" left="229" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="1083" left="242" width="187" height="15" font="0">would instead be 1.18, 3.09,</text>
<text top="1101" left="82" width="346" height="15" font="0">4.19, 1.25, 3.42, 1.22, and 1.36. Furthermore, if in ad-</text>
<text top="1119" left="82" width="346" height="15" font="0">dition we used the option prune=TRUE enabling post-</text>
<text top="1137" left="82" width="346" height="15" font="0">estimation pruning of the model, the first row of Ta-</text>
<text top="1155" left="82" width="20" height="15" font="0">ble</text>
<text top="1155" left="106" width="7" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#7">2</a></text>
<text top="1155" left="116" width="313" height="15" font="0">would instead be 1.48, 3.91, 5.35, 1.59, 4.28, 1.53,</text>
<text top="1173" left="82" width="346" height="15" font="0">and 1.72 (note that this can only be used in conjunc-</text>
<text top="125" left="459" width="346" height="15" font="0">tion with the option kernel=FALSE). The point to be</text>
<text top="143" left="459" width="346" height="15" font="0">made is that indeed efficiency can be improved in</text>
<text top="161" left="459" width="346" height="15" font="0">some cases by tuning of smoothing parameters and</text>
<text top="179" left="459" width="340" height="15" font="0">choice of the basis, and this also holds for crs itself.</text>
<text top="225" left="459" width="346" height="21" font="4"><b>Demos, data, and additional infor-</b></text>
<text top="252" left="459" width="69" height="21" font="4"><b>mation</b></text>
<text top="290" left="459" width="346" height="15" font="0">There exist a range of demonstrations available via</text>
<text top="309" left="459" width="46" height="12" font="0">demo()</text>
<text top="308" left="508" width="64" height="15" font="0">including</text>
<text top="335" left="478" width="328" height="15" font="0">1. radial_persp: R code for fitting and plotting a</text>
<text top="353" left="496" width="290" height="15" font="0">3D perspective plot for the ‘radial’ function.</text>
<text top="381" left="478" width="328" height="15" font="0">2. radial_rgl: R code for fitting and generating</text>
<text top="398" left="496" width="309" height="15" font="0">a 3D real-time rendering plot for the ‘radial’</text>
<text top="416" left="496" width="245" height="15" font="0">function using OpenGL (requires the</text>
<text top="416" left="746" width="19" height="15" font="5"><a href="http://cran.r-project.org/package=rgl"><b>rgl</b></a></text>
<text top="416" left="769" width="36" height="15" font="0">pack-</text>
<text top="434" left="496" width="32" height="15" font="0">age <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">(</a></text>
<text top="434" left="528" width="132" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">Adler and Murdoch</a></text>
<text top="434" left="660" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">,</a></text>
<text top="434" left="668" width="30" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">2012</a></text>
<text top="434" left="698" width="14" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#9">)).</a></text>
<text top="462" left="478" width="328" height="15" font="0">3. sine_rgl: R code for fitting and generating a</text>
<text top="480" left="496" width="309" height="15" font="0">3D real-time rendering plot for a product sine</text>
<text top="498" left="496" width="160" height="15" font="0">function using OpenGL.</text>
<text top="525" left="478" width="328" height="15" font="0">4. radial_constrained_mean: R code for con-</text>
<text top="543" left="496" width="232" height="15" font="0">strained radial function estimation.</text>
<text top="571" left="478" width="328" height="15" font="0">5. cqrs.R: R code for fitting and plotting quantile</text>
<text top="589" left="496" width="121" height="15" font="0">regression splines.</text>
<text top="616" left="481" width="281" height="15" font="0">There exist a number of datasets including</text>
<text top="643" left="478" width="328" height="15" font="0">1. cps71: Canadian cross-section wage data con-</text>
<text top="661" left="496" width="309" height="15" font="0">sisting of a random sample taken from the 1971</text>
<text top="679" left="496" width="309" height="15" font="0">Canadian Census Public Use Tapes for male</text>
<text top="696" left="496" width="309" height="15" font="0">individuals having common education (grade</text>
<text top="714" left="496" width="309" height="15" font="0">13). There are 205 observations in total (con-</text>
<text top="732" left="496" width="168" height="15" font="0">tributed by Aman Ullah).</text>
<text top="760" left="478" width="328" height="15" font="0">2. Engel95: British cross-section data consisting</text>
<text top="778" left="496" width="309" height="15" font="0">of a random sample taken from the British</text>
<text top="796" left="496" width="263" height="15" font="0">Family Expenditure Survey for 1995.</text>
<text top="796" left="780" width="25" height="15" font="0">The</text>
<text top="814" left="496" width="309" height="15" font="0">households consist of married couples with an</text>
<text top="832" left="496" width="309" height="15" font="0">employed head-of-household between the ages</text>
<text top="850" left="496" width="309" height="15" font="0">of 25 and 55 years. There are 1655 household-</text>
<text top="867" left="496" width="309" height="15" font="0">level observations in total (contributed by</text>
<text top="885" left="496" width="121" height="15" font="0">Richard Blundell).</text>
<text top="913" left="478" width="328" height="15" font="0">3. wage1: Cross-section wage data consisting of</text>
<text top="931" left="496" width="309" height="15" font="0">a random sample taken from the U.S. Current</text>
<text top="949" left="496" width="309" height="15" font="0">Population Survey for the year 1976. There are</text>
<text top="967" left="496" width="309" height="15" font="0">526 observations in total (contributed by Jeffrey</text>
<text top="985" left="496" width="87" height="15" font="0">Wooldridge).</text>
<text top="1012" left="481" width="324" height="15" font="0">We have tried to overload the crs method and as-</text>
<text top="1030" left="459" width="346" height="15" font="0">sociated S3 plot method to accommodate the needs</text>
<text top="1048" left="459" width="346" height="15" font="0">of a range of users and to automate a number of rou-</text>
<text top="1065" left="459" width="346" height="15" font="0">tine tasks. Warning messages are produced where</text>
<text top="1083" left="459" width="346" height="15" font="0">possible to guide the user towards the most appro-</text>
<text top="1101" left="459" width="346" height="15" font="0">priate choice of settings. User specified weights can</text>
<text top="1119" left="459" width="346" height="15" font="0">be provided to allow for weighted least squares and</text>
<text top="1137" left="459" width="346" height="15" font="0">weighted cross-validation. In addition, we have a</text>
<text top="1155" left="459" width="346" height="15" font="0">function crsiv that implements instrumental vari-</text>
<text top="1173" left="459" width="346" height="15" font="0">able regression splines that may be of interest to</text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="82" width="15" height="15" font="0">56</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="125" left="82" width="346" height="15" font="0">some users (see ?crsiv for details). Furthermore,</text>
<text top="143" left="82" width="346" height="15" font="0">quantile regression splines are supported by setting</text>
<text top="162" left="82" width="30" height="12" font="0">tau=</text>
<text top="161" left="118" width="138" height="15" font="0">a scalar in the range</text>
<text top="161" left="262" width="6" height="14" font="9">(</text>
<text top="161" left="268" width="20" height="15" font="0">0, 1</text>
<text top="161" left="288" width="6" height="14" font="9">)</text>
<text top="161" left="295" width="134" height="15" font="0">. Finally, we would</text>
<text top="179" left="82" width="346" height="15" font="0">like to direct the reader to the vignettes crs, crs_faq,</text>
<text top="197" left="82" width="346" height="15" font="0">and spline_primer for further examples, frequently</text>
<text top="215" left="82" width="308" height="15" font="0">asked questions, and background information.</text>
<text top="262" left="82" width="196" height="21" font="4"><b>Acknowledgements</b></text>
<text top="301" left="82" width="346" height="15" font="0">Racine would like to gratefully acknowledge support</text>
<text top="319" left="82" width="346" height="15" font="0">from the Natural Sciences and Engineering Research</text>
<text top="337" left="82" width="139" height="15" font="0">Council of Canada <a href="http://www.nserc.ca">(</a></text>
<text top="338" left="221" width="145" height="12" font="6"><a href="http://www.nserc.ca">http://www.nserc.ca</a></text>
<text top="337" left="366" width="63" height="15" font="0"><a href="http://www.nserc.ca">), </a>the So-</text>
<text top="355" left="82" width="346" height="15" font="0">cial Sciences and Humanities Research Council of</text>
<text top="373" left="82" width="60" height="15" font="0">Canada <a href="http://www.sshrc.ca">(</a></text>
<text top="374" left="143" width="145" height="12" font="6"><a href="http://www.sshrc.ca">http://www.sshrc.ca</a></text>
<text top="373" left="288" width="141" height="15" font="0"><a href="http://www.sshrc.ca">), </a>and the Shared Hi-</text>
<text top="391" left="82" width="346" height="15" font="0">erarchical Academic Research Computing Network</text>
<text top="409" left="82" width="5" height="15" font="0"><a href="http://www.sharcnet.ca">(</a></text>
<text top="410" left="87" width="168" height="12" font="6"><a href="http://www.sharcnet.ca">http://www.sharcnet.ca</a></text>
<text top="409" left="255" width="174" height="15" font="0"><a href="http://www.sharcnet.ca">). </a>We would also like to</text>
<text top="426" left="82" width="346" height="15" font="0">gratefully acknowledge Sébastien Le Digabel and</text>
<text top="444" left="82" width="346" height="15" font="0">members of the NOMAD project for their contributions</text>
<text top="462" left="82" width="346" height="15" font="0">to the FOSS community. Finally, we are indebted to</text>
<text top="480" left="82" width="346" height="15" font="0">the editors and two anonymous referees for their in-</text>
<text top="498" left="82" width="243" height="15" font="0">valuable comments and suggestions.</text>
<text top="546" left="82" width="130" height="21" font="4"><b>Bibliography</b></text>
<text top="584" left="82" width="346" height="15" font="0">M. Abramson, C. Audet, G. Couture, J. Dennis Jr.,</text>
<text top="602" left="97" width="332" height="15" font="0">and S. Le Digabel. The NOMAD project, 2011.</text>
<text top="620" left="97" width="31" height="15" font="0">URL</text>
<text top="622" left="131" width="191" height="12" font="6"><a href="http://www.gerad.ca/nomad">http://www.gerad.ca/nomad</a></text>
<text top="620" left="322" width="22" height="15" font="0"><a href="http://www.gerad.ca/nomad">. </a><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="620" left="343" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="620" left="358" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">,</a></text>
<text top="620" left="365" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">50</a></text>
<text top="620" left="380" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">,</a></text>
<text top="620" left="387" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">51</a></text>
<text top="620" left="402" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">,</a></text>
<text top="620" left="409" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">52</a></text>
<text top="620" left="424" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">]</a></text>
<text top="651" left="82" width="346" height="15" font="0">D. Adler and D. Murdoch. rgl: 3D visualization de-</text>
<text top="668" left="97" width="186" height="15" font="0">vice system (OpenGL), 2012.</text>
<text top="668" left="300" width="31" height="15" font="0">URL</text>
<text top="670" left="338" width="91" height="12" font="6"><a href="http://CRAN.R-project.org/package=rgl">http://CRAN.</a></text>
<text top="688" left="97" width="191" height="12" font="6"><a href="http://CRAN.R-project.org/package=rgl">R-project.org/package=rgl</a></text>
<text top="686" left="289" width="140" height="15" font="0"><a href="http://CRAN.R-project.org/package=rgl">. </a>R package version</text>
<text top="704" left="97" width="75" height="15" font="0">0.92.892. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#8">[p</a></text>
<text top="704" left="173" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#8">55</a></text>
<text top="704" left="188" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#8">]</a></text>
<text top="735" left="82" width="346" height="15" font="0">J. Aitchison and C. G. G. Aitken. Multivariate binary</text>
<text top="753" left="97" width="332" height="15" font="0">discrimination by the kernel method. Biometrika,</text>
<text top="771" left="97" width="149" height="15" font="0">63(3):413–420, 1976. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">[p</a></text>
<text top="771" left="246" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">50</a></text>
<text top="771" left="261" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">]</a></text>
<text top="801" left="82" width="346" height="15" font="0">P. Craven and G. Wahba. Smoothing noisy data with</text>
<text top="819" left="97" width="332" height="15" font="0">spline functions. Numerische Mathematik, 13:377–</text>
<text top="837" left="97" width="83" height="15" font="0">403, 1979. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="837" left="180" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="837" left="195" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">,</a></text>
<text top="837" left="203" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">51</a></text>
<text top="837" left="218" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">]</a></text>
<text top="867" left="82" width="346" height="15" font="0">M. Galassi, J. Davies, J. Theiler, B. Gough, G. Jung-</text>
<text top="885" left="97" width="280" height="15" font="0">man, P. Alken, M. Booth, and F. Rossi.</text>
<text top="885" left="395" width="34" height="15" font="0">GNU</text>
<text top="903" left="97" width="332" height="15" font="0">Scientific Library Reference Manual, third edition,</text>
<text top="921" left="97" width="129" height="15" font="0">January 2009. URL</text>
<text top="922" left="231" width="198" height="12" font="6"><a href="http://http://www.gnu.org/software/gsl/">http://http://www.gnu.org/</a></text>
<text top="940" left="97" width="99" height="12" font="6"><a href="http://http://www.gnu.org/software/gsl/">software/gsl/</a></text>
<text top="939" left="197" width="112" height="15" font="0"><a href="http://http://www.gnu.org/software/gsl/">. </a>Version 1.12. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="939" left="308" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="939" left="323" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="969" left="82" width="346" height="15" font="0">C. Gu. gss: General Smoothing Splines, 2012. URL</text>
<text top="988" left="97" width="283" height="12" font="6"><a href="http://CRAN.R-project.org/package=gss">http://CRAN.R-project.org/package=gss</a></text>
<text top="987" left="380" width="4" height="15" font="0"><a href="http://CRAN.R-project.org/package=gss">.</a></text>
<text top="987" left="419" width="10" height="15" font="0">R</text>
<text top="1005" left="97" width="165" height="15" font="0">package version 2.0-9. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="1005" left="262" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="1005" left="277" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="1035" left="82" width="221" height="15" font="0">P. Hall, J. S. Racine, and Q. Li.</text>
<text top="1035" left="320" width="109" height="15" font="0">Cross-validation</text>
<text top="1053" left="97" width="332" height="15" font="0">and the estimation of conditional probability den-</text>
<text top="1071" left="97" width="332" height="15" font="0">sities. Journal of the American Statistical Association,</text>
<text top="1089" left="97" width="179" height="15" font="0">99(468):1015–1026, 2004. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="1089" left="276" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="1089" left="291" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="1119" left="82" width="346" height="15" font="0">P. Hall, Q. Li, and J. S. Racine. Nonparametric esti-</text>
<text top="1137" left="97" width="332" height="15" font="0">mation of regression functions in the presence of</text>
<text top="1155" left="97" width="332" height="15" font="0">irrelevant regressors. The Review of Economics and</text>
<text top="1173" left="97" width="195" height="15" font="0">Statistics, 89:784–789, 2007. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="1173" left="292" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="1173" left="307" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="125" left="459" width="70" height="15" font="0">T. Hastie.</text>
<text top="125" left="560" width="29" height="15" font="0">gam:</text>
<text top="125" left="610" width="195" height="15" font="0">Generalized Additive Models,</text>
<text top="143" left="474" width="69" height="15" font="0">2011. URL</text>
<text top="144" left="545" width="260" height="12" font="6"><a href="http://CRAN.R-project.org/package=gam">http://CRAN.R-project.org/package=</a></text>
<text top="162" left="474" width="23" height="12" font="6"><a href="http://CRAN.R-project.org/package=gam">gam</a></text>
<text top="161" left="497" width="194" height="15" font="0"><a href="http://CRAN.R-project.org/package=gam">. </a>R package version 1.06.2. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="161" left="691" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="161" left="706" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="190" left="459" width="346" height="15" font="0">C. M. Hurvich, J. S. Simonoff, and C. L. Tsai. Smooth-</text>
<text top="208" left="474" width="332" height="15" font="0">ing parameter selection in nonparametric regres-</text>
<text top="226" left="474" width="332" height="15" font="0">sion using an improved Akaike information crite-</text>
<text top="244" left="474" width="332" height="15" font="0">rion. Journal of the Royal Statistical Society Series B,</text>
<text top="262" left="474" width="131" height="15" font="0">60:271–293, 1998. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="262" left="605" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="262" left="620" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">,</a></text>
<text top="262" left="628" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">51</a></text>
<text top="262" left="643" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">]</a></text>
<text top="291" left="459" width="346" height="15" font="0">S. Le Digabel. Algorithm 909: NOMAD: Nonlin-</text>
<text top="309" left="474" width="332" height="15" font="0">ear optimization with the MADS algorithm. ACM</text>
<text top="327" left="474" width="332" height="15" font="0">Transactions on Mathematical Software, 37(4):44:1–</text>
<text top="345" left="474" width="94" height="15" font="0">44:15, 2011. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="345" left="568" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="345" left="583" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">,</a></text>
<text top="345" left="590" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">50</a></text>
<text top="345" left="605" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#3">,</a></text>
<text top="345" left="613" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">51</a></text>
<text top="345" left="628" width="4" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#4">,</a></text>
<text top="345" left="635" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">52</a></text>
<text top="345" left="650" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">]</a></text>
<text top="375" left="459" width="346" height="15" font="0">S. Ma and J. S. Racine. Additive regression splines</text>
<text top="393" left="474" width="332" height="15" font="0">with irrelevant categorical and continuous regres-</text>
<text top="411" left="474" width="255" height="15" font="0">sors. Statistica Sinica, 2012. In Press. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="411" left="729" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="411" left="744" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="440" left="459" width="346" height="15" font="0">S. Ma, J. S. Racine, and L. Yang. Spline regression</text>
<text top="458" left="474" width="332" height="15" font="0">in the presence of categorical predictors. Journal of</text>
<text top="476" left="474" width="332" height="15" font="0">Multivariate Analysis, 2012. Revised and Resubmit-</text>
<text top="494" left="474" width="44" height="15" font="0">ted. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="494" left="518" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="494" left="533" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="523" left="459" width="346" height="15" font="0">J. S. Racine and Q. Li. Nonparametric estimation</text>
<text top="541" left="474" width="332" height="15" font="0">of regression functions with both categorical and</text>
<text top="559" left="474" width="332" height="15" font="0">continuous data. Journal of Econometrics, 119(1):99–</text>
<text top="577" left="474" width="83" height="15" font="0">130, 2004. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="577" left="557" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="577" left="572" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="606" left="459" width="346" height="15" font="0">C. J. Stone. Cross-validatory choice and assessment</text>
<text top="624" left="474" width="332" height="15" font="0">of statistical predictions (with discussion). Jour-</text>
<text top="642" left="474" width="332" height="15" font="0">nal of the Royal Statistical Society, 36:111–147, 1974.</text>
<text top="660" left="474" width="14" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="660" left="488" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="660" left="503" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="690" left="459" width="346" height="15" font="0">C. J. Stone. Consistent nonparametric regression. An-</text>
<text top="707" left="474" width="230" height="15" font="0">nals of Statistics, 5:595–645, 1977. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">[p</a></text>
<text top="707" left="704" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">48</a></text>
<text top="707" left="719" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#1">]</a></text>
<text top="737" left="459" width="346" height="15" font="0">A. Wächter and L. T. Biegler. On the implementa-</text>
<text top="755" left="474" width="332" height="15" font="0">tion of an interior-point filter line-search algorithm</text>
<text top="773" left="474" width="332" height="15" font="0">for large-scale nonlinear programming. Mathemat-</text>
<text top="791" left="474" width="288" height="15" font="0">ical Programming, 106(1):25–57, 2006. URL</text>
<text top="792" left="767" width="38" height="12" font="6"><a href="http://projects.coin-or.org/ipopt">http:</a></text>
<text top="810" left="474" width="214" height="12" font="6"><a href="http://projects.coin-or.org/ipopt">//projects.coin-or.org/ipopt</a></text>
<text top="809" left="688" width="23" height="15" font="0"><a href="http://projects.coin-or.org/ipopt">. </a><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">[p</a></text>
<text top="809" left="711" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">52</a></text>
<text top="809" left="726" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#5">]</a></text>
<text top="838" left="459" width="346" height="15" font="0">G. Wahba. Spline Models for Observational Data. SIAM,</text>
<text top="856" left="474" width="53" height="15" font="0">1990. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="856" left="527" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="856" left="542" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="885" left="459" width="72" height="15" font="0">M. Wand.</text>
<text top="885" left="561" width="55" height="15" font="0">SemiPar:</text>
<text top="885" left="636" width="170" height="15" font="0">Semiparametic Regression,</text>
<text top="903" left="474" width="69" height="15" font="0">2010. URL</text>
<text top="905" left="545" width="260" height="12" font="6"><a href="http://CRAN.R-project.org/package=SemiPar">http://CRAN.R-project.org/package=</a></text>
<text top="923" left="474" width="53" height="12" font="6"><a href="http://CRAN.R-project.org/package=SemiPar">SemiPar</a></text>
<text top="921" left="527" width="188" height="15" font="0"><a href="http://CRAN.R-project.org/package=SemiPar">. </a>R package version 1.0-3. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="921" left="715" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="921" left="730" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="951" left="459" width="346" height="15" font="0">S. Wood. Generalized Additive Models: An Introduction</text>
<text top="968" left="474" width="277" height="15" font="0">with R. Chapman and Hall/CRC, 2006. <a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="969" left="751" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="969" left="766" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="998" left="459" width="346" height="15" font="0">S. Zhou and D. A. Wolfe. On derivative estimation in</text>
<text top="1016" left="474" width="332" height="15" font="0">spline regression. Statistica Sinica, 10:93–108, 2000.</text>
<text top="1034" left="474" width="14" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">[p</a></text>
<text top="1034" left="488" width="15" height="15" font="6"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">49</a></text>
<text top="1034" left="503" width="5" height="15" font="0"><a href="2012-2-RJournal_2012-2_Nie+S~Racine.html#2">]</a></text>
<text top="1083" left="459" width="193" height="15" font="0">Jeffrey S. Racine, Zhenghua Nie</text>
<text top="1101" left="459" width="133" height="15" font="0">McMaster University</text>
<text top="1119" left="459" width="261" height="15" font="0">1280 Main Street West, Hamilton, Ontario</text>
<text top="1137" left="459" width="46" height="15" font="0">Canada</text>
<text top="1156" left="459" width="145" height="12" font="6"><a href="mailto:racinej@mcmaster.ca">racinej@mcmaster.ca</a></text>
<text top="1174" left="459" width="122" height="12" font="6"><a href="mailto:niez@mcmaster.ca">niez@mcmaster.ca</a></text>
<text top="1218" left="82" width="257" height="15" font="0">The R Journal Vol. 4/2, December 2012</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
</pdf2xml>
