<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml producer="poppler" version="0.30.0">
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="12" family="Times" color="#000000"/>
	<fontspec id="1" size="9" family="Times" color="#000000"/>
	<fontspec id="2" size="35" family="Times" color="#000000"/>
	<fontspec id="3" size="12" family="Times" color="#000000"/>
	<fontspec id="4" size="19" family="Times" color="#000000"/>
	<fontspec id="5" size="12" family="Times" color="#00004c"/>
	<fontspec id="6" size="12" family="Times" color="#00004c"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">35</text>
<text top="121" left="82" width="572" height="36" font="2"><b>rworldmap: A New R package for</b></text>
<text top="166" left="82" width="374" height="36" font="2"><b>Mapping Global Data</b></text>
<text top="218" left="82" width="92" height="15" font="0">by Andy South</text>
<text top="253" left="96" width="57" height="15" font="3"><b>Abstract</b></text>
<text top="253" left="169" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="253" left="250" width="165" height="15" font="0">is a relatively new pack-</text>
<text top="271" left="96" width="319" height="15" font="0">age available on CRAN for the mapping and vi-</text>
<text top="289" left="96" width="319" height="15" font="0">sualisation of global data. The vision is to make</text>
<text top="307" left="96" width="319" height="15" font="0">the display of global data easier, to facilitate un-</text>
<text top="325" left="96" width="319" height="15" font="0">derstanding and communication. The initial fo-</text>
<text top="343" left="96" width="319" height="15" font="0">cus is on data referenced by country or grid due</text>
<text top="361" left="96" width="319" height="15" font="0">to the frequency of use of such data in global as-</text>
<text top="379" left="96" width="319" height="15" font="0">sessments. Tools to link data referenced by coun-</text>
<text top="397" left="96" width="319" height="15" font="0">try (either name or code) to a map, and then to</text>
<text top="415" left="96" width="319" height="15" font="0">display the map are provided as are functions to</text>
<text top="433" left="96" width="319" height="15" font="0">map global gridded data. Country and gridded</text>
<text top="450" left="96" width="319" height="15" font="0">functions accept the same arguments to specify</text>
<text top="468" left="96" width="319" height="15" font="0">the nature of categories and colour and how leg-</text>
<text top="486" left="96" width="319" height="15" font="0">ends are formatted. This package builds on the</text>
<text top="504" left="96" width="319" height="15" font="0">functionality of existing packages, particularly</text>
<text top="522" left="96" width="16" height="15" font="3"><b>sp</b></text>
<text top="522" left="112" width="303" height="15" font="0">, <b>maptools </b>and <b>fields</b>. Example code is pro-</text>
<text top="540" left="96" width="319" height="15" font="0">vided to produce maps, to link with the pack-</text>
<text top="558" left="96" width="319" height="15" font="0">ages <b>classInt</b>, <b>RColorBrewer </b>and <b>ncdf</b>, and to</text>
<text top="576" left="96" width="319" height="15" font="0">plot examples of publicly available country and</text>
<text top="594" left="96" width="90" height="15" font="0">gridded data.</text>
<text top="647" left="82" width="124" height="21" font="4"><b>Introduction</b></text>
<text top="688" left="82" width="346" height="15" font="0">Global datasets are becoming increasingly common</text>
<text top="706" left="82" width="346" height="15" font="0">and are frequently seen on the web, in journal pa-</text>
<text top="724" left="82" width="346" height="15" font="0">pers and in our newspapers (for example a ’carbon</text>
<text top="741" left="82" width="244" height="15" font="0">atlas’ of global emissions available at</text>
<text top="743" left="330" width="99" height="12" font="5"><a href="http://image.guardian.co.uk/sys-files/Guardian/documents/2007/12/17/CARBON_ATLAS.pdf">http://image.</a></text>
<text top="761" left="82" width="336" height="12" font="5"><a href="http://image.guardian.co.uk/sys-files/Guardian/documents/2007/12/17/CARBON_ATLAS.pdf">guardian.co.uk/sys-files/Guardian/documents/</a></text>
<text top="779" left="82" width="206" height="12" font="5"><a href="http://image.guardian.co.uk/sys-files/Guardian/documents/2007/12/17/CARBON_ATLAS.pdf">2007/12/17/CARBON_ATLAS.pdf</a></text>
<text top="777" left="288" width="141" height="15" font="0"><a href="http://image.guardian.co.uk/sys-files/Guardian/documents/2007/12/17/CARBON_ATLAS.pdf">). </a>At the same time</text>
<text top="795" left="82" width="346" height="15" font="0">there is a greater interest in global issues such as cli-</text>
<text top="813" left="82" width="346" height="15" font="0">mate change, the global economy, and poverty (as</text>
<text top="831" left="82" width="346" height="15" font="0">for example outlined in the Millenium Development</text>
<text top="849" left="82" width="41" height="15" font="0">Goals,</text>
<text top="850" left="132" width="297" height="12" font="5"><a href="http://www.un.org/millenniumgoals/bkgd.shtml">http://www.un.org/millenniumgoals/bkgd.</a></text>
<text top="868" left="82" width="38" height="12" font="5"><a href="http://www.un.org/millenniumgoals/bkgd.shtml">shtml</a></text>
<text top="867" left="121" width="308" height="15" font="0"><a href="http://www.un.org/millenniumgoals/bkgd.shtml">). </a>Thirdly, there is an increasing availability of</text>
<text top="885" left="82" width="346" height="15" font="0">software tools for visualising data in new and inter-</text>
<text top="903" left="82" width="186" height="15" font="0">esting ways. Gapminder <a href="http://www.gapminder.org">(</a></text>
<text top="904" left="269" width="160" height="12" font="5"><a href="http://www.gapminder.org">http://www.gapminder.</a></text>
<text top="922" left="82" width="23" height="12" font="5"><a href="http://www.gapminder.org">org</a></text>
<text top="921" left="105" width="324" height="15" font="0"><a href="http://www.gapminder.org">) </a>has pioneered making UN statistics more avail-</text>
<text top="939" left="82" width="346" height="15" font="0">able and intelligible using innovative visualisation</text>
<text top="957" left="82" width="165" height="15" font="0">tools and Many Eyes <a href="http://www-958.ibm.com/">(</a></text>
<text top="958" left="248" width="176" height="12" font="5"><a href="http://www-958.ibm.com/">http://www-958.ibm.com/</a></text>
<text top="957" left="424" width="5" height="15" font="0"><a href="http://www-958.ibm.com/">)</a></text>
<text top="975" left="82" width="346" height="15" font="0">provides a very impressive interface for sharing data</text>
<text top="993" left="82" width="180" height="15" font="0">and creating visualisations.</text>
<text top="1012" left="105" width="324" height="15" font="0">World maps have become so common that they</text>
<text top="1030" left="82" width="183" height="15" font="0">have even attracted satire.</text>
<text top="1030" left="282" width="147" height="15" font="0">The Onion’s Atlas of</text>
<text top="1048" left="82" width="116" height="15" font="0">the Planet Earth <a href="2011-1-RJournal_2011-1_South.html#8">(</a></text>
<text top="1048" left="198" width="71" height="15" font="5"><a href="2011-1-RJournal_2011-1_South.html#8">The Onion</a></text>
<text top="1048" left="269" width="4" height="15" font="0"><a href="2011-1-RJournal_2011-1_South.html#8">,</a></text>
<text top="1048" left="277" width="30" height="15" font="5"><a href="2011-1-RJournal_2011-1_South.html#8">2007</a></text>
<text top="1048" left="307" width="122" height="15" font="0"><a href="2011-1-RJournal_2011-1_South.html#8">), </a>contains a ’Bono</text>
<text top="1065" left="82" width="346" height="15" font="0">Awareness’ world map representing ’the intensity</text>
<text top="1083" left="82" width="346" height="15" font="0">with which artist Bono is aware of the plight and</text>
<text top="1101" left="82" width="346" height="15" font="0">daily struggles of region’, with a categorisation rang-</text>
<text top="1119" left="82" width="346" height="15" font="0">ing from ’has heard of nation once’ through ’moved</text>
<text top="1137" left="82" width="346" height="15" font="0">enough by nations crisis to momentarily remove sun-</text>
<text top="1155" left="82" width="346" height="15" font="0">glasses’ to ’cares about welfare of nation nearly as</text>
<text top="1173" left="82" width="119" height="15" font="0">much as his own’.</text>
<text top="218" left="481" width="324" height="15" font="0">There appears to be a gap in the market for</text>
<text top="236" left="459" width="346" height="15" font="0">free software tools that can be used across disci-</text>
<text top="254" left="459" width="346" height="15" font="0">plinary boundaries to produce innovative, publica-</text>
<text top="271" left="459" width="346" height="15" font="0">tion quality global visualisations. Within R there are</text>
<text top="289" left="459" width="227" height="15" font="0">great building blocks (particularly</text>
<text top="289" left="689" width="16" height="15" font="6"><a href="http://cran.r-project.org/package=sp"><b>sp</b></a></text>
<text top="289" left="705" width="4" height="15" font="0"><a href="http://cran.r-project.org/package=sp">,</a></text>
<text top="289" left="713" width="63" height="15" font="6"><a href="http://cran.r-project.org/package=maptools"><b>maptools</b></a></text>
<text top="289" left="780" width="25" height="15" font="0">and</text>
<text top="307" left="459" width="37" height="15" font="6"><a href="http://cran.r-project.org/package=fields"><b>fields</b></a></text>
<text top="307" left="496" width="309" height="15" font="0"><a href="http://cran.r-project.org/package=fields">) </a>for spatial data but users previously had to go</text>
<text top="325" left="459" width="346" height="15" font="0">through a number of steps if they wanted to produce</text>
<text top="343" left="459" width="346" height="15" font="0">world maps of their own data. Experience has shown</text>
<text top="361" left="459" width="346" height="15" font="0">that difficulties with linking data and creating classi-</text>
<text top="379" left="459" width="346" height="15" font="0">fications, colour schemes and legends, currently con-</text>
<text top="397" left="459" width="346" height="15" font="0">strains researchers’ ability to view and display global</text>
<text top="415" left="459" width="346" height="15" font="0">data. We aim to reduce that constraint to allow re-</text>
<text top="433" left="459" width="346" height="15" font="0">searchers to spend more time on the more important</text>
<text top="451" left="459" width="346" height="15" font="0">issue of what they want to display. The vision for</text>
<text top="469" left="459" width="76" height="15" font="6"><a href="http://cran.r-project.org/package=rworldmap"><b>rworldmap</b></a></text>
<text top="469" left="540" width="265" height="15" font="0">is to produce a package to facilitate the</text>
<text top="487" left="459" width="346" height="15" font="0">visualisation and mapping of global data. Because</text>
<text top="505" left="459" width="346" height="15" font="0">the focus is on global data, the package can be more</text>
<text top="523" left="459" width="346" height="15" font="0">specialised than existing packages, making world</text>
<text top="540" left="459" width="346" height="15" font="0">mapping easier, partly because it doesn’t have to deal</text>
<text top="558" left="459" width="346" height="15" font="0">with detailed local maps. Through <b>rworldmap </b>we</text>
<text top="576" left="459" width="346" height="15" font="0">aim to make it easy for R users to explore their global</text>
<text top="594" left="459" width="346" height="15" font="0">data and also to produce publication quality figures</text>
<text top="612" left="459" width="125" height="15" font="0">from their outputs.</text>
<text top="689" left="481" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="689" left="569" width="236" height="15" font="0">was partly inspired and largely</text>
<text top="707" left="459" width="346" height="15" font="0">funded by the UK Natural Environment Research</text>
<text top="725" left="459" width="346" height="15" font="0">Council (NERC) program Quantifying Uncertainty</text>
<text top="743" left="459" width="185" height="15" font="0">in Earth System Science <a href="http://quest.bris.ac.uk">(</a></text>
<text top="743" left="644" width="50" height="15" font="5"><a href="http://quest.bris.ac.uk">QUEST</a></text>
<text top="743" left="693" width="112" height="15" font="0"><a href="http://quest.bris.ac.uk">). </a>This program</text>
<text top="761" left="459" width="346" height="15" font="0">brings together scientists from a wide range of dis-</text>
<text top="779" left="459" width="346" height="15" font="0">ciplines including climate modellers, hydrologists</text>
<text top="796" left="459" width="141" height="15" font="0">and social scientists.</text>
<text top="796" left="617" width="189" height="15" font="0">It was apparent that while</text>
<text top="814" left="459" width="346" height="15" font="0">researchers have common tools for visualisation</text>
<text top="832" left="459" width="346" height="15" font="0">within disciplines, they tend to use different ones</text>
<text top="850" left="459" width="346" height="15" font="0">across disciplines and that this limits the sharing</text>
<text top="868" left="459" width="346" height="15" font="0">of data and methods necessary for truly interdis-</text>
<text top="886" left="459" width="346" height="15" font="0">ciplinary research. Within the project, climate and</text>
<text top="904" left="459" width="346" height="15" font="0">earth system modellers tended to use IDL, ecologists</text>
<text top="922" left="459" width="346" height="15" font="0">ArcGIS, hydrologists and social scientists Matlab and</text>
<text top="940" left="459" width="346" height="15" font="0">fisheries scientists R. With the exception of R, these</text>
<text top="958" left="459" width="346" height="15" font="0">software products cost thousands of pounds which</text>
<text top="976" left="459" width="346" height="15" font="0">acts as a considerable constraint on users being able</text>
<text top="994" left="459" width="346" height="15" font="0">to try out techniques used by collaborators. This</text>
<text top="1012" left="459" width="346" height="15" font="0">high cost and learning curve of adopting new soft-</text>
<text top="1030" left="459" width="346" height="15" font="0">ware tools hinders the sharing of data and methods</text>
<text top="1048" left="459" width="346" height="15" font="0">between disciplines. To address this, part of the vi-</text>
<text top="1065" left="459" width="346" height="15" font="0">sion for <b>rworldmap </b>was to develop a tool that can be</text>
<text top="1083" left="459" width="346" height="15" font="0">freely used and modified across a multi-disciplinary</text>
<text top="1101" left="459" width="346" height="15" font="0">project, to facilitate the sharing of scripts, data and</text>
<text top="1119" left="459" width="346" height="15" font="0">outputs. Such freely available software offers greater</text>
<text top="1137" left="459" width="346" height="15" font="0">opportunity for collaboration with research institutes</text>
<text top="1155" left="459" width="346" height="15" font="0">in developing countries that may not be able to af-</text>
<text top="1173" left="459" width="156" height="15" font="0">ford expensive licenses.</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="7" size="15" family="Times" color="#000000"/>
	<fontspec id="8" size="11" family="Times" color="#000000"/>
	<fontspec id="9" size="13" family="Times" color="#000000"/>
<text top="67" left="82" width="15" height="15" font="0">36</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="121" left="82" width="226" height="21" font="4"><b>rworldmap data inputs</b></text>
<text top="163" left="82" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="163" left="164" width="265" height="15" font="0">consists of tools to visualise global data</text>
<text top="181" left="82" width="346" height="15" font="0">and focuses on two types of data. Firstly, data that</text>
<text top="199" left="82" width="346" height="15" font="0">are referenced by country codes or names and sec-</text>
<text top="217" left="82" width="267" height="15" font="0">ondly, data that are referenced on a grid.</text>
<text top="268" left="82" width="107" height="17" font="7"><b>Country data</b></text>
<text top="302" left="82" width="346" height="15" font="0">There is a wealth of global country level data avail-</text>
<text top="320" left="82" width="346" height="15" font="0">able on the internet including UN population data,</text>
<text top="338" left="82" width="301" height="15" font="0">and many global indices for, among others:</text>
<text top="338" left="393" width="36" height="15" font="5"><a href="http://epi.yale.edu/Files">Envi-</a></text>
<text top="356" left="82" width="158" height="15" font="5"><a href="http://epi.yale.edu/Files">ronmental Performance</a></text>
<text top="356" left="240" width="4" height="15" font="0"><a href="http://epi.yale.edu/Files">,</a></text>
<text top="356" left="250" width="101" height="15" font="5"><a href="http://www.ifpri.org/publication/2010-global-hunger-index">Global Hunger</a></text>
<text top="356" left="357" width="25" height="15" font="0">and</text>
<text top="356" left="387" width="42" height="15" font="5"><a href="http://www.ophi.org.uk/policy/multidimensional-poverty-index/">Multi-</a></text>
<text top="374" left="82" width="137" height="15" font="5"><a href="http://www.ophi.org.uk/policy/multidimensional-poverty-index/">dimensional Poverty</a></text>
<text top="374" left="220" width="4" height="15" font="0"><a href="http://www.ophi.org.uk/policy/multidimensional-poverty-index/">.</a></text>
<text top="393" left="105" width="324" height="15" font="0">Data are commonly referenced by country names</text>
<text top="411" left="82" width="346" height="15" font="0">as these are the most easily recognised by users,</text>
<text top="429" left="82" width="346" height="15" font="0">but country names have the problem that vocabu-</text>
<text top="447" left="82" width="346" height="15" font="0">laries are not well conserved and many countries</text>
<text top="465" left="82" width="346" height="15" font="0">have a number of subtly different alternate names</text>
<text top="483" left="82" width="346" height="15" font="0">(e.g. Ivory Coast and Cote d’Ivoire, Laos and Peo-</text>
<text top="501" left="82" width="346" height="15" font="0">ple’s Democratic Republic of Lao). To address this</text>
<text top="519" left="82" width="346" height="15" font="0">problem there are ISO standard country codes of ei-</text>
<text top="537" left="82" width="346" height="15" font="0">ther 2 letters, 3 letters or numeric, and also 2 letter</text>
<text top="555" left="82" width="346" height="15" font="0">FIPS country codes, so there is still not one univer-</text>
<text top="573" left="82" width="346" height="15" font="0">sally adopted standard. <b>rworldmap </b>supports all of</text>
<text top="590" left="82" width="346" height="15" font="0">these country codes and offers tools to help when</text>
<text top="608" left="82" width="324" height="15" font="0">data are referenced by names or other identifiers.</text>
<text top="660" left="82" width="109" height="17" font="7"><b>Gridded data</b></text>
<text top="693" left="82" width="346" height="15" font="0">Global datasets are frequently spatially referenced</text>
<text top="711" left="82" width="346" height="15" font="0">on a grid, because such gridded or raster data for-</text>
<text top="729" left="82" width="346" height="15" font="0">mats offer advantages in efficiency of data storage</text>
<text top="747" left="82" width="346" height="15" font="0">and processing. Remotely sensed data and other val-</text>
<text top="765" left="82" width="346" height="15" font="0">ues calculated from it are most frequently available</text>
<text top="783" left="82" width="346" height="15" font="0">in gridded formats. These can include terrestrial or</text>
<text top="801" left="82" width="135" height="15" font="0">marine data or both.</text>
<text top="821" left="105" width="324" height="15" font="0">There are many gridded data formats, here I will</text>
<text top="839" left="82" width="321" height="15" font="0">concentrate on two: ESRI GridAscii and netCDF.</text>
<text top="858" left="105" width="324" height="15" font="0">ESRI GridAscii files are an efficient way of storing</text>
<text top="876" left="82" width="346" height="15" font="0">and transferring gridded data. They are straightfor-</text>
<text top="894" left="82" width="346" height="15" font="0">ward text files so can be opened by any text editor.</text>
<text top="912" left="82" width="346" height="15" font="0">They have a short header defining the structure of</text>
<text top="930" left="82" width="346" height="15" font="0">the file (e.g. number, size and position of rows and</text>
<text top="948" left="82" width="346" height="15" font="0">columns), followed by a single row specifying the</text>
<text top="966" left="82" width="346" height="15" font="0">value at each grid cell. Thus they use much less space</text>
<text top="984" left="82" width="346" height="15" font="0">than if the coordinates for each cell had to be speci-</text>
<text top="1002" left="82" width="29" height="15" font="0">fied.</text>
<text top="1021" left="105" width="324" height="15" font="0">Example start of gridAscii file for a half degree</text>
<text top="1039" left="82" width="76" height="15" font="0">global grid:</text>
<text top="1077" left="89" width="34" height="10" font="8">ncols</text>
<text top="1077" left="137" width="21" height="10" font="8">720</text>
<text top="1093" left="89" width="34" height="10" font="8">nrows</text>
<text top="1093" left="137" width="21" height="10" font="8">360</text>
<text top="1110" left="89" width="96" height="10" font="8">xllcorner -180</text>
<text top="1126" left="89" width="89" height="10" font="8">yllcorner -90</text>
<text top="1142" left="89" width="55" height="10" font="8">cellsize</text>
<text top="1142" left="158" width="21" height="10" font="8">0.5</text>
<text top="1159" left="89" width="117" height="10" font="8">NODATA_value -999</text>
<text top="1175" left="89" width="281" height="10" font="8">-999 1 0 1 1 ... [all 259200 cell values]</text>
<text top="125" left="481" width="324" height="15" font="0">NetCDF is a data storage file format com-</text>
<text top="143" left="459" width="346" height="15" font="0">monly used by climate scientists and oceanogra-</text>
<text top="161" left="459" width="346" height="15" font="0">phers. NetCDF files can be multi-dimensional, e.g.</text>
<text top="179" left="459" width="52" height="15" font="0">holding</text>
<text top="179" left="515" width="6" height="14" font="9">(</text>
<text top="179" left="522" width="21" height="15" font="0">x, y</text>
<text top="179" left="543" width="6" height="14" font="9">)</text>
<text top="179" left="554" width="251" height="15" font="0">data for multiple attributes over mul-</text>
<text top="197" left="459" width="294" height="15" font="0">tiple months, years, days etc. The package</text>
<text top="197" left="758" width="31" height="15" font="6"><a href="http://cran.r-project.org/package=ncdf"><b>ncdf</b></a></text>
<text top="197" left="795" width="11" height="15" font="0">is</text>
<text top="215" left="459" width="269" height="15" font="0">good for reading data from netCDF files.</text>
<text top="260" left="459" width="243" height="21" font="4"><b>rworldmap functionality</b></text>
<text top="299" left="459" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="299" left="540" width="265" height="15" font="0">has three core functions outlined below</text>
<text top="317" left="459" width="228" height="15" font="0">and others that are described later.</text>
<text top="341" left="478" width="328" height="15" font="0">1. joinCountryData2Map() joins user country</text>
<text top="359" left="496" width="309" height="15" font="0">data referenced by country names or codes to</text>
<text top="377" left="496" width="161" height="15" font="0">a map to enable plotting</text>
<text top="404" left="478" width="327" height="15" font="0">2. mapCountryData() plots a map of country data</text>
<text top="432" left="478" width="328" height="15" font="0">3. mapGriddedData() plots a map of gridded data</text>
<text top="472" left="459" width="242" height="17" font="7"><b>Joining country data to a map</b></text>
<text top="502" left="459" width="346" height="15" font="0">To join the data to a map use joinCountryData2Map.</text>
<text top="520" left="459" width="346" height="15" font="0">You will need to specify the name of column contain-</text>
<text top="538" left="459" width="346" height="15" font="0">ing your country identifiers (nameJoinColumn) and</text>
<text top="556" left="459" width="346" height="15" font="0">the type of code used (joinCode) e.g. &#34;ISO3&#34; for ISO</text>
<text top="574" left="459" width="325" height="15" font="0">3 letter codes or &#34;UN&#34; for numeric country codes.</text>
<text top="601" left="459" width="130" height="10" font="8">data(countryExData)</text>
<text top="617" left="459" width="288" height="10" font="8">sPDF &lt;- joinCountryData2Map( countryExData</text>
<text top="634" left="521" width="123" height="10" font="8">,joinCode = &#34;ISO3&#34;</text>
<text top="650" left="521" width="192" height="10" font="8">,nameJoinColumn = &#34;ISO3V10&#34;)</text>
<text top="674" left="459" width="346" height="15" font="0">This code outputs, to the R console, a summary of</text>
<text top="692" left="459" width="346" height="15" font="0">how many countries are successfully joined. You can</text>
<text top="710" left="459" width="346" height="15" font="0">specify verbose=TRUE to get a full list of countries.</text>
<text top="728" left="459" width="346" height="15" font="0">The object returned (named sPDF in this case) is of</text>
<text top="746" left="459" width="346" height="15" font="0">type &#34;SpatialPolygonsDataFrame&#34; from the package</text>
<text top="764" left="459" width="16" height="15" font="3"><b>sp</b></text>
<text top="764" left="475" width="331" height="15" font="0">. This object is required for the next step, display-</text>
<text top="782" left="459" width="83" height="15" font="0">ing the map.</text>
<text top="800" left="481" width="324" height="15" font="0">If you only have country names rather than codes</text>
<text top="818" left="459" width="346" height="15" font="0">in your data, use joinCode=&#34;NAME&#34;; you can expect</text>
<text top="836" left="459" width="346" height="15" font="0">more mismatches due to the greater variation within</text>
<text top="853" left="459" width="346" height="15" font="0">country names mentioned previously. To address</text>
<text top="871" left="459" width="346" height="15" font="0">this you can use the identifyCountries() function</text>
<text top="889" left="459" width="346" height="15" font="0">described below, and change any country names in</text>
<text top="907" left="459" width="346" height="15" font="0">your data that do not exactly match those in the in-</text>
<text top="925" left="459" width="76" height="15" font="0">ternal map.</text>
<text top="966" left="459" width="182" height="17" font="7"><b>Mapping country data</b></text>
<text top="996" left="459" width="346" height="15" font="0">To plot anything other than the default map,</text>
<text top="1015" left="459" width="107" height="12" font="0">mapCountryData</text>
<text top="1014" left="583" width="54" height="15" font="0">requires</text>
<text top="1014" left="654" width="16" height="15" font="0">an</text>
<text top="1014" left="688" width="39" height="15" font="0">object</text>
<text top="1014" left="744" width="13" height="15" font="0">of</text>
<text top="1014" left="774" width="31" height="15" font="0">class</text>
<text top="1033" left="459" width="198" height="12" font="0">&#34;SpatialPolygonsDataFrame&#34;</text>
<text top="1032" left="662" width="143" height="15" font="0">and a specification of</text>
<text top="1050" left="459" width="338" height="15" font="0">the name of the column containing the data to plot:</text>
<text top="1077" left="459" width="130" height="10" font="8">data(countryExData)</text>
<text top="1093" left="459" width="288" height="10" font="8">sPDF &lt;- joinCountryData2Map( countryExData</text>
<text top="1110" left="521" width="123" height="10" font="8">,joinCode = &#34;ISO3&#34;</text>
<text top="1126" left="521" width="192" height="10" font="8">,nameJoinColumn = &#34;ISO3V10&#34;)</text>
<text top="1142" left="459" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="1159" left="459" width="130" height="10" font="8">mapCountryData(sPDF</text>
<text top="1175" left="555" width="229" height="10" font="8">,nameColumnToPlot='BIODIVERSITY')</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="10" size="4" family="Helvetica" color="#000000"/>
	<fontspec id="11" size="5" family="Helvetica" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">37</text>
<text top="285" left="95" width="9" height="6" font="10">0.2</text>
<text top="285" left="400" width="11" height="6" font="10">100</text>
<text top="122" left="227" width="52" height="7" font="11"><b>BIODIVERSITY</b></text>
<text top="320" left="127" width="258" height="15" font="0">Figure 1: Output of mapCountryData()</text>
<text top="360" left="82" width="184" height="17" font="7"><b>Mapping gridded data</b></text>
<text top="390" left="82" width="308" height="15" font="0">The mapGriddedData function can accept either</text>
<text top="420" left="101" width="328" height="15" font="0">1. an object of type &#34;SpatialGridDataFrame&#34;, as</text>
<text top="438" left="120" width="169" height="15" font="0">defined in the package <b>sp</b></text>
<text top="468" left="101" width="328" height="15" font="0">2. the name of an ESRI GridAscii file as a charac-</text>
<text top="486" left="120" width="60" height="15" font="0">ter string</text>
<text top="515" left="101" width="293" height="15" font="0">3. a 2D R matrix or array (rows by columns)</text>
<text top="545" left="105" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="545" left="187" width="242" height="15" font="0">contains a &#34;SpatialGridDataFrame&#34;</text>
<text top="563" left="82" width="346" height="15" font="0">example that can be accessed and mapped as shown</text>
<text top="581" left="82" width="191" height="15" font="0">in the code and figure below.</text>
<text top="614" left="96" width="110" height="10" font="8">data(gridExData)</text>
<text top="631" left="96" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="647" left="96" width="178" height="10" font="8">mapGriddedData(gridExData)</text>
<text top="838" left="98" width="4" height="6" font="10">0</text>
<text top="838" left="392" width="28" height="6" font="10">27350000</text>
<text top="873" left="126" width="259" height="15" font="0">Figure 2: Output of mapGriddedData()</text>
<text top="913" left="82" width="226" height="17" font="7"><b>Modifying map appearance</b></text>
<text top="943" left="82" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="943" left="166" width="263" height="15" font="0">plotting functions are set up to work</text>
<text top="961" left="82" width="346" height="15" font="0">with few parameters specified (usually just those</text>
<text top="979" left="82" width="346" height="15" font="0">identifying the data) and in such cases, default val-</text>
<text top="997" left="82" width="346" height="15" font="0">ues will be used. However, there is considerable flex-</text>
<text top="1015" left="82" width="346" height="15" font="0">ibility to modify the appearance of plots by specify-</text>
<text top="1033" left="82" width="346" height="15" font="0">ing values for arguments. Details of argument op-</text>
<text top="1051" left="82" width="346" height="15" font="0">tions are provided in the help files but here are a se-</text>
<text top="1069" left="82" width="201" height="15" font="0">lection of the main arguments:</text>
<text top="1101" left="103" width="326" height="15" font="0">• catMethod determines how the data values</text>
<text top="1119" left="120" width="309" height="15" font="0">are put into categories (then colourPalette</text>
<text top="1137" left="120" width="74" height="15" font="0">determines</text>
<text top="1137" left="210" width="21" height="15" font="0">the</text>
<text top="1137" left="247" width="49" height="15" font="0">colours</text>
<text top="1137" left="311" width="19" height="15" font="0">for</text>
<text top="1137" left="347" width="35" height="15" font="0">those</text>
<text top="1137" left="398" width="31" height="15" font="0">cate-</text>
<text top="1155" left="120" width="309" height="15" font="0">gories). Options for catMethod are: &#34;pretty&#34;,</text>
<text top="1174" left="120" width="91" height="12" font="0">&#34;fixedWidth&#34;</text>
<text top="1173" left="211" width="218" height="15" font="0">, &#34;diverging&#34;, &#34;logfixedWidth&#34;,</text>
<text top="126" left="496" width="84" height="12" font="0">&#34;quantiles&#34;</text>
<text top="125" left="580" width="225" height="15" font="0">, &#34;categorical&#34;, or a numeric vec-</text>
<text top="143" left="496" width="309" height="15" font="0">tor defining the breaks between categories.</text>
<text top="161" left="496" width="309" height="15" font="0">Works with the next argument (numCats) , al-</text>
<text top="179" left="496" width="309" height="15" font="0">though numCats is not used for &#34;categorical&#34;,</text>
<text top="197" left="496" width="309" height="15" font="0">where the data are not modified, or if the user</text>
<text top="215" left="496" width="309" height="15" font="0">specifies a numeric vector, where the number</text>
<text top="233" left="496" width="188" height="15" font="0">of categories will be a result.</text>
<text top="261" left="480" width="326" height="15" font="0">• numCats specifies the favoured number of cat-</text>
<text top="279" left="496" width="309" height="15" font="0">egories for the data. The number of categories</text>
<text top="297" left="496" width="309" height="15" font="0">used may be different if the number requested</text>
<text top="315" left="496" width="309" height="15" font="0">is not possible for the chosen catMethod (e.g.</text>
<text top="333" left="496" width="309" height="15" font="0">for &#34;quantiles&#34; if there are only 2 values in the</text>
<text top="351" left="496" width="309" height="15" font="0">data it is not possible to have more than 2 cate-</text>
<text top="369" left="496" width="49" height="15" font="0">gories).</text>
<text top="397" left="480" width="326" height="15" font="0">• colourPalette specifies a colour palette to use</text>
<text top="415" left="496" width="36" height="15" font="0">from:</text>
<text top="443" left="510" width="235" height="15" font="0">1. &#34;palette&#34; for the current palette</text>
<text top="466" left="510" width="295" height="15" font="0">2. a vector of valid colours, e.g. c(&#34;red&#34;,</text>
<text top="485" left="529" width="122" height="12" font="0">&#34;white&#34;, &#34;blue&#34;)</text>
<text top="484" left="672" width="14" height="15" font="0">or</text>
<text top="484" left="707" width="45" height="15" font="0">output</text>
<text top="484" left="773" width="32" height="15" font="0">from</text>
<text top="502" left="529" width="98" height="15" font="6"><a href="http://cran.r-project.org/package=RColorBrewer"><b>RColorBrewer</b></a></text>
<text top="524" left="510" width="26" height="15" font="0">3. a</text>
<text top="524" left="553" width="38" height="15" font="0">string</text>
<text top="524" left="608" width="55" height="15" font="0">defining</text>
<text top="524" left="680" width="24" height="15" font="0">one</text>
<text top="524" left="720" width="13" height="15" font="0">of</text>
<text top="524" left="750" width="21" height="15" font="0">the</text>
<text top="524" left="787" width="18" height="15" font="0">in-</text>
<text top="542" left="529" width="38" height="15" font="0">ternal</text>
<text top="542" left="593" width="76" height="15" font="0">rworldmap</text>
<text top="542" left="693" width="51" height="15" font="0">palettes</text>
<text top="542" left="770" width="36" height="15" font="0">from:</text>
<text top="561" left="529" width="46" height="12" font="0">&#34;heat&#34;</text>
<text top="560" left="575" width="4" height="15" font="0">,</text>
<text top="561" left="597" width="84" height="12" font="0">&#34;diverging&#34;</text>
<text top="560" left="681" width="4" height="15" font="0">,</text>
<text top="561" left="703" width="99" height="12" font="0">&#34;white2Black&#34;</text>
<text top="560" left="802" width="4" height="15" font="0">,</text>
<text top="579" left="529" width="99" height="12" font="0">&#34;black2White&#34;</text>
<text top="578" left="628" width="4" height="15" font="0">,</text>
<text top="579" left="658" width="46" height="12" font="0">&#34;topo&#34;</text>
<text top="578" left="703" width="4" height="15" font="0">,</text>
<text top="579" left="733" width="69" height="12" font="0">&#34;rainbow&#34;</text>
<text top="578" left="802" width="4" height="15" font="0">,</text>
<text top="597" left="529" width="69" height="12" font="0">&#34;terrain&#34;</text>
<text top="596" left="598" width="156" height="15" font="0">, &#34;negpos8&#34;, &#34;negpos9&#34;.</text>
<text top="624" left="480" width="326" height="15" font="0">• addLegend set to TRUE for a default legend,</text>
<text top="642" left="496" width="309" height="15" font="0">if set to FALSE the function addMapLegend or</text>
<text top="661" left="496" width="130" height="12" font="0">addMapLegendBoxes</text>
<text top="660" left="634" width="171" height="15" font="0">can be used to create a</text>
<text top="678" left="496" width="138" height="15" font="0">more flexible legend.</text>
<text top="706" left="480" width="326" height="15" font="0">• mapRegion a region to zoom in on, can be set to</text>
<text top="724" left="496" width="309" height="15" font="0">a country name from getMap()$NAME or one of</text>
<text top="744" left="496" width="69" height="12" font="0">&#34;eurasia&#34;</text>
<text top="742" left="565" width="241" height="15" font="0">, &#34;africa&#34;, &#34;latin america&#34;, &#34;uk&#34;,</text>
<text top="762" left="496" width="69" height="12" font="0">&#34;oceania&#34;</text>
<text top="760" left="565" width="57" height="15" font="0">, &#34;asia&#34;.</text>
<text top="801" left="459" width="334" height="17" font="7"><b>mapBubbles(), mapBars(), and mapPies()</b></text>
<text top="832" left="459" width="346" height="15" font="0">Another option for displaying data is to use the</text>
<text top="851" left="459" width="76" height="12" font="0">mapBubbles</text>
<text top="850" left="541" width="264" height="15" font="0">function which allows flexible creation</text>
<text top="867" left="459" width="346" height="15" font="0">of bubble plots on global maps. You can specify data</text>
<text top="885" left="459" width="346" height="15" font="0">columns that will determine the sizing and colouring</text>
<text top="903" left="459" width="346" height="15" font="0">of the bubbles (using nameZSize and nameZColour).</text>
<text top="921" left="459" width="346" height="15" font="0">The function also accepts other spatialDataFrame ob-</text>
<text top="939" left="459" width="346" height="15" font="0">jects or data frames containing columns specifying</text>
<text top="957" left="459" width="346" height="15" font="0">the x and y coordinates. If you wish to represent</text>
<text top="975" left="459" width="346" height="15" font="0">more attribute values per location there are also the</text>
<text top="993" left="459" width="346" height="15" font="0">newer mapBars() and mapPies() functions to pro-</text>
<text top="1011" left="459" width="346" height="15" font="0">duce bar and pie charts respectively (noting that pie</text>
<text top="1029" left="459" width="346" height="15" font="0">charts may not be the best way of presenting data</text>
<text top="1047" left="459" width="288" height="15" font="0">when there are more than a few categories).</text>
<text top="1077" left="459" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="1093" left="459" width="151" height="10" font="8">mapBubbles(dF=getMap()</text>
<text top="1110" left="527" width="137" height="10" font="8">,nameZSize=&#34;POP2005&#34;</text>
<text top="1126" left="527" width="144" height="10" font="8">,nameZColour=&#34;REGION&#34;</text>
<text top="1142" left="527" width="165" height="10" font="8">,colourPalette=&#34;rainbow&#34;</text>
<text top="1159" left="527" width="144" height="10" font="8">,oceanCol=&#34;lightblue&#34;</text>
<text top="1175" left="527" width="117" height="10" font="8">,landCol=&#34;wheat&#34;)</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="12" size="-1" family="Times" color="#00ff00"/>
	<fontspec id="13" size="0" family="Times" color="#0000ff"/>
	<fontspec id="14" size="-1" family="Times" color="#ffff00"/>
	<fontspec id="15" size="-1" family="Times" color="#ff0000"/>
	<fontspec id="16" size="-1" family="Times" color="#0000ff"/>
	<fontspec id="17" size="-1" family="Times" color="#00ffff"/>
	<fontspec id="18" size="0" family="Times" color="#00ff00"/>
	<fontspec id="19" size="1" family="Times" color="#ffff00"/>
	<fontspec id="20" size="3" family="Times" color="#00ff00"/>
	<fontspec id="21" size="1" family="Times" color="#0000ff"/>
	<fontspec id="22" size="0" family="Times" color="#ffff00"/>
	<fontspec id="23" size="1" family="Times" color="#ff0000"/>
	<fontspec id="24" size="2" family="Times" color="#00ff00"/>
	<fontspec id="25" size="3" family="Times" color="#0000ff"/>
	<fontspec id="26" size="3" family="Times" color="#ffff00"/>
	<fontspec id="27" size="0" family="Times" color="#ff0000"/>
	<fontspec id="28" size="3" family="Times" color="#ff0000"/>
	<fontspec id="29" size="5" family="Times" color="#00ff00"/>
	<fontspec id="30" size="4" family="Times" color="#ffff00"/>
	<fontspec id="31" size="-2" family="Times" color="#00ffff"/>
	<fontspec id="32" size="9" family="Times" color="#ffffff"/>
<text top="67" left="82" width="15" height="15" font="0">38</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="201" left="191" width="0" height="0" font="12">●</text>
<text top="189" left="254" width="2" height="2" font="13">●</text>
<text top="177" left="300" width="1" height="1" font="14">●</text>
<text top="177" left="272" width="1" height="1" font="15">●</text>
<text top="177" left="297" width="1" height="1" font="14">●</text>
<text top="230" left="269" width="1" height="2" font="16">●</text>
<text top="232" left="83" width="0" height="0" font="17">●</text>
<text top="252" left="186" width="2" height="3" font="18">●</text>
<text top="243" left="386" width="2" height="2" font="17">●</text>
<text top="192" left="303" width="0" height="0" font="14">●</text>
<text top="205" left="193" width="0" height="0" font="12">●</text>
<text top="186" left="188" width="0" height="0" font="12">●</text>
<text top="193" left="174" width="0" height="0" font="12">●</text>
<text top="193" left="342" width="1" height="2" font="14">●</text>
<text top="201" left="164" width="0" height="0" font="12">●</text>
<text top="174" left="270" width="1" height="1" font="15">●</text>
<text top="234" left="187" width="1" height="1" font="12">●</text>
<text top="196" left="348" width="2" height="3" font="19">●</text>
<text top="208" left="254" width="1" height="1" font="16">●</text>
<text top="228" left="413" width="0" height="0" font="17">●</text>
<text top="226" left="197" width="5" height="6" font="20">●</text>
<text top="175" left="277" width="1" height="1" font="15">●</text>
<text top="214" left="367" width="0" height="0" font="14">●</text>
<text top="159" left="150" width="2" height="2" font="18">●</text>
<text top="205" left="357" width="1" height="2" font="14">●</text>
<text top="210" left="333" width="1" height="2" font="14">●</text>
<text top="219" left="267" width="1" height="1" font="16">●</text>
<text top="219" left="275" width="3" height="3" font="21">●</text>
<text top="221" left="282" width="1" height="1" font="16">●</text>
<text top="183" left="318" width="2" height="2" font="22">●</text>
<text top="191" left="343" width="0" height="0" font="14">●</text>
<text top="252" left="181" width="1" height="2" font="12">●</text>
<text top="199" left="171" width="0" height="0" font="12">●</text>
<text top="212" left="265" width="1" height="2" font="16">●</text>
<text top="202" left="271" width="1" height="1" font="16">●</text>
<text top="230" left="296" width="0" height="0" font="16">●</text>
<text top="214" left="179" width="1" height="1" font="12">●</text>
<text top="208" left="168" width="1" height="1" font="12">●</text>
<text top="211" left="273" width="1" height="1" font="16">●</text>
<text top="196" left="173" width="1" height="1" font="12">●</text>
<text top="203" left="229" width="0" height="0" font="16">●</text>
<text top="239" left="93" width="0" height="0" font="17">●</text>
<text top="183" left="286" width="0" height="0" font="14">●</text>
<text top="162" left="261" width="1" height="1" font="15">●</text>
<text top="206" left="295" width="0" height="0" font="16">●</text>
<text top="203" left="191" width="0" height="0" font="12">●</text>
<text top="199" left="182" width="1" height="1" font="12">●</text>
<text top="219" left="174" width="1" height="2" font="12">●</text>
<text top="190" left="281" width="3" height="4" font="21">●</text>
<text top="165" left="244" width="1" height="1" font="15">●</text>
<text top="216" left="263" width="0" height="0" font="16">●</text>
<text top="159" left="278" width="0" height="0" font="15">●</text>
<text top="202" left="291" width="1" height="1" font="16">●</text>
<text top="204" left="163" width="1" height="1" font="12">●</text>
<text top="208" left="291" width="3" height="4" font="21">●</text>
<text top="170" left="266" width="1" height="1" font="15">●</text>
<text top="168" left="267" width="1" height="1" font="15">●</text>
<text top="214" left="199" width="0" height="0" font="12">●</text>
<text top="153" left="278" width="1" height="1" font="15">●</text>
<text top="270" left="194" width="0" height="0" font="12">●</text>
<text top="211" left="411" width="0" height="0" font="17">●</text>
<text top="236" left="103" width="0" height="0" font="17">●</text>
<text top="170" left="254" width="3" height="3" font="23">●</text>
<text top="204" left="237" width="0" height="1" font="16">●</text>
<text top="219" left="264" width="0" height="0" font="16">●</text>
<text top="176" left="296" width="1" height="1" font="14">●</text>
<text top="210" left="251" width="1" height="1" font="16">●</text>
<text top="206" left="191" width="0" height="0" font="12">●</text>
<text top="143" left="211" width="0" height="0" font="12">●</text>
<text top="165" left="261" width="3" height="4" font="23">●</text>
<text top="205" left="397" width="0" height="0" font="17">●</text>
<text top="178" left="275" width="1" height="1" font="15">●</text>
<text top="202" left="162" width="1" height="1" font="12">●</text>
<text top="207" left="241" width="1" height="1" font="16">●</text>
<text top="213" left="193" width="0" height="0" font="12">●</text>
<text top="199" left="179" width="1" height="1" font="12">●</text>
<text top="203" left="166" width="0" height="0" font="12">●</text>
<text top="173" left="269" width="0" height="0" font="15">●</text>
<text top="170" left="271" width="1" height="1" font="15">●</text>
<text top="153" left="234" width="0" height="0" font="15">●</text>
<text top="184" left="305" width="3" height="3" font="19">●</text>
<text top="186" left="287" width="1" height="1" font="14">●</text>
<text top="174" left="264" width="1" height="1" font="15">●</text>
<text top="210" left="246" width="1" height="2" font="16">●</text>
<text top="184" left="295" width="2" height="2" font="22">●</text>
<text top="181" left="390" width="1" height="1" font="14">●</text>
<text top="200" left="175" width="1" height="1" font="12">●</text>
<text top="186" left="289" width="1" height="1" font="14">●</text>
<text top="216" left="289" width="2" height="2" font="13">●</text>
<text top="176" left="327" width="1" height="1" font="14">●</text>
<text top="177" left="379" width="2" height="2" font="22">●</text>
<text top="216" left="95" width="0" height="0" font="17">●</text>
<text top="180" left="379" width="2" height="3" font="22">●</text>
<text top="189" left="300" width="0" height="0" font="14">●</text>
<text top="169" left="319" width="1" height="2" font="14">●</text>
<text top="199" left="356" width="0" height="0" font="14">●</text>
<text top="184" left="288" width="0" height="0" font="14">●</text>
<text top="161" left="277" width="1" height="1" font="15">●</text>
<text top="164" left="280" width="1" height="1" font="15">●</text>
<text top="162" left="276" width="1" height="1" font="15">●</text>
<text top="211" left="243" width="1" height="1" font="16">●</text>
<text top="169" left="272" width="1" height="1" font="15">●</text>
<text top="171" left="262" width="0" height="0" font="15">●</text>
<text top="191" left="270" width="1" height="1" font="16">●</text>
<text top="237" left="299" width="1" height="2" font="16">●</text>
<text top="203" left="191" width="0" height="0" font="12">●</text>
<text top="171" left="355" width="1" height="1" font="14">●</text>
<text top="201" left="190" width="0" height="0" font="12">●</text>
<text top="176" left="274" width="0" height="1" font="15">●</text>
<text top="201" left="249" width="0" height="0" font="16">●</text>
<text top="185" left="245" width="2" height="2" font="13">●</text>
<text top="238" left="310" width="0" height="0" font="16">●</text>
<text top="198" left="242" width="1" height="1" font="16">●</text>
<text top="182" left="267" width="0" height="0" font="15">●</text>
<text top="197" left="308" width="1" height="1" font="14">●</text>
<text top="211" left="326" width="0" height="0" font="14">●</text>
<text top="192" left="148" width="4" height="4" font="24">●</text>
<text top="214" left="366" width="2" height="2" font="22">●</text>
<text top="234" left="287" width="2" height="2" font="16">●</text>
<text top="231" left="286" width="1" height="2" font="16">●</text>
<text top="240" left="418" width="0" height="0" font="17">●</text>
<text top="237" left="83" width="0" height="0" font="17">●</text>
<text top="201" left="262" width="0" height="0" font="16">●</text>
<text top="206" left="182" width="0" height="0" font="12">●</text>
<text top="200" left="189" width="0" height="0" font="12">●</text>
<text top="167" left="257" width="1" height="1" font="15">●</text>
<text top="195" left="366" width="1" height="1" font="14">●</text>
<text top="203" left="398" width="0" height="0" font="17">●</text>
<text top="156" left="245" width="0" height="0" font="15">●</text>
<text top="176" left="254" width="0" height="0" font="15">●</text>
<text top="182" left="247" width="0" height="0" font="15">●</text>
<text top="164" left="248" width="0" height="0" font="15">●</text>
<text top="168" left="259" width="0" height="0" font="15">●</text>
<text top="196" left="366" width="0" height="0" font="14">●</text>
<text top="174" left="260" width="0" height="0" font="15">●</text>
<text top="186" left="288" width="1" height="1" font="14">●</text>
<text top="175" left="272" width="0" height="0" font="15">●</text>
<text top="233" left="419" width="0" height="0" font="17">●</text>
<text top="206" left="259" width="4" height="5" font="25">●</text>
<text top="166" left="258" width="0" height="1" font="15">●</text>
<text top="154" left="266" width="1" height="1" font="15">●</text>
<text top="189" left="336" width="2" height="2" font="22">●</text>
<text top="219" left="420" width="0" height="0" font="17">●</text>
<text top="214" left="197" width="0" height="0" font="12">●</text>
<text top="205" left="167" width="1" height="1" font="12">●</text>
<text top="241" left="194" width="1" height="1" font="12">●</text>
<text top="226" left="177" width="2" height="2" font="18">●</text>
<text top="186" left="320" width="4" height="5" font="26">●</text>
<text top="165" left="271" width="2" height="3" font="27">●</text>
<text top="209" left="172" width="1" height="1" font="12">●</text>
<text top="178" left="244" width="1" height="1" font="15">●</text>
<text top="224" left="396" width="1" height="1" font="17">●</text>
<text top="206" left="237" width="0" height="1" font="16">●</text>
<text top="193" left="304" width="0" height="0" font="14">●</text>
<text top="239" left="308" width="0" height="0" font="16">●</text>
<text top="171" left="277" width="2" height="2" font="27">●</text>
<text top="171" left="281" width="1" height="1" font="15">●</text>
<text top="200" left="372" width="3" height="4" font="19">●</text>
<text top="200" left="186" width="1" height="1" font="12">●</text>
<text top="154" left="350" width="4" height="5" font="28">●</text>
<text top="220" left="282" width="1" height="1" font="16">●</text>
<text top="194" left="297" width="1" height="1" font="14">●</text>
<text top="201" left="190" width="0" height="0" font="12">●</text>
<text top="223" left="308" width="0" height="0" font="16">●</text>
<text top="246" left="277" width="2" height="3" font="21">●</text>
<text top="247" left="281" width="0" height="1" font="16">●</text>
<text top="240" left="276" width="0" height="1" font="16">●</text>
<text top="204" left="238" width="0" height="0" font="16">●</text>
<text top="172" left="267" width="0" height="1" font="15">●</text>
<text top="209" left="240" width="1" height="1" font="16">●</text>
<text top="216" left="356" width="1" height="1" font="14">●</text>
<text top="212" left="298" width="1" height="1" font="16">●</text>
<text top="176" left="248" width="2" height="3" font="27">●</text>
<text top="204" left="192" width="0" height="0" font="12">●</text>
<text top="203" left="282" width="2" height="3" font="13">●</text>
<text top="155" left="269" width="1" height="1" font="15">●</text>
<text top="182" left="290" width="1" height="2" font="14">●</text>
<text top="171" left="260" width="1" height="1" font="15">●</text>
<text top="207" left="191" width="0" height="0" font="12">●</text>
<text top="201" left="352" width="3" height="3" font="19">●</text>
<text top="179" left="323" width="1" height="1" font="14">●</text>
<text top="209" left="253" width="1" height="1" font="16">●</text>
<text top="218" left="259" width="0" height="0" font="16">●</text>
<text top="183" left="262" width="1" height="1" font="16">●</text>
<text top="177" left="287" width="3" height="4" font="19">●</text>
<text top="179" left="312" width="1" height="1" font="14">●</text>
<text top="223" left="286" width="2" height="3" font="13">●</text>
<text top="216" left="284" width="2" height="2" font="13">●</text>
<text top="163" left="249" width="3" height="3" font="23">●</text>
<text top="168" left="283" width="2" height="3" font="27">●</text>
<text top="175" left="150" width="6" height="7" font="29">●</text>
<text top="205" left="250" width="1" height="2" font="16">●</text>
<text top="251" left="196" width="1" height="1" font="12">●</text>
<text top="175" left="315" width="2" height="2" font="22">●</text>
<text top="205" left="191" width="0" height="0" font="12">●</text>
<text top="210" left="185" width="2" height="2" font="18">●</text>
<text top="200" left="188" width="0" height="0" font="12">●</text>
<text top="200" left="357" width="3" height="4" font="19">●</text>
<text top="200" left="188" width="0" height="0" font="12">●</text>
<text top="240" left="270" width="0" height="1" font="16">●</text>
<text top="245" left="284" width="0" height="0" font="16">●</text>
<text top="201" left="299" width="2" height="2" font="14">●</text>
<text top="231" left="280" width="1" height="1" font="16">●</text>
<text top="236" left="282" width="1" height="2" font="16">●</text>
<text top="215" left="364" width="5" height="6" font="30">●</text>
<text top="202" left="191" width="0" height="0" font="12">●</text>
<text top="206" left="184" width="0" height="0" font="12">●</text>
<text top="194" left="307" width="1" height="1" font="14">●</text>
<text top="227" left="378" width="0" height="0" font="14">●</text>
<text top="243" left="124" width="0" height="1" font="31">●</text>
<text top="211" left="387" width="0" height="0" font="17">●</text>
<text top="207" left="420" width="0" height="0" font="17">●</text>
<text top="171" left="196" width="0" height="0" font="12">●</text>
<text top="234" left="247" width="0" height="0" font="16">●</text>
<text top="174" left="265" width="0" height="0" font="15">●</text>
<text top="196" left="181" width="0" height="0" font="12">●</text>
<text top="193" left="239" width="0" height="0" font="16">●</text>
<text top="174" left="273" width="1" height="1" font="15">●</text>
<text top="176" left="265" width="0" height="0" font="15">●</text>
<text top="274" left="382" width="9" height="11" font="32">●</text>
<text top="254" left="388" width="27" height="6" font="10">POP2005</text>
<text top="268" left="393" width="4" height="6" font="10">0</text>
<text top="277" left="393" width="26" height="6" font="10">6.56e+08</text>
<text top="287" left="393" width="26" height="6" font="10">1.31e+09</text>
<text top="241" left="84" width="25" height="6" font="10">REGION</text>
<text top="251" left="95" width="4" height="6" font="10">0</text>
<text top="258" left="95" width="4" height="6" font="10">2</text>
<text top="266" left="95" width="4" height="6" font="10">9</text>
<text top="273" left="95" width="7" height="6" font="10">19</text>
<text top="281" left="95" width="11" height="6" font="10">142</text>
<text top="288" left="95" width="11" height="6" font="10">150</text>
<text top="320" left="144" width="224" height="15" font="0">Figure 3: Output of mapBubbles()</text>
<text top="366" left="82" width="174" height="17" font="7"><b>Identifying countries</b></text>
<text top="399" left="82" width="346" height="15" font="0">The interactive function identifyCountries() al-</text>
<text top="417" left="82" width="346" height="15" font="0">lows the user to click on the current map and, pro-</text>
<text top="435" left="82" width="346" height="15" font="0">vided the cursor is sufficiently close to country cen-</text>
<text top="453" left="82" width="346" height="15" font="0">troid, will add the country name to the map. Op-</text>
<text top="471" left="82" width="346" height="15" font="0">tionally, the name of an attribute variable can also</text>
<text top="488" left="82" width="346" height="15" font="0">be passed to the function to cause the value of the</text>
<text top="506" left="82" width="346" height="15" font="0">attribute to be added to the label. e.g. ’Cape Verde</text>
<text top="524" left="82" width="346" height="15" font="0">506807’ will be printed on the map if the code below</text>
<text top="542" left="82" width="346" height="15" font="0">is entered and the mouse clicked over those islands</text>
<text top="560" left="82" width="199" height="15" font="0">(if you know where they are!).</text>
<text top="595" left="82" width="178" height="10" font="8">identifyCountries(getMap()</text>
<text top="612" left="199" width="192" height="10" font="8">,nameColumnToPlot=&#34;POP2005&#34;)</text>
<text top="657" left="82" width="346" height="17" font="7"><b>Aggregating data to produce different out-</b></text>
<text top="678" left="82" width="36" height="17" font="7"><b>puts</b></text>
<text top="711" left="82" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="711" left="165" width="264" height="15" font="0">offers options for aggregating half de-</text>
<text top="729" left="82" width="346" height="15" font="0">gree gridded data to countries, and in turn for aggre-</text>
<text top="747" left="82" width="346" height="15" font="0">gating country level data to regions. In both of these</text>
<text top="765" left="82" width="346" height="15" font="0">options a range of aggregation options are available</text>
<text top="783" left="82" width="345" height="15" font="0">including mean, minimum, maximum and variance.</text>
<text top="803" left="105" width="229" height="12" font="0">mapHalfDegreeGridToCountries()</text>
<text top="802" left="341" width="88" height="15" font="0">takes a grid-</text>
<text top="820" left="82" width="346" height="15" font="0">ded input file, aggregates to a country level and plots</text>
<text top="838" left="82" width="346" height="15" font="0">the map. It accepts most of the same arguments as</text>
<text top="857" left="82" width="122" height="12" font="0">mapCountryData()</text>
<text top="856" left="204" width="4" height="15" font="0">.</text>
<text top="875" left="105" width="324" height="15" font="0">Country level data can be aggregated to global re-</text>
<text top="893" left="82" width="346" height="15" font="0">gions specified by regionType in country2Region()</text>
<text top="911" left="82" width="346" height="15" font="0">which outputs as text, and mapByRegion() which</text>
<text top="928" left="82" width="346" height="15" font="0">produces a map plot. The regional classifications</text>
<text top="946" left="82" width="346" height="15" font="0">available include SRES (The Special Report on Emis-</text>
<text top="964" left="82" width="346" height="15" font="0">sions Scenarios of the Intergovernmental Panel on</text>
<text top="982" left="82" width="346" height="15" font="0">Climate Change (IPCC) ), GEO3(Global Earth Obser-</text>
<text top="1000" left="82" width="339" height="15" font="0">vation), Stern and GBD (Global Burden of Disease).</text>
<text top="1039" left="82" width="130" height="10" font="8">data(countryExData)</text>
<text top="1056" left="82" width="192" height="10" font="8">country2Region(countryExData</text>
<text top="1072" left="158" width="171" height="10" font="8">,nameDataColumn=&#34;CLIMATE&#34;</text>
<text top="1089" left="158" width="110" height="10" font="8">,joinCode=&#34;ISO3&#34;</text>
<text top="1105" left="158" width="171" height="10" font="8">,nameJoinColumn=&#34;ISO3V10&#34;</text>
<text top="1122" left="158" width="130" height="10" font="8">,regionType=&#34;Stern&#34;</text>
<text top="1138" left="158" width="82" height="10" font="8">,FUN=&#34;mean&#34;)</text>
<text top="1173" left="105" width="115" height="15" font="0">Outputs this text:</text>
<text top="127" left="569" width="123" height="10" font="8">meanCLIMATEbyStern</text>
<text top="144" left="459" width="75" height="10" font="8">Australasia</text>
<text top="144" left="637" width="55" height="10" font="8">56.92000</text>
<text top="160" left="459" width="62" height="10" font="8">Caribbean</text>
<text top="160" left="637" width="55" height="10" font="8">65.20000</text>
<text top="177" left="459" width="103" height="10" font="8">Central America</text>
<text top="177" left="637" width="55" height="10" font="8">76.11250</text>
<text top="193" left="459" width="82" height="10" font="8">Central Asia</text>
<text top="193" left="637" width="55" height="10" font="8">56.18000</text>
<text top="210" left="459" width="62" height="10" font="8">East Asia</text>
<text top="210" left="637" width="55" height="10" font="8">69.18462</text>
<text top="226" left="459" width="41" height="10" font="8">Europe</text>
<text top="226" left="637" width="55" height="10" font="8">73.87619</text>
<text top="242" left="459" width="82" height="10" font="8">North Africa</text>
<text top="242" left="637" width="55" height="10" font="8">71.00000</text>
<text top="259" left="459" width="89" height="10" font="8">North America</text>
<text top="259" left="637" width="55" height="10" font="8">62.70000</text>
<text top="275" left="459" width="89" height="10" font="8">South America</text>
<text top="275" left="637" width="55" height="10" font="8">77.01818</text>
<text top="292" left="459" width="69" height="10" font="8">South Asia</text>
<text top="292" left="637" width="55" height="10" font="8">77.22000</text>
<text top="308" left="459" width="96" height="10" font="8">South+E Africa</text>
<text top="308" left="637" width="55" height="10" font="8">75.79474</text>
<text top="325" left="459" width="75" height="10" font="8">West Africa</text>
<text top="325" left="637" width="55" height="10" font="8">78.68421</text>
<text top="341" left="459" width="62" height="10" font="8">West Asia</text>
<text top="341" left="637" width="55" height="10" font="8">49.62000</text>
<text top="368" left="459" width="130" height="10" font="8">data(countryExData)</text>
<text top="385" left="459" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="401" left="459" width="171" height="10" font="8">mapByRegion(countryExData</text>
<text top="417" left="534" width="171" height="10" font="8">,nameDataColumn=&#34;CLIMATE&#34;</text>
<text top="434" left="534" width="110" height="10" font="8">,joinCode=&#34;ISO3&#34;</text>
<text top="450" left="534" width="171" height="10" font="8">,nameJoinColumn=&#34;ISO3V10&#34;</text>
<text top="467" left="534" width="130" height="10" font="8">,regionType=&#34;Stern&#34;</text>
<text top="483" left="534" width="82" height="10" font="8">,FUN=&#34;mean&#34;)</text>
<text top="509" left="481" width="126" height="15" font="0">Produces this map:</text>
<text top="690" left="470" width="12" height="6" font="10">49.6</text>
<text top="690" left="776" width="12" height="6" font="10">78.7</text>
<text top="527" left="572" width="113" height="7" font="11"><b>mean CLIMATE by Stern regions</b></text>
<text top="726" left="515" width="235" height="15" font="0">Figure 4: Output of mapByRegion()</text>
<text top="760" left="481" width="324" height="15" font="0">The identity of which countries are in which re-</text>
<text top="778" left="459" width="346" height="15" font="0">gions are stored in the data frame countryRegions.</text>
<text top="796" left="459" width="346" height="15" font="0">This also identifies which countries are currently</text>
<text top="814" left="459" width="346" height="15" font="0">classed by the UN as Least Developed Countries</text>
<text top="832" left="459" width="346" height="15" font="0">(LDC), Small Island Developing states (SID) and</text>
<text top="850" left="459" width="346" height="15" font="0">Landlocked Developing Countries (LLDC). To map</text>
<text top="868" left="459" width="346" height="15" font="0">just the Least Developed Countries the code below</text>
<text top="885" left="459" width="96" height="15" font="0">could be used:</text>
<text top="913" left="459" width="137" height="10" font="8">data(countryRegions)</text>
<text top="929" left="459" width="295" height="10" font="8">sPDF &lt;- joinCountryData2Map( countryRegions</text>
<text top="946" left="521" width="123" height="10" font="8">,joinCode = &#34;ISO3&#34;</text>
<text top="962" left="521" width="171" height="10" font="8">,nameJoinColumn = &#34;ISO3&#34;)</text>
<text top="978" left="459" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="995" left="459" width="304" height="10" font="8">mapCountryData(sPDF[which(sPDF$LDC=='LDC'),]</text>
<text top="1011" left="555" width="192" height="10" font="8">,nameColumnToPlot=&#34;POP2005&#34;)</text>
<text top="1050" left="459" width="346" height="17" font="7"><b>Using rworldmap with other packages</b></text>
<text top="1071" left="459" width="220" height="17" font="7"><b>classInt and RColorBrewer</b></text>
<text top="1101" left="459" width="346" height="15" font="0">While <b>rworldmap </b>sets many defaults internally there</text>
<text top="1119" left="459" width="346" height="15" font="0">are also options to use other packages to have greater</text>
<text top="1137" left="459" width="219" height="15" font="0">flexibility. In the example below</text>
<text top="1137" left="683" width="52" height="15" font="6"><a href="http://cran.r-project.org/package=classInt"><b>classInt</b></a></text>
<text top="1137" left="740" width="65" height="15" font="0">is used to</text>
<text top="1155" left="459" width="186" height="15" font="0">create the classification and</text>
<text top="1155" left="650" width="98" height="15" font="6"><a href="http://cran.r-project.org/package=RColorBrewer"><b>RColorBrewer</b></a></text>
<text top="1155" left="753" width="52" height="15" font="0">to spec-</text>
<text top="1173" left="459" width="98" height="15" font="0">ify the colours.</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">39</text>
<text top="127" left="82" width="117" height="10" font="8">library(classInt)</text>
<text top="144" left="82" width="144" height="10" font="8">library(RColorBrewer)</text>
<text top="177" left="82" width="322" height="10" font="8">#getting smallexample data and joining to a map</text>
<text top="193" left="82" width="130" height="10" font="8">data(countryExData)</text>
<text top="210" left="82" width="281" height="10" font="8">sPDF &lt;- joinCountryData2Map(countryExData</text>
<text top="226" left="137" width="123" height="10" font="8">,joinCode = &#34;ISO3&#34;</text>
<text top="242" left="137" width="185" height="10" font="8">,nameJoinColumn = &#34;ISO3V10&#34;</text>
<text top="259" left="137" width="178" height="10" font="8">,mapResolution = &#34;coarse&#34;)</text>
<text top="292" left="82" width="165" height="10" font="8">#getting class intervals</text>
<text top="308" left="82" width="281" height="10" font="8">classInt &lt;- classIntervals( sPDF[[&#34;EPI&#34;]]</text>
<text top="325" left="165" width="151" height="10" font="8">,n=5, style = &#34;jenks&#34;)</text>
<text top="341" left="82" width="206" height="10" font="8">catMethod = classInt[[&#34;brks&#34;]]</text>
<text top="374" left="82" width="110" height="10" font="8">#getting colours</text>
<text top="390" left="82" width="256" height="10" font="8">colourPalette &lt;- brewer.pal(5,'RdPu')</text>
<text top="423" left="82" width="62" height="10" font="8">#plot map</text>
<text top="440" left="82" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="456" left="82" width="219" height="10" font="8">mapParams &lt;- mapCountryData(sPDF</text>
<text top="473" left="172" width="158" height="10" font="8">,nameColumnToPlot=&#34;EPI&#34;</text>
<text top="489" left="172" width="110" height="10" font="8">,addLegend=FALSE</text>
<text top="505" left="172" width="151" height="10" font="8">,catMethod = catMethod</text>
<text top="522" left="172" width="206" height="10" font="8">,colourPalette=colourPalette )</text>
<text top="555" left="82" width="96" height="10" font="8">#adding legend</text>
<text top="571" left="82" width="137" height="10" font="8">do.call(addMapLegend</text>
<text top="588" left="131" width="82" height="10" font="8">,c(mapParams</text>
<text top="604" left="144" width="130" height="10" font="8">,legendLabels=&#34;all&#34;</text>
<text top="620" left="144" width="110" height="10" font="8">,legendWidth=0.5</text>
<text top="637" left="144" width="158" height="10" font="8">,legendIntervals=&#34;data&#34;</text>
<text top="653" left="144" width="110" height="10" font="8">,legendMar = 2))</text>
<text top="685" left="247" width="12" height="7" font="11"><b>EPI</b></text>
<text top="856" left="93" width="12" height="6" font="10">39.1</text>
<text top="856" left="155" width="12" height="6" font="10">50.5</text>
<text top="856" left="219" width="12" height="6" font="10">62.3</text>
<text top="856" left="276" width="12" height="6" font="10">72.8</text>
<text top="856" left="325" width="12" height="6" font="10">81.8</text>
<text top="856" left="400" width="12" height="6" font="10">95.5</text>
<text top="884" left="82" width="346" height="15" font="0">Figure 5: Output of mapCountryData() using inputs</text>
<text top="902" left="82" width="219" height="15" font="0">from <b>classInt </b>and <b>RColorBrewer</b></text>
<text top="945" left="82" width="346" height="21" font="4"><b>Examples using data freely avail-</b></text>
<text top="972" left="82" width="156" height="21" font="4"><b>able on the web</b></text>
<text top="1014" left="82" width="291" height="17" font="7"><b>Example country data from the web</b></text>
<text top="1046" left="82" width="263" height="15" font="0">The Happy Planet Index or HPI <a href="http://www.happyplanetindex.org">(</a></text>
<text top="1048" left="345" width="84" height="12" font="5"><a href="http://www.happyplanetindex.org">http://www.</a></text>
<text top="1066" left="82" width="152" height="12" font="5"><a href="http://www.happyplanetindex.org">happyplanetindex.org</a></text>
<text top="1064" left="235" width="194" height="15" font="0"><a href="http://www.happyplanetindex.org">) </a>combines country by coun-</text>
<text top="1082" left="82" width="346" height="15" font="0">try estimates of life expectancy, life satisfaction and</text>
<text top="1100" left="82" width="346" height="15" font="0">ecological footprint to create an index of sustainable</text>
<text top="1118" left="82" width="346" height="15" font="0">well-being that makes much more sense than GDP</text>
<text top="1136" left="82" width="345" height="15" font="0">for assessing how countries are doing (Marks, 2010).</text>
<text top="1155" left="105" width="278" height="15" font="0">An Excel file containing the data (‘</text>
<text top="1156" left="383" width="46" height="12" font="8">hpi-2-0-</text>
<text top="1174" left="82" width="60" height="12" font="8">results.xls</text>
<text top="1173" left="142" width="287" height="15" font="0">’) can be downloaded from the HPI</text>
<text top="125" left="459" width="80" height="15" font="0">website at:</text>
<text top="126" left="561" width="244" height="12" font="5"><a href="http://www.happyplanetindex.org/learn/download-report.html">http://www.happyplanetindex.org/</a></text>
<text top="144" left="459" width="199" height="12" font="5"><a href="http://www.happyplanetindex.org/learn/download-report.html">learn/download-report.html</a></text>
<text top="143" left="658" width="4" height="15" font="0"><a href="http://www.happyplanetindex.org/learn/download-report.html">.</a></text>
<text top="161" left="481" width="324" height="15" font="0">I copied the country data from the sheet ‘All Data’</text>
<text top="179" left="459" width="130" height="15" font="0">and pasted into a ‘</text>
<text top="180" left="589" width="24" height="12" font="8">.csv</text>
<text top="179" left="613" width="192" height="15" font="0">’ file so that the header row</text>
<text top="197" left="459" width="346" height="15" font="0">was at the top of the file and the summary statistics</text>
<text top="215" left="459" width="346" height="15" font="0">at the bottom were left off. I then edited some of the</text>
<text top="233" left="459" width="346" height="15" font="0">column names to make them appropriate R variable</text>
<text top="251" left="459" width="325" height="15" font="0">names (e.g. changing ‘Life Sat (0-10)’ to ‘LifeSat’).</text>
<text top="268" left="481" width="324" height="15" font="0">This data can then be read in easily using</text>
<text top="288" left="459" width="76" height="12" font="0">read.csv()</text>
<text top="286" left="539" width="193" height="15" font="0">and joinCountryData2Map().</text>
<text top="320" left="459" width="201" height="10" font="8">inFile &lt;- 'hpi2_0edited2.csv'</text>
<text top="336" left="459" width="309" height="10" font="8">dF &lt;- read.csv(inFile,header=TRUE,as.is=TRUE)</text>
<text top="352" left="459" width="206" height="10" font="8">sPDF &lt;- joinCountryData2Map(dF</text>
<text top="369" left="582" width="119" height="10" font="8">, joinCode='NAME'</text>
<text top="385" left="582" width="181" height="10" font="8">, nameJoinColumn='country'</text>
<text top="402" left="582" width="119" height="10" font="8">, verbose='TRUE')</text>
<text top="432" left="481" width="324" height="15" font="0">Unfortunately, but in common with many global</text>
<text top="450" left="459" width="346" height="15" font="0">country level datasets, the countries are specified by</text>
<text top="468" left="459" width="346" height="15" font="0">name alone rather than by ISO country codes. The</text>
<text top="487" left="459" width="91" height="12" font="0">verbose=TRUE</text>
<text top="486" left="554" width="251" height="15" font="0">option in joinCountryData2Map() can</text>
<text top="504" left="459" width="346" height="15" font="0">be used to show the names of the 10 countries that</text>
<text top="522" left="459" width="346" height="15" font="0">don’t join due to their names being slightly different</text>
<text top="539" left="459" width="346" height="15" font="0">in the data than rworldmap. The names of the coun-</text>
<text top="557" left="459" width="346" height="15" font="0">tries that failed to join can be edited in the csv to be</text>
<text top="575" left="459" width="346" height="15" font="0">the same as those in getMap()[[’NAME’]], and then</text>
<text top="593" left="459" width="277" height="15" font="0">they will join. A selection is shown below.</text>
<text top="626" left="459" width="75" height="10" font="8">name in HPI</text>
<text top="626" left="569" width="117" height="10" font="8">name in rworldmap</text>
<text top="643" left="459" width="27" height="10" font="8">Iran</text>
<text top="643" left="569" width="178" height="10" font="8">Iran (Islamic Republic of)</text>
<text top="659" left="459" width="34" height="10" font="8">Korea</text>
<text top="659" left="569" width="123" height="10" font="8">Korea, Republic of</text>
<text top="676" left="459" width="27" height="10" font="8">Laos</text>
<text top="676" left="569" width="221" height="10" font="8">Lao People's Democratic Republic</text>
<text top="692" left="459" width="48" height="10" font="8">Moldova</text>
<text top="692" left="569" width="130" height="10" font="8">Republic of Moldova</text>
<text top="709" left="459" width="34" height="10" font="8">Syria</text>
<text top="709" left="569" width="137" height="10" font="8">Syrian Arab Republic</text>
<text top="725" left="459" width="55" height="10" font="8">Tanzania</text>
<text top="725" left="569" width="185" height="10" font="8">United Republic of Tanzania</text>
<text top="741" left="459" width="48" height="10" font="8">Vietnam</text>
<text top="741" left="569" width="55" height="10" font="8">Viet Nam</text>
<text top="758" left="459" width="165" height="10" font="8">United States of America</text>
<text top="758" left="651" width="89" height="10" font="8">United States</text>
<text top="788" left="481" width="324" height="15" font="0">The map of the HPI on the website is interesting</text>
<text top="806" left="459" width="346" height="15" font="0">in that the colours applied to countries are not deter-</text>
<text top="824" left="459" width="346" height="15" font="0">mined by the value of the HPI for that country, but</text>
<text top="842" left="459" width="346" height="15" font="0">instead by the values of the three component indices</text>
<text top="860" left="459" width="346" height="15" font="0">for Life Expectancy, Life Satisfaction and Ecological</text>
<text top="878" left="459" width="346" height="15" font="0">Footprint. Therefore I needed to add some extra R</text>
<text top="896" left="459" width="262" height="15" font="0">code to be able to recreate the HPI map.</text>
<text top="929" left="459" width="199" height="10" font="8">#categorise component indices</text>
<text top="945" left="459" width="130" height="10" font="8">dF$LifeSatcolour &lt;-</text>
<text top="962" left="473" width="201" height="10" font="8">ifelse(dF$LifeSat &lt; 5.5,'red'</text>
<text top="978" left="486" width="222" height="10" font="8">,ifelse(dF$LifeSat &gt; 7.0,'green'</text>
<text top="995" left="534" width="78" height="10" font="8">,'amber' ))</text>
<text top="1027" left="459" width="130" height="10" font="8">dF$LifeExpcolour &lt;-</text>
<text top="1044" left="473" width="194" height="10" font="8">ifelse(dF$LifeExp &lt; 60,'red'</text>
<text top="1060" left="486" width="215" height="10" font="8">,ifelse(dF$LifeExp &gt; 75,'green'</text>
<text top="1077" left="534" width="78" height="10" font="8">,'amber' ))</text>
<text top="1110" left="459" width="103" height="10" font="8">dF$HLYcolour &lt;-</text>
<text top="1126" left="473" width="167" height="10" font="8">ifelse(dF$HLY &lt; 33,'red'</text>
<text top="1142" left="486" width="201" height="10" font="8">,ifelse(dF$HLY &gt; 52.5,'green'</text>
<text top="1159" left="534" width="78" height="10" font="8">,'amber' ))</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="82" width="15" height="15" font="0">40</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="127" left="82" width="144" height="10" font="8">dF$Footprintcolour &lt;-</text>
<text top="144" left="96" width="256" height="10" font="8">ifelse(dF$Footprint &gt; 8.4,'blood red'</text>
<text top="160" left="110" width="222" height="10" font="8">,ifelse(dF$Footprint &gt; 4.2,'red'</text>
<text top="177" left="144" width="236" height="10" font="8">,ifelse(dF$Footprint &lt; 2.1,'green'</text>
<text top="193" left="192" width="85" height="10" font="8">,'amber' )))</text>
<text top="226" left="82" width="261" height="10" font="8">#count red, amber , greens per country</text>
<text top="242" left="82" width="62" height="10" font="8">numReds&lt;-</text>
<text top="259" left="96" width="263" height="10" font="8">(as.numeric(dF$Footprintcolour=='red')</text>
<text top="275" left="96" width="249" height="10" font="8">+as.numeric(dF$LifeExpcolour=='red')</text>
<text top="292" left="96" width="256" height="10" font="8">+as.numeric(dF$LifeSatcolour=='red'))</text>
<text top="308" left="82" width="75" height="10" font="8">numAmbers&lt;-</text>
<text top="325" left="96" width="277" height="10" font="8">(as.numeric(dF$Footprintcolour=='amber')</text>
<text top="341" left="96" width="263" height="10" font="8">+as.numeric(dF$LifeExpcolour=='amber')</text>
<text top="357" left="96" width="270" height="10" font="8">+as.numeric(dF$LifeSatcolour=='amber'))</text>
<text top="374" left="82" width="75" height="10" font="8">numGreens&lt;-</text>
<text top="390" left="96" width="277" height="10" font="8">(as.numeric(dF$Footprintcolour=='green')</text>
<text top="407" left="96" width="263" height="10" font="8">+as.numeric(dF$LifeExpcolour=='green')</text>
<text top="423" left="96" width="270" height="10" font="8">+as.numeric(dF$LifeSatcolour=='green'))</text>
<text top="456" left="82" width="226" height="10" font="8">#calculate HPI colour per country</text>
<text top="473" left="82" width="103" height="10" font="8">dF$HPIcolour &lt;-</text>
<text top="489" left="89" width="263" height="10" font="8">ifelse(dF$Footprintcolour=='blood red'</text>
<text top="505" left="131" width="89" height="10" font="8">| numReds&gt;1,6</text>
<text top="522" left="96" width="137" height="10" font="8">,ifelse(numReds==1,5</text>
<text top="538" left="103" width="151" height="10" font="8">,ifelse(numAmbers==3,4</text>
<text top="555" left="110" width="254" height="10" font="8">,ifelse(numGreens==1 &amp; numAmbers==2,3</text>
<text top="571" left="117" width="254" height="10" font="8">,ifelse(numGreens==2 &amp; numAmbers==1,2</text>
<text top="588" left="124" width="151" height="10" font="8">,ifelse(numGreens==3,1</text>
<text top="604" left="131" width="62" height="10" font="8">,NA))))))</text>
<text top="637" left="82" width="117" height="10" font="8">#join data to map</text>
<text top="653" left="82" width="206" height="10" font="8">sPDF &lt;- joinCountryData2Map(dF</text>
<text top="670" left="206" width="110" height="10" font="8">,joinCode=&#34;NAME&#34;</text>
<text top="686" left="206" width="178" height="10" font="8">,nameJoinColumn=&#34;country&#34;)</text>
<text top="719" left="82" width="82" height="10" font="8">#set colours</text>
<text top="736" left="82" width="208" height="10" font="8">colourPalette &lt;- c('palegreen'</text>
<text top="752" left="206" width="64" height="10" font="8">,'yellow'</text>
<text top="768" left="206" width="64" height="10" font="8">,'orange'</text>
<text top="785" left="206" width="85" height="10" font="8">,'orangered'</text>
<text top="801" left="206" width="78" height="10" font="8">,'darkred')</text>
<text top="834" left="82" width="62" height="10" font="8">#plot map</text>
<text top="851" left="82" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="867" left="82" width="219" height="10" font="8">mapParams &lt;- mapCountryData(sPDF</text>
<text top="883" left="179" width="201" height="10" font="8">,nameColumnToPlot='HPIcolour'</text>
<text top="900" left="179" width="167" height="10" font="8">,catMethod='categorical'</text>
<text top="916" left="179" width="192" height="10" font="8">,colourPalette=colourPalette</text>
<text top="933" left="179" width="110" height="10" font="8">,addLegend=FALSE</text>
<text top="949" left="179" width="215" height="10" font="8">,mapTitle='Happy Planet Index')</text>
<text top="982" left="82" width="137" height="10" font="8">#changing legendText</text>
<text top="999" left="82" width="158" height="10" font="8">mapParams$legendText &lt;-</text>
<text top="1015" left="110" width="140" height="10" font="8">c('2 good, 1 middle'</text>
<text top="1031" left="117" width="133" height="10" font="8">,'1 good, 2 middle'</text>
<text top="1048" left="117" width="78" height="10" font="8">,'3 middle'</text>
<text top="1064" left="117" width="64" height="10" font="8">,'1 poor'</text>
<text top="1081" left="117" width="208" height="10" font="8">,'2 poor or footprint v.poor')</text>
<text top="1097" left="82" width="75" height="10" font="8">#add legend</text>
<text top="1114" left="82" width="178" height="10" font="8">do.call( addMapLegendBoxes</text>
<text top="1130" left="137" width="89" height="10" font="8">, c(mapParams</text>
<text top="1146" left="158" width="78" height="10" font="8">,x='bottom'</text>
<text top="1163" left="158" width="144" height="10" font="8">,title=&#34;HPI colour&#34;))</text>
<text top="157" left="595" width="68" height="7" font="11"><b>Happy Planet Index</b></text>
<text top="283" left="486" width="29" height="6" font="10">HPI colour</text>
<text top="293" left="470" width="47" height="6" font="10">2 good, 1 middle</text>
<text top="301" left="470" width="47" height="6" font="10">1 good, 2 middle</text>
<text top="308" left="470" width="24" height="6" font="10">3 middle</text>
<text top="316" left="470" width="18" height="6" font="10">1 poor</text>
<text top="323" left="470" width="69" height="6" font="10">2 poor or footprint v.poor</text>
<text top="355" left="459" width="346" height="15" font="0">Figure 6: Happy Planet Index 2.0, using rworldmap</text>
<text top="373" left="459" width="259" height="15" font="0">to replicate map in happy planet report</text>
<text top="417" left="459" width="293" height="17" font="7"><b>Example gridded data from the web</b></text>
<text top="450" left="459" width="346" height="15" font="0">‘Koeppen Geiger’ is a published classification divid-</text>
<text top="467" left="459" width="346" height="15" font="0">ing the world into 30 climatic zones. The GIS files</text>
<text top="485" left="459" width="346" height="15" font="0">for a Koeppen Geiger gridded climatic regions map</text>
<text top="503" left="459" width="171" height="15" font="0">are freely available from</text>
<text top="505" left="637" width="168" height="12" font="5"><a href="http://koeppen-geiger.vu-wien.ac.at/">http://koeppen-geiger.</a></text>
<text top="523" left="459" width="107" height="12" font="5"><a href="http://koeppen-geiger.vu-wien.ac.at/">vu-wien.ac.at/</a></text>
<text top="521" left="566" width="239" height="15" font="0"><a href="http://koeppen-geiger.vu-wien.ac.at/">. </a>The code below shows how to read</text>
<text top="539" left="459" width="332" height="15" font="0">in and plot an ascii file downloaded from that site.</text>
<text top="577" left="459" width="256" height="10" font="8">inFile1 &lt;- 'Koeppen-Geiger-ASCII.txt'</text>
<text top="594" left="459" width="268" height="10" font="8">#read in data which is as lon,lat,catID</text>
<text top="610" left="459" width="316" height="10" font="8">dF&lt;-read.table(inFile1,header=TRUE,as.is=TRUE)</text>
<text top="626" left="459" width="254" height="10" font="8">#convert to sp SpatialPointsDataFrame</text>
<text top="643" left="459" width="226" height="10" font="8">coordinates(dF) = c(&#34;Lon&#34;, &#34;Lat&#34;)</text>
<text top="659" left="459" width="240" height="10" font="8"># promote to SpatialPixelsDataFrame</text>
<text top="676" left="459" width="130" height="10" font="8">gridded(dF) &lt;- TRUE</text>
<text top="692" left="459" width="226" height="10" font="8"># promote to SpatialGridDataFrame</text>
<text top="709" left="459" width="254" height="10" font="8">sGDF = as(dF, &#34;SpatialGridDataFrame&#34;)</text>
<text top="725" left="459" width="89" height="10" font="8">#plotting map</text>
<text top="742" left="459" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="758" left="459" width="219" height="10" font="8">mapParams &lt;- mapGriddedData(sGDF</text>
<text top="774" left="603" width="167" height="10" font="8">,catMethod='categorical'</text>
<text top="791" left="603" width="117" height="10" font="8">,addLegend=FALSE)</text>
<text top="807" left="459" width="165" height="10" font="8">#adding formatted legend</text>
<text top="824" left="459" width="171" height="10" font="8">do.call(addMapLegendBoxes</text>
<text top="840" left="507" width="82" height="10" font="8">,c(mapParams</text>
<text top="857" left="521" width="55" height="10" font="8">,cex=0.8</text>
<text top="873" left="521" width="55" height="10" font="8">,ncol=10</text>
<text top="889" left="521" width="78" height="10" font="8">,x='bottom'</text>
<text top="906" left="521" width="270" height="10" font="8">,title='Koeppen-Geiger Climate Zones'))</text>
<text top="940" left="481" width="324" height="15" font="0">This produces a map that looks a lot different</text>
<text top="958" left="459" width="346" height="15" font="0">from the published map because it is using a differ-</text>
<text top="976" left="459" width="346" height="15" font="0">ent colour palette. The default &#34;heat&#34; colour palette</text>
<text top="994" left="459" width="346" height="15" font="0">is not the best for this categorical data and one of</text>
<text top="1012" left="459" width="346" height="15" font="0">the palettes from <b>RColorBrewer </b>more suitable for</text>
<text top="1030" left="459" width="346" height="15" font="0">categorical data could be used. However it would</text>
<text top="1048" left="459" width="346" height="15" font="0">be good to retain the palette created by the authors</text>
<text top="1065" left="459" width="82" height="15" font="0">of the data.</text>
<text top="1065" left="558" width="247" height="15" font="0">The ascii file does not contain any</text>
<text top="1083" left="459" width="346" height="15" font="0">colour information, however the authors also pro-</text>
<text top="1101" left="459" width="346" height="15" font="0">vide ESRI and Google Earth compatible files that do</text>
<text top="1119" left="459" width="346" height="15" font="0">have colour information. It appeared to be impos-</text>
<text top="1137" left="459" width="346" height="15" font="0">sible to extract the palette from the ESRI files, but</text>
<text top="1155" left="459" width="109" height="15" font="0">by opening the ‘</text>
<text top="1156" left="568" width="28" height="12" font="8">.kmz</text>
<text top="1155" left="596" width="209" height="15" font="0">’ file in Google Earth, saving to</text>
<text top="1173" left="459" width="4" height="15" font="0">‘</text>
<text top="1174" left="463" width="25" height="12" font="8">.kml</text>
<text top="1173" left="488" width="318" height="15" font="0">’ and some fiddly text editing in R the colours</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="33" size="3" family="Helvetica" color="#000000"/>
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">41</text>
<text top="125" left="82" width="346" height="15" font="0">could be extracted as a single column then saved to a</text>
<text top="143" left="82" width="4" height="15" font="0">‘</text>
<text top="144" left="87" width="24" height="12" font="8">.csv</text>
<text top="143" left="111" width="239" height="15" font="0">’ file, the first few lines of which are:</text>
<text top="162" left="105" width="42" height="15" font="0">colour</text>
<text top="180" left="82" width="52" height="15" font="0">#960000</text>
<text top="198" left="82" width="47" height="15" font="0">#ff0000</text>
<text top="216" left="82" width="47" height="15" font="0">#ff9999</text>
<text top="234" left="82" width="44" height="15" font="0">#ffcccc</text>
<text top="252" left="82" width="11" height="15" font="0">...</text>
<text top="272" left="105" width="324" height="15" font="0">Plotting the map in the original colours can then</text>
<text top="290" left="82" width="217" height="15" font="0">be achieved relatively simply by:</text>
<text top="331" left="82" width="178" height="10" font="8">#reading in colour palette</text>
<text top="347" left="82" width="247" height="10" font="8">#as.is=T stops conversion to factors</text>
<text top="364" left="82" width="233" height="10" font="8">#which otherwise messes up colours</text>
<text top="380" left="82" width="318" height="10" font="8">tst &lt;- read.csv('paletteSaved.csv',as.is=TRUE)</text>
<text top="413" left="82" width="89" height="10" font="8">#plotting map</text>
<text top="430" left="82" width="295" height="10" font="8">mapDevice() #create world map shaped window</text>
<text top="446" left="82" width="254" height="10" font="8">#tst$x passes the palette as a vector</text>
<text top="462" left="82" width="219" height="10" font="8">mapParams &lt;- mapGriddedData(sGDF</text>
<text top="479" left="185" width="167" height="10" font="8">,catMethod='categorical'</text>
<text top="495" left="185" width="110" height="10" font="8">,addLegend=FALSE</text>
<text top="512" left="185" width="144" height="10" font="8">,colourPalette=tst$x)</text>
<text top="528" left="82" width="96" height="10" font="8">#adding legend</text>
<text top="545" left="82" width="171" height="10" font="8">do.call(addMapLegendBoxes</text>
<text top="561" left="96" width="82" height="10" font="8">,c(mapParams</text>
<text top="578" left="96" width="55" height="10" font="8">,cex=0.8</text>
<text top="594" left="96" width="48" height="10" font="8">,ncol=3</text>
<text top="610" left="96" width="105" height="10" font="8">,x='bottomleft'</text>
<text top="627" left="96" width="270" height="10" font="8">,title='Koeppen-Geiger Climate Zones'))</text>
<text top="767" left="84" width="75" height="5" font="33">Koeppen−Geiger Climate Zones</text>
<text top="775" left="98" width="5" height="5" font="33">Af</text>
<text top="781" left="98" width="8" height="5" font="33">Am</text>
<text top="787" left="98" width="6" height="5" font="33">As</text>
<text top="793" left="98" width="7" height="5" font="33">Aw</text>
<text top="799" left="98" width="10" height="5" font="33">BSh</text>
<text top="805" left="98" width="10" height="5" font="33">BSk</text>
<text top="811" left="98" width="11" height="5" font="33">BWh</text>
<text top="817" left="98" width="11" height="5" font="33">BWk</text>
<text top="823" left="98" width="8" height="5" font="33">Cfa</text>
<text top="829" left="98" width="8" height="5" font="33">Cfb</text>
<text top="775" left="119" width="8" height="5" font="33">Cfc</text>
<text top="781" left="119" width="9" height="5" font="33">Csa</text>
<text top="787" left="119" width="9" height="5" font="33">Csb</text>
<text top="793" left="119" width="9" height="5" font="33">Csc</text>
<text top="799" left="119" width="10" height="5" font="33">Cwa</text>
<text top="805" left="119" width="10" height="5" font="33">Cwb</text>
<text top="811" left="119" width="10" height="5" font="33">Cwc</text>
<text top="817" left="119" width="8" height="5" font="33">Dfa</text>
<text top="823" left="119" width="8" height="5" font="33">Dfb</text>
<text top="829" left="119" width="8" height="5" font="33">Dfc</text>
<text top="775" left="139" width="8" height="5" font="33">Dfd</text>
<text top="781" left="139" width="9" height="5" font="33">Dsa</text>
<text top="787" left="139" width="9" height="5" font="33">Dsb</text>
<text top="793" left="139" width="9" height="5" font="33">Dsc</text>
<text top="799" left="139" width="10" height="5" font="33">Dwa</text>
<text top="805" left="139" width="10" height="5" font="33">Dwb</text>
<text top="811" left="139" width="10" height="5" font="33">Dwc</text>
<text top="817" left="139" width="10" height="5" font="33">Dwd</text>
<text top="823" left="139" width="7" height="5" font="33">EF</text>
<text top="829" left="139" width="7" height="5" font="33">ET</text>
<text top="859" left="82" width="346" height="15" font="0">Figure 7: ‘Koeppen Geiger’ climatic zones, map pro-</text>
<text top="877" left="82" width="346" height="15" font="0">duced using mapGriddedData() and freely available</text>
<text top="895" left="82" width="29" height="15" font="0">data</text>
<text top="939" left="82" width="346" height="17" font="7"><b>Using rworldmap to map netCDF data in</b></text>
<text top="960" left="82" width="145" height="17" font="7"><b>tandem with ncdf</b></text>
<text top="994" left="82" width="346" height="15" font="0">netCDF is a common file format used in meteorology</text>
<text top="1012" left="82" width="346" height="15" font="0">and oceanography, it is both multi-dimensional and</text>
<text top="1030" left="82" width="346" height="15" font="0">self documented. The package <b>ncdf </b>allows netCDF</text>
<text top="1048" left="82" width="346" height="15" font="0">files to be opened, queried and data extracted di-</text>
<text top="1065" left="82" width="346" height="15" font="0">rectly to R. Data extracted from netCDF files in this</text>
<text top="1083" left="82" width="346" height="15" font="0">way can then be converted to <b>sp </b>objects and plotted</text>
<text top="1101" left="82" width="346" height="15" font="0">using <b>rworldmap</b>. In the example below the netCDF</text>
<text top="1119" left="82" width="32" height="15" font="0">file (</text>
<text top="1118" left="114" width="12" height="15" font="9">∼</text>
<text top="1119" left="131" width="298" height="15" font="0">333 KB) is first downloaded from the IPCC</text>
<text top="1137" left="82" width="179" height="15" font="0">data distribution centre at:</text>
<text top="1139" left="268" width="161" height="12" font="5"><a href="http://www.ipcc-data.org/cgi-bin/downl/ar4_nc/tas/HADCM3_SRA1B_1_tas-change_2046-2065.cyto180.nc">http://www.ipcc-data.</a></text>
<text top="1156" left="82" width="336" height="12" font="5"><a href="http://www.ipcc-data.org/cgi-bin/downl/ar4_nc/tas/HADCM3_SRA1B_1_tas-change_2046-2065.cyto180.nc">org/cgi-bin/downl/ar4_nc/tas/HADCM3_SRA1B_1_</a></text>
<text top="1174" left="82" width="238" height="12" font="5"><a href="http://www.ipcc-data.org/cgi-bin/downl/ar4_nc/tas/HADCM3_SRA1B_1_tas-change_2046-2065.cyto180.nc">tas-change_2046-2065.cyto180.nc</a></text>
<text top="1173" left="320" width="4" height="15" font="0"><a href="http://www.ipcc-data.org/cgi-bin/downl/ar4_nc/tas/HADCM3_SRA1B_1_tas-change_2046-2065.cyto180.nc">.</a></text>
<text top="125" left="481" width="262" height="15" font="0">This particular file was accessed from:</text>
<text top="126" left="752" width="53" height="12" font="5"><a href="http://www.ipcc-data.org/ar4/info/UKMO-HADCM3_SRA1B_tas.html">http://</a></text>
<text top="144" left="459" width="344" height="12" font="5"><a href="http://www.ipcc-data.org/ar4/info/UKMO-HADCM3_SRA1B_tas.html">www.ipcc-data.org/ar4/info/UKMO-HADCM3_SRA1B_</a></text>
<text top="162" left="459" width="61" height="12" font="5"><a href="http://www.ipcc-data.org/ar4/info/UKMO-HADCM3_SRA1B_tas.html">tas.html</a></text>
<text top="179" left="481" width="324" height="15" font="0">The ’lon180’ option was chosen to get a file with</text>
<text top="197" left="459" width="150" height="15" font="0">longitude values from</text>
<text top="196" left="614" width="12" height="15" font="9">−</text>
<text top="197" left="627" width="179" height="15" font="0">180 to 180 as that requires</text>
<text top="215" left="459" width="180" height="15" font="0">less editing before plotting.</text>
<text top="249" left="459" width="89" height="10" font="8">library(ncdf)</text>
<text top="266" left="459" width="137" height="10" font="8">#the downloaded file</text>
<text top="282" left="459" width="62" height="10" font="8">inFile &lt;-</text>
<text top="299" left="479" width="332" height="10" font="8">'HADCM3_SRA1B_1_tas-change_2046-2065.cyto180.nc'</text>
<text top="315" left="459" width="295" height="10" font="8">memory.limit(4000) #set memory limit to max</text>
<text top="331" left="459" width="240" height="10" font="8">nc = open.ncdf(inFile, write=FALSE)</text>
<text top="364" left="481" width="69" height="12" font="0">print(nc)</text>
<text top="363" left="555" width="250" height="15" font="0">prints to console a description of the</text>
<text top="381" left="459" width="346" height="15" font="0">file contents which includes the information shown</text>
<text top="398" left="459" width="226" height="15" font="0">below (edited slightly for brevity).</text>
<text top="433" left="459" width="178" height="10" font="8">file ... has 4 dimensions:</text>
<text top="449" left="459" width="27" height="10" font="8">time</text>
<text top="449" left="507" width="55" height="10" font="8">Size: 12</text>
<text top="466" left="459" width="55" height="10" font="8">latitude</text>
<text top="466" left="534" width="55" height="10" font="8">Size: 73</text>
<text top="482" left="459" width="62" height="10" font="8">longitude</text>
<text top="482" left="541" width="55" height="10" font="8">Size: 96</text>
<text top="499" left="459" width="41" height="10" font="8">bounds</text>
<text top="499" left="521" width="48" height="10" font="8">Size: 2</text>
<text top="515" left="459" width="165" height="10" font="8">------------------------</text>
<text top="531" left="459" width="165" height="10" font="8">file ... has 4 variables</text>
<text top="548" left="459" width="274" height="10" font="8">float climatological_bounds[bounds,time]</text>
<text top="564" left="459" width="261" height="10" font="8">float latitude_bounds[bounds,latitude]</text>
<text top="581" left="459" width="274" height="10" font="8">float longitude_bounds[bounds,longitude]</text>
<text top="597" left="459" width="34" height="10" font="8">float</text>
<text top="614" left="479" width="329" height="10" font="8">air_temperature_anomaly[longitude,latitude,time]</text>
<text top="645" left="481" width="35" height="15" font="0">After</text>
<text top="645" left="531" width="21" height="15" font="0">the</text>
<text top="645" left="568" width="51" height="15" font="0">netCDF</text>
<text top="645" left="635" width="21" height="15" font="0">file</text>
<text top="645" left="671" width="23" height="15" font="0">has</text>
<text top="645" left="709" width="31" height="15" font="0">been</text>
<text top="645" left="756" width="49" height="15" font="0">opened</text>
<text top="663" left="459" width="95" height="15" font="0">in this way,</text>
<text top="663" left="570" width="235" height="15" font="0">selected variables can be read</text>
<text top="681" left="459" width="346" height="15" font="0">into R using get.var.ncdf(), converted to a</text>
<text top="700" left="459" width="152" height="12" font="0">SpatialGridDataFrame</text>
<text top="699" left="627" width="25" height="15" font="0">and</text>
<text top="699" left="668" width="48" height="15" font="0">plotted</text>
<text top="699" left="732" width="37" height="15" font="0">using</text>
<text top="699" left="785" width="21" height="15" font="0">the</text>
<text top="717" left="459" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="717" left="544" width="175" height="15" font="0">function mapGriddedData.</text>
<text top="717" left="740" width="65" height="15" font="0">The code</text>
<text top="735" left="459" width="346" height="15" font="0">below first creates a grid from the parameters in</text>
<text top="752" left="459" width="346" height="15" font="0">netCDF file, and is written to be generic so that it</text>
<text top="770" left="459" width="346" height="15" font="0">should work on other similar netCDF files. Then it</text>
<text top="788" left="459" width="346" height="15" font="0">creates a standard classification and colour scheme</text>
<text top="806" left="459" width="346" height="15" font="0">for all of the plots based on having looked at the val-</text>
<text top="824" left="459" width="346" height="15" font="0">ues in each months data first. Finally it loops through</text>
<text top="842" left="459" width="346" height="15" font="0">all months reads in the data for that month, creates a</text>
<text top="860" left="459" width="346" height="15" font="0">spatialGridDataFrame for each, plots it and saves it</text>
<text top="878" left="459" width="33" height="15" font="0">as a ‘</text>
<text top="879" left="492" width="26" height="12" font="8">.png</text>
<text top="878" left="518" width="8" height="15" font="0">’.</text>
<text top="912" left="459" width="62" height="10" font="8">ncArray =</text>
<text top="929" left="479" width="291" height="10" font="8">get.var.ncdf(nc,'air_temperature_anomaly')</text>
<text top="962" left="459" width="329" height="10" font="8"># creating gridTopology from the netCDF metadata</text>
<text top="978" left="459" width="254" height="10" font="8">offset = c(min(nc$dim$longitude$vals)</text>
<text top="995" left="527" width="185" height="10" font="8">,min(nc$dim$latitude$vals))</text>
<text top="1011" left="459" width="350" height="10" font="8">cellsize = c( abs(diff(nc$dim$longitude$vals[1:2]))</text>
<text top="1027" left="541" width="268" height="10" font="8">, abs(diff(nc$dim$latitude$vals[1:2])))</text>
<text top="1044" left="459" width="178" height="10" font="8"># add cellsize/2 to offset</text>
<text top="1060" left="459" width="343" height="10" font="8"># to convert from lower left referencing to centre</text>
<text top="1077" left="459" width="192" height="10" font="8">offset = offset + cellsize/2</text>
<text top="1093" left="459" width="233" height="10" font="8">cells.dim = c(nc$dim$longitude$len</text>
<text top="1110" left="548" width="151" height="10" font="8">,nc$dim$latitude$len )</text>
<text top="1142" left="459" width="309" height="10" font="8">gt &lt;- GridTopology(cellcentre.offset = offset</text>
<text top="1159" left="582" width="144" height="10" font="8">, cellsize = cellsize</text>
<text top="1175" left="582" width="171" height="10" font="8">, cells.dim = cells.dim )</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="82" width="15" height="15" font="0">42</text>
<text top="67" left="562" width="11" height="15" font="0">C</text>
<text top="69" left="573" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="664" width="10" height="15" font="0">R</text>
<text top="69" left="674" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="740" width="12" height="15" font="0">A</text>
<text top="69" left="752" width="53" height="12" font="1">RTICLES</text>
<text top="127" left="82" width="75" height="10" font="8">mapDevice()</text>
<text top="144" left="82" width="268" height="10" font="8">#creating a vector to classify the data</text>
<text top="160" left="82" width="226" height="10" font="8">catMethod=seq(from=-5,to=19,by=2)</text>
<text top="177" left="82" width="268" height="10" font="8">#creating a colourPalette for all plots</text>
<text top="193" left="82" width="254" height="10" font="8">#-ve blue, 0 white, +ve yellow to red</text>
<text top="210" left="82" width="295" height="10" font="8">colourPalette=c('blue','lightblue','white'</text>
<text top="226" left="185" width="167" height="10" font="8">,brewer.pal(9,'YlOrRd'))</text>
<text top="259" left="82" width="158" height="10" font="8">#looping for each month</text>
<text top="275" left="82" width="240" height="10" font="8">for( zDim in 1 : nc$dim$time$len ){</text>
<text top="292" left="89" width="233" height="10" font="8">#reading the values for this month</text>
<text top="308" left="89" width="185" height="10" font="8">ncMatrix &lt;- ncArray[,,zDim]</text>
<text top="325" left="89" width="233" height="10" font="8">#to get the image up the right way</text>
<text top="341" left="89" width="316" height="10" font="8">#this reverses the y values but not the x ones</text>
<text top="357" left="89" width="316" height="10" font="8">ncMatrix2 &lt;-ncMatrix[ ,nc$dim$latitude$len:1 ]</text>
<text top="374" left="89" width="322" height="10" font="8">gridVals &lt;-data.frame(att=as.vector(ncMatrix2))</text>
<text top="390" left="89" width="219" height="10" font="8">#creating a spatialGridDataFrame</text>
<text top="407" left="89" width="316" height="10" font="8">sGDF &lt;-SpatialGridDataFrame(gt, data=gridVals)</text>
<text top="440" left="89" width="322" height="10" font="8">#plotting the map and getting params for legend</text>
<text top="456" left="89" width="226" height="10" font="8">mapParams &lt;- mapGriddedData( sGDF</text>
<text top="473" left="185" width="160" height="10" font="8">,nameColumnToPlot='att'</text>
<text top="489" left="185" width="137" height="10" font="8">,catMethod=catMethod</text>
<text top="505" left="185" width="192" height="10" font="8">,colourPalette=colourPalette</text>
<text top="522" left="185" width="123" height="10" font="8">,addLegend=FALSE )</text>
<text top="538" left="89" width="165" height="10" font="8">#adding formatted legend</text>
<text top="555" left="89" width="137" height="10" font="8">do.call(addMapLegend</text>
<text top="571" left="137" width="82" height="10" font="8">,c(mapParams</text>
<text top="588" left="137" width="130" height="10" font="8">,legendLabels=&#34;all&#34;</text>
<text top="604" left="137" width="110" height="10" font="8">,legendWidth=0.5</text>
<text top="620" left="137" width="110" height="10" font="8">,legendMar = 3))</text>
<text top="637" left="89" width="325" height="10" font="8">title(paste('month :',zDim))#adding brief title</text>
<text top="670" left="89" width="153" height="10" font="8">outputPlotType = 'png'</text>
<text top="686" left="89" width="339" height="10" font="8">savePlot(paste(&#34;ipccAirAnomalyMonth&#34;,zDim,sep='')</text>
<text top="703" left="144" width="144" height="10" font="8">,type=outputPlotType)</text>
<text top="719" left="82" width="137" height="10" font="8">} #end of month loop</text>
<text top="736" left="82" width="254" height="10" font="8">close.ncdf(nc) #closing the ncdf file</text>
<text top="1140" left="82" width="65" height="15" font="0">Figure 8:</text>
<text top="1140" left="166" width="263" height="15" font="0">Two examples of IPCC temperature</text>
<text top="1158" left="82" width="346" height="15" font="0">anomaly data (for December and June respectively)</text>
<text top="1176" left="82" width="214" height="15" font="0">plotted using mapGriddedData()</text>
<text top="121" left="459" width="96" height="21" font="4"><b>Summary</b></text>
<text top="160" left="459" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="160" left="539" width="266" height="15" font="0">is a new package to facilitate the display</text>
<text top="178" left="459" width="346" height="15" font="0">of global data, referenced by grid, country or region.</text>
<text top="196" left="459" width="174" height="15" font="0">It is available on CRAN at</text>
<text top="197" left="637" width="168" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmap">http://cran.r-project.</a></text>
<text top="215" left="459" width="198" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmap">org/web/packages/rworldmap</a></text>
<text top="214" left="657" width="148" height="15" font="0"><a href="http://cran.r-project.org/web/packages/rworldmap">. </a><b>rworldmap </b>aims to</text>
<text top="232" left="459" width="346" height="15" font="0">provide tools to improve the communication and</text>
<text top="250" left="459" width="346" height="15" font="0">understanding of world datasets. If you have any</text>
<text top="268" left="459" width="346" height="15" font="0">comments or suggestions or would like to contribute</text>
<text top="285" left="459" width="346" height="15" font="0">code please get in touch. The source code and de-</text>
<text top="303" left="459" width="252" height="15" font="0">velopment versions are available from</text>
<text top="305" left="714" width="91" height="12" font="5"><a href="http://code.google.com/p/rworld/">http://code.</a></text>
<text top="323" left="459" width="152" height="12" font="5"><a href="http://code.google.com/p/rworld/">google.com/p/rworld/</a></text>
<text top="321" left="611" width="194" height="15" font="0"><a href="http://code.google.com/p/rworld/">. </a>I plan to extend this work by</text>
<text top="339" left="459" width="346" height="15" font="0">making datasets, including those used in this paper,</text>
<text top="357" left="459" width="346" height="15" font="0">more easily accessible, perhaps through a package</text>
<text top="375" left="459" width="346" height="15" font="0">called <b>rworldmapData</b>. We are also working on vi-</text>
<text top="393" left="459" width="346" height="15" font="0">sualisations to communicate more information than</text>
<text top="411" left="459" width="346" height="15" font="0">by maps alone. For more help on rworldmap there is</text>
<text top="429" left="459" width="144" height="15" font="0">a vignette available at</text>
<text top="430" left="606" width="199" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmap/vignettes/rworldmap.pdf">http://cran.r-project.org/</a></text>
<text top="448" left="459" width="328" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmap/vignettes/rworldmap.pdf">web/packages/rworldmap/vignettes/rworldmap.</a></text>
<text top="466" left="459" width="23" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmap/vignettes/rworldmap.pdf">pdf</a></text>
<text top="465" left="490" width="109" height="15" font="0">and an FAQ at</text>
<text top="466" left="606" width="199" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmapvignettes/rworldmapFAQ.pdf">http://cran.r-project.org/</a></text>
<text top="484" left="459" width="343" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmapvignettes/rworldmapFAQ.pdf">web/packages/rworldmapvignettes/rworldmapFAQ.</a></text>
<text top="502" left="459" width="23" height="12" font="5"><a href="http://cran.r-project.org/web/packages/rworldmapvignettes/rworldmapFAQ.pdf">pdf</a></text>
<text top="501" left="482" width="4" height="15" font="0"><a href="http://cran.r-project.org/web/packages/rworldmapvignettes/rworldmapFAQ.pdf">.</a></text>
<text top="550" left="459" width="196" height="21" font="4"><b>Acknowledgements</b></text>
<text top="589" left="459" width="346" height="15" font="0">This work was funded by NERC through the QUEST</text>
<text top="607" left="459" width="346" height="15" font="0">Data Initiative (QESDI) and QUEST Global Systems</text>
<text top="625" left="459" width="346" height="15" font="0">Impacts (GSI) projects. Thanks to Pru Foster and</text>
<text top="643" left="459" width="346" height="15" font="0">Sarah Cornell at QUEST and Graham Pilling at Cefas</text>
<text top="661" left="459" width="346" height="15" font="0">without whose enthusiasm this would not have hap-</text>
<text top="679" left="459" width="346" height="15" font="0">pened. Thanks to Martin Juckes for understanding</text>
<text top="697" left="459" width="346" height="15" font="0">project management, Barry Rowlingson and Roger</text>
<text top="715" left="459" width="346" height="15" font="0">Bivand for their contributions at a startup workshop</text>
<text top="732" left="459" width="346" height="15" font="0">and after, and to Nick Dulvy, Joe Scutt-Phillips and</text>
<text top="750" left="459" width="346" height="15" font="0">Elisabeth Simelton for inspiration on global vulnera-</text>
<text top="768" left="459" width="172" height="15" font="0">bility analyses and colour.</text>
<text top="817" left="459" width="130" height="21" font="4"><b>Bibliography</b></text>
<text top="856" left="459" width="68" height="15" font="0">N. Marks</text>
<text top="856" left="551" width="154" height="15" font="0">GDP RIP (1933-2010).</text>
<text top="856" left="728" width="77" height="15" font="0">Significance,</text>
<text top="874" left="474" width="258" height="15" font="0">7(1):27–30, 2010. Published Online:</text>
<text top="874" left="754" width="51" height="15" font="0">23 Feb</text>
<text top="892" left="474" width="30" height="15" font="0">2010</text>
<text top="892" left="529" width="31" height="15" font="0">URL</text>
<text top="893" left="569" width="236" height="12" font="5"><a href="http://www3.interscience.wiley.com/cgi-bin/fulltext/123300797/PDFSTART">http://www3.interscience.wiley.</a></text>
<text top="911" left="474" width="298" height="12" font="5"><a href="http://www3.interscience.wiley.com/cgi-bin/fulltext/123300797/PDFSTART">com/cgi-bin/fulltext/123300797/PDFSTART</a></text>
<text top="910" left="772" width="4" height="15" font="0"><a href="http://www3.interscience.wiley.com/cgi-bin/fulltext/123300797/PDFSTART">.</a></text>
<text top="941" left="459" width="346" height="15" font="0">The Onion Our Dumb World: The Onion’s Atlas of</text>
<text top="959" left="474" width="110" height="15" font="0">the Planet Earth.</text>
<text top="959" left="602" width="204" height="15" font="0">Little, Brown, and Company,</text>
<text top="977" left="474" width="243" height="15" font="0">2007. ISBN: 978 0 7528 9120 0. URL</text>
<text top="979" left="721" width="84" height="12" font="5"><a href="http://www.theonion.com/">http://www.</a></text>
<text top="997" left="474" width="99" height="12" font="5"><a href="http://www.theonion.com/">theonion.com/</a></text>
<text top="995" left="573" width="4" height="15" font="0"><a href="http://www.theonion.com/">.</a></text>
<text top="1047" left="459" width="73" height="15" font="0">Andy South</text>
<text top="1065" left="459" width="346" height="15" font="0">Centre for Environment, Fisheries and Aquaculture Sci-</text>
<text top="1083" left="459" width="72" height="15" font="0">ence (Cefas)</text>
<text top="1101" left="459" width="262" height="15" font="0">Pakefield Road, Lowestoft, NR33 OHT, UK</text>
<text top="1119" left="459" width="285" height="15" font="0">Current address: Graduate School of Education</text>
<text top="1137" left="459" width="123" height="15" font="0">University of Exeter</text>
<text top="1155" left="459" width="133" height="15" font="0">Exeter, EX1 2LU, UK</text>
<text top="1174" left="459" width="145" height="12" font="5"><a href="mailto:southandy@gmail.com">southandy@gmail.com</a></text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1262" width="892">
<text top="67" left="83" width="11" height="15" font="0">C</text>
<text top="69" left="94" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="67" left="184" width="10" height="15" font="0">R</text>
<text top="69" left="195" width="61" height="12" font="1">ESEARCH</text>
<text top="67" left="261" width="12" height="15" font="0">A</text>
<text top="69" left="273" width="53" height="12" font="1">RTICLES</text>
<text top="67" left="790" width="15" height="15" font="0">43</text>
<text top="121" left="82" width="103" height="21" font="4"><b>Appendix:</b></text>
<text top="121" left="236" width="111" height="21" font="4"><b>Comparing</b></text>
<text top="121" left="374" width="55" height="21" font="4"><b>using</b></text>
<text top="148" left="82" width="252" height="21" font="4"><b>rworldmap to not using it</b></text>
<text top="187" left="82" width="346" height="15" font="0">Here I show a brief comparison between using</text>
<text top="205" left="82" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="205" left="165" width="264" height="15" font="0">and not. It is not my intention to set</text>
<text top="222" left="82" width="346" height="15" font="0">up a straw-man that demonstrates how superior my</text>
<text top="240" left="82" width="346" height="15" font="0">package is to others. Other packages have different</text>
<text top="258" left="82" width="346" height="15" font="0">objectives, by focusing on world maps I can afford</text>
<text top="276" left="82" width="346" height="15" font="0">to ignore certain details. It is only by building on</text>
<text top="294" left="82" width="346" height="15" font="0">the great work in other packages that I have been</text>
<text top="312" left="82" width="346" height="15" font="0">able to get this far. Those caveats aside here is the</text>
<text top="330" left="82" width="346" height="15" font="0">comparison using some data on alcohol consump-</text>
<text top="348" left="82" width="346" height="15" font="0">tion per adult by country, downloaded as an Ex-</text>
<text top="366" left="82" width="258" height="15" font="0">cel file from the gapminder website at</text>
<text top="367" left="345" width="84" height="12" font="5"><a href="http://www.gapminder.org/data/">http://www.</a></text>
<text top="385" left="82" width="145" height="12" font="5"><a href="http://www.gapminder.org/data/">gapminder.org/data/</a></text>
<text top="384" left="231" width="105" height="15" font="0">and saved as a ‘</text>
<text top="385" left="337" width="24" height="12" font="8">.csv</text>
<text top="384" left="361" width="68" height="15" font="0">’. Reading</text>
<text top="402" left="82" width="280" height="15" font="0">in the data is common to both approaches:</text>
<text top="433" left="82" width="352" height="10" font="8">inFile &lt;- 'indicatoralcoholconsumption20100830.csv'</text>
<text top="450" left="82" width="151" height="10" font="8">dF &lt;- read.csv(inFile)</text>
<text top="489" left="82" width="145" height="17" font="7"><b>Using rworldmap</b></text>
<text top="520" left="82" width="123" height="10" font="8">library(rworldmap)</text>
<text top="536" left="82" width="213" height="10" font="8">sPDF &lt;- joinCountryData2Map(dF,</text>
<text top="553" left="165" width="130" height="10" font="8">, joinCode = &#34;NAME&#34;</text>
<text top="569" left="165" width="151" height="10" font="8">, nameJoinColumn = &#34;X&#34;</text>
<text top="586" left="165" width="171" height="10" font="8">, nameCountryColumn = &#34;X&#34;</text>
<text top="602" left="165" width="117" height="10" font="8">, verbose = TRUE)</text>
<text top="635" left="82" width="311" height="10" font="8">mapCountryData(sPDF,nameColumnToPlot='X2005')</text>
<text top="674" left="82" width="177" height="17" font="7"><b>Not using rworldmap</b></text>
<text top="705" left="82" width="117" height="10" font="8">library(maptools)</text>
<text top="722" left="82" width="103" height="10" font="8">library(fields)</text>
<text top="738" left="82" width="69" height="10" font="8">## get map</text>
<text top="755" left="82" width="268" height="10" font="8">data(wrld_simpl) #from package maptools</text>
<text top="771" left="82" width="69" height="10" font="8">## joining</text>
<text top="787" left="82" width="165" height="10" font="8">#first identify failures</text>
<text top="804" left="82" width="192" height="10" font="8">matchPosnsInLookup &lt;- match(</text>
<text top="820" left="151" width="123" height="10" font="8">as.character(dF$X)</text>
<text top="837" left="144" width="213" height="10" font="8">,as.character(wrld_simpl$NAME))</text>
<text top="853" left="82" width="316" height="10" font="8">failedCodes &lt;- dF$X[is.na(matchPosnsInLookup)]</text>
<text top="870" left="82" width="254" height="10" font="8">numFailedCodes &lt;- length(failedCodes)</text>
<text top="903" left="82" width="171" height="10" font="8">#printing info to console</text>
<text top="919" left="82" width="123" height="10" font="8">cat(numFailedCodes</text>
<text top="935" left="110" width="281" height="10" font="8">,&#34;countries failed to join to the map\n&#34;)</text>
<text top="952" left="82" width="123" height="10" font="8">print(failedCodes)</text>
<text top="968" left="82" width="226" height="10" font="8">#find match positions in the data</text>
<text top="985" left="82" width="178" height="10" font="8">matchPosnsInData &lt;- match(</text>
<text top="1001" left="158" width="199" height="10" font="8">as.character(wrld_simpl$NAME)</text>
<text top="1018" left="151" width="137" height="10" font="8">,as.character(dF$X))</text>
<text top="1034" left="82" width="151" height="10" font="8"># join data to the map</text>
<text top="1050" left="82" width="274" height="10" font="8">wrld_simpl@data &lt;- cbind(wrld_simpl@data</text>
<text top="1067" left="247" width="165" height="10" font="8">, dF[matchPosnsInData,])</text>
<text top="1100" left="82" width="302" height="10" font="8">#sizing window to a good shape for the world</text>
<text top="127" left="459" width="185" height="10" font="8">dev.new(width=9,height=4.5)</text>
<text top="144" left="459" width="268" height="10" font="8">#so that maps extends to edge of window</text>
<text top="160" left="459" width="213" height="10" font="8">oldpar &lt;- par(mai=c(0,0,0.2,0))</text>
<text top="193" left="459" width="151" height="10" font="8">#categorising the data</text>
<text top="210" left="459" width="82" height="10" font="8">numCats &lt;- 7</text>
<text top="226" left="459" width="240" height="10" font="8">quantileProbs &lt;- seq(0,1,1/numCats)</text>
<text top="242" left="459" width="295" height="10" font="8">quantileBreaks &lt;- quantile(wrld_simpl$X2005</text>
<text top="259" left="637" width="55" height="10" font="8">,na.rm=T</text>
<text top="275" left="637" width="144" height="10" font="8">,probs=quantileProbs)</text>
<text top="308" left="459" width="288" height="10" font="8">wrld_simpl$toPlot &lt;- cut( wrld_simpl$X2005</text>
<text top="325" left="623" width="158" height="10" font="8">, breaks=quantileBreaks</text>
<text top="341" left="623" width="82" height="10" font="8">, labels=F )</text>
<text top="357" left="459" width="89" height="10" font="8">#plotting map</text>
<text top="374" left="459" width="103" height="10" font="8">plot(wrld_simpl</text>
<text top="390" left="486" width="343" height="10" font="8">,col=rev(heat.colors(numCats))[wrld_simpl$toPlot])</text>
<text top="423" left="459" width="268" height="10" font="8">#adding legend using the fields package</text>
<text top="440" left="459" width="274" height="10" font="8">zlim &lt;- range(quantileBreaks,na.rm=TRUE)</text>
<text top="456" left="459" width="185" height="10" font="8">image.plot(legend.only=TRUE</text>
<text top="473" left="527" width="69" height="10" font="8">,zlim=zlim</text>
<text top="489" left="527" width="206" height="10" font="8">,col=rev(heat.colors(numCats))</text>
<text top="505" left="527" width="151" height="10" font="8">,breaks=quantileBreaks</text>
<text top="522" left="527" width="117" height="10" font="8">,horizontal=TRUE)</text>
<text top="555" left="459" width="247" height="10" font="8">par(oldpar) #reset graphics settings</text>
<text top="605" left="481" width="324" height="15" font="0">Slight differences in country naming, and an ab-</text>
<text top="623" left="459" width="346" height="15" font="0">sence of country codes, causes 9 countries not to</text>
<text top="641" left="459" width="346" height="15" font="0">to join in both approaches. joinCountryData2Map()</text>
<text top="659" left="459" width="346" height="15" font="0">outputs the identities of these countries. This means</text>
<text top="677" left="459" width="346" height="15" font="0">that in the maps it incorrectly looks like alcohol con-</text>
<text top="695" left="459" width="346" height="15" font="0">sumption is zero in both the UK and USA. To correct</text>
<text top="713" left="459" width="346" height="15" font="0">this the country names need to be renamed prior to</text>
<text top="731" left="459" width="141" height="15" font="0">joining, either in the ‘</text>
<text top="732" left="600" width="24" height="12" font="8">.csv</text>
<text top="731" left="624" width="182" height="15" font="0">’ or in the dataframe. In the</text>
<text top="749" left="459" width="317" height="15" font="0">R dataframe the countries could be renamed by:</text>
<text top="785" left="459" width="356" height="9" font="1">n1&lt;-'United Kingdom of Great Britain and Northern Ireland'</text>
<text top="799" left="459" width="124" height="9" font="1">n2&lt;-'United Kingdom'</text>
<text top="813" left="459" width="262" height="9" font="1">levels(dF$X)[which(levels(dF$X)==n1)] &lt;- n2</text>
<text top="846" left="481" width="324" height="15" font="0">The objective for <b>rworldmap </b>is to make world</text>
<text top="864" left="459" width="346" height="15" font="0">mapping easier, based on difficulties experienced by</text>
<text top="882" left="459" width="346" height="15" font="0">the author and project collaborators. Of course, there</text>
<text top="900" left="459" width="346" height="15" font="0">is still a learning curve associated with being able to</text>
<text top="918" left="459" width="346" height="15" font="0">use <b>rworldmap </b>itself. All of the operations shown</text>
<text top="936" left="459" width="346" height="15" font="0">in this paper can be accomplished by accomplished</text>
<text top="954" left="459" width="346" height="15" font="0">R programmers without the need for <b>rworldmap</b>,</text>
<text top="972" left="459" width="346" height="15" font="0">however in an inter-disciplinary project <b>rworldmap</b></text>
<text top="990" left="459" width="346" height="15" font="0">made it easier for scientists who are new to R to start</text>
<text top="1008" left="459" width="346" height="15" font="0">producing outputs, and encouraged them to extend</text>
<text top="1026" left="459" width="346" height="15" font="0">their R learning further. There are repetitive data</text>
<text top="1044" left="459" width="346" height="15" font="0">manipulation routines that are tricky to implement,</text>
<text top="1062" left="459" width="76" height="15" font="3"><b>rworldmap</b></text>
<text top="1062" left="540" width="265" height="15" font="0">reduces the time spent on these so that</text>
<text top="1080" left="459" width="346" height="15" font="0">more time can be spent on the important task of com-</text>
<text top="1098" left="459" width="198" height="15" font="0">municating what the data say.</text>
<text top="1218" left="82" width="220" height="15" font="0">The R Journal Vol. 3/1, June 2011</text>
<text top="1218" left="704" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
</pdf2xml>
