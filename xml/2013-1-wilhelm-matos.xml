<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pdf2xml SYSTEM "pdf2xml.dtd">

<pdf2xml producer="poppler" version="0.30.0">
<page number="1" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="0" size="12" family="Times" color="#000000"/>
	<fontspec id="1" size="9" family="Times" color="#000000"/>
	<fontspec id="2" size="28" family="Times" color="#000000"/>
	<fontspec id="3" size="11" family="Times" color="#000000"/>
	<fontspec id="4" size="11" family="Times" color="#000000"/>
	<fontspec id="5" size="15" family="Times" color="#000000"/>
	<fontspec id="6" size="11" family="Times" color="#7282aa"/>
	<fontspec id="7" size="11" family="Times" color="#7282aa"/>
	<fontspec id="8" size="11" family="Times" color="#000000"/>
	<fontspec id="9" size="11" family="Times" color="#000000"/>
	<fontspec id="10" size="8" family="Times" color="#000000"/>
	<fontspec id="11" size="8" family="Times" color="#000000"/>
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">130</text>
<text top="98" left="149" width="538" height="30" font="2"><b>Estimating Spatial Probit Models in R</b></text>
<text top="134" left="149" width="299" height="15" font="0">by Stefan Wilhelm and Miguel Godinho de Matos</text>
<text top="175" left="148" width="52" height="13" font="3"><b>Abstract</b></text>
<text top="175" left="206" width="538" height="13" font="4">In this article we present the Bayesian estimation of spatial probit models in R and provide an</text>
<text top="192" left="149" width="595" height="13" font="4">implementation in the package <b>spatialprobit</b>. We show that large probit models can be estimated with</text>
<text top="208" left="149" width="595" height="13" font="4">sparse matrix representations and Gibbs sampling of a truncated multivariate normal distribution with</text>
<text top="224" left="149" width="595" height="13" font="4">the precision matrix. We present three examples and point to ways to achieve further performance</text>
<text top="241" left="149" width="440" height="13" font="4">gains through parallelization of the Markov Chain Monte Carlo approach.</text>
<text top="286" left="149" width="104" height="17" font="5"><b>Introduction</b></text>
<text top="325" left="148" width="596" height="13" font="4">The abundance of geolocation data and social network data has lead to a growing interest in spatial</text>
<text top="341" left="149" width="595" height="13" font="4">econometric methods, which model a contemporaneous dependence structure using neighboring</text>
<text top="357" left="149" width="268" height="13" font="4">observations (e.g. friends in social networks).</text>
<text top="378" left="171" width="519" height="13" font="4">There are a variety of R packages for spatial models available, an incomplete list includes</text>
<text top="378" left="694" width="50" height="13" font="6"><a href="http://CRAN.R-project.org/package=spBayes"><b>spBayes</b></a></text>
<text top="395" left="148" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="395" left="153" width="119" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Finley and Banerjee</a></text>
<text top="395" left="271" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="395" left="278" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="395" left="305" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">),</a></text>
<text top="395" left="317" width="41" height="13" font="6"><a href="http://CRAN.R-project.org/package=spatial"><b>spatial</b></a></text>
<text top="395" left="361" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="395" left="366" width="123" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Venables and Ripley</a></text>
<text top="395" left="488" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="395" left="495" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2002</a></text>
<text top="395" left="522" width="187" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">), </a>geostatistical packages called</text>
<text top="395" left="713" width="31" height="13" font="6"><a href="http://CRAN.R-project.org/package=geoR"><b>geoR</b></a></text>
<text top="411" left="148" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="411" left="153" width="115" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Diggle and Ribeiro</a></text>
<text top="411" left="268" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="411" left="276" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2007</a></text>
<text top="411" left="303" width="32" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>and</text>
<text top="411" left="339" width="49" height="13" font="6"><a href="http://CRAN.R-project.org/package=sgeostat"><b>sgeostat</b></a></text>
<text top="411" left="392" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="411" left="396" width="132" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Majure and Gebhardt</a></text>
<text top="411" left="528" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="411" left="535" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="411" left="563" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">),</a></text>
<text top="411" left="575" width="37" height="13" font="6"><a href="http://CRAN.R-project.org/package=spdep"><b>spdep</b></a></text>
<text top="411" left="616" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="411" left="620" width="43" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Bivand</a></text>
<text top="411" left="664" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="411" left="671" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2013</a></text>
<text top="411" left="698" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">),</a></text>
<text top="411" left="710" width="34" height="13" font="6"><a href="http://CRAN.R-project.org/package=sphet"><b>sphet</b></a></text>
<text top="428" left="148" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="428" left="153" width="30" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Piras</a></text>
<text top="428" left="183" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="428" left="189" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2010</a></text>
<text top="428" left="216" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">),</a></text>
<text top="428" left="227" width="21" height="13" font="6"><a href="http://CRAN.R-project.org/package=sna"><b>sna</b></a></text>
<text top="428" left="252" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="428" left="256" width="31" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Butts</a></text>
<text top="428" left="287" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="428" left="294" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2013</a></text>
<text top="428" left="321" width="31" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>and</text>
<text top="428" left="355" width="52" height="13" font="6"><a href="http://CRAN.R-project.org/package=network"><b>network</b></a></text>
<text top="428" left="410" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="428" left="414" width="62" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Butts et al.</a></text>
<text top="428" left="476" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="428" left="483" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2013</a></text>
<text top="428" left="510" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">).</a></text>
<text top="449" left="171" width="573" height="13" font="4">While all of these packages deal with linear spatial models, in this article we focus on a nonlinear</text>
<text top="465" left="149" width="510" height="13" font="4">model, the spatial probit model, and present the Bayesian estimation first proposed by</text>
<text top="465" left="662" width="42" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage</a></text>
<text top="465" left="707" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="465" left="712" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2000</a></text>
<text top="465" left="739" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">).</a></text>
<text top="481" left="148" width="596" height="13" font="4">As will be shown below, one crucial point we have been working on was the generation of random</text>
<text top="498" left="149" width="487" height="13" font="4">numbers of a truncated multivariate normal distribution in very high dimensions.</text>
<text top="519" left="171" width="573" height="13" font="4">Together with these high dimensions and the size of problems in spatial models comes the need to</text>
<text top="535" left="148" width="596" height="13" font="4">work with sparse matrix representations rather than the usual dense matrix(). Popular R packages</text>
<text top="552" left="149" width="217" height="13" font="4">for dealing with sparse matrices are</text>
<text top="552" left="369" width="41" height="13" font="6"><a href="http://CRAN.R-project.org/package=Matrix"><b>Matrix</b></a></text>
<text top="552" left="413" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="552" left="418" width="119" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Bates and Maechler</a></text>
<text top="552" left="537" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="552" left="543" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2013</a></text>
<text top="552" left="571" width="31" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>and</text>
<text top="552" left="606" width="52" height="13" font="6"><a href="http://CRAN.R-project.org/package=sparseM"><b>sparseM</b></a></text>
<text top="552" left="661" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="552" left="666" width="78" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Koenker and</a></text>
<text top="568" left="149" width="19" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Ng</a></text>
<text top="568" left="167" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="568" left="174" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="568" left="201" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">).</a></text>
<text top="589" left="171" width="573" height="13" font="4">In the next section we first introduce spatial probit models and describe the Bayesian estimation</text>
<text top="605" left="148" width="596" height="13" font="4">procedure of the SAR probit model in detail. Subsequently we discuss some implementation issues in</text>
<text top="622" left="149" width="271" height="13" font="4">R, describe the sarprobit method in package</text>
<text top="622" left="423" width="79" height="13" font="6"><a href="http://CRAN.R-project.org/package=spatialprobit"><b>spatialprobit</b></a></text>
<text top="622" left="506" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="622" left="510" width="136" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and de Matos</a></text>
<text top="622" left="647" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="622" left="654" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="622" left="681" width="63" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">), </a>compare</text>
<text top="638" left="149" width="595" height="13" font="4">it against maximum likelihood (ML) and generalized method of moments (GMM) estimation in</text>
<text top="655" left="149" width="63" height="13" font="6"><a href="http://CRAN.R-project.org/package=McSpatial"><b>McSpatial</b></a></text>
<text top="655" left="215" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="655" left="219" width="58" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">McMillen</a></text>
<text top="655" left="277" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="655" left="284" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="655" left="311" width="433" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>and illustrate the estimation with an example from social networks. We</text>
<text top="671" left="149" width="493" height="13" font="4">also illustrate how to parallelize the Bayesian estimation with the <b>parallel </b>package.</text>
<text top="716" left="149" width="177" height="17" font="5"><b>Spatial probit models</b></text>
<text top="755" left="148" width="73" height="13" font="4">The book of</text>
<text top="755" left="225" width="102" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage and Pace</a></text>
<text top="755" left="331" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="755" left="336" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="755" left="363" width="381" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>is a good starting point and reference for spatial econometric</text>
<text top="771" left="149" width="597" height="13" font="4">models in general and for limited dependent variable spatial models in particular (chapter 10, p. 279).</text>
<text top="792" left="171" width="488" height="13" font="4">Suppose we have the spatial autoregressive model (SAR model, spatial lag model)</text>
<text top="826" left="335" width="7" height="13" font="3"><b>z</b></text>
<text top="826" left="346" width="11" height="12" font="0">=</text>
<text top="829" left="360" width="27" height="10" font="8"><i>ρ</i><b>Wz</b></text>
<text top="826" left="390" width="11" height="12" font="0">+</text>
<text top="826" left="404" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="826" left="424" width="11" height="12" font="0">+</text>
<text top="829" left="438" width="6" height="10" font="8"><i>e</i></text>
<text top="826" left="445" width="3" height="13" font="4">,</text>
<text top="829" left="464" width="6" height="10" font="8"><i>e</i></text>
<text top="824" left="474" width="11" height="16" font="0">∼</text>
<text top="826" left="490" width="10" height="13" font="4">N</text>
<text top="820" left="503" width="8" height="6" font="4"></text>
<text top="826" left="511" width="20" height="13" font="4">0, <i>σ</i></text>
<text top="822" left="532" width="5" height="10" font="10">2</text>
<text top="834" left="531" width="5" height="8" font="11"><i>e</i></text>
<text top="826" left="538" width="5" height="13" font="3"><b>I</b></text>
<text top="830" left="543" width="6" height="10" font="10">n</text>
<text top="820" left="550" width="8" height="6" font="4"></text>
<text top="826" left="728" width="16" height="13" font="4">(1)</text>
<text top="860" left="149" width="28" height="13" font="4">for <b>z</b></text>
<text top="859" left="182" width="22" height="12" font="0">= (</text>
<text top="859" left="204" width="6" height="13" font="4">z</text>
<text top="864" left="210" width="5" height="10" font="10">1</text>
<text top="860" left="216" width="35" height="13" font="4">, . . . , z</text>
<text top="864" left="252" width="6" height="10" font="10">n</text>
<text top="859" left="259" width="5" height="12" font="0">)</text>
<text top="856" left="265" width="3" height="13" font="10">0</text>
<text top="860" left="273" width="237" height="13" font="4">with some fixed matrix of covariates <b>X</b></text>
<text top="859" left="514" width="5" height="12" font="0">(</text>
<text top="859" left="520" width="7" height="13" font="4">n</text>
<text top="858" left="530" width="11" height="16" font="0">×</text>
<text top="859" left="544" width="6" height="13" font="4">k</text>
<text top="859" left="551" width="5" height="12" font="0">)</text>
<text top="860" left="560" width="184" height="13" font="4">associated with the parameter</text>
<text top="876" left="148" width="48" height="13" font="4">vector <i><b>β</b></i></text>
<text top="876" left="200" width="5" height="12" font="0">(</text>
<text top="876" left="205" width="6" height="13" font="4">k</text>
<text top="875" left="214" width="11" height="16" font="0">×</text>
<text top="876" left="228" width="7" height="13" font="4">1</text>
<text top="876" left="234" width="5" height="12" font="0">)</text>
<text top="876" left="240" width="87" height="13" font="4">. The matrix <b>W</b></text>
<text top="876" left="330" width="5" height="12" font="0">(</text>
<text top="876" left="336" width="7" height="13" font="4">n</text>
<text top="875" left="346" width="11" height="16" font="0">×</text>
<text top="876" left="360" width="7" height="13" font="4">n</text>
<text top="876" left="368" width="5" height="12" font="0">)</text>
<text top="876" left="376" width="368" height="13" font="4">is called the spatial weight matrix and captures the dependence</text>
<text top="892" left="149" width="595" height="13" font="4">structure between neighboring observations such as friends or nearby locations. The term <b>Wz </b>is a</text>
<text top="909" left="149" width="595" height="13" font="4">linear combination of neighboring observations. The scalar <i>ρ </i>is the dependence parameter and will</text>
<text top="925" left="149" width="76" height="13" font="4">assumed abs</text>
<text top="925" left="225" width="5" height="12" font="0">(</text>
<text top="928" left="231" width="7" height="10" font="8"><i>ρ</i></text>
<text top="925" left="238" width="20" height="12" font="0">) &lt;</text>
<text top="925" left="262" width="46" height="13" font="4">1. The k</text>
<text top="925" left="311" width="11" height="12" font="0">+</text>
<text top="925" left="325" width="419" height="13" font="4">1 model parameters to be estimated are the parameter vector <i><b>β </b></i>and the</text>
<text top="942" left="149" width="48" height="13" font="4">scalar <i>ρ</i>.</text>
<text top="963" left="171" width="573" height="13" font="4">In a spatial probit model, <b>z </b>is regarded as a latent variable, which cannot be observed. Instead, the</text>
<text top="979" left="149" width="231" height="13" font="4">observables are only binary variables y</text>
<text top="984" left="380" width="3" height="10" font="10">i</text>
<text top="979" left="387" width="45" height="13" font="4">(0, 1) as</text>
<text top="1021" left="390" width="7" height="13" font="4">y</text>
<text top="1025" left="397" width="3" height="10" font="10">i</text>
<text top="1021" left="405" width="11" height="12" font="0">=</text>
<text top="1007" left="420" width="11" height="6" font="4">(</text>
<text top="1011" left="431" width="7" height="13" font="4">1</text>
<text top="1011" left="451" width="18" height="13" font="4">if z</text>
<text top="1016" left="469" width="3" height="10" font="10">i</text>
<text top="1010" left="477" width="11" height="16" font="0">≥</text>
<text top="1011" left="491" width="10" height="13" font="4">0,</text>
<text top="1031" left="431" width="7" height="13" font="4">0</text>
<text top="1031" left="451" width="18" height="13" font="4">if z</text>
<text top="1036" left="469" width="3" height="10" font="10">i</text>
<text top="1031" left="477" width="11" height="12" font="0">&lt;</text>
<text top="1031" left="491" width="10" height="13" font="4">0.</text>
<text top="1061" left="149" width="7" height="13" font="4">y</text>
<text top="1066" left="156" width="3" height="10" font="10">i</text>
<text top="1061" left="164" width="581" height="13" font="4">can reflect any binary outcome such as survival, a buy/don’t buy decision or a class variable in</text>
<text top="1078" left="149" width="302" height="13" font="4">binary classification problems. For identification, <i>σ</i></text>
<text top="1075" left="451" width="5" height="10" font="10">2</text>
<text top="1086" left="450" width="5" height="8" font="11"><i>e</i></text>
<text top="1078" left="460" width="90" height="13" font="4">is often set to <i>σ</i></text>
<text top="1075" left="550" width="5" height="10" font="10">2</text>
<text top="1086" left="549" width="5" height="8" font="11"><i>e</i></text>
<text top="1078" left="560" width="11" height="12" font="0">=</text>
<text top="1078" left="575" width="10" height="13" font="4">1.</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="2" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="12" size="12" family="Times" color="#000000"/>
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">131</text>
<text top="103" left="171" width="210" height="13" font="4">The data generating process for <b>z </b>is</text>
<text top="135" left="336" width="7" height="13" font="3"><b>z</b></text>
<text top="135" left="346" width="20" height="13" font="0">= (</text>
<text top="135" left="367" width="5" height="13" font="3"><b>I</b></text>
<text top="139" left="372" width="6" height="10" font="10">n</text>
<text top="134" left="382" width="11" height="16" font="0">−</text>
<text top="138" left="396" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="135" left="416" width="5" height="12" font="0">)</text>
<text top="130" left="422" width="14" height="13" font="10">−1</text>
<text top="135" left="439" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="135" left="459" width="19" height="13" font="0">+ (</text>
<text top="135" left="479" width="5" height="13" font="3"><b>I</b></text>
<text top="139" left="484" width="6" height="10" font="10">n</text>
<text top="134" left="493" width="11" height="16" font="0">−</text>
<text top="138" left="507" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="135" left="528" width="5" height="12" font="0">)</text>
<text top="130" left="534" width="14" height="13" font="10">−1</text>
<text top="138" left="551" width="7" height="10" font="9"><i><b>e</b></i></text>
<text top="159" left="335" width="7" height="10" font="9"><i><b>e</b></i></text>
<text top="154" left="346" width="11" height="16" font="0">∼</text>
<text top="156" left="362" width="10" height="13" font="4">N</text>
<text top="156" left="375" width="5" height="12" font="0">(</text>
<text top="156" left="381" width="18" height="13" font="4">0, <b>I</b></text>
<text top="160" left="399" width="6" height="10" font="10">n</text>
<text top="156" left="406" width="5" height="12" font="0">)</text>
<text top="189" left="171" width="75" height="13" font="4">Note that if <i>ρ</i></text>
<text top="189" left="251" width="11" height="12" font="0">=</text>
<text top="189" left="265" width="38" height="13" font="4">0 or <b>W</b></text>
<text top="189" left="308" width="11" height="12" font="0">=</text>
<text top="189" left="322" width="5" height="13" font="3"><b>I</b></text>
<text top="193" left="328" width="6" height="10" font="10">n</text>
<text top="189" left="334" width="338" height="13" font="4">, the model reduces to an ordinary probit model, for which</text>
<text top="189" left="675" width="69" height="13" font="7"><a href="2013-1-wilhelm-matos.html#14">Wooldridge</a></text>
<text top="206" left="148" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#14">(</a></text>
<text top="206" left="153" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#14">2002</a></text>
<text top="206" left="180" width="99" height="13" font="4"><a href="2013-1-wilhelm-matos.html#14">, </a>chapter 17) and</text>
<text top="206" left="282" width="38" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Albert</a></text>
<text top="206" left="324" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="206" left="328" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2007</a></text>
<text top="206" left="355" width="389" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">, </a>section 10.1) are good references. The ordinary probit model can</text>
<text top="222" left="149" width="162" height="13" font="4">be estimated in R by glm().</text>
<text top="243" left="171" width="505" height="13" font="4">Another popular spatial model is the spatial error model (SEM) which takes the form</text>
<text top="277" left="307" width="7" height="13" font="3"><b>z</b></text>
<text top="276" left="318" width="11" height="12" font="0">=</text>
<text top="277" left="332" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="276" left="353" width="11" height="12" font="0">+</text>
<text top="277" left="367" width="8" height="13" font="3"><b>u</b></text>
<text top="277" left="375" width="3" height="13" font="4">,</text>
<text top="277" left="394" width="8" height="13" font="3"><b>u</b></text>
<text top="276" left="406" width="11" height="12" font="0">=</text>
<text top="280" left="421" width="29" height="10" font="8"><i>ρ</i><b>Wu</b></text>
<text top="276" left="452" width="11" height="12" font="0">+</text>
<text top="280" left="466" width="6" height="10" font="8"><i>e</i></text>
<text top="277" left="472" width="3" height="13" font="4">,</text>
<text top="280" left="492" width="6" height="10" font="8"><i>e</i></text>
<text top="275" left="502" width="11" height="16" font="0">∼</text>
<text top="276" left="517" width="10" height="13" font="4">N</text>
<text top="271" left="531" width="8" height="6" font="4"></text>
<text top="277" left="539" width="20" height="13" font="4">0, <i>σ</i></text>
<text top="273" left="559" width="5" height="10" font="10">2</text>
<text top="284" left="559" width="5" height="8" font="11"><i>e</i></text>
<text top="277" left="565" width="5" height="13" font="3"><b>I</b></text>
<text top="281" left="571" width="6" height="10" font="10">n</text>
<text top="271" left="578" width="8" height="6" font="4"></text>
<text top="277" left="728" width="16" height="13" font="4">(2)</text>
<text top="305" left="307" width="7" height="13" font="3"><b>z</b></text>
<text top="305" left="318" width="11" height="12" font="0">=</text>
<text top="305" left="332" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="305" left="353" width="19" height="13" font="0">+ (</text>
<text top="305" left="372" width="5" height="13" font="3"><b>I</b></text>
<text top="309" left="378" width="6" height="10" font="10">n</text>
<text top="304" left="387" width="11" height="16" font="0">−</text>
<text top="308" left="401" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="305" left="421" width="5" height="12" font="0">)</text>
<text top="300" left="427" width="14" height="13" font="10">−1</text>
<text top="308" left="444" width="7" height="10" font="9"><i><b>e</b></i></text>
<text top="334" left="148" width="234" height="13" font="4">where as before, only binary variables y</text>
<text top="339" left="382" width="3" height="10" font="10">i</text>
<text top="334" left="389" width="194" height="13" font="4">(0,1) can be observed instead of z</text>
<text top="339" left="584" width="3" height="10" font="10">i</text>
<text top="334" left="588" width="156" height="13" font="4">. Our following discussion</text>
<text top="350" left="149" width="233" height="13" font="4">focuses on the spatial lag probit model <a href="2013-1-wilhelm-matos.html#1">(</a></text>
<text top="350" left="382" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">1</a></text>
<text top="350" left="389" width="356" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">)</a>, but the estimation of the probit model with spatial errors is</text>
<text top="367" left="149" width="193" height="13" font="4">covered in <b>spatialprobit </b>as well.</text>
<text top="388" left="171" width="396" height="13" font="4">Recent studies using spatial probit models include, among others,</text>
<text top="388" left="571" width="71" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Marsh et al.</a></text>
<text top="388" left="645" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="388" left="649" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2000</a></text>
<text top="388" left="677" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">),</a></text>
<text top="388" left="688" width="56" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Klier and</a></text>
<text top="404" left="149" width="57" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">McMillen</a></text>
<text top="404" left="210" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="404" left="214" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2008</a></text>
<text top="404" left="241" width="31" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>and</text>
<text top="404" left="275" width="74" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage et al.</a></text>
<text top="404" left="352" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="404" left="357" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2011</a></text>
<text top="404" left="384" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">).</a></text>
<text top="446" left="149" width="137" height="15" font="12"><b>Bayesian estimation</b></text>
<text top="478" left="149" width="595" height="13" font="4">Maximum Likelihood and GMM estimation of the spatial probit is implemented in the package</text>
<text top="494" left="149" width="63" height="13" font="3"><b>McSpatial</b></text>
<text top="494" left="215" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="494" left="219" width="57" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">McMillen</a></text>
<text top="494" left="276" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="494" left="283" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="494" left="309" width="435" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>with the methods spprobitml and spprobit. Here we present the details</text>
<text top="511" left="149" width="595" height="13" font="4">of Bayesian estimation. Although GMM is massively more efficient computationally than Bayesian</text>
<text top="527" left="149" width="595" height="13" font="4">Markov Chain Monte Carlo (MCMC), as a instrumental-variables estimation it will work well only in</text>
<text top="544" left="148" width="284" height="13" font="4">very large samples. This point is also brought by</text>
<text top="544" left="436" width="83" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Franzese et al.</a></text>
<text top="544" left="522" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="544" left="526" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="544" left="552" width="192" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">), </a>who compares different spatial</text>
<text top="560" left="148" width="165" height="13" font="4">probit estimation strategies.</text>
<text top="581" left="171" width="573" height="13" font="4">The basic idea in Bayesian estimation is to sample from a posterior distribution of the model</text>
<text top="597" left="148" width="76" height="13" font="4">parameters p</text>
<text top="597" left="225" width="5" height="12" font="0">(</text>
<text top="598" left="231" width="7" height="13" font="3"><b>z</b></text>
<text top="597" left="238" width="27" height="13" font="4">, <i><b>β</b></i>, <i>ρ</i></text>
<text top="596" left="264" width="4" height="16" font="0">|</text>
<text top="598" left="268" width="7" height="13" font="3"><b>y</b></text>
<text top="597" left="276" width="5" height="12" font="0">)</text>
<text top="597" left="285" width="274" height="13" font="4">given the data <b>y </b>and some prior distributions p</text>
<text top="597" left="559" width="5" height="12" font="0">(</text>
<text top="598" left="565" width="7" height="13" font="3"><b>z</b></text>
<text top="597" left="572" width="5" height="12" font="0">)</text>
<text top="597" left="577" width="14" height="13" font="4">, p</text>
<text top="597" left="592" width="5" height="12" font="0">(</text>
<text top="601" left="598" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="597" left="606" width="5" height="12" font="0">)</text>
<text top="597" left="612" width="14" height="13" font="4">, p</text>
<text top="597" left="626" width="5" height="12" font="0">(</text>
<text top="601" left="632" width="7" height="10" font="8"><i>ρ</i></text>
<text top="597" left="639" width="5" height="12" font="0">)</text>
<text top="597" left="645" width="99" height="13" font="4">. See for example</text>
<text top="614" left="148" width="39" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Albert</a></text>
<text top="614" left="191" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="614" left="195" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2007</a></text>
<text top="614" left="223" width="200" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>and the accompanying package</text>
<text top="614" left="426" width="71" height="13" font="6"><a href="http://CRAN.R-project.org/package=LearnBayes"><b>LearnBayes</b></a></text>
<text top="614" left="500" width="244" height="13" font="4">for an introduction to Bayesian statistics</text>
<text top="630" left="149" width="35" height="13" font="4">in R <a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="630" left="184" width="39" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Albert</a></text>
<text top="630" left="223" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="630" left="231" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2012</a></text>
<text top="630" left="258" width="299" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">). </a>This sampling for the posterior distribution p</text>
<text top="630" left="558" width="5" height="12" font="0">(</text>
<text top="630" left="563" width="7" height="13" font="3"><b>z</b></text>
<text top="630" left="570" width="27" height="13" font="4">, <i><b>β</b></i>, <i>ρ</i></text>
<text top="629" left="597" width="4" height="16" font="0">|</text>
<text top="630" left="601" width="7" height="13" font="3"><b>y</b></text>
<text top="630" left="609" width="5" height="12" font="0">)</text>
<text top="630" left="619" width="125" height="13" font="4">can be realized by a</text>
<text top="647" left="149" width="595" height="13" font="4">Markov Chain Monte Carlo and Gibbs sampling scheme, where we sample from the following three</text>
<text top="663" left="149" width="134" height="13" font="4">conditional densities p</text>
<text top="663" left="283" width="5" height="12" font="0">(</text>
<text top="663" left="289" width="7" height="13" font="3"><b>z</b></text>
<text top="662" left="296" width="4" height="16" font="0">|</text>
<text top="667" left="300" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="663" left="309" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="663" left="334" width="5" height="12" font="0">)</text>
<text top="663" left="340" width="14" height="13" font="4">, p</text>
<text top="663" left="355" width="5" height="12" font="0">(</text>
<text top="667" left="361" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="662" left="369" width="4" height="16" font="0">|</text>
<text top="663" left="373" width="7" height="13" font="3"><b>z</b></text>
<text top="663" left="380" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="663" left="406" width="5" height="12" font="0">)</text>
<text top="663" left="415" width="34" height="13" font="4">and p</text>
<text top="663" left="449" width="5" height="12" font="0">(</text>
<text top="666" left="455" width="7" height="10" font="8"><i>ρ</i></text>
<text top="662" left="462" width="4" height="16" font="0">|</text>
<text top="663" left="466" width="7" height="13" font="3"><b>z</b></text>
<text top="663" left="473" width="27" height="13" font="4">, <i><b>β</b></i>, <b>y</b></text>
<text top="663" left="500" width="5" height="12" font="0">)</text>
<text top="663" left="506" width="3" height="13" font="4">:</text>
<text top="692" left="169" width="428" height="13" font="4">1. Given the observed variables <b>y </b>and parameters <i><b>β </b></i>and <i>ρ</i>, we have p</text>
<text top="692" left="597" width="5" height="12" font="0">(</text>
<text top="692" left="603" width="7" height="13" font="3"><b>z</b></text>
<text top="691" left="610" width="4" height="16" font="0">|</text>
<text top="695" left="614" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="692" left="622" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="692" left="648" width="5" height="12" font="0">)</text>
<text top="692" left="658" width="86" height="13" font="4">as a truncated</text>
<text top="709" left="186" width="149" height="13" font="4">multinormal distribution</text>
<text top="743" left="307" width="7" height="13" font="3"><b>z</b></text>
<text top="741" left="318" width="11" height="16" font="0">∼</text>
<text top="742" left="333" width="10" height="13" font="4">N</text>
<text top="733" left="347" width="10" height="6" font="4"></text>
<text top="743" left="357" width="5" height="12" font="0">(</text>
<text top="743" left="363" width="5" height="13" font="3"><b>I</b></text>
<text top="747" left="368" width="6" height="10" font="10">n</text>
<text top="741" left="377" width="11" height="16" font="0">−</text>
<text top="746" left="391" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="743" left="412" width="5" height="12" font="0">)</text>
<text top="737" left="417" width="14" height="13" font="10">−1</text>
<text top="743" left="434" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="743" left="452" width="3" height="13" font="4">,</text>
<text top="737" left="458" width="6" height="6" font="4">h</text>
<text top="743" left="464" width="5" height="12" font="0">(</text>
<text top="743" left="470" width="5" height="13" font="3"><b>I</b></text>
<text top="747" left="475" width="6" height="10" font="10">n</text>
<text top="741" left="485" width="11" height="16" font="0">−</text>
<text top="746" left="499" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="743" left="519" width="5" height="12" font="0">)</text>
<text top="737" left="525" width="3" height="13" font="10">0</text>
<text top="743" left="531" width="5" height="12" font="0">(</text>
<text top="743" left="537" width="5" height="13" font="3"><b>I</b></text>
<text top="747" left="542" width="6" height="10" font="10">n</text>
<text top="741" left="552" width="11" height="16" font="0">−</text>
<text top="746" left="565" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="743" left="586" width="5" height="12" font="0">)</text>
<text top="737" left="592" width="6" height="6" font="4">i</text>
<text top="732" left="598" width="14" height="13" font="10">−1</text>
<text top="733" left="613" width="10" height="6" font="4"></text>
<text top="743" left="728" width="16" height="13" font="4">(3)</text>
<text top="779" left="186" width="67" height="13" font="4">subject to z</text>
<text top="784" left="253" width="3" height="10" font="10">i</text>
<text top="778" left="261" width="11" height="16" font="0">≥</text>
<text top="779" left="276" width="38" height="13" font="4">0 for y</text>
<text top="784" left="314" width="3" height="10" font="10">i</text>
<text top="779" left="322" width="11" height="12" font="0">=</text>
<text top="779" left="337" width="43" height="13" font="4">1 and z</text>
<text top="784" left="380" width="3" height="10" font="10">i</text>
<text top="779" left="387" width="11" height="12" font="0">&lt;</text>
<text top="779" left="402" width="38" height="13" font="4">0 for y</text>
<text top="784" left="440" width="3" height="10" font="10">i</text>
<text top="779" left="448" width="11" height="12" font="0">=</text>
<text top="779" left="463" width="281" height="13" font="4">0, which can be efficiently sampled from using</text>
<text top="796" left="186" width="298" height="13" font="4">the method rtmvnorm.sparseMatrix() in package</text>
<text top="796" left="488" width="61" height="13" font="6"><a href="http://CRAN.R-project.org/package=tmvtnorm"><b>tmvtnorm</b></a></text>
<text top="796" left="552" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="796" left="557" width="147" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and Manjunath</a></text>
<text top="796" left="704" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="796" left="711" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="796" left="738" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">),</a></text>
<text top="812" left="186" width="181" height="13" font="4">see the next section for details.</text>
<text top="834" left="169" width="139" height="13" font="4">2. For a normal prior <i><b>β</b></i></text>
<text top="833" left="312" width="11" height="16" font="0">∼</text>
<text top="834" left="327" width="10" height="13" font="4">N</text>
<text top="834" left="339" width="5" height="12" font="0">(</text>
<text top="834" left="344" width="6" height="13" font="3"><b>c</b></text>
<text top="834" left="350" width="15" height="13" font="4">, <b>T</b></text>
<text top="834" left="365" width="5" height="12" font="0">)</text>
<text top="834" left="371" width="105" height="13" font="4">, we can sample p</text>
<text top="834" left="476" width="5" height="12" font="0">(</text>
<text top="837" left="482" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="833" left="491" width="4" height="16" font="0">|</text>
<text top="837" left="495" width="7" height="10" font="8"><i>ρ</i></text>
<text top="834" left="502" width="25" height="13" font="4">, <b>z</b>, <b>y</b></text>
<text top="834" left="527" width="5" height="12" font="0">)</text>
<text top="834" left="536" width="178" height="13" font="4">from a multivariate normal as</text>
<text top="863" left="330" width="7" height="13" font="4">p</text>
<text top="863" left="339" width="5" height="12" font="0">(</text>
<text top="866" left="345" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="862" left="354" width="4" height="16" font="0">|</text>
<text top="866" left="358" width="7" height="10" font="8"><i>ρ</i></text>
<text top="863" left="365" width="25" height="13" font="4">, <b>z</b>, <b>y</b></text>
<text top="863" left="390" width="5" height="12" font="0">)</text>
<text top="860" left="400" width="24" height="17" font="4">∝ N</text>
<text top="863" left="427" width="5" height="12" font="0">(</text>
<text top="863" left="432" width="6" height="13" font="3"><b>c</b></text>
<text top="859" left="439" width="5" height="13" font="10">∗</text>
<text top="863" left="445" width="15" height="13" font="4">, <b>T</b></text>
<text top="859" left="460" width="5" height="13" font="10">∗</text>
<text top="863" left="466" width="5" height="12" font="0">)</text>
<text top="863" left="728" width="16" height="13" font="4">(4)</text>
<text top="893" left="384" width="6" height="13" font="3"><b>c</b></text>
<text top="888" left="390" width="5" height="13" font="10">∗</text>
<text top="893" left="400" width="11" height="12" font="0">=</text>
<text top="887" left="415" width="8" height="6" font="4"></text>
<text top="893" left="423" width="9" height="13" font="3"><b>X</b></text>
<text top="888" left="432" width="3" height="13" font="10">0</text>
<text top="893" left="436" width="9" height="13" font="3"><b>X</b></text>
<text top="893" left="448" width="11" height="12" font="0">+</text>
<text top="893" left="461" width="9" height="13" font="3"><b>T</b></text>
<text top="888" left="471" width="14" height="13" font="10">−1</text>
<text top="887" left="485" width="8" height="6" font="4"></text>
<text top="882" left="494" width="14" height="13" font="10">−1</text>
<text top="887" left="511" width="8" height="6" font="4"></text>
<text top="893" left="519" width="9" height="13" font="3"><b>X</b></text>
<text top="888" left="528" width="3" height="13" font="10">0</text>
<text top="893" left="532" width="15" height="13" font="3"><b>Sz</b></text>
<text top="893" left="550" width="11" height="12" font="0">+</text>
<text top="893" left="563" width="9" height="13" font="3"><b>T</b></text>
<text top="888" left="572" width="14" height="13" font="10">−1</text>
<text top="893" left="587" width="6" height="13" font="3"><b>c</b></text>
<text top="887" left="593" width="8" height="6" font="4"></text>
<text top="926" left="381" width="9" height="13" font="3"><b>T</b></text>
<text top="922" left="390" width="5" height="13" font="10">∗</text>
<text top="926" left="400" width="11" height="12" font="0">=</text>
<text top="920" left="415" width="8" height="6" font="4"></text>
<text top="926" left="423" width="9" height="13" font="3"><b>X</b></text>
<text top="922" left="432" width="3" height="13" font="10">0</text>
<text top="926" left="436" width="9" height="13" font="3"><b>X</b></text>
<text top="926" left="448" width="11" height="12" font="0">+</text>
<text top="926" left="461" width="9" height="13" font="3"><b>T</b></text>
<text top="922" left="471" width="14" height="13" font="10">−1</text>
<text top="920" left="485" width="8" height="6" font="4"></text>
<text top="916" left="494" width="14" height="13" font="10">−1</text>
<text top="952" left="388" width="8" height="13" font="3"><b>S</b></text>
<text top="952" left="400" width="20" height="13" font="0">= (</text>
<text top="952" left="420" width="5" height="13" font="3"><b>I</b></text>
<text top="956" left="426" width="6" height="10" font="10">n</text>
<text top="951" left="435" width="11" height="16" font="0">−</text>
<text top="955" left="449" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="952" left="470" width="5" height="12" font="0">)</text>
<text top="981" left="186" width="497" height="13" font="4">The standard way for sampling from this distribution is rmvnorm() from package</text>
<text top="982" left="687" width="57" height="13" font="6"><a href="http://CRAN.R-project.org/package=mvtnorm"><b>mvtnorm</b></a></text>
<text top="998" left="186" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="998" left="190" width="63" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Genz et al.</a></text>
<text top="998" left="253" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="998" left="260" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="998" left="287" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">).</a></text>
<text top="1020" left="169" width="234" height="13" font="4">3. The remaining conditional density p</text>
<text top="1020" left="403" width="5" height="12" font="0">(</text>
<text top="1023" left="408" width="7" height="10" font="8"><i>ρ</i></text>
<text top="1018" left="415" width="4" height="16" font="0">|</text>
<text top="1023" left="420" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="1020" left="428" width="25" height="13" font="4">, <b>z</b>, <b>y</b></text>
<text top="1020" left="454" width="5" height="12" font="0">)</text>
<text top="1020" left="463" width="10" height="13" font="4">is</text>
<text top="1057" left="297" width="7" height="13" font="4">p</text>
<text top="1057" left="306" width="5" height="12" font="0">(</text>
<text top="1060" left="312" width="7" height="10" font="8"><i>ρ</i></text>
<text top="1056" left="319" width="4" height="16" font="0">|</text>
<text top="1060" left="323" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="1057" left="332" width="25" height="13" font="4">, <b>z</b>, <b>y</b></text>
<text top="1057" left="357" width="5" height="12" font="0">)</text>
<text top="1054" left="367" width="9" height="17" font="4">∝</text>
<text top="1056" left="380" width="4" height="16" font="0">|</text>
<text top="1057" left="384" width="5" height="13" font="3"><b>I</b></text>
<text top="1061" left="389" width="6" height="10" font="10">n</text>
<text top="1056" left="399" width="11" height="16" font="0">−</text>
<text top="1060" left="412" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="1056" left="433" width="4" height="16" font="0">|</text>
<text top="1057" left="439" width="21" height="13" font="4">exp</text>
<text top="1047" left="463" width="10" height="6" font="4"></text>
<text top="1056" left="473" width="11" height="16" font="0">−</text>
<text top="1048" left="486" width="7" height="13" font="4">1</text>
<text top="1066" left="486" width="7" height="13" font="4">2</text>
<text top="1057" left="497" width="5" height="12" font="0">(</text>
<text top="1057" left="503" width="15" height="13" font="3"><b>Sz</b></text>
<text top="1056" left="520" width="11" height="16" font="0">−</text>
<text top="1057" left="534" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="1057" left="552" width="5" height="12" font="0">)</text>
<text top="1052" left="558" width="3" height="13" font="10">0</text>
<text top="1057" left="564" width="5" height="12" font="0">(</text>
<text top="1057" left="569" width="15" height="13" font="3"><b>Sz</b></text>
<text top="1056" left="587" width="11" height="16" font="0">−</text>
<text top="1057" left="601" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="1057" left="619" width="5" height="12" font="0">)</text>
<text top="1047" left="624" width="10" height="6" font="4"></text>
<text top="1057" left="728" width="16" height="13" font="4">(5)</text>
<text top="1094" left="186" width="561" height="13" font="4">which can be sampled from using Metropolis-Hastings or some other sampling scheme (i.e.</text>
<text top="1110" left="186" width="558" height="13" font="4">Importance Sampling). We implement a grid-based evaluation and numerical integration</text>
<text top="1127" left="186" width="515" height="13" font="4">proposed by LeSage and Pace and then draw from the inverse distribution function <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="1127" left="701" width="43" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage</a></text>
<text top="1143" left="186" width="53" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">and Pace</a></text>
<text top="1143" left="240" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="1143" left="246" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="1143" left="273" width="48" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">, </a>p. 132).</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="3" position="absolute" top="0" left="0" height="1262" width="892">
	<fontspec id="13" size="13" family="Times" color="#000000"/>
	<fontspec id="14" size="12" family="Times" color="#000000"/>
	<fontspec id="15" size="12" family="Times" color="#000000"/>
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">132</text>
<text top="100" left="149" width="187" height="17" font="5"><b>Implementation issues</b></text>
<text top="139" left="149" width="595" height="13" font="4">Since MCMC methods are widely considered to be (very) slow, we devote this section to the discussion</text>
<text top="155" left="149" width="595" height="13" font="4">of some implementation issues in R. Key factors to estimate large spatial probit models in R include the</text>
<text top="172" left="149" width="595" height="13" font="4">usage of sparse matrices and compiled Fortran code, and possibly also parallelization, which has been</text>
<text top="188" left="149" width="595" height="13" font="4">introduced to R 2.14.0 with the package <b>parallel</b>. We report estimation times and memory requirements</text>
<text top="205" left="149" width="550" height="13" font="4">for several medium-size and large-size problems and compare our times to those reported by</text>
<text top="205" left="702" width="42" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage</a></text>
<text top="221" left="149" width="52" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">and Pace</a></text>
<text top="221" left="204" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="221" left="208" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="221" left="235" width="510" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">, </a>p. 291). We show that our approach allows the estimation of large spatial probit models</text>
<text top="237" left="149" width="167" height="13" font="4">in R within reasonable time.</text>
<text top="279" left="149" width="73" height="15" font="12"><b>Drawing </b>p</text>
<text top="279" left="222" width="6" height="14" font="13">(</text>
<text top="279" left="228" width="7" height="15" font="12"><b>z</b></text>
<text top="278" left="236" width="4" height="18" font="13">|</text>
<text top="283" left="241" width="9" height="11" font="14"><i><b>β</b></i></text>
<text top="279" left="250" width="29" height="15" font="0">, <i>ρ</i>, <b>y</b></text>
<text top="279" left="279" width="6" height="14" font="13">)</text>
<text top="311" left="149" width="421" height="13" font="4">In this section we describe the efforts made to generate samples from p</text>
<text top="311" left="570" width="5" height="12" font="0">(</text>
<text top="311" left="575" width="7" height="13" font="3"><b>z</b></text>
<text top="309" left="582" width="4" height="16" font="0">|</text>
<text top="314" left="587" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="311" left="595" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="311" left="621" width="5" height="12" font="0">)</text>
<text top="348" left="288" width="7" height="13" font="3"><b>z</b></text>
<text top="347" left="299" width="11" height="16" font="0">∼</text>
<text top="348" left="315" width="10" height="13" font="4">N</text>
<text top="338" left="328" width="10" height="6" font="4"></text>
<text top="348" left="338" width="5" height="12" font="0">(</text>
<text top="348" left="344" width="5" height="13" font="3"><b>I</b></text>
<text top="352" left="349" width="6" height="10" font="10">n</text>
<text top="347" left="359" width="11" height="16" font="0">−</text>
<text top="351" left="373" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="348" left="393" width="5" height="12" font="0">)</text>
<text top="343" left="399" width="14" height="13" font="10">−1</text>
<text top="348" left="416" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="348" left="433" width="3" height="13" font="4">,</text>
<text top="342" left="439" width="6" height="6" font="4">h</text>
<text top="348" left="446" width="5" height="12" font="0">(</text>
<text top="348" left="451" width="5" height="13" font="3"><b>I</b></text>
<text top="352" left="457" width="6" height="10" font="10">n</text>
<text top="347" left="466" width="11" height="16" font="0">−</text>
<text top="351" left="480" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="348" left="500" width="5" height="12" font="0">)</text>
<text top="343" left="506" width="3" height="13" font="10">0</text>
<text top="348" left="512" width="5" height="12" font="0">(</text>
<text top="348" left="518" width="5" height="13" font="3"><b>I</b></text>
<text top="352" left="523" width="6" height="10" font="10">n</text>
<text top="347" left="533" width="11" height="16" font="0">−</text>
<text top="351" left="547" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="348" left="567" width="5" height="12" font="0">)</text>
<text top="342" left="573" width="6" height="6" font="4">i</text>
<text top="338" left="580" width="14" height="13" font="10">−1</text>
<text top="338" left="594" width="10" height="6" font="4"></text>
<text top="385" left="149" width="66" height="13" font="4">subject to z</text>
<text top="390" left="215" width="3" height="10" font="10">i</text>
<text top="384" left="223" width="11" height="16" font="0">≥</text>
<text top="385" left="237" width="37" height="13" font="4">0 for y</text>
<text top="390" left="275" width="3" height="10" font="10">i</text>
<text top="385" left="283" width="11" height="12" font="0">=</text>
<text top="385" left="298" width="42" height="13" font="4">1 and z</text>
<text top="390" left="340" width="3" height="10" font="10">i</text>
<text top="385" left="348" width="11" height="12" font="0">&lt;</text>
<text top="385" left="363" width="37" height="13" font="4">0 for y</text>
<text top="390" left="401" width="3" height="10" font="10">i</text>
<text top="385" left="408" width="11" height="12" font="0">=</text>
<text top="385" left="423" width="10" height="13" font="4">0.</text>
<text top="406" left="171" width="573" height="13" font="4">The generation of samples from a truncated multivariate normal distribution in high dimensions</text>
<text top="422" left="149" width="595" height="13" font="4">is typically done with a Gibbs sampler rather than with other techniques such as rejection sampling</text>
<text top="439" left="148" width="134" height="13" font="4">(for a comparison, see</text>
<text top="439" left="286" width="149" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and Manjunath</a></text>
<text top="439" left="439" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="439" left="443" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2010</a></text>
<text top="439" left="471" width="273" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">)). </a>The Gibbs sampler draws from univariate</text>
<text top="455" left="149" width="132" height="13" font="4">conditional densities f</text>
<text top="455" left="283" width="5" height="12" font="0">(</text>
<text top="455" left="289" width="6" height="13" font="4">z</text>
<text top="460" left="295" width="3" height="10" font="10">i</text>
<text top="454" left="299" width="4" height="16" font="0">|</text>
<text top="455" left="303" width="7" height="13" font="3"><b>z</b></text>
<text top="459" left="310" width="12" height="13" font="10">−i</text>
<text top="455" left="323" width="20" height="12" font="0">) =</text>
<text top="455" left="349" width="4" height="13" font="4">f</text>
<text top="455" left="355" width="5" height="12" font="0">(</text>
<text top="455" left="361" width="6" height="13" font="4">z</text>
<text top="460" left="367" width="3" height="10" font="10">i</text>
<text top="454" left="371" width="4" height="16" font="0">|</text>
<text top="455" left="375" width="6" height="13" font="4">z</text>
<text top="460" left="381" width="5" height="10" font="10">1</text>
<text top="455" left="387" width="35" height="13" font="4">, . . . , z</text>
<text top="460" left="423" width="3" height="10" font="10">i</text>
<text top="459" left="426" width="14" height="13" font="10">−1</text>
<text top="455" left="441" width="12" height="13" font="4">, z</text>
<text top="460" left="453" width="17" height="11" font="10">i+1</text>
<text top="455" left="470" width="35" height="13" font="4">, . . . , z</text>
<text top="459" left="506" width="6" height="10" font="10">n</text>
<text top="455" left="513" width="5" height="12" font="0">)</text>
<text top="455" left="518" width="3" height="13" font="4">.</text>
<text top="476" left="171" width="121" height="13" font="4">The distribution of z</text>
<text top="481" left="292" width="3" height="10" font="10">i</text>
<text top="476" left="300" width="96" height="13" font="4">conditional on <b>z</b></text>
<text top="480" left="396" width="12" height="13" font="10">−i</text>
<text top="476" left="412" width="266" height="13" font="4">is univariate truncated normal with variance</text>
<text top="504" left="361" width="9" height="17" font="3"><b>Σ</b></text>
<text top="512" left="370" width="6" height="11" font="10">i.</text>
<text top="511" left="376" width="12" height="13" font="10">−i</text>
<text top="507" left="392" width="11" height="12" font="0">=</text>
<text top="504" left="407" width="9" height="17" font="3"><b>Σ</b></text>
<text top="512" left="417" width="6" height="10" font="10">ii</text>
<text top="506" left="426" width="11" height="16" font="0">−</text>
<text top="504" left="440" width="9" height="17" font="3"><b>Σ</b></text>
<text top="512" left="449" width="6" height="11" font="10">i,</text>
<text top="511" left="455" width="12" height="13" font="10">−i</text>
<text top="504" left="468" width="9" height="17" font="3"><b>Σ</b></text>
<text top="502" left="477" width="14" height="13" font="10">−1</text>
<text top="513" left="477" width="26" height="13" font="10">−i,−i</text>
<text top="504" left="505" width="9" height="17" font="3"><b>Σ</b></text>
<text top="511" left="514" width="17" height="13" font="10">−i,i</text>
<text top="507" left="728" width="16" height="13" font="4">(6)</text>
<text top="532" left="392" width="11" height="12" font="0">=</text>
<text top="532" left="407" width="11" height="13" font="3"><b>H</b></text>
<text top="528" left="419" width="14" height="13" font="10">−1</text>
<text top="539" left="419" width="6" height="10" font="10">ii</text>
<text top="532" left="728" width="16" height="13" font="4">(7)</text>
<text top="561" left="149" width="59" height="13" font="4">and mean</text>
<text top="594" left="342" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="597" left="350" width="6" height="11" font="10">i.</text>
<text top="596" left="356" width="12" height="13" font="10">−i</text>
<text top="590" left="372" width="11" height="12" font="0">=</text>
<text top="594" left="387" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="597" left="395" width="3" height="10" font="10">i</text>
<text top="590" left="402" width="11" height="12" font="0">+</text>
<text top="587" left="415" width="9" height="17" font="3"><b>Σ</b></text>
<text top="595" left="425" width="6" height="11" font="10">i,</text>
<text top="594" left="430" width="12" height="13" font="10">−i</text>
<text top="587" left="443" width="9" height="17" font="3"><b>Σ</b></text>
<text top="586" left="452" width="14" height="13" font="10">−1</text>
<text top="597" left="452" width="26" height="13" font="10">−i,−i</text>
<text top="591" left="488" width="7" height="13" font="3"><b>z</b></text>
<text top="594" left="495" width="12" height="13" font="10">−i</text>
<text top="589" left="510" width="11" height="16" font="0">−</text>
<text top="594" left="524" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="596" left="532" width="12" height="13" font="10">−i</text>
<text top="589" left="545" width="6" height="6" font="4"></text>
<text top="590" left="728" width="16" height="13" font="4">(8)</text>
<text top="616" left="372" width="11" height="12" font="0">=</text>
<text top="619" left="387" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="622" left="395" width="3" height="10" font="10">i</text>
<text top="615" left="402" width="11" height="16" font="0">−</text>
<text top="616" left="415" width="11" height="13" font="3"><b>H</b></text>
<text top="611" left="427" width="14" height="13" font="10">−1</text>
<text top="623" left="426" width="6" height="10" font="10">ii</text>
<text top="616" left="441" width="11" height="13" font="3"><b>H</b></text>
<text top="621" left="452" width="6" height="11" font="10">i,</text>
<text top="620" left="458" width="12" height="13" font="10">−i</text>
<text top="616" left="480" width="7" height="13" font="3"><b>z</b></text>
<text top="620" left="486" width="12" height="13" font="10">−i</text>
<text top="615" left="502" width="11" height="16" font="0">−</text>
<text top="619" left="516" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="621" left="523" width="12" height="13" font="10">−i</text>
<text top="614" left="536" width="6" height="6" font="4"></text>
<text top="616" left="728" width="16" height="13" font="4">(9)</text>
<text top="645" left="149" width="71" height="13" font="4">and bounds</text>
<text top="644" left="223" width="11" height="16" font="0">−</text>
<text top="642" left="234" width="11" height="17" font="4">∞</text>
<text top="644" left="250" width="11" height="16" font="0">≤</text>
<text top="645" left="265" width="6" height="13" font="4">z</text>
<text top="650" left="271" width="3" height="10" font="10">i</text>
<text top="644" left="279" width="11" height="16" font="0">≤</text>
<text top="645" left="294" width="37" height="13" font="4">0 for y</text>
<text top="650" left="331" width="3" height="10" font="10">i</text>
<text top="645" left="339" width="11" height="12" font="0">=</text>
<text top="645" left="354" width="43" height="13" font="4">0 and 0</text>
<text top="644" left="401" width="11" height="16" font="0">≤</text>
<text top="645" left="416" width="6" height="13" font="4">z</text>
<text top="650" left="422" width="3" height="10" font="10">i</text>
<text top="644" left="430" width="11" height="16" font="0">≤</text>
<text top="642" left="445" width="42" height="17" font="4">∞ for y</text>
<text top="650" left="487" width="3" height="10" font="10">i</text>
<text top="645" left="495" width="11" height="12" font="0">=</text>
<text top="645" left="510" width="10" height="13" font="4">1.</text>
<text top="666" left="171" width="573" height="13" font="4">Package <b>tmvtnorm </b>has such a Gibbs sampler in place since version 0.9, based on the covariance</text>
<text top="682" left="149" width="40" height="13" font="4">matrix</text>
<text top="679" left="192" width="78" height="17" font="3"><b>Σ</b>. Following</text>
<text top="682" left="274" width="49" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Geweke</a></text>
<text top="682" left="326" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="682" left="331" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">1991</a></text>
<text top="682" left="358" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="682" left="365" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2005</a></text>
<text top="682" left="392" width="352" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">, </a>p. 171), the Gibbs sampler is easier to state in terms of the</text>
<text top="699" left="148" width="586" height="13" font="4">precision matrix <b>H</b>, simply because it requires fewer and easier operations in the above equations <a href="2013-1-wilhelm-matos.html#3">(</a></text>
<text top="699" left="734" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">7</a></text>
<text top="699" left="741" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">)</a></text>
<text top="715" left="149" width="30" height="13" font="4">and <a href="2013-1-wilhelm-matos.html#3">(</a></text>
<text top="715" left="179" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">9</a></text>
<text top="715" left="186" width="558" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">)</a>. These equations will further simplify in the case of a sparse precision matrix <b>H</b>, in which most</text>
<text top="732" left="149" width="384" height="13" font="4">of the elements are zero. With sparse <b>H</b>, operations involving <b>H</b></text>
<text top="737" left="533" width="6" height="11" font="10">i,</text>
<text top="736" left="539" width="12" height="13" font="10">−i</text>
<text top="732" left="555" width="189" height="13" font="4">need only to be executed for all</text>
<text top="748" left="149" width="228" height="13" font="4">non-zero elements rather than for all n</text>
<text top="747" left="380" width="11" height="16" font="0">−</text>
<text top="748" left="394" width="89" height="13" font="4">1 variables in <b>z</b></text>
<text top="752" left="483" width="12" height="13" font="10">−i</text>
<text top="748" left="496" width="3" height="13" font="4">.</text>
<text top="769" left="171" width="290" height="13" font="4">In our spatial probit model, the covariance matrix</text>
<text top="766" left="465" width="9" height="17" font="3"><b>Σ</b></text>
<text top="769" left="478" width="25" height="12" font="0">= [(</text>
<text top="769" left="502" width="5" height="13" font="3"><b>I</b></text>
<text top="773" left="508" width="6" height="10" font="10">n</text>
<text top="768" left="517" width="11" height="16" font="0">−</text>
<text top="772" left="531" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="769" left="552" width="5" height="12" font="0">)</text>
<text top="765" left="557" width="3" height="13" font="10">0</text>
<text top="769" left="561" width="5" height="12" font="0">(</text>
<text top="769" left="567" width="5" height="13" font="3"><b>I</b></text>
<text top="773" left="572" width="6" height="10" font="10">n</text>
<text top="768" left="582" width="11" height="16" font="0">−</text>
<text top="772" left="596" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="769" left="616" width="10" height="12" font="0">)]</text>
<text top="765" left="626" width="14" height="13" font="10">−1</text>
<text top="769" left="644" width="102" height="13" font="4">is a dense matrix,</text>
<text top="785" left="148" width="272" height="13" font="4">whereas the corresponding precision matrix <b>H</b></text>
<text top="785" left="424" width="11" height="12" font="0">=</text>
<text top="782" left="439" width="9" height="17" font="3"><b>Σ</b></text>
<text top="781" left="448" width="14" height="13" font="10">−1</text>
<text top="785" left="467" width="20" height="12" font="0">= (</text>
<text top="786" left="487" width="5" height="13" font="3"><b>I</b></text>
<text top="790" left="493" width="6" height="10" font="10">n</text>
<text top="784" left="502" width="11" height="16" font="0">−</text>
<text top="789" left="516" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="785" left="537" width="5" height="12" font="0">)</text>
<text top="782" left="542" width="3" height="13" font="10">0</text>
<text top="785" left="546" width="5" height="12" font="0">(</text>
<text top="786" left="552" width="5" height="13" font="3"><b>I</b></text>
<text top="790" left="557" width="6" height="10" font="10">n</text>
<text top="784" left="567" width="11" height="16" font="0">−</text>
<text top="789" left="581" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="785" left="601" width="5" height="12" font="0">)</text>
<text top="785" left="610" width="134" height="13" font="4">is sparse. Hence, using</text>
<text top="799" left="149" width="595" height="17" font="3"><b>Σ </b>for sampling <b>z </b>is inefficient. For this reason we reimplemented the Gibbs sampler with the precision</text>
<text top="818" left="149" width="240" height="13" font="4">matrix <b>H </b>in package <b>tmvtnorm </b>instead <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="818" left="389" width="145" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and Manjunath</a></text>
<text top="818" left="534" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="818" left="541" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="818" left="568" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">).</a></text>
<text top="839" left="171" width="573" height="13" font="4">Suppose one wants to draw N truncated multinormal samples in n dimensions, where the precision</text>
<text top="856" left="149" width="107" height="13" font="4">matrix <b>H </b>is sparse</text>
<text top="856" left="259" width="5" height="12" font="0">(</text>
<text top="856" left="265" width="7" height="13" font="4">n</text>
<text top="854" left="275" width="11" height="16" font="0">×</text>
<text top="856" left="289" width="7" height="13" font="4">n</text>
<text top="856" left="297" width="5" height="12" font="0">)</text>
<text top="856" left="306" width="70" height="13" font="4">with only m</text>
<text top="856" left="380" width="11" height="12" font="0">&lt;</text>
<text top="856" left="395" width="323" height="14" font="4">n entries different from zero per row on average (e.g. m</text>
<text top="856" left="723" width="11" height="12" font="0">=</text>
<text top="856" left="737" width="7" height="13" font="4">6</text>
<text top="872" left="149" width="595" height="13" font="4">nearest neighbors or average branching factor in a network). With growing dimension n, two types of</text>
<text top="889" left="148" width="372" height="13" font="4">problems arise with a usual dense matrix representation for <b>H</b>:</text>
<text top="914" left="169" width="276" height="13" font="4">1. <b>Data storage problem: </b>Since matrix <b>H </b>is n</text>
<text top="913" left="448" width="11" height="16" font="0">×</text>
<text top="914" left="462" width="283" height="14" font="4">n, the space required to store the dense matrix</text>
<text top="930" left="186" width="558" height="13" font="4">will be quadratic in n. One remedy is, of course, using some sparse matrix representation for <b>H</b></text>
<text top="947" left="186" width="389" height="13" font="4">(e.g. packages <b>Matrix</b>, <b>sparseM </b>etc.), which actually holds only n</text>
<text top="945" left="578" width="4" height="16" font="0">·</text>
<text top="947" left="585" width="141" height="14" font="4">m elements instead of n</text>
<text top="945" left="729" width="4" height="16" font="0">·</text>
<text top="947" left="735" width="11" height="14" font="4">n.</text>
<text top="963" left="186" width="559" height="13" font="4">The following code example shows the difference in object sizes for a dense vs. sparse identity</text>
<text top="980" left="186" width="48" height="13" font="4">matrix <b>I</b></text>
<text top="984" left="234" width="6" height="10" font="10">n</text>
<text top="980" left="244" width="28" height="13" font="4">for n</text>
<text top="979" left="276" width="11" height="12" font="0">=</text>
<text top="980" left="291" width="74" height="13" font="4">10000 and m</text>
<text top="979" left="369" width="11" height="12" font="0">=</text>
<text top="980" left="384" width="10" height="13" font="4">1.</text>
<text top="1004" left="186" width="117" height="11" font="4">&gt; library(Matrix)</text>
<text top="1020" left="186" width="178" height="11" font="4">&gt; I_n_dense &lt;- diag(10000)</text>
<text top="1037" left="186" width="309" height="11" font="4">&gt; print(object.size(I_n_dense), units = &#34;Mb&#34;)</text>
<text top="1063" left="186" width="55" height="11" font="4">762.9 Mb</text>
<text top="1089" left="186" width="103" height="11" font="4">&gt; rm(I_n_dense)</text>
<text top="1105" left="186" width="418" height="11" font="4">&gt; I_n_sparse &lt;- sparseMatrix(i = 1:10000, j = 1:10000, x = 1)</text>
<text top="1121" left="186" width="316" height="11" font="4">&gt; print(object.size(I_n_sparse), units = &#34;Mb&#34;)</text>
<text top="1147" left="186" width="41" height="11" font="4">0.2 Mb</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="4" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">133</text>
<text top="103" left="169" width="575" height="13" font="4">2. <b>Data access problem: </b>Even with a sparse matrix representation for <b>H</b>, a naive strategy that tries</text>
<text top="120" left="186" width="558" height="13" font="4">to access an arbitrary matrix element H[i,j] like in triplet or hash table representations, will</text>
<text top="136" left="186" width="63" height="13" font="4">result in N</text>
<text top="135" left="253" width="4" height="16" font="0">·</text>
<text top="136" left="259" width="7" height="13" font="4">n</text>
<text top="135" left="270" width="4" height="16" font="0">·</text>
<text top="136" left="277" width="468" height="14" font="4">n matrix accesses to <b>H</b>. This number grows quadratically in n. For example, for</text>
<text top="152" left="187" width="10" height="13" font="4">N</text>
<text top="152" left="202" width="11" height="12" font="0">=</text>
<text top="152" left="217" width="51" height="13" font="4">30 and n</text>
<text top="152" left="272" width="11" height="12" font="0">=</text>
<text top="152" left="286" width="130" height="13" font="4">10000 it adds up to 30</text>
<text top="151" left="420" width="4" height="16" font="0">·</text>
<text top="152" left="426" width="34" height="13" font="4">10000</text>
<text top="151" left="463" width="4" height="16" font="0">·</text>
<text top="152" left="470" width="34" height="13" font="4">10000</text>
<text top="152" left="508" width="11" height="12" font="0">=</text>
<text top="152" left="523" width="222" height="13" font="4">3 billion hash function calls, which is</text>
<text top="169" left="186" width="272" height="13" font="4">inefficient and too slow for most applications.</text>
<text top="185" left="186" width="419" height="13" font="4">Iterating only over the non-zero elements in row i, for example in term H</text>
<text top="190" left="605" width="6" height="11" font="10">i,</text>
<text top="189" left="611" width="12" height="13" font="10">−i</text>
<text top="185" left="623" width="121" height="13" font="4">, reduces the number</text>
<text top="202" left="186" width="152" height="13" font="4">of accesses to <b>H </b>to only N</text>
<text top="201" left="342" width="4" height="16" font="0">·</text>
<text top="202" left="349" width="7" height="13" font="4">n</text>
<text top="201" left="359" width="4" height="16" font="0">·</text>
<text top="202" left="366" width="86" height="14" font="4">m instead of N</text>
<text top="201" left="456" width="4" height="16" font="0">·</text>
<text top="202" left="462" width="7" height="13" font="4">n</text>
<text top="201" left="473" width="4" height="16" font="0">·</text>
<text top="202" left="480" width="265" height="14" font="4">n, which furthermore will only grow linearly</text>
<text top="218" left="186" width="558" height="13" font="4">in n for a fixed m. Suitable data structures to access all non-zero elements of the precision matrix</text>
<text top="235" left="186" width="11" height="13" font="3"><b>H</b></text>
<text top="235" left="201" width="543" height="13" font="4">are linked lists of elements for each row i (list-of-lists) or, thanks to the symmetry of <b>H</b>, the</text>
<text top="251" left="186" width="558" height="13" font="4">compressed-sparse-column/row representation of sparse matrices, directly available from the</text>
<text top="268" left="186" width="41" height="13" font="3"><b>Matrix</b></text>
<text top="268" left="231" width="52" height="13" font="4">package.</text>
<text top="294" left="171" width="573" height="13" font="4">How fast is the random number generation for <b>z </b>now? We performed a series of tests for varying</text>
<text top="311" left="149" width="448" height="13" font="4">sizes N and n and two different values of m. The results presented in Table</text>
<text top="311" left="600" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#4">1</a></text>
<text top="311" left="611" width="134" height="13" font="4">show that the sampler</text>
<text top="327" left="148" width="596" height="13" font="4">with sparse <b>H </b>is indeed very fast and works fine in high dimensions. The time required scales with</text>
<text top="344" left="149" width="10" height="13" font="4">N</text>
<text top="342" left="163" width="4" height="16" font="0">·</text>
<text top="344" left="170" width="11" height="14" font="4">n.</text>
<text top="379" left="484" width="12" height="15" font="0">N</text>
<text top="397" left="328" width="8" height="15" font="0">n</text>
<text top="397" left="371" width="15" height="15" font="0">10</text>
<text top="395" left="386" width="6" height="11" font="1">1</text>
<text top="397" left="416" width="15" height="15" font="0">10</text>
<text top="395" left="430" width="6" height="11" font="1">2</text>
<text top="397" left="460" width="15" height="15" font="0">10</text>
<text top="395" left="475" width="6" height="11" font="1">3</text>
<text top="397" left="504" width="15" height="15" font="0">10</text>
<text top="395" left="519" width="6" height="11" font="1">4</text>
<text top="397" left="548" width="15" height="15" font="0">10</text>
<text top="395" left="563" width="6" height="11" font="1">5</text>
<text top="397" left="592" width="15" height="15" font="0">10</text>
<text top="395" left="607" width="6" height="11" font="1">6</text>
<text top="424" left="280" width="30" height="15" font="0">m=2</text>
<text top="424" left="327" width="15" height="15" font="0">10</text>
<text top="421" left="342" width="6" height="11" font="1">1</text>
<text top="424" left="499" width="26" height="15" font="0">0.03</text>
<text top="424" left="543" width="26" height="15" font="0">0.25</text>
<text top="424" left="587" width="26" height="15" font="0">2.60</text>
<text top="442" left="327" width="15" height="15" font="0">10</text>
<text top="439" left="342" width="6" height="11" font="1">2</text>
<text top="442" left="455" width="26" height="15" font="0">0.03</text>
<text top="442" left="499" width="26" height="15" font="0">0.25</text>
<text top="442" left="543" width="26" height="15" font="0">2.75</text>
<text top="461" left="327" width="15" height="15" font="0">10</text>
<text top="458" left="342" width="6" height="11" font="1">3</text>
<text top="461" left="411" width="26" height="15" font="0">0.03</text>
<text top="461" left="455" width="26" height="15" font="0">0.25</text>
<text top="461" left="499" width="26" height="15" font="0">2.84</text>
<text top="479" left="327" width="15" height="15" font="0">10</text>
<text top="477" left="342" width="6" height="11" font="1">4</text>
<text top="479" left="367" width="26" height="15" font="0">0.03</text>
<text top="479" left="411" width="26" height="15" font="0">0.25</text>
<text top="479" left="455" width="26" height="15" font="0">2.80</text>
<text top="498" left="327" width="15" height="15" font="0">10</text>
<text top="495" left="342" width="6" height="11" font="1">5</text>
<text top="498" left="367" width="26" height="15" font="0">0.26</text>
<text top="498" left="411" width="26" height="15" font="0">2.79</text>
<text top="524" left="280" width="30" height="15" font="0">m=6</text>
<text top="524" left="327" width="15" height="15" font="0">10</text>
<text top="521" left="342" width="6" height="11" font="1">1</text>
<text top="524" left="499" width="26" height="15" font="0">0.03</text>
<text top="524" left="543" width="26" height="15" font="0">0.23</text>
<text top="524" left="587" width="26" height="15" font="0">2.48</text>
<text top="543" left="327" width="15" height="15" font="0">10</text>
<text top="540" left="342" width="6" height="11" font="1">2</text>
<text top="543" left="455" width="26" height="15" font="0">0.01</text>
<text top="543" left="499" width="26" height="15" font="0">0.23</text>
<text top="543" left="543" width="26" height="15" font="0">2.53</text>
<text top="561" left="327" width="15" height="15" font="0">10</text>
<text top="559" left="342" width="6" height="11" font="1">3</text>
<text top="561" left="411" width="26" height="15" font="0">0.03</text>
<text top="561" left="455" width="26" height="15" font="0">0.23</text>
<text top="561" left="499" width="26" height="15" font="0">2.59</text>
<text top="580" left="327" width="15" height="15" font="0">10</text>
<text top="577" left="342" width="6" height="11" font="1">4</text>
<text top="580" left="367" width="26" height="15" font="0">0.02</text>
<text top="580" left="411" width="26" height="15" font="0">0.24</text>
<text top="580" left="455" width="26" height="15" font="0">2.57</text>
<text top="599" left="327" width="15" height="15" font="0">10</text>
<text top="596" left="342" width="6" height="11" font="1">5</text>
<text top="599" left="367" width="26" height="15" font="0">0.25</text>
<text top="599" left="411" width="26" height="15" font="0">2.68</text>
<text top="650" left="148" width="47" height="13" font="3"><b>Table 1:</b></text>
<text top="650" left="200" width="544" height="13" font="4">Performance test results for the generation of truncated multivariate normal samples <b>z </b>with</text>
<text top="667" left="149" width="158" height="11" font="4">rtmvnorm.sparseMatrix()</text>
<text top="667" left="311" width="433" height="13" font="4">(<b>tmvtnorm</b>) for a varying number of samples N and dimension n. The</text>
<text top="683" left="148" width="204" height="13" font="4">precision matrix in each case is <b>H</b></text>
<text top="683" left="357" width="21" height="12" font="0">= (</text>
<text top="683" left="378" width="5" height="13" font="3"><b>I</b></text>
<text top="687" left="383" width="6" height="10" font="10">n</text>
<text top="682" left="393" width="11" height="16" font="0">−</text>
<text top="686" left="407" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="683" left="428" width="5" height="12" font="0">)</text>
<text top="679" left="433" width="3" height="13" font="10">0</text>
<text top="683" left="437" width="5" height="12" font="0">(</text>
<text top="683" left="443" width="5" height="13" font="3"><b>I</b></text>
<text top="687" left="448" width="6" height="10" font="10">n</text>
<text top="682" left="458" width="11" height="16" font="0">−</text>
<text top="686" left="472" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="683" left="492" width="5" height="12" font="0">)</text>
<text top="683" left="498" width="246" height="13" font="4">, the spatial weight matrix <b>W </b>contains m</text>
<text top="700" left="149" width="595" height="13" font="4">non-zero entries per row. Times are in seconds and measured on an Intel® Core™i7-2600 CPU @3.40</text>
<text top="716" left="149" width="32" height="13" font="4">GHz.</text>
<text top="760" left="171" width="573" height="13" font="4">One more performance issue we discuss here is the burn-in size in the innermost Gibbs sampler</text>
<text top="776" left="149" width="119" height="13" font="4">generating <b>z </b>from p</text>
<text top="776" left="268" width="5" height="12" font="0">(</text>
<text top="776" left="273" width="7" height="13" font="3"><b>z</b></text>
<text top="775" left="280" width="4" height="16" font="0">|</text>
<text top="779" left="285" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="776" left="293" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="776" left="319" width="5" height="12" font="0">)</text>
<text top="776" left="325" width="420" height="13" font="4">. Depending on the start value, Gibbs samplers often require a certain</text>
<text top="793" left="149" width="596" height="13" font="4">burn-in phase until the sampler mixes well and draws from the desired target distribution. In our</text>
<text top="809" left="149" width="311" height="13" font="4">MCMC setup, we only draw one sample of <b>z </b>from p</text>
<text top="809" left="460" width="5" height="12" font="0">(</text>
<text top="809" left="466" width="7" height="13" font="3"><b>z</b></text>
<text top="808" left="473" width="4" height="16" font="0">|</text>
<text top="812" left="477" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="809" left="485" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="809" left="511" width="5" height="12" font="0">)</text>
<text top="809" left="520" width="224" height="13" font="4">in each MCMC iteration, but possibly</text>
<text top="825" left="149" width="191" height="13" font="4">in very high dimensions (e.g. N</text>
<text top="825" left="344" width="11" height="12" font="0">=</text>
<text top="825" left="359" width="21" height="13" font="4">1, n</text>
<text top="825" left="384" width="11" height="12" font="0">=</text>
<text top="825" left="399" width="346" height="13" font="4">10000). With burn.in=20 samples, we have to generate 21</text>
<text top="842" left="149" width="595" height="13" font="4">draws in order to keep just one. In our situation, a large burn-in size will dramatically degrade the</text>
<text top="858" left="149" width="598" height="13" font="4">MCMC performance, so the number of burn-in samples for generating <b>z </b>has to be chosen carefully.</text>
<text top="875" left="149" width="104" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage and Pace</a></text>
<text top="875" left="258" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="875" left="262" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="875" left="290" width="454" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>discuss the role of the burn-in size and often use burn.in=10, when the</text>
<text top="891" left="149" width="598" height="13" font="4">Gibbs sampler starts from zero. Alternatively, they also propose to use no burn-in phase at all (e.g.</text>
<text top="908" left="149" width="62" height="11" font="4">burn.in=0</text>
<text top="908" left="211" width="521" height="13" font="4">), but then to set the start value of the sampler to the previous value of <b>z </b>instead of zero.</text>
<text top="950" left="149" width="146" height="15" font="12"><b>QR decomposition of</b></text>
<text top="950" left="299" width="6" height="14" font="13">(</text>
<text top="950" left="305" width="6" height="15" font="12"><b>I</b></text>
<text top="955" left="311" width="6" height="11" font="1">n</text>
<text top="949" left="321" width="12" height="18" font="13">−</text>
<text top="953" left="337" width="23" height="11" font="15"><i>ρ</i><b>W</b></text>
<text top="950" left="359" width="6" height="14" font="13">)</text>
<text top="982" left="148" width="395" height="13" font="4">The mean vector <i><b>µ </b></i>of the truncated normal samples <b>z </b>in equation <a href="2013-1-wilhelm-matos.html#2">(</a></text>
<text top="982" left="544" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">3</a></text>
<text top="982" left="550" width="93" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">) </a>takes the form</text>
<text top="1016" left="386" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="1013" left="397" width="20" height="13" font="0">= (</text>
<text top="1013" left="418" width="5" height="13" font="3"><b>I</b></text>
<text top="1017" left="423" width="6" height="10" font="10">n</text>
<text top="1012" left="433" width="11" height="16" font="0">−</text>
<text top="1016" left="447" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="1013" left="467" width="5" height="12" font="0">)</text>
<text top="1008" left="473" width="14" height="13" font="10">−1</text>
<text top="1013" left="490" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="1013" left="722" width="22" height="13" font="4">(10)</text>
<text top="1042" left="149" width="235" height="13" font="4">However, inverting the sparse matrix <b>S</b></text>
<text top="1042" left="388" width="20" height="12" font="0">= (</text>
<text top="1042" left="408" width="5" height="13" font="3"><b>I</b></text>
<text top="1046" left="414" width="6" height="10" font="10">n</text>
<text top="1041" left="423" width="11" height="16" font="0">−</text>
<text top="1045" left="437" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="1042" left="458" width="5" height="12" font="0">)</text>
<text top="1042" left="467" width="278" height="13" font="4">will produce a dense matrix and will therefore</text>
<text top="1059" left="149" width="595" height="13" font="4">offset all benefits from using sparse matrices (i.e. memory consumption and size of problems that</text>
<text top="1075" left="149" width="423" height="13" font="4">can be solved). It is preferable to determine <i><b>µ </b></i>by solving the equations</text>
<text top="1075" left="575" width="5" height="12" font="0">(</text>
<text top="1075" left="581" width="5" height="13" font="3"><b>I</b></text>
<text top="1079" left="586" width="6" height="10" font="10">n</text>
<text top="1074" left="595" width="11" height="16" font="0">−</text>
<text top="1078" left="609" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="1075" left="630" width="5" height="12" font="0">)</text>
<text top="1079" left="636" width="8" height="10" font="9"><i><b>µ</b></i></text>
<text top="1075" left="647" width="11" height="12" font="0">=</text>
<text top="1075" left="662" width="17" height="13" font="3"><b>X<i>β</i></b></text>
<text top="1075" left="683" width="61" height="13" font="4">with a QR</text>
<text top="1092" left="149" width="119" height="13" font="4">decomposition of <b>S</b></text>
<text top="1092" left="274" width="22" height="12" font="0">= (</text>
<text top="1092" left="296" width="5" height="13" font="3"><b>I</b></text>
<text top="1096" left="301" width="6" height="10" font="10">n</text>
<text top="1090" left="311" width="11" height="16" font="0">−</text>
<text top="1095" left="325" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="1092" left="346" width="5" height="12" font="0">)</text>
<text top="1092" left="351" width="393" height="13" font="4">. We point out that there is a significant performance difference</text>
<text top="1108" left="149" width="595" height="13" font="4">between the usual code mu &lt;-qr.solve(S,X %*% beta) and mu &lt;-solve(qr(S),X %*% beta). The</text>
<text top="1125" left="149" width="595" height="13" font="4">latter will apply a QR decomposition for a sparse matrix <b>S </b>and will use a method qr() from the</text>
<text top="1141" left="148" width="598" height="13" font="4">package <b>Matrix</b>, whereas the first function from the <b>base </b>package will coerce <b>S </b>into a dense matrix.</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="5" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">134</text>
<text top="104" left="149" width="158" height="11" font="4">solve(qr(S),X %*% beta)</text>
<text top="103" left="310" width="369" height="13" font="4">takes only half the time required by qr.solve(S,X %*% beta).</text>
<text top="145" left="149" width="73" height="15" font="12"><b>Drawing </b>p</text>
<text top="145" left="222" width="6" height="14" font="13">(</text>
<text top="149" left="229" width="9" height="11" font="14"><i><b>β</b></i></text>
<text top="144" left="238" width="4" height="18" font="13">|</text>
<text top="145" left="242" width="7" height="15" font="12"><b>z</b></text>
<text top="145" left="250" width="29" height="15" font="0">, <i>ρ</i>, <b>y</b></text>
<text top="145" left="279" width="6" height="14" font="13">)</text>
<text top="177" left="149" width="65" height="13" font="4">Drawing p</text>
<text top="177" left="215" width="5" height="12" font="0">(</text>
<text top="180" left="221" width="8" height="10" font="9"><i><b>β</b></i></text>
<text top="176" left="229" width="4" height="16" font="0">|</text>
<text top="177" left="233" width="7" height="13" font="3"><b>z</b></text>
<text top="177" left="240" width="26" height="13" font="4">, <i>ρ</i>, <b>y</b></text>
<text top="177" left="266" width="5" height="12" font="0">)</text>
<text top="177" left="275" width="78" height="13" font="4">in equation <a href="2013-1-wilhelm-matos.html#2">(</a></text>
<text top="177" left="353" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">4</a></text>
<text top="177" left="360" width="346" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">) </a>is a multivariate normal distribution, whose variance <b>T</b></text>
<text top="173" left="706" width="5" height="13" font="10">∗</text>
<text top="177" left="716" width="28" height="13" font="4">does</text>
<text top="193" left="149" width="595" height="13" font="4">not depend on <b>z </b>and <i>ρ</i>. Therefore, we can efficiently vectorize and generate temporary draws</text>
<text top="213" left="149" width="7" height="10" font="8"><i>β</i></text>
<text top="214" left="157" width="18" height="10" font="10">tmp</text>
<text top="209" left="180" width="11" height="16" font="0">∼</text>
<text top="210" left="195" width="10" height="13" font="4">N</text>
<text top="210" left="207" width="5" height="12" font="0">(</text>
<text top="210" left="212" width="21" height="13" font="4">0, <b>T</b></text>
<text top="206" left="233" width="5" height="13" font="10">∗</text>
<text top="210" left="240" width="5" height="12" font="0">)</text>
<text top="210" left="249" width="496" height="13" font="4">for all MCMC iterations before running the chain and then just shift these temporary</text>
<text top="226" left="149" width="65" height="13" font="4">draws by <b>c</b></text>
<text top="223" left="214" width="5" height="13" font="10">∗</text>
<text top="226" left="223" width="179" height="13" font="4">in every iteration to obtain a <i>β</i></text>
<text top="225" left="407" width="11" height="16" font="0">∼</text>
<text top="226" left="422" width="10" height="13" font="4">N</text>
<text top="226" left="433" width="5" height="12" font="0">(</text>
<text top="226" left="439" width="6" height="13" font="3"><b>c</b></text>
<text top="223" left="445" width="5" height="13" font="10">∗</text>
<text top="226" left="451" width="15" height="13" font="4">, <b>T</b></text>
<text top="222" left="466" width="5" height="13" font="10">∗</text>
<text top="226" left="473" width="5" height="12" font="0">)</text>
<text top="226" left="478" width="3" height="13" font="4">.</text>
<text top="269" left="149" width="311" height="15" font="12"><b>Determining log-determinants and drawing </b>p</text>
<text top="268" left="461" width="6" height="14" font="13">(</text>
<text top="272" left="467" width="7" height="11" font="15"><i>ρ</i></text>
<text top="267" left="475" width="4" height="18" font="13">|</text>
<text top="269" left="479" width="7" height="15" font="12"><b>z</b></text>
<text top="269" left="487" width="30" height="15" font="0">, <i><b>β</b></i>, <b>y</b></text>
<text top="268" left="517" width="6" height="14" font="13">)</text>
<text top="300" left="148" width="268" height="13" font="4">The computation of log-determinants for ln</text>
<text top="299" left="419" width="4" height="16" font="0">|</text>
<text top="300" left="423" width="4" height="13" font="4">I</text>
<text top="304" left="428" width="6" height="10" font="10">n</text>
<text top="299" left="438" width="11" height="16" font="0">−</text>
<text top="303" left="452" width="19" height="10" font="8"><i>ρ</i>W</text>
<text top="299" left="472" width="4" height="16" font="0">|</text>
<text top="300" left="476" width="268" height="13" font="4">, whose evaluation is frequently needed for</text>
<text top="317" left="149" width="60" height="13" font="4">drawing p</text>
<text top="317" left="210" width="5" height="12" font="0">(</text>
<text top="320" left="215" width="7" height="10" font="8"><i>ρ</i></text>
<text top="315" left="222" width="4" height="16" font="0">|</text>
<text top="317" left="226" width="7" height="13" font="3"><b>z</b></text>
<text top="317" left="233" width="27" height="13" font="4">, <i><b>β</b></i>, <b>y</b></text>
<text top="317" left="260" width="5" height="12" font="0">)</text>
<text top="317" left="266" width="272" height="13" font="4">, becomes a challenging task for large matrices.</text>
<text top="317" left="542" width="42" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Bivand</a></text>
<text top="317" left="587" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="317" left="591" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2010</a></text>
<text top="317" left="618" width="127" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>gives a survey of the</text>
<text top="333" left="149" width="311" height="13" font="4">different methods for calculating the Jacobian like the</text>
<text top="333" left="463" width="88" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Pace and Barry</a></text>
<text top="333" left="555" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="333" left="559" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">1997</a></text>
<text top="333" left="585" width="159" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>grid evaluation of <i>ρ </i>in the</text>
<text top="350" left="149" width="45" height="13" font="4">interval</text>
<text top="349" left="197" width="4" height="12" font="0">[</text>
<text top="348" left="202" width="11" height="16" font="0">−</text>
<text top="350" left="213" width="33" height="13" font="4">1, . . . ,</text>
<text top="349" left="248" width="11" height="12" font="0">+</text>
<text top="350" left="259" width="7" height="13" font="4">1</text>
<text top="349" left="266" width="4" height="12" font="0">]</text>
<text top="350" left="273" width="471" height="13" font="4">and spline approximations between grid points or the Chebyshev approximation</text>
<text top="366" left="149" width="142" height="13" font="4">of the log-determinant <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="366" left="291" width="99" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Pace and LeSage</a></text>
<text top="366" left="390" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="366" left="397" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2004</a></text>
<text top="366" left="424" width="320" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">). </a>All of them are implemented in package <b>spdep</b>. For</text>
<text top="382" left="149" width="545" height="13" font="4">the estimation of the probit models we are using the existing facilities in <b>spdep </b>(do_ldet()).</text>
<text top="425" left="149" width="222" height="15" font="12"><b>Computation of marginal effects</b></text>
<text top="456" left="149" width="521" height="13" font="4">In spatial lag models (and its probit variants), a change of an explanatory variable x</text>
<text top="461" left="671" width="7" height="10" font="10">ir</text>
<text top="456" left="683" width="61" height="13" font="4">will affect</text>
<text top="473" left="149" width="203" height="13" font="4">both the same response variable z</text>
<text top="478" left="352" width="3" height="10" font="10">i</text>
<text top="473" left="359" width="291" height="13" font="4">(direct effects) and possibly all other responses z</text>
<text top="478" left="651" width="3" height="10" font="10">j</text>
<text top="473" left="659" width="9" height="13" font="4">(j</text>
<text top="472" left="672" width="11" height="16" font="0">6=</text>
<text top="473" left="687" width="57" height="14" font="4">i; indirect</text>
<text top="489" left="149" width="343" height="13" font="4">effects or spatial spillovers). The resulting effects matrix S</text>
<text top="493" left="492" width="4" height="10" font="10">r</text>
<text top="489" left="497" width="5" height="12" font="0">(</text>
<text top="489" left="502" width="13" height="13" font="4">W</text>
<text top="489" left="516" width="5" height="12" font="0">)</text>
<text top="489" left="525" width="21" height="13" font="4">is n</text>
<text top="488" left="549" width="11" height="16" font="0">×</text>
<text top="489" left="562" width="38" height="14" font="4">n for <b>x</b></text>
<text top="493" left="601" width="4" height="10" font="10">r</text>
<text top="489" left="609" width="10" height="13" font="4">(r</text>
<text top="489" left="623" width="11" height="12" font="0">=</text>
<text top="489" left="638" width="106" height="13" font="4">1, . . . , k) and three</text>
<text top="506" left="149" width="139" height="13" font="4">summary measures of S</text>
<text top="510" left="287" width="4" height="10" font="10">r</text>
<text top="506" left="293" width="5" height="12" font="0">(</text>
<text top="506" left="298" width="13" height="13" font="4">W</text>
<text top="506" left="312" width="5" height="12" font="0">)</text>
<text top="506" left="320" width="250" height="13" font="4">will be computed: average direct effects (M</text>
<text top="510" left="571" width="4" height="10" font="10">r</text>
<text top="506" left="576" width="5" height="12" font="0">(</text>
<text top="506" left="582" width="10" height="13" font="4">D</text>
<text top="506" left="593" width="20" height="12" font="0">) =</text>
<text top="506" left="617" width="7" height="13" font="4">n</text>
<text top="502" left="625" width="14" height="13" font="10">−1</text>
<text top="506" left="640" width="18" height="13" font="4">trS</text>
<text top="510" left="658" width="4" height="10" font="10">r</text>
<text top="506" left="663" width="5" height="12" font="0">(</text>
<text top="506" left="668" width="13" height="13" font="4">W</text>
<text top="506" left="682" width="5" height="12" font="0">)</text>
<text top="506" left="688" width="56" height="13" font="4">), average</text>
<text top="522" left="149" width="91" height="13" font="4">total effects (M</text>
<text top="526" left="239" width="4" height="10" font="10">r</text>
<text top="522" left="245" width="5" height="12" font="0">(</text>
<text top="522" left="251" width="8" height="13" font="4">T</text>
<text top="522" left="260" width="21" height="12" font="0">) =</text>
<text top="522" left="284" width="7" height="13" font="4">n</text>
<text top="518" left="292" width="14" height="13" font="10">−1</text>
<text top="522" left="307" width="7" height="13" font="4">1</text>
<text top="518" left="314" width="3" height="13" font="10">0</text>
<text top="527" left="314" width="6" height="10" font="10">n</text>
<text top="522" left="321" width="7" height="13" font="4">S</text>
<text top="526" left="328" width="4" height="10" font="10">r</text>
<text top="522" left="333" width="5" height="12" font="0">(</text>
<text top="522" left="339" width="13" height="13" font="4">W</text>
<text top="522" left="353" width="5" height="12" font="0">)</text>
<text top="522" left="358" width="7" height="13" font="4">1</text>
<text top="526" left="365" width="6" height="10" font="10">n</text>
<text top="522" left="372" width="372" height="13" font="4">) and the average indirect effects as the difference of total and</text>
<text top="539" left="149" width="96" height="13" font="4">direct effects (M</text>
<text top="543" left="245" width="4" height="10" font="10">r</text>
<text top="538" left="250" width="5" height="12" font="0">(</text>
<text top="538" left="257" width="4" height="13" font="4">I</text>
<text top="538" left="262" width="20" height="12" font="0">) =</text>
<text top="538" left="287" width="13" height="13" font="4">M</text>
<text top="543" left="300" width="4" height="10" font="10">r</text>
<text top="538" left="305" width="5" height="12" font="0">(</text>
<text top="538" left="311" width="8" height="13" font="4">T</text>
<text top="538" left="320" width="5" height="12" font="0">)</text>
<text top="537" left="328" width="11" height="16" font="0">−</text>
<text top="538" left="343" width="13" height="13" font="4">M</text>
<text top="543" left="355" width="4" height="10" font="10">r</text>
<text top="538" left="361" width="5" height="12" font="0">(</text>
<text top="538" left="367" width="10" height="13" font="4">D</text>
<text top="538" left="378" width="5" height="12" font="0">)</text>
<text top="539" left="383" width="361" height="13" font="4">). In contrast to the SAR probit, there are no spatial spill-over</text>
<text top="555" left="149" width="195" height="13" font="4">effects in the SEM probit model <a href="2013-1-wilhelm-matos.html#2">(</a></text>
<text top="555" left="344" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">2</a></text>
<text top="555" left="350" width="288" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">)</a>. In the MATLAB spatial econometrics toolbox <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="555" left="638" width="42" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage</a></text>
<text top="555" left="681" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="555" left="687" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2010</a></text>
<text top="555" left="714" width="30" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">), </a>the</text>
<text top="571" left="149" width="421" height="13" font="4">computation of the average total effects requires an inversion of the n</text>
<text top="570" left="572" width="11" height="16" font="0">×</text>
<text top="571" left="586" width="63" height="14" font="4">n matrix <b>S</b></text>
<text top="571" left="653" width="21" height="12" font="0">= (</text>
<text top="571" left="674" width="5" height="13" font="3"><b>I</b></text>
<text top="575" left="680" width="6" height="10" font="10">n</text>
<text top="570" left="689" width="11" height="16" font="0">−</text>
<text top="575" left="703" width="20" height="10" font="8"><i>ρ</i><b>W</b></text>
<text top="571" left="724" width="5" height="12" font="0">)</text>
<text top="571" left="733" width="11" height="13" font="4">at</text>
<text top="588" left="149" width="595" height="13" font="4">every MCMC iteration. Using the same QR-decomposition of <b>S </b>as described above and solving the</text>
<text top="604" left="149" width="535" height="13" font="4">equation solve(qr(S),rep(1,n)) speeds up the calculation of total effects by magnitudes.</text>
<text top="649" left="149" width="79" height="17" font="5"><b>Examples</b></text>
<text top="691" left="149" width="147" height="15" font="12"><b>Package spatialprobit</b></text>
<text top="722" left="148" width="596" height="13" font="4">After describing the implementation issues to ensure that the estimation is fast enough and capable</text>
<text top="739" left="149" width="595" height="13" font="4">to handle large problems, we briefly describe the interface of the methods in package <b>spatialprobit</b></text>
<text top="755" left="148" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="755" left="153" width="135" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and de Matos</a></text>
<text top="755" left="288" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="755" left="295" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="755" left="321" width="202" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>and then turn to some examples.</text>
<text top="776" left="171" width="573" height="13" font="4">The main estimation method for the SAR probit model sar_probit_mcmc(y,X,W) takes a vector of</text>
<text top="793" left="149" width="600" height="13" font="4">dependent variables y, a model matrix X and a spatial weight matrix W. The method sarprobit(formula,</text>
<text top="810" left="148" width="48" height="11" font="4">W,data)</text>
<text top="809" left="200" width="544" height="13" font="4">is a wrapper which allows a model formula and a data frame. Both methods require a spatial</text>
<text top="825" left="148" width="598" height="13" font="4">weight matrix W to be passed as an argument. Additionally, the number of MCMC start values,</text>
<text top="842" left="149" width="595" height="13" font="4">the number of burn-in iterations and a thinning parameter can be specified. The estimation fit</text>
<text top="859" left="147" width="174" height="11" font="4">&lt;-sarprobit(y ~ x,W,data)</text>
<text top="858" left="325" width="422" height="13" font="4">returns an object of class sarprobit. The model coefficients can be ex-</text>
<text top="875" left="149" width="595" height="13" font="4">tracted via coef(fit). summary(fit) returns a coefficient table with z-values, impacts(fit) gives</text>
<text top="891" left="149" width="595" height="13" font="4">the marginal effects and the plot(fit) method provides MCMC trace plots, posterior density plots</text>
<text top="908" left="149" width="595" height="13" font="4">as well as autocorrelation plots of the model parameters. logLik(fit) and AIC(fit) return the log</text>
<text top="924" left="149" width="423" height="13" font="4">likelihood and the AIC of the model for model comparison and testing.</text>
<text top="966" left="149" width="204" height="15" font="12"><b>Experiment from LeSage/Pace</b></text>
<text top="998" left="148" width="203" height="13" font="4">We replicate the experiment from</text>
<text top="998" left="355" width="102" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage and Pace</a></text>
<text top="998" left="461" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="998" left="465" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="998" left="493" width="125" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">, </a>section 10.1.5) for n</text>
<text top="998" left="622" width="11" height="12" font="0">=</text>
<text top="998" left="638" width="59" height="13" font="4">400 and n</text>
<text top="998" left="701" width="11" height="12" font="0">=</text>
<text top="998" left="717" width="27" height="13" font="4">1000</text>
<text top="1014" left="149" width="595" height="13" font="4">random points in a plane and a spatial weight matrix with the 6 nearest neighbors. The spatial probit</text>
<text top="1031" left="149" width="138" height="13" font="4">model parameters are <i>σ</i></text>
<text top="1028" left="287" width="5" height="10" font="10">2</text>
<text top="1039" left="286" width="5" height="8" font="11"><i>e</i></text>
<text top="1031" left="297" width="11" height="12" font="0">=</text>
<text top="1031" left="312" width="22" height="13" font="4">1, <i><b>β</b></i></text>
<text top="1031" left="338" width="20" height="12" font="0">= (</text>
<text top="1031" left="358" width="22" height="13" font="4">0, 1,</text>
<text top="1030" left="383" width="11" height="16" font="0">−</text>
<text top="1031" left="394" width="7" height="13" font="4">1</text>
<text top="1031" left="401" width="5" height="12" font="0">)</text>
<text top="1027" left="406" width="3" height="13" font="10">0</text>
<text top="1031" left="413" width="33" height="13" font="4">and <i>ρ</i></text>
<text top="1031" left="450" width="11" height="12" font="0">=</text>
<text top="1031" left="465" width="279" height="13" font="4">0.75. We generate data from this model with the</text>
<text top="1047" left="149" width="92" height="13" font="4">following code.</text>
<text top="1075" left="149" width="165" height="11" font="4">&gt; library(spatialprobit)</text>
<text top="1091" left="149" width="89" height="11" font="4">&gt; set.seed(2)</text>
<text top="1108" left="149" width="69" height="11" font="4">&gt; n &lt;- 400</text>
<text top="1124" left="149" width="144" height="11" font="4">&gt; beta &lt;- c(0, 1, -1)</text>
<text top="1141" left="149" width="89" height="11" font="4">&gt; rho &lt;- 0.75</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="6" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">135</text>
<text top="104" left="149" width="377" height="11" font="4">&gt; X &lt;- cbind(intercept = 1, x = rnorm(n), y = rnorm(n))</text>
<text top="120" left="149" width="316" height="11" font="4">&gt; I_n &lt;- sparseMatrix(i = 1:n, j = 1:n, x = 1)</text>
<text top="137" left="149" width="466" height="11" font="4">&gt; nb &lt;- knn2nb(knearneigh(cbind(x = rnorm(n), y = rnorm(n)), k = 6))</text>
<text top="153" left="149" width="247" height="11" font="4">&gt; listw &lt;- nb2listw(nb, style = &#34;W&#34;)</text>
<text top="169" left="149" width="364" height="11" font="4">&gt; W &lt;- as(as_dgRMatrix_listw(listw), &#34;CsparseMatrix&#34;)</text>
<text top="186" left="149" width="268" height="11" font="4">&gt; eps &lt;- rnorm(n = n, mean = 0, sd = 1)</text>
<text top="202" left="149" width="336" height="11" font="4">&gt; z &lt;- solve(qr(I_n - rho * W), X %*% beta + eps)</text>
<text top="219" left="149" width="165" height="11" font="4">&gt; y &lt;- as.double(z &gt;= 0)</text>
<text top="244" left="148" width="233" height="13" font="4">We estimate the spatial probit model as</text>
<text top="271" left="149" width="494" height="11" font="4">&gt; sarprobit.fit1 &lt;- sarprobit(y ~ X - 1, W, ndraw = 1000, burn.in = 200,</text>
<text top="288" left="149" width="7" height="11" font="4">+</text>
<text top="288" left="190" width="144" height="11" font="4">thinning = 1, m = 10)</text>
<text top="304" left="149" width="171" height="11" font="4">&gt; summary(sarprobit.fit1)</text>
<text top="320" left="149" width="151" height="11" font="4">&gt; plot(sarprobit.fit1)</text>
<text top="346" left="148" width="32" height="13" font="4">Table</text>
<text top="346" left="185" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">2</a></text>
<text top="346" left="196" width="473" height="13" font="4">shows the results of the SAR probit estimation for the same experiment as in</text>
<text top="346" left="673" width="71" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage and</a></text>
<text top="363" left="149" width="28" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Pace</a></text>
<text top="363" left="180" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="363" left="185" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="363" left="212" width="471" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">). </a>The results shown there can be replicated either using the code above (for n</text>
<text top="362" left="688" width="11" height="12" font="0">=</text>
<text top="363" left="703" width="42" height="13" font="4">400) or</text>
<text top="379" left="149" width="531" height="13" font="4">using the LeSagePaceExperiment() function in the package and setting set.seed(2) (for n</text>
<text top="379" left="684" width="11" height="12" font="0">=</text>
<text top="379" left="699" width="45" height="13" font="4">400 and</text>
<text top="395" left="149" width="7" height="13" font="4">n</text>
<text top="395" left="161" width="11" height="12" font="0">=</text>
<text top="395" left="175" width="39" height="13" font="4">1000)):</text>
<text top="422" left="149" width="89" height="11" font="4">&gt; set.seed(2)</text>
<text top="439" left="149" width="487" height="11" font="4">&gt; res1 &lt;- LeSagePaceExperiment(n = 400, beta = c(0, 1, -1), rho = 0.75,</text>
<text top="455" left="149" width="7" height="11" font="4">+</text>
<text top="455" left="190" width="343" height="11" font="4">ndraw = 1000, burn.in = 200, thinning = 1, m = 10)</text>
<text top="472" left="149" width="103" height="11" font="4">&gt; summary(res1)</text>
<text top="488" left="149" width="89" height="11" font="4">&gt; set.seed(2)</text>
<text top="504" left="149" width="494" height="11" font="4">&gt; res2 &lt;- LeSagePaceExperiment(n = 1000, beta = c(0, 1, -1), rho = 0.75,</text>
<text top="521" left="149" width="7" height="11" font="4">+</text>
<text top="521" left="190" width="336" height="11" font="4">ndraw = 1000, burn.in = 200, thinning = 1, m = 1)</text>
<text top="537" left="149" width="103" height="11" font="4">&gt; summary(res2)</text>
<text top="563" left="148" width="308" height="13" font="4">The corresponding ML and GMM estimates in Table</text>
<text top="563" left="460" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">2</a></text>
<text top="563" left="470" width="274" height="13" font="4">can be replicated by creating the data as above</text>
<text top="579" left="148" width="150" height="13" font="4">(replacing n &lt;-1000 for n</text>
<text top="579" left="302" width="11" height="12" font="0">=</text>
<text top="579" left="317" width="131" height="13" font="4">1000 accordingly) and</text>
<text top="606" left="149" width="137" height="11" font="4">&gt; library(McSpatial)</text>
<text top="623" left="149" width="151" height="11" font="4">&gt; wmat &lt;- as.matrix(W)</text>
<text top="639" left="149" width="425" height="11" font="4">&gt; mle.fit1 &lt;- spprobitml(y ~ X[, &#34;x&#34;] + X[, &#34;y&#34;], wmat = wmat)</text>
<text top="655" left="149" width="412" height="11" font="4">&gt; gmm.fit1 &lt;- spprobit(y ~ X[, &#34;x&#34;] + X[, &#34;y&#34;], wmat = wmat)</text>
<text top="681" left="171" width="573" height="13" font="4">Our Bayesian estimation yields similar results, but our implementation is much faster (factor</text>
<text top="697" left="149" width="595" height="13" font="4">20-100) than the LeSage implementation, even on a single core. The <b>McSpatial </b>GMM estimation seems</text>
<text top="714" left="149" width="596" height="13" font="4">to be biased in this example. The evaluation of the performance relative to <b>McSpatial </b>ML clearly</text>
<text top="730" left="149" width="595" height="13" font="4">needs to take into account a number of factors: First, the choice of the number of MCMC iterations N</text>
<text top="747" left="149" width="595" height="13" font="4">and burn.in samples, as well as m do control the estimation time to a large degree. Second, the current</text>
<text top="763" left="149" width="595" height="13" font="4">ML implementation in <b>McSpatial </b>does not compute marginal effects. Finally, <b>McSpatial </b>works with</text>
<text top="780" left="149" width="522" height="13" font="4">dense matrices which is superior for smaller sample sizes, but will not scale for larger n.</text>
<text top="801" left="171" width="32" height="13" font="4">Table</text>
<text top="801" left="206" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">3</a></text>
<text top="801" left="216" width="528" height="13" font="4">shows that a change of the Gibbs sampler burn-in size m for drawing <b>z </b>has little effect on</text>
<text top="817" left="149" width="272" height="13" font="4">the mean and the variance of the estimates. m</text>
<text top="817" left="425" width="11" height="12" font="0">=</text>
<text top="817" left="440" width="247" height="13" font="4">1 means taking the previous value of <b>z</b>, m</text>
<text top="817" left="691" width="11" height="12" font="0">=</text>
<text top="817" left="706" width="38" height="13" font="4">2, 5, 10</text>
<text top="833" left="149" width="126" height="13" font="4">start the chain from <b>z</b></text>
<text top="833" left="279" width="11" height="12" font="0">=</text>
<text top="833" left="294" width="130" height="13" font="4">0. Clearly, choosing m</text>
<text top="833" left="428" width="11" height="12" font="0">=</text>
<text top="833" left="443" width="240" height="13" font="4">2 might not be enough as burn-in phase.</text>
<text top="875" left="149" width="163" height="15" font="12"><b>Random graph example</b></text>
<text top="907" left="148" width="596" height="13" font="4">As a second example we present the estimation of the probit model based on a random undirected</text>
<text top="923" left="149" width="77" height="13" font="4">graph with n</text>
<text top="923" left="230" width="11" height="12" font="0">=</text>
<text top="923" left="245" width="499" height="13" font="4">200 nodes and an average branching factor of 3. Of course this estimation procedure</text>
<text top="940" left="149" width="510" height="13" font="4">can be applied to real network structures such as from social networks. The package</text>
<text top="940" left="662" width="40" height="13" font="6"><a href="http://CRAN.R-project.org/package=igraph"><b>igraph</b></a></text>
<text top="940" left="706" width="38" height="13" font="4">can be</text>
<text top="956" left="149" width="595" height="13" font="4">used to create random graphs and to compute the adjacency matrix <b>A </b>as well as the spatial weight</text>
<text top="973" left="149" width="64" height="13" font="4">matrix <b>W </b><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="973" left="213" width="115" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Csardi and Nepusz</a></text>
<text top="973" left="328" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="973" left="334" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2006</a></text>
<text top="973" left="361" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">).</a></text>
<text top="1000" left="149" width="117" height="11" font="4">&gt; library(igraph)</text>
<text top="1016" left="149" width="165" height="11" font="4">&gt; library(spatialprobit)</text>
<text top="1032" left="149" width="89" height="11" font="4">&gt; set.seed(1)</text>
<text top="1049" left="149" width="69" height="11" font="4">&gt; n &lt;- 200</text>
<text top="1065" left="149" width="89" height="11" font="4">&gt; branch &lt;- 3</text>
<text top="1082" left="149" width="171" height="11" font="4">&gt; probability &lt;- branch/n</text>
<text top="1098" left="149" width="453" height="11" font="4">&gt; grandom &lt;- igraph::erdos.renyi.game(n = n, p.or.m = probability,</text>
<text top="1115" left="149" width="7" height="11" font="4">+</text>
<text top="1115" left="190" width="261" height="11" font="4">type = &#34;gnp&#34;, directed = F, loops = F)</text>
<text top="1131" left="149" width="165" height="11" font="4">&gt; V(grandom)$name &lt;- 1:n</text>
<text top="1147" left="149" width="460" height="11" font="4">&gt; A &lt;- igraph::get.adjacency(grandom, type = &#34;both&#34;, sparse = TRUE)</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="7" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">136</text>
<text top="104" left="149" width="322" height="11" font="4">&gt; W &lt;- A/ifelse(rowSums(A) == 0, 1, rowSums(A))</text>
<text top="120" left="149" width="569" height="11" font="4">&gt; plot(grandom, layout = layout.fruchterman.reingold, vertex.label.family = &#34;sans&#34;,</text>
<text top="137" left="149" width="7" height="11" font="4">+</text>
<text top="137" left="190" width="240" height="11" font="4">vertex.size = 2, vertex.label = &#34;&#34;)</text>
<text top="163" left="149" width="38" height="13" font="4">Figure</text>
<text top="163" left="191" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#7">1</a></text>
<text top="163" left="201" width="209" height="13" font="4">shows the resulting random graph.</text>
<text top="509" left="219" width="53" height="13" font="3"><b>Figure 1:</b></text>
<text top="509" left="277" width="131" height="13" font="4">Random graph with n</text>
<text top="509" left="412" width="11" height="12" font="0">=</text>
<text top="509" left="427" width="247" height="13" font="4">200 nodes and average branching factor 3</text>
<text top="549" left="171" width="361" height="13" font="4">Next we are going to estimate the spatial probit model with N</text>
<text top="549" left="536" width="11" height="12" font="0">=</text>
<text top="549" left="551" width="193" height="13" font="4">3000 draws and compare it to the</text>
<text top="565" left="149" width="469" height="13" font="4">standard probit model which neglects the spatial dependencies in the network.</text>
<text top="593" left="149" width="123" height="11" font="4">&gt; set.seed(1.2345)</text>
<text top="609" left="149" width="103" height="11" font="4">&gt; x &lt;- rnorm(n)</text>
<text top="626" left="149" width="261" height="11" font="4">&gt; X &lt;- cbind(const = rep(1, n), x = x)</text>
<text top="642" left="149" width="69" height="11" font="4">&gt; p &lt;- 0.3</text>
<text top="658" left="149" width="123" height="11" font="4">&gt; beta &lt;- c(-1, 2)</text>
<text top="675" left="149" width="316" height="11" font="4">&gt; I_n &lt;- sparseMatrix(i = 1:n, j = 1:n, x = 1)</text>
<text top="691" left="149" width="357" height="11" font="4">&gt; z &lt;- solve(qr(I_n - p * W), X %*% beta + rnorm(n))</text>
<text top="708" left="149" width="171" height="11" font="4">&gt; y &lt;- as.numeric(z &gt;= 0)</text>
<text top="724" left="149" width="487" height="11" font="4">&gt; sarprobit.fit &lt;- sarprobit(y ~ X - 1, W, ndraw = 3000, burn.in = 200,</text>
<text top="741" left="149" width="7" height="11" font="4">+</text>
<text top="741" left="348" width="89" height="11" font="4">thinning = 1)</text>
<text top="767" left="148" width="230" height="13" font="4">The true parameter in this model are <i><b>β</b></i></text>
<text top="767" left="382" width="20" height="12" font="0">= (</text>
<text top="766" left="403" width="11" height="16" font="0">−</text>
<text top="767" left="414" width="19" height="13" font="4">1, 2</text>
<text top="767" left="433" width="5" height="12" font="0">)</text>
<text top="763" left="439" width="3" height="13" font="10">0</text>
<text top="767" left="446" width="33" height="13" font="4">and <i>ρ</i></text>
<text top="767" left="483" width="11" height="12" font="0">=</text>
<text top="767" left="498" width="20" height="13" font="4">0.3.</text>
<text top="794" left="149" width="165" height="11" font="4">&gt; summary(sarprobit.fit)</text>
<text top="824" left="149" width="343" height="11" font="4">--------MCMC spatial autoregressive probit--------</text>
<text top="841" left="149" width="96" height="11" font="4">Execution time</text>
<text top="841" left="259" width="89" height="11" font="4">= 25.350 secs</text>
<text top="874" left="149" width="48" height="11" font="4">N draws</text>
<text top="874" left="259" width="7" height="11" font="4">=</text>
<text top="874" left="286" width="158" height="11" font="4">3000, N omit (burn-in)=</text>
<text top="874" left="471" width="21" height="11" font="4">200</text>
<text top="890" left="149" width="96" height="11" font="4">N observations</text>
<text top="890" left="259" width="7" height="11" font="4">=</text>
<text top="890" left="293" width="117" height="11" font="4">200, K covariates</text>
<text top="890" left="437" width="7" height="11" font="4">=</text>
<text top="890" left="485" width="7" height="11" font="4">2</text>
<text top="906" left="149" width="117" height="11" font="4"># of 0 Y values =</text>
<text top="906" left="293" width="151" height="11" font="4">151, # of 1 Y values =</text>
<text top="906" left="478" width="14" height="11" font="4">49</text>
<text top="923" left="149" width="48" height="11" font="4">Min rho</text>
<text top="923" left="259" width="117" height="11" font="4">= -1.000, Max rho</text>
<text top="923" left="437" width="7" height="11" font="4">=</text>
<text top="923" left="457" width="34" height="11" font="4">1.000</text>
<text top="939" left="149" width="343" height="11" font="4">--------------------------------------------------</text>
<text top="972" left="197" width="117" height="11" font="4">Estimate Std. Dev</text>
<text top="972" left="327" width="165" height="11" font="4">p-level t-value Pr(&gt;|z|)</text>
<text top="989" left="149" width="103" height="11" font="4">Xconst -1.25361</text>
<text top="989" left="265" width="48" height="11" font="4">0.20035</text>
<text top="989" left="327" width="48" height="11" font="4">0.00000</text>
<text top="989" left="396" width="34" height="11" font="4">-6.26</text>
<text top="989" left="444" width="75" height="11" font="4">2.3e-09 ***</text>
<text top="1005" left="149" width="14" height="11" font="4">Xx</text>
<text top="1005" left="204" width="48" height="11" font="4">2.05238</text>
<text top="1005" left="265" width="48" height="11" font="4">0.28529</text>
<text top="1005" left="327" width="48" height="11" font="4">0.00000</text>
<text top="1005" left="403" width="27" height="11" font="4">7.19</text>
<text top="1005" left="444" width="75" height="11" font="4">1.2e-11 ***</text>
<text top="1022" left="149" width="21" height="11" font="4">rho</text>
<text top="1022" left="204" width="48" height="11" font="4">0.24796</text>
<text top="1022" left="265" width="48" height="11" font="4">0.10571</text>
<text top="1022" left="327" width="48" height="11" font="4">0.00967</text>
<text top="1022" left="403" width="27" height="11" font="4">2.35</text>
<text top="1022" left="464" width="41" height="11" font="4">0.02 *</text>
<text top="1038" left="149" width="21" height="11" font="4">---</text>
<text top="1054" left="149" width="96" height="11" font="4">Signif. codes:</text>
<text top="1054" left="259" width="316" height="11" font="4">0 ’***’ 0.001 ’**’ 0.01 ’*’ 0.05 ’.’ 0.1 ’ ’ 1</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="8" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">137</text>
<text top="103" left="148" width="383" height="13" font="4">The direct, indirect and total marginal effects are extracted using</text>
<text top="131" left="149" width="165" height="11" font="4">&gt; impacts(sarprobit.fit)</text>
<text top="161" left="149" width="219" height="11" font="4">--------Marginal Effects--------</text>
<text top="193" left="149" width="123" height="11" font="4">(a) Direct effects</text>
<text top="210" left="169" width="233" height="11" font="4">lower_005 posterior_mean upper_095</text>
<text top="226" left="149" width="14" height="11" font="4">Xx</text>
<text top="226" left="197" width="34" height="11" font="4">0.231</text>
<text top="226" left="300" width="34" height="11" font="4">0.268</text>
<text top="226" left="382" width="21" height="11" font="4">0.3</text>
<text top="259" left="149" width="137" height="11" font="4">(b) Indirect effects</text>
<text top="276" left="169" width="233" height="11" font="4">lower_005 posterior_mean upper_095</text>
<text top="292" left="149" width="14" height="11" font="4">Xx</text>
<text top="292" left="190" width="41" height="11" font="4">-0.299</text>
<text top="292" left="293" width="41" height="11" font="4">-0.266</text>
<text top="292" left="368" width="34" height="11" font="4">-0.23</text>
<text top="325" left="149" width="117" height="11" font="4">(c) Total effects</text>
<text top="341" left="169" width="233" height="11" font="4">lower_005 posterior_mean upper_095</text>
<text top="358" left="149" width="14" height="11" font="4">Xx</text>
<text top="358" left="183" width="48" height="11" font="4">0.00149</text>
<text top="358" left="286" width="48" height="11" font="4">0.00179</text>
<text top="358" left="396" width="7" height="11" font="4">0</text>
<text top="387" left="148" width="491" height="13" font="4">The corresponding non-spatial probit model is estimated using the glm() function:</text>
<text top="415" left="149" width="336" height="11" font="4">&gt; glm1 &lt;- glm(y ~ x, family = binomial(&#34;probit&#34;))</text>
<text top="431" left="149" width="185" height="11" font="4">&gt; summary(glm1, digits = 4)</text>
<text top="461" left="149" width="34" height="11" font="4">Call:</text>
<text top="477" left="149" width="336" height="11" font="4">glm(formula = y ~ x, family = binomial(&#34;probit&#34;))</text>
<text top="510" left="149" width="130" height="11" font="4">Deviance Residuals:</text>
<text top="527" left="176" width="21" height="11" font="4">Min</text>
<text top="527" left="245" width="14" height="11" font="4">1Q</text>
<text top="527" left="279" width="41" height="11" font="4">Median</text>
<text top="527" left="368" width="14" height="11" font="4">3Q</text>
<text top="527" left="423" width="21" height="11" font="4">Max</text>
<text top="543" left="149" width="48" height="11" font="4">-2.2337</text>
<text top="543" left="211" width="48" height="11" font="4">-0.3488</text>
<text top="543" left="272" width="48" height="11" font="4">-0.0870</text>
<text top="543" left="334" width="48" height="11" font="4">-0.0002</text>
<text top="543" left="403" width="41" height="11" font="4">2.4107</text>
<text top="576" left="149" width="89" height="11" font="4">Coefficients:</text>
<text top="592" left="231" width="247" height="11" font="4">Estimate Std. Error z value Pr(&gt;|z|)</text>
<text top="609" left="149" width="75" height="11" font="4">(Intercept)</text>
<text top="609" left="245" width="41" height="11" font="4">-1.491</text>
<text top="609" left="327" width="34" height="11" font="4">0.208</text>
<text top="609" left="382" width="34" height="11" font="4">-7.18</text>
<text top="609" left="430" width="75" height="11" font="4">7.2e-13 ***</text>
<text top="625" left="149" width="7" height="11" font="4">x</text>
<text top="625" left="252" width="34" height="11" font="4">1.966</text>
<text top="625" left="327" width="34" height="11" font="4">0.281</text>
<text top="625" left="389" width="27" height="11" font="4">6.99</text>
<text top="625" left="430" width="75" height="11" font="4">2.7e-12 ***</text>
<text top="642" left="149" width="21" height="11" font="4">---</text>
<text top="658" left="149" width="96" height="11" font="4">Signif. codes:</text>
<text top="658" left="259" width="316" height="11" font="4">0 ’***’ 0.001 ’**’ 0.01 ’*’ 0.05 ’.’ 0.1 ’ ’ 1</text>
<text top="691" left="149" width="384" height="11" font="4">(Dispersion parameter for binomial family taken to be 1)</text>
<text top="724" left="176" width="144" height="11" font="4">Null deviance: 222.71</text>
<text top="724" left="334" width="41" height="11" font="4">on 199</text>
<text top="724" left="389" width="123" height="11" font="4">degrees of freedom</text>
<text top="740" left="149" width="171" height="11" font="4">Residual deviance: 103.48</text>
<text top="740" left="334" width="41" height="11" font="4">on 198</text>
<text top="740" left="389" width="123" height="11" font="4">degrees of freedom</text>
<text top="757" left="149" width="69" height="11" font="4">AIC: 107.5</text>
<text top="790" left="149" width="261" height="11" font="4">Number of Fisher Scoring iterations: 7</text>
<text top="819" left="171" width="45" height="13" font="4">Figures</text>
<text top="819" left="221" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#9">2</a></text>
<text top="819" left="232" width="23" height="13" font="4">and</text>
<text top="819" left="260" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#9">3</a></text>
<text top="819" left="271" width="473" height="13" font="4">show the trace plots and posterior densities as part of the MCMC estimation</text>
<text top="835" left="149" width="78" height="13" font="4">results. Table</text>
<text top="835" left="231" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">4</a></text>
<text top="835" left="241" width="333" height="13" font="4">compares the SAR probit and standard probit estimates.</text>
<text top="878" left="149" width="279" height="15" font="12"><b>Diffusion of innovation and information</b></text>
<text top="909" left="148" width="393" height="13" font="4">A last example looks at the information flow in social networks.</text>
<text top="909" left="547" width="88" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Coleman et al.</a></text>
<text top="909" left="639" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="909" left="644" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">1957</a></text>
<text top="909" left="671" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="909" left="679" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">1966</a></text>
<text top="909" left="706" width="38" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>have</text>
<text top="926" left="149" width="596" height="13" font="4">studied how innovations (i.e. new drugs) diffuse among physicians, until the new drug is widely</text>
<text top="942" left="149" width="595" height="13" font="4">adopted by all physicians. They interviewed 246 physicians in 4 different US cities and looked at the</text>
<text top="959" left="149" width="595" height="13" font="4">role of 3 interpersonal networks (friends, colleagues and discussion circles) in the diffusion process</text>
<text top="975" left="148" width="255" height="13" font="4">(November, 1953–February, 1955). Figure</text>
<text top="975" left="408" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#9">4</a></text>
<text top="975" left="420" width="324" height="13" font="4">illustrates one of the 3 social structures based on the</text>
<text top="991" left="148" width="596" height="13" font="4">question &#34;To whom do you most often turn for advice and information?&#34;. The data set is available at</text>
<text top="1008" left="149" width="261" height="11" font="7"><a href="http://moreno.ss.uci.edu/data.html#ckm">http://moreno.ss.uci.edu/data.html#ckm</a></text>
<text top="1008" left="409" width="306" height="13" font="4"><a href="http://moreno.ss.uci.edu/data.html#ckm">, </a>but also part of <b>spatialprobit </b>(data(CKM)). See also</text>
<text top="1008" left="718" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">Burt</a></text>
<text top="1024" left="148" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="1024" left="153" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">1987</a></text>
<text top="1024" left="180" width="31" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>and</text>
<text top="1024" left="214" width="121" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">den Bulte and Lilien</a></text>
<text top="1024" left="338" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="1024" left="342" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2001</a></text>
<text top="1024" left="369" width="375" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">) </a>for further discussion of this data set. The dependent variable</text>
<text top="1041" left="149" width="595" height="13" font="4">in the model is the month in which a doctor first prescribed the new drug. Explanatory variables are</text>
<text top="1057" left="149" width="265" height="13" font="4">the social structure and individual variables.</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="9" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">138</text>
<text top="420" left="149" width="53" height="13" font="3"><b>Figure 2:</b></text>
<text top="420" left="206" width="538" height="13" font="4">MCMC trace plots for model parameters with horizontal lines marking the true parameters</text>
<text top="777" left="161" width="53" height="13" font="3"><b>Figure 3:</b></text>
<text top="777" left="219" width="513" height="13" font="4">Posterior densities for model parameters with vertical markers for the true parameters</text>
<text top="1134" left="169" width="53" height="13" font="3"><b>Figure 4:</b></text>
<text top="1134" left="226" width="498" height="13" font="4">Social network of physicians in 4 different cities based on &#34;advisorship&#34; relationship</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="10" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">139</text>
<text top="128" left="263" width="91" height="15" font="0">LeSage (2009)</text>
<text top="128" left="396" width="60" height="15" font="0">sarprobit</text>
<text top="128" left="503" width="93" height="15" font="0">McSpatial ML</text>
<text top="128" left="611" width="110" height="15" font="0">McSpatial GMM</text>
<text top="146" left="172" width="64" height="15" font="0">Estimates</text>
<text top="146" left="268" width="97" height="15" font="0">Mean Std dev</text>
<text top="146" left="382" width="97" height="15" font="0">Mean Std dev</text>
<text top="146" left="505" width="97" height="15" font="0">Mean Std dev</text>
<text top="146" left="620" width="101" height="15" font="0">Mean Std dev</text>
<text top="171" left="312" width="8" height="15" font="0">n</text>
<text top="171" left="325" width="12" height="14" font="13">=</text>
<text top="171" left="341" width="42" height="15" font="0">400, m</text>
<text top="171" left="387" width="12" height="14" font="13">=</text>
<text top="171" left="404" width="15" height="15" font="0">10</text>
<text top="171" left="583" width="8" height="15" font="0">n</text>
<text top="171" left="596" width="12" height="14" font="13">=</text>
<text top="171" left="612" width="22" height="15" font="0">400</text>
<text top="218" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="220" left="181" width="6" height="11" font="1">1</text>
<text top="214" left="192" width="12" height="14" font="13">=</text>
<text top="214" left="209" width="7" height="15" font="0">0</text>
<text top="214" left="259" width="46" height="15" font="0">-0.1844</text>
<text top="214" left="323" width="96" height="15" font="0">0.0686 0.0385</text>
<text top="214" left="438" width="41" height="15" font="0">0.0562</text>
<text top="214" left="502" width="41" height="15" font="0">0.0286</text>
<text top="214" left="561" width="96" height="15" font="0">0.0302 -0.1042</text>
<text top="214" left="680" width="41" height="15" font="0">0.0729</text>
<text top="236" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="237" left="181" width="6" height="11" font="1">2</text>
<text top="232" left="192" width="12" height="14" font="13">=</text>
<text top="232" left="209" width="7" height="15" font="0">1</text>
<text top="232" left="264" width="41" height="15" font="0">0.9654</text>
<text top="232" left="323" width="96" height="15" font="0">0.1179 0.9824</text>
<text top="232" left="438" width="41" height="15" font="0">0.1139</text>
<text top="232" left="502" width="41" height="15" font="0">1.0813</text>
<text top="232" left="561" width="96" height="15" font="0">0.1115 0.7690</text>
<text top="232" left="680" width="41" height="15" font="0">0.0815</text>
<text top="254" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="255" left="181" width="6" height="11" font="1">3</text>
<text top="250" left="192" width="12" height="14" font="13">=</text>
<text top="249" left="209" width="12" height="18" font="13">−</text>
<text top="250" left="221" width="7" height="15" font="0">1</text>
<text top="250" left="259" width="46" height="15" font="0">-0.8816</text>
<text top="250" left="323" width="96" height="15" font="0">0.1142 -1.0014</text>
<text top="250" left="438" width="41" height="15" font="0">0.1163</text>
<text top="250" left="497" width="46" height="15" font="0">-0.9788</text>
<text top="250" left="561" width="96" height="15" font="0">0.1040 -0.7544</text>
<text top="250" left="680" width="41" height="15" font="0">0.0829</text>
<text top="272" left="172" width="7" height="11" font="15"><i>ρ</i></text>
<text top="268" left="184" width="12" height="14" font="13">=</text>
<text top="268" left="201" width="26" height="15" font="0">0.75</text>
<text top="268" left="264" width="41" height="15" font="0">0.6653</text>
<text top="268" left="323" width="96" height="15" font="0">0.0564 0.7139</text>
<text top="268" left="438" width="41" height="15" font="0">0.0427</text>
<text top="268" left="502" width="41" height="15" font="0">0.7322</text>
<text top="268" left="561" width="96" height="15" font="0">0.0372 1.2208</text>
<text top="268" left="680" width="41" height="15" font="0">0.1424</text>
<text top="287" left="172" width="71" height="15" font="0">Time (sec.)</text>
<text top="287" left="265" width="34" height="15" font="0">1,276</text>
<text top="284" left="299" width="6" height="11" font="1">†</text>
<text top="287" left="309" width="35" height="15" font="0">/ 623</text>
<text top="284" left="345" width="6" height="11" font="1">‡</text>
<text top="287" left="413" width="26" height="15" font="0">11.5</text>
<text top="287" left="537" width="19" height="15" font="0">1.4</text>
<text top="284" left="556" width="6" height="11" font="1">§</text>
<text top="287" left="653" width="19" height="15" font="0">0.0</text>
<text top="284" left="672" width="6" height="11" font="1">§</text>
<text top="312" left="312" width="8" height="15" font="0">n</text>
<text top="312" left="325" width="12" height="14" font="13">=</text>
<text top="312" left="341" width="49" height="15" font="0">1000, m</text>
<text top="312" left="395" width="12" height="14" font="13">=</text>
<text top="312" left="411" width="7" height="15" font="0">1</text>
<text top="312" left="579" width="8" height="15" font="0">n</text>
<text top="312" left="592" width="12" height="14" font="13">=</text>
<text top="312" left="609" width="30" height="15" font="0">1000</text>
<text top="359" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="361" left="181" width="6" height="11" font="1">1</text>
<text top="355" left="192" width="12" height="14" font="13">=</text>
<text top="355" left="209" width="7" height="15" font="0">0</text>
<text top="355" left="257" width="49" height="15" font="0">0.05924</text>
<text top="355" left="323" width="96" height="15" font="0">0.0438 -0.0859</text>
<text top="355" left="438" width="41" height="15" font="0">0.0371</text>
<text top="355" left="502" width="41" height="15" font="0">0.0010</text>
<text top="355" left="561" width="96" height="15" font="0">0.0195 -0.1045</text>
<text top="355" left="680" width="41" height="15" font="0">0.0421</text>
<text top="377" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="378" left="181" width="6" height="11" font="1">2</text>
<text top="373" left="192" width="12" height="14" font="13">=</text>
<text top="373" left="209" width="7" height="15" font="0">1</text>
<text top="373" left="257" width="49" height="15" font="0">0.96105</text>
<text top="373" left="323" width="96" height="15" font="0">0.0729 0.9709</text>
<text top="373" left="438" width="41" height="15" font="0">0.0709</text>
<text top="373" left="502" width="41" height="15" font="0">1.0608</text>
<text top="373" left="561" width="96" height="15" font="0">0.0713 0.7483</text>
<text top="373" left="680" width="41" height="15" font="0">0.0494</text>
<text top="395" left="173" width="8" height="11" font="15"><i>β</i></text>
<text top="396" left="181" width="6" height="11" font="1">3</text>
<text top="391" left="192" width="12" height="14" font="13">=</text>
<text top="390" left="209" width="12" height="18" font="13">−</text>
<text top="391" left="221" width="7" height="15" font="0">1</text>
<text top="391" left="252" width="54" height="15" font="0">-1.04398</text>
<text top="391" left="323" width="96" height="15" font="0">0.0749 -0.9858</text>
<text top="391" left="438" width="41" height="15" font="0">0.0755</text>
<text top="391" left="497" width="46" height="15" font="0">-1.1014</text>
<text top="391" left="561" width="96" height="15" font="0">0.0728 -0.7850</text>
<text top="391" left="680" width="41" height="15" font="0">0.0528</text>
<text top="413" left="172" width="7" height="11" font="15"><i>ρ</i></text>
<text top="409" left="184" width="12" height="14" font="13">=</text>
<text top="409" left="201" width="26" height="15" font="0">0.75</text>
<text top="409" left="257" width="49" height="15" font="0">0.69476</text>
<text top="409" left="323" width="96" height="15" font="0">0.0382 0.7590</text>
<text top="409" left="438" width="41" height="15" font="0">0.0222</text>
<text top="409" left="502" width="41" height="15" font="0">0.7227</text>
<text top="409" left="561" width="96" height="15" font="0">0.0229 1.4254</text>
<text top="409" left="680" width="41" height="15" font="0">0.0848</text>
<text top="428" left="172" width="71" height="15" font="0">Time (sec.)</text>
<text top="428" left="271" width="22" height="15" font="0">586</text>
<text top="425" left="293" width="6" height="11" font="1">†</text>
<text top="428" left="304" width="35" height="15" font="0">/ 813</text>
<text top="425" left="339" width="6" height="11" font="1">‡</text>
<text top="428" left="413" width="26" height="15" font="0">15.5</text>
<text top="428" left="533" width="26" height="15" font="0">18.7</text>
<text top="425" left="559" width="6" height="11" font="1">§</text>
<text top="428" left="653" width="19" height="15" font="0">0.0</text>
<text top="425" left="672" width="6" height="11" font="1">§</text>
<text top="480" left="148" width="48" height="13" font="3"><b>Table 2:</b></text>
<text top="479" left="202" width="221" height="13" font="4">Bayesian SAR probit estimates for n</text>
<text top="479" left="428" width="11" height="12" font="0">=</text>
<text top="479" left="444" width="60" height="13" font="4">400 and n</text>
<text top="479" left="509" width="11" height="12" font="0">=</text>
<text top="479" left="526" width="75" height="13" font="4">1000 with N</text>
<text top="479" left="606" width="11" height="12" font="0">=</text>
<text top="479" left="623" width="122" height="13" font="4">1000 draws and 200</text>
<text top="496" left="149" width="595" height="13" font="4">burn-in samples. m is the burn-in size in the Gibbs sampler drawing <b>z</b>. Timings in R include the</text>
<text top="512" left="149" width="595" height="13" font="4">computation of marginal effects and were measured using R 2.15.2 on an Intel® Core™i7-2600 CPU</text>
<text top="529" left="148" width="305" height="13" font="4">@3.40 GHz. Times marked with (†) are taken from</text>
<text top="529" left="456" width="101" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage and Pace</a></text>
<text top="529" left="561" width="5" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="529" left="566" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2009</a></text>
<text top="529" left="593" width="151" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">, </a>Table 10.1). To allow for</text>
<text top="545" left="149" width="595" height="13" font="4">a better comparison, these models were estimated anew (‡) using MATLAB R2007b and the spatial</text>
<text top="562" left="149" width="132" height="13" font="4">econometrics toolbox <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="562" left="280" width="42" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">LeSage</a></text>
<text top="562" left="322" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="562" left="329" width="26" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2010</a></text>
<text top="562" left="355" width="390" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">) </a>on the very same machine used for getting the R timings. The ML</text>
<text top="578" left="149" width="437" height="13" font="4">and GMM timings (§) do not involve the computation of marginal effects.</text>
<text top="657" left="310" width="30" height="15" font="0">m=1</text>
<text top="657" left="429" width="30" height="15" font="0">m=2</text>
<text top="657" left="548" width="30" height="15" font="0">m=5</text>
<text top="657" left="663" width="37" height="15" font="0">m=10</text>
<text top="683" left="159" width="64" height="15" font="0">Estimates</text>
<text top="683" left="282" width="95" height="15" font="0">Mean Std dev</text>
<text top="683" left="401" width="95" height="15" font="0">Mean Std dev</text>
<text top="683" left="519" width="95" height="15" font="0">Mean Std dev</text>
<text top="683" left="638" width="95" height="15" font="0">Mean Std dev</text>
<text top="712" left="160" width="8" height="11" font="15"><i>β</i></text>
<text top="713" left="169" width="6" height="11" font="1">1</text>
<text top="708" left="179" width="12" height="14" font="13">=</text>
<text top="708" left="196" width="7" height="15" font="0">0</text>
<text top="708" left="278" width="41" height="15" font="0">0.0385</text>
<text top="708" left="336" width="41" height="15" font="0">0.0571</text>
<text top="708" left="397" width="41" height="15" font="0">0.0447</text>
<text top="708" left="455" width="41" height="15" font="0">0.0585</text>
<text top="708" left="516" width="41" height="15" font="0">0.0422</text>
<text top="708" left="574" width="41" height="15" font="0">0.0571</text>
<text top="708" left="635" width="41" height="15" font="0">0.0385</text>
<text top="708" left="692" width="41" height="15" font="0">0.0562</text>
<text top="729" left="160" width="8" height="11" font="15"><i>β</i></text>
<text top="731" left="169" width="6" height="11" font="1">2</text>
<text top="726" left="179" width="12" height="14" font="13">=</text>
<text top="726" left="196" width="7" height="15" font="0">1</text>
<text top="726" left="278" width="41" height="15" font="0">1.0051</text>
<text top="726" left="336" width="41" height="15" font="0">0.1146</text>
<text top="726" left="397" width="41" height="15" font="0">0.8294</text>
<text top="726" left="455" width="41" height="15" font="0">0.0960</text>
<text top="726" left="516" width="41" height="15" font="0">0.9261</text>
<text top="726" left="574" width="41" height="15" font="0">0.1146</text>
<text top="726" left="635" width="41" height="15" font="0">0.9824</text>
<text top="726" left="692" width="41" height="15" font="0">0.1139</text>
<text top="747" left="160" width="8" height="11" font="15"><i>β</i></text>
<text top="749" left="169" width="6" height="11" font="1">3</text>
<text top="744" left="179" width="12" height="14" font="13">=</text>
<text top="743" left="196" width="12" height="18" font="13">−</text>
<text top="744" left="208" width="7" height="15" font="0">1</text>
<text top="744" left="273" width="46" height="15" font="0">-1.0264</text>
<text top="744" left="336" width="41" height="15" font="0">0.1138</text>
<text top="744" left="392" width="46" height="15" font="0">-0.8417</text>
<text top="744" left="455" width="41" height="15" font="0">0.0989</text>
<text top="744" left="511" width="46" height="15" font="0">-0.9446</text>
<text top="744" left="574" width="41" height="15" font="0">0.1138</text>
<text top="744" left="630" width="46" height="15" font="0">-1.0014</text>
<text top="744" left="692" width="41" height="15" font="0">0.1163</text>
<text top="765" left="160" width="7" height="11" font="15"><i>ρ</i></text>
<text top="762" left="172" width="12" height="14" font="13">=</text>
<text top="762" left="188" width="26" height="15" font="0">0.75</text>
<text top="762" left="278" width="41" height="15" font="0">0.7226</text>
<text top="762" left="336" width="41" height="15" font="0">0.0411</text>
<text top="762" left="397" width="41" height="15" font="0">0.6427</text>
<text top="762" left="455" width="41" height="15" font="0">0.0473</text>
<text top="762" left="516" width="41" height="15" font="0">0.6922</text>
<text top="762" left="574" width="41" height="15" font="0">0.0411</text>
<text top="762" left="635" width="41" height="15" font="0">0.7139</text>
<text top="762" left="692" width="41" height="15" font="0">0.0427</text>
<text top="780" left="159" width="71" height="15" font="0">Time (sec.)</text>
<text top="780" left="293" width="26" height="15" font="0">10.2</text>
<text top="780" left="412" width="26" height="15" font="0">10.2</text>
<text top="780" left="531" width="26" height="15" font="0">10.5</text>
<text top="780" left="650" width="26" height="15" font="0">11.0</text>
<text top="798" left="159" width="71" height="15" font="0">Time (sec.)</text>
<text top="816" left="159" width="106" height="15" font="0">in LeSage (2009)</text>
<text top="798" left="297" width="22" height="15" font="0">195</text>
<text top="798" left="416" width="22" height="15" font="0">314</text>
<text top="798" left="552" width="5" height="15" font="0">-</text>
<text top="798" left="646" width="30" height="15" font="0">1270</text>
<text top="867" left="148" width="47" height="13" font="3"><b>Table 3:</b></text>
<text top="867" left="200" width="440" height="13" font="4">Effects of the Gibbs sampler burn-in size m on SAR probit estimates for n</text>
<text top="867" left="644" width="11" height="12" font="0">=</text>
<text top="867" left="659" width="38" height="13" font="4">400, N</text>
<text top="867" left="702" width="11" height="12" font="0">=</text>
<text top="867" left="717" width="27" height="13" font="4">1000</text>
<text top="884" left="149" width="142" height="13" font="4">draws and burn.in=200</text>
<text top="963" left="347" width="73" height="15" font="0">SAR probit</text>
<text top="963" left="577" width="40" height="15" font="0">Probit</text>
<text top="988" left="207" width="64" height="15" font="0">Estimates</text>
<text top="988" left="304" width="37" height="15" font="0">Mean</text>
<text top="988" left="359" width="50" height="15" font="0">Std dev</text>
<text top="988" left="427" width="45" height="15" font="0">p-level</text>
<text top="988" left="517" width="37" height="15" font="0">Mean</text>
<text top="988" left="573" width="50" height="15" font="0">Std dev</text>
<text top="988" left="641" width="45" height="15" font="0">p-level</text>
<text top="1017" left="207" width="8" height="11" font="15"><i>β</i></text>
<text top="1019" left="216" width="6" height="11" font="1">1</text>
<text top="1014" left="227" width="12" height="14" font="13">=</text>
<text top="1012" left="243" width="12" height="18" font="13">−</text>
<text top="1014" left="255" width="7" height="15" font="0">1</text>
<text top="1014" left="295" width="46" height="15" font="0">-1.2536</text>
<text top="1014" left="368" width="41" height="15" font="0">0.2004</text>
<text top="1014" left="432" width="41" height="15" font="0">0.0000</text>
<text top="1014" left="509" width="46" height="15" font="0">-1.4905</text>
<text top="1014" left="582" width="41" height="15" font="0">0.2077</text>
<text top="1014" left="645" width="41" height="15" font="0">0.0000</text>
<text top="1035" left="207" width="8" height="11" font="15"><i>β</i></text>
<text top="1037" left="216" width="6" height="11" font="1">2</text>
<text top="1032" left="227" width="12" height="14" font="13">=</text>
<text top="1032" left="243" width="7" height="15" font="0">2</text>
<text top="1032" left="300" width="41" height="15" font="0">2.0524</text>
<text top="1032" left="368" width="41" height="15" font="0">0.2853</text>
<text top="1032" left="432" width="41" height="15" font="0">0.0000</text>
<text top="1032" left="514" width="41" height="15" font="0">1.9656</text>
<text top="1032" left="582" width="41" height="15" font="0">0.2812</text>
<text top="1032" left="645" width="41" height="15" font="0">0.0000</text>
<text top="1053" left="207" width="7" height="11" font="15"><i>ρ</i></text>
<text top="1049" left="219" width="12" height="14" font="13">=</text>
<text top="1050" left="235" width="19" height="15" font="0">0.3</text>
<text top="1050" left="300" width="41" height="15" font="0">0.2480</text>
<text top="1050" left="368" width="41" height="15" font="0">0.1057</text>
<text top="1050" left="432" width="41" height="15" font="0">0.0097</text>
<text top="1068" left="207" width="71" height="15" font="0">Time (sec.)</text>
<text top="1068" left="315" width="26" height="15" font="0">25.4</text>
<text top="1119" left="206" width="47" height="13" font="3"><b>Table 4:</b></text>
<text top="1119" left="257" width="429" height="13" font="4">SAR probit estimates vs. probit estimates for the random graph example</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="11" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">140</text>
<text top="105" left="407" width="40" height="15" font="0">Probit</text>
<text top="105" left="527" width="73" height="15" font="0">SAR Probit</text>
<text top="123" left="269" width="64" height="15" font="0">Estimates</text>
<text top="123" left="384" width="37" height="15" font="0">Mean</text>
<text top="123" left="439" width="48" height="15" font="0">z value</text>
<text top="123" left="521" width="37" height="15" font="0">Mean</text>
<text top="123" left="576" width="48" height="15" font="0">z value</text>
<text top="148" left="269" width="69" height="15" font="0">(Intercept)</text>
<text top="147" left="368" width="12" height="18" font="13">−</text>
<text top="148" left="380" width="41" height="15" font="0">0.3659</text>
<text top="147" left="448" width="12" height="18" font="13">−</text>
<text top="148" left="460" width="26" height="15" font="0">0.40</text>
<text top="148" left="517" width="41" height="15" font="0">0.1309</text>
<text top="148" left="598" width="26" height="15" font="0">0.16</text>
<text top="166" left="269" width="61" height="15" font="0">influence</text>
<text top="166" left="380" width="41" height="15" font="0">0.9042</text>
<text top="166" left="460" width="26" height="15" font="0">2.67</text>
<text top="184" left="269" width="24" height="15" font="0">city</text>
<text top="183" left="368" width="12" height="18" font="13">−</text>
<text top="184" left="380" width="41" height="15" font="0">0.0277</text>
<text top="183" left="448" width="12" height="18" font="13">−</text>
<text top="184" left="460" width="26" height="15" font="0">0.26</text>
<text top="183" left="505" width="12" height="18" font="13">−</text>
<text top="184" left="517" width="41" height="15" font="0">0.0371</text>
<text top="183" left="585" width="12" height="18" font="13">−</text>
<text top="184" left="598" width="26" height="15" font="0">0.39</text>
<text top="202" left="269" width="80" height="15" font="0">med_sch_yr</text>
<text top="202" left="380" width="41" height="15" font="0">0.2937</text>
<text top="202" left="460" width="26" height="15" font="0">2.63</text>
<text top="202" left="517" width="41" height="15" font="0">0.3226</text>
<text top="202" left="598" width="26" height="15" font="0">3.22</text>
<text top="220" left="269" width="60" height="15" font="0">meetings</text>
<text top="219" left="368" width="12" height="18" font="13">−</text>
<text top="220" left="380" width="41" height="15" font="0">0.1797</text>
<text top="219" left="448" width="12" height="18" font="13">−</text>
<text top="220" left="460" width="26" height="15" font="0">1.55</text>
<text top="219" left="505" width="12" height="18" font="13">−</text>
<text top="220" left="517" width="41" height="15" font="0">0.1813</text>
<text top="219" left="585" width="12" height="18" font="13">−</text>
<text top="220" left="598" width="26" height="15" font="0">1.64</text>
<text top="238" left="269" width="33" height="15" font="0">jours</text>
<text top="238" left="380" width="41" height="15" font="0">0.1592</text>
<text top="238" left="460" width="26" height="15" font="0">2.46</text>
<text top="238" left="517" width="41" height="15" font="0">0.1368</text>
<text top="238" left="598" width="26" height="15" font="0">2.08</text>
<text top="256" left="269" width="62" height="15" font="0">free_time</text>
<text top="256" left="380" width="41" height="15" font="0">0.3179</text>
<text top="256" left="460" width="26" height="15" font="0">2.31</text>
<text top="256" left="517" width="41" height="15" font="0">0.3253</text>
<text top="256" left="598" width="26" height="15" font="0">2.58</text>
<text top="274" left="269" width="48" height="15" font="0">discuss</text>
<text top="273" left="368" width="12" height="18" font="13">−</text>
<text top="274" left="380" width="41" height="15" font="0">0.0010</text>
<text top="273" left="448" width="12" height="18" font="13">−</text>
<text top="274" left="460" width="26" height="15" font="0">0.01</text>
<text top="273" left="505" width="12" height="18" font="13">−</text>
<text top="274" left="517" width="41" height="15" font="0">0.0643</text>
<text top="273" left="585" width="12" height="18" font="13">−</text>
<text top="274" left="598" width="26" height="15" font="0">0.57</text>
<text top="292" left="269" width="35" height="15" font="0">clubs</text>
<text top="291" left="368" width="12" height="18" font="13">−</text>
<text top="292" left="380" width="41" height="15" font="0">0.2366</text>
<text top="291" left="448" width="12" height="18" font="13">−</text>
<text top="292" left="460" width="26" height="15" font="0">2.36</text>
<text top="291" left="505" width="12" height="18" font="13">−</text>
<text top="292" left="517" width="41" height="15" font="0">0.2252</text>
<text top="291" left="585" width="12" height="18" font="13">−</text>
<text top="292" left="598" width="26" height="15" font="0">2.45</text>
<text top="310" left="269" width="47" height="15" font="0">friends</text>
<text top="308" left="368" width="12" height="18" font="13">−</text>
<text top="310" left="380" width="41" height="15" font="0">0.0003</text>
<text top="308" left="448" width="12" height="18" font="13">−</text>
<text top="310" left="460" width="26" height="15" font="0">0.00</text>
<text top="308" left="505" width="12" height="18" font="13">−</text>
<text top="310" left="517" width="41" height="15" font="0">0.0185</text>
<text top="308" left="585" width="12" height="18" font="13">−</text>
<text top="310" left="598" width="26" height="15" font="0">0.31</text>
<text top="328" left="269" width="76" height="15" font="0">community</text>
<text top="328" left="380" width="41" height="15" font="0">0.1974</text>
<text top="328" left="460" width="26" height="15" font="0">1.65</text>
<text top="328" left="517" width="41" height="15" font="0">0.2298</text>
<text top="328" left="598" width="26" height="15" font="0">2.08</text>
<text top="346" left="269" width="53" height="15" font="0">patients</text>
<text top="344" left="368" width="12" height="18" font="13">−</text>
<text top="346" left="380" width="41" height="15" font="0">0.0402</text>
<text top="344" left="448" width="12" height="18" font="13">−</text>
<text top="346" left="460" width="26" height="15" font="0">0.67</text>
<text top="344" left="505" width="12" height="18" font="13">−</text>
<text top="346" left="517" width="41" height="15" font="0">0.0413</text>
<text top="344" left="585" width="12" height="18" font="13">−</text>
<text top="346" left="598" width="26" height="15" font="0">0.72</text>
<text top="364" left="269" width="66" height="15" font="0">proximity</text>
<text top="362" left="368" width="12" height="18" font="13">−</text>
<text top="364" left="380" width="41" height="15" font="0">0.0284</text>
<text top="362" left="448" width="12" height="18" font="13">−</text>
<text top="364" left="460" width="26" height="15" font="0">0.45</text>
<text top="362" left="505" width="12" height="18" font="13">−</text>
<text top="364" left="517" width="41" height="15" font="0">0.0232</text>
<text top="362" left="585" width="12" height="18" font="13">−</text>
<text top="364" left="598" width="26" height="15" font="0">0.40</text>
<text top="382" left="269" width="58" height="15" font="0">specialty</text>
<text top="380" left="368" width="12" height="18" font="13">−</text>
<text top="382" left="380" width="41" height="15" font="0">0.9693</text>
<text top="380" left="448" width="12" height="18" font="13">−</text>
<text top="382" left="460" width="26" height="15" font="0">8.53</text>
<text top="380" left="505" width="12" height="18" font="13">−</text>
<text top="382" left="517" width="41" height="15" font="0">1.0051</text>
<text top="380" left="585" width="12" height="18" font="13">−</text>
<text top="382" left="598" width="26" height="15" font="0">8.11</text>
<text top="403" left="269" width="7" height="11" font="15"><i>ρ</i></text>
<text top="399" left="517" width="41" height="15" font="0">0.1138</text>
<text top="399" left="598" width="26" height="15" font="0">1.33</text>
<text top="451" left="231" width="47" height="13" font="3"><b>Table 5:</b></text>
<text top="451" left="282" width="379" height="13" font="4">SAR probit and standard probit estimates for the Coleman data.</text>
<text top="500" left="171" width="573" height="13" font="4">We are estimating a standard probit model as well as a SAR probit model based on the &#34;advisorship&#34;</text>
<text top="517" left="149" width="596" height="13" font="4">network and trying to find determinants for all adopters of the new drug. We do not aim to fully</text>
<text top="533" left="149" width="595" height="13" font="4">reanalyze the Coleman data set, nor to provide a detailed discussion of the results. We rather want to</text>
<text top="550" left="149" width="595" height="13" font="4">illustrate the model estimation in R. We find a positive relationship for the social influence variable in</text>
<text top="566" left="149" width="595" height="13" font="4">the probit model, but social contagion effects as captured by <i>ρ</i><b>W </b>in the more sound SAR probit model</text>
<text top="583" left="149" width="595" height="13" font="4">is rather small and insignificant. This result suggests that social influence is a factor in information</text>
<text top="599" left="149" width="595" height="13" font="4">diffusion, but the information flow might not be correctly described by a SAR model. Other drivers</text>
<text top="615" left="149" width="595" height="13" font="4">for adoption which are ignored here, such as marketing efforts or aggressive pricing of the new drug</text>
<text top="632" left="149" width="264" height="13" font="4">may play a role in the diffusion process too <a href="2013-1-wilhelm-matos.html#12">(</a></text>
<text top="632" left="413" width="121" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">den Bulte and Lilien</a></text>
<text top="632" left="534" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">,</a></text>
<text top="632" left="540" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">2001</a></text>
<text top="632" left="567" width="8" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">).</a></text>
<text top="659" left="149" width="117" height="11" font="4">&gt; set.seed(12345)</text>
<text top="676" left="149" width="453" height="11" font="4">&gt; # load data set &#34;CKM&#34; and spatial weight matrices &#34;W1&#34;,&#34;W2&#34;,&#34;W3&#34;</text>
<text top="692" left="149" width="75" height="11" font="4">&gt; data(CKM)</text>
<text top="709" left="149" width="233" height="11" font="4">&gt; # 0/1 variable for early adopter</text>
<text top="725" left="149" width="384" height="11" font="4">&gt; y &lt;- as.numeric(CKM$adoption.date &lt;= &#34;February, 1955&#34;)</text>
<text top="741" left="149" width="247" height="11" font="4">&gt; # create social influence variable</text>
<text top="758" left="149" width="316" height="11" font="4">&gt; influence &lt;- as.double(W1 %*% as.numeric(y))</text>
<text top="774" left="149" width="233" height="11" font="4">&gt; # Estimate Standard probit model</text>
<text top="791" left="149" width="562" height="11" font="4">&gt; glm.W1 &lt;- glm(y ~ influence + city + med_sch_yr + meetings + jours + free_time +</text>
<text top="807" left="149" width="7" height="11" font="4">+</text>
<text top="807" left="190" width="501" height="11" font="4">discuss + clubs + friends + community + patients + proximity + specialty,</text>
<text top="824" left="149" width="7" height="11" font="4">+</text>
<text top="824" left="190" width="274" height="11" font="4">data = CKM, family = binomial(&#34;probit&#34;))</text>
<text top="840" left="149" width="199" height="11" font="4">&gt; summary(glm.W1, digits = 3)</text>
<text top="856" left="149" width="384" height="11" font="4">&gt; # Estimate SAR probit model without influence variable</text>
<text top="873" left="149" width="535" height="11" font="4">&gt; sarprobit.fit.W1 &lt;- sarprobit(y ~ 1 + city + med_sch_yr + meetings + jours +</text>
<text top="889" left="149" width="7" height="11" font="4">+</text>
<text top="889" left="190" width="508" height="11" font="4">free_time + discuss + clubs + friends + community + patients + proximity +</text>
<text top="906" left="149" width="7" height="11" font="4">+</text>
<text top="906" left="190" width="206" height="11" font="4">specialty, data = CKM, W = W1)</text>
<text top="922" left="149" width="268" height="11" font="4">&gt; summary(sarprobit.fit.W1, digits = 3)</text>
<text top="948" left="171" width="31" height="13" font="4">Table</text>
<text top="948" left="206" width="7" height="13" font="7"><a href="2013-1-wilhelm-matos.html#11">5</a></text>
<text top="948" left="216" width="530" height="13" font="4">presents the estimation results for the non-spatial probit and the SAR probit specification.</text>
<text top="965" left="148" width="596" height="13" font="4">The coefficient estimates are similar in magnitude and sign, but the estimate for <i>ρ </i>does not support the</text>
<text top="981" left="149" width="244" height="13" font="4">idea of spatial correlation in this data set.</text>
<text top="1026" left="149" width="240" height="17" font="5"><b>Parallel estimation of models</b></text>
<text top="1065" left="149" width="595" height="13" font="4">MCMC is, similar to the bootstrap, an embarrassingly parallel problem. It can be easily run in</text>
<text top="1081" left="148" width="596" height="13" font="4">parallel on several cores. From version 2.14.0, R offers a unified way of doing parallelization with the</text>
<text top="1098" left="148" width="47" height="13" font="3"><b>parallel</b></text>
<text top="1098" left="199" width="546" height="13" font="4">package. There are several different approaches available to achieve parallelization and not all</text>
<text top="1114" left="149" width="595" height="13" font="4">approaches are available for all platforms. See for example the conceptual differences between the two</text>
<text top="1130" left="149" width="595" height="13" font="4">main methods mclapply and parLapply, where the first will only work serially on Windows. Users are</text>
<text top="1147" left="149" width="594" height="13" font="4">therefore encouraged to read the <b>parallel </b>package documentation for choosing the appropriate way.</text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="12" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">141</text>
<text top="103" left="171" width="557" height="13" font="4">Here, we only sketch how easy the SAR probit estimation can be done in parallel with 2 tasks:</text>
<text top="131" left="149" width="130" height="11" font="4">&gt; library(parallel)</text>
<text top="147" left="149" width="62" height="11" font="4">&gt; mc &lt;- 2</text>
<text top="163" left="149" width="514" height="11" font="4">&gt; run1 &lt;- function(...) sarprobit(y ~ X - 1, W, ndraw = 500, burn.in = 200,</text>
<text top="180" left="149" width="7" height="11" font="4">+</text>
<text top="180" left="190" width="89" height="11" font="4">thinning = 1)</text>
<text top="196" left="149" width="103" height="11" font="4">&gt; system.time({</text>
<text top="213" left="149" width="7" height="11" font="4">+</text>
<text top="213" left="190" width="171" height="11" font="4">set.seed(123, &#34;L’Ecuyer&#34;)</text>
<text top="229" left="149" width="7" height="11" font="4">+</text>
<text top="229" left="190" width="384" height="11" font="4">sarprobit.res &lt;- do.call(c, mclapply(seq_len(mc), run1))</text>
<text top="246" left="149" width="27" height="11" font="4">+ })</text>
<text top="262" left="149" width="165" height="11" font="4">&gt; summary(sarprobit.res)</text>
<text top="288" left="171" width="573" height="13" font="4">Due to the overhead in setting up the cluster, it is reasonable to expect another 50% performance</text>
<text top="305" left="149" width="198" height="13" font="4">gain when working with 2 CPUs.</text>
<text top="350" left="149" width="80" height="17" font="5"><b>Summary</b></text>
<text top="389" left="149" width="595" height="13" font="4">In this article we presented the estimation of spatial probit models in R and pointed to the critical</text>
<text top="405" left="149" width="537" height="13" font="4">implementation issues. Our performance studies showed that even large problems with n</text>
<text top="405" left="690" width="11" height="12" font="0">=</text>
<text top="405" left="705" width="40" height="13" font="4">10, 000</text>
<text top="421" left="149" width="25" height="13" font="4">or n</text>
<text top="421" left="180" width="11" height="12" font="0">=</text>
<text top="421" left="197" width="547" height="13" font="4">100, 000 observations can be handled within reasonable time. We provided an update of</text>
<text top="438" left="149" width="61" height="13" font="3"><b>tmvtnorm</b></text>
<text top="438" left="213" width="531" height="13" font="4">and a new package <b>spatialprobit </b>on CRAN with the methods for estimating spatial probit</text>
<text top="454" left="149" width="133" height="13" font="4">models implemented <a href="2013-1-wilhelm-matos.html#13">(</a></text>
<text top="454" left="282" width="134" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">Wilhelm and de Matos</a></text>
<text top="454" left="415" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">,</a></text>
<text top="454" left="422" width="27" height="13" font="7"><a href="2013-1-wilhelm-matos.html#13">2013</a></text>
<text top="454" left="449" width="295" height="13" font="4"><a href="2013-1-wilhelm-matos.html#13">). </a>The package currently implements three limited</text>
<text top="471" left="149" width="595" height="13" font="4">dependent models: the spatial lag probit model (sarprobit()), the probit model with spatial errors</text>
<text top="487" left="148" width="596" height="13" font="4">(semprobit()) and the SAR Tobit model (sartobit()). The Bayesian approach can be further extended</text>
<text top="504" left="149" width="595" height="13" font="4">to other limited dependent spatial models, such as ordered probit or models with multiple spatial</text>
<text top="520" left="148" width="480" height="13" font="4">weights matrices. We are planning to include these in the package in near future.</text>
<text top="565" left="149" width="109" height="17" font="5"><b>Bibliography</b></text>
<text top="604" left="149" width="321" height="13" font="4">J. Albert. Bayesian Computation in R. Springer, 2007. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="604" left="470" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="604" left="490" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="632" left="149" width="444" height="13" font="4">J. Albert. LearnBayes: Functions for Learning Bayesian Inference, 2012. URL</text>
<text top="633" left="597" width="152" height="11" font="7"><a href="http://CRAN.R-project.org/package=LearnBayes">http://CRAN.R-project.</a></text>
<text top="649" left="164" width="151" height="11" font="7"><a href="http://CRAN.R-project.org/package=LearnBayes">org/package=LearnBayes</a></text>
<text top="648" left="315" width="165" height="13" font="4"><a href="http://CRAN.R-project.org/package=LearnBayes">. </a>R package version 2.12. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="648" left="479" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="648" left="499" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="677" left="149" width="560" height="13" font="4">D. Bates and M. Maechler. Matrix: Sparse and Dense Matrix Classes and Methods, 2013. URL</text>
<text top="677" left="713" width="34" height="11" font="7"><a href="http://CRAN.R-project.org/package=Matrix">http:</a></text>
<text top="694" left="163" width="241" height="11" font="7"><a href="http://CRAN.R-project.org/package=Matrix">//CRAN.R-project.org/package=Matrix</a></text>
<text top="693" left="404" width="176" height="13" font="4"><a href="http://CRAN.R-project.org/package=Matrix">. </a>R package version 1.0-12. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="693" left="580" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="693" left="600" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="722" left="149" width="598" height="13" font="4">R. Bivand. Computing the Jacobian in spatial models: an applied survey. Discussion paper /</text>
<text top="738" left="164" width="582" height="13" font="4">Norwegian School of Economics and Business Administration, Department of Economics ; 2010,20,</text>
<text top="755" left="163" width="117" height="13" font="4">August 2010. URL</text>
<text top="755" left="285" width="460" height="11" font="7"><a href="http://brage.bibsys.no/nhh/bitstream/URN:NBN:no-bibsys_brage_23930/1/dp2010-20.pdf">http://brage.bibsys.no/nhh/bitstream/URN:NBN:no-bibsys_brage_23930/</a></text>
<text top="772" left="163" width="104" height="11" font="7"><a href="http://brage.bibsys.no/nhh/bitstream/URN:NBN:no-bibsys_brage_23930/1/dp2010-20.pdf">1/dp2010-20.pdf</a></text>
<text top="771" left="267" width="21" height="13" font="4"><a href="http://brage.bibsys.no/nhh/bitstream/URN:NBN:no-bibsys_brage_23930/1/dp2010-20.pdf">. </a><a href="2013-1-wilhelm-matos.html#5">[p</a></text>
<text top="771" left="288" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="771" left="308" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">]</a></text>
<text top="799" left="149" width="499" height="13" font="4">R. Bivand. spdep: Spatial dependence: weighting schemes, statistics and models, 2013. URL</text>
<text top="800" left="651" width="96" height="11" font="7"><a href="http://CRAN.R-project.org/package=spdep">http://CRAN.R-</a></text>
<text top="816" left="164" width="171" height="11" font="7"><a href="http://CRAN.R-project.org/package=spdep">project.org/package=spdep</a></text>
<text top="816" left="335" width="176" height="13" font="4"><a href="http://CRAN.R-project.org/package=spdep">. </a>R package version 0.5-57. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="816" left="511" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="816" left="531" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="844" left="149" width="595" height="13" font="4">R. S. Burt. Social contagion and innovation: Cohesion versus structural equivalence. American Journal</text>
<text top="861" left="164" width="219" height="14" font="4">of Sociology, 92(6):1287–1335, 1987. <a href="2013-1-wilhelm-matos.html#8">[p</a></text>
<text top="861" left="383" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#8">137</a></text>
<text top="861" left="403" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#8">]</a></text>
<text top="889" left="149" width="337" height="13" font="4">C. T. Butts. sna: Tools for Social Network Analysis, 2013. URL</text>
<text top="890" left="489" width="255" height="11" font="7"><a href="http://CRAN.R-project.org/package=sna">http://CRAN.R-project.org/package=sna</a></text>
<text top="889" left="743" width="3" height="13" font="4"><a href="http://CRAN.R-project.org/package=sna">.</a></text>
<text top="906" left="164" width="161" height="13" font="4">R package version 2.3-1. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="906" left="325" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="906" left="345" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="934" left="149" width="598" height="13" font="4">C. T. Butts, M. S. Handcock, and D. R. Hunter. network: Classes for Relational Data. Irvine, CA, 2013.</text>
<text top="950" left="164" width="28" height="13" font="4">URL</text>
<text top="951" left="195" width="130" height="11" font="7"><a href="http://statnet.org/">http://statnet.org/</a></text>
<text top="950" left="325" width="169" height="13" font="4"><a href="http://statnet.org/">. </a>R package version 1.7-2. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="950" left="494" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="950" left="514" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="979" left="149" width="597" height="13" font="4">J. Coleman, E. Katz, and H. Menzel. The diffusion of an innovation among physicians. Sociometry, 20:</text>
<text top="995" left="164" width="101" height="13" font="4">253–270, 1957. <a href="2013-1-wilhelm-matos.html#8">[p</a></text>
<text top="995" left="265" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#8">137</a></text>
<text top="995" left="285" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#8">]</a></text>
<text top="1024" left="149" width="597" height="13" font="4">J. S. Coleman, E. Katz, and H. Menzel. Medical Innovation: A Diffusion Study. New York: Bobbs Merrill,</text>
<text top="1040" left="163" width="48" height="13" font="4">1966. <a href="2013-1-wilhelm-matos.html#8">[p</a></text>
<text top="1040" left="211" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#8">137</a></text>
<text top="1040" left="231" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#8">]</a></text>
<text top="1068" left="149" width="597" height="13" font="4">G. Csardi and T. Nepusz. The igraph software package for complex network research. InterJournal,</text>
<text top="1085" left="164" width="206" height="13" font="4">Complex Systems:1695, 2006. URL</text>
<text top="1085" left="373" width="137" height="11" font="7"><a href="http://igraph.sf.net">http://igraph.sf.net</a></text>
<text top="1085" left="510" width="21" height="13" font="4"><a href="http://igraph.sf.net">. </a><a href="2013-1-wilhelm-matos.html#6">[p</a></text>
<text top="1085" left="531" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#6">135</a></text>
<text top="1085" left="551" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#6">]</a></text>
<text top="1113" left="149" width="595" height="13" font="4">C. V. den Bulte and G. L. Lilien. Medical innovation revisited: Social contagion versus marketing</text>
<text top="1130" left="164" width="366" height="13" font="4">effort. American Journal of Sociology, 106(5):1409–1435, 2001. <a href="2013-1-wilhelm-matos.html#8">[p</a></text>
<text top="1130" left="530" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#8">137</a></text>
<text top="1130" left="550" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#8">,</a></text>
<text top="1130" left="557" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#11">140</a></text>
<text top="1130" left="577" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#11">]</a></text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="13" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">142</text>
<text top="103" left="149" width="468" height="13" font="4">P. Diggle and P. Ribeiro. Model Based Geostatistics. Springer, New York, 2007. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="103" left="617" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="103" left="637" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="132" left="149" width="561" height="13" font="4">A. O. Finley and S. Banerjee. spBayes: Univariate and Multivariate Spatial Modeling, 2013. URL</text>
<text top="132" left="713" width="34" height="11" font="7"><a href="http://CRAN.R-project.org/package=spBayes">http:</a></text>
<text top="149" left="163" width="248" height="11" font="7"><a href="http://CRAN.R-project.org/package=spBayes">//CRAN.R-project.org/package=spBayes</a></text>
<text top="148" left="411" width="169" height="13" font="4"><a href="http://CRAN.R-project.org/package=spBayes">. </a>R package version 0.3-7. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="148" left="580" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="148" left="600" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="176" left="149" width="595" height="13" font="4">R. J. Franzese, J. C. Hays, and S. Cook. Spatial-, temporal-, and spatiotemporal-autoregressive probit</text>
<text top="193" left="164" width="580" height="13" font="4">models of interdependent binary outcomes: Estimation and interpretation. Prepared for the Spatial</text>
<text top="209" left="164" width="484" height="13" font="4">Models of Politics in Europe &amp; Beyond, Texas A&amp;M University, February 2013. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="209" left="648" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="209" left="668" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="238" left="149" width="595" height="13" font="4">A. Genz, F. Bretz, T. Miwa, X. Mi, F. Leisch, F. Scheipl, and T. Hothorn. mvtnorm: Multivariate Normal</text>
<text top="254" left="164" width="177" height="14" font="4">and t Distributions, 2013. URL</text>
<text top="255" left="344" width="282" height="11" font="7"><a href="http://CRAN.R-project.org/package=mvtnorm">http://CRAN.R-project.org/package=mvtnorm</a></text>
<text top="254" left="626" width="118" height="13" font="4"><a href="http://CRAN.R-project.org/package=mvtnorm">. </a>R package version</text>
<text top="271" left="164" width="69" height="13" font="4">0.9-9995. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="271" left="233" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="271" left="253" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="299" left="149" width="595" height="13" font="4">J. F. Geweke. Efficient simulation from the multivariate normal and Student-t distributions subject to</text>
<text top="315" left="164" width="438" height="13" font="4">linear constraints and the evaluation of constraint probabilities, 1991. URL</text>
<text top="316" left="605" width="144" height="11" font="7"><a href="http://www.biz.uiowa.edu/faculty/jgeweke/papers/paper47/paper47.pdf">http://www.biz.uiowa.</a></text>
<text top="332" left="164" width="316" height="11" font="7"><a href="http://www.biz.uiowa.edu/faculty/jgeweke/papers/paper47/paper47.pdf">edu/faculty/jgeweke/papers/paper47/paper47.pdf</a></text>
<text top="332" left="479" width="21" height="13" font="4"><a href="http://www.biz.uiowa.edu/faculty/jgeweke/papers/paper47/paper47.pdf">. </a><a href="2013-1-wilhelm-matos.html#3">[p</a></text>
<text top="332" left="500" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">132</a></text>
<text top="332" left="520" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">]</a></text>
<text top="360" left="149" width="550" height="13" font="4">J. F. Geweke. Contemporary Bayesian Econometrics and Statistics. John Wiley and Sons, 2005. <a href="2013-1-wilhelm-matos.html#3">[p</a></text>
<text top="360" left="699" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">132</a></text>
<text top="360" left="719" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">]</a></text>
<text top="389" left="149" width="595" height="13" font="4">T. Klier and D. P. McMillen. Clustering of auto supplier plants in the United States: Generalized</text>
<text top="405" left="164" width="582" height="13" font="4">method of moments spatial probit for large samples. Journal of Business and Economic Statistics, 26:</text>
<text top="421" left="164" width="101" height="13" font="4">460–471, 2008. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="421" left="265" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="421" left="285" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="450" left="149" width="413" height="13" font="4">R. Koenker and P. Ng. SparseM: Sparse Linear Algebra, 2013. URL</text>
<text top="450" left="566" width="179" height="11" font="7"><a href="http://CRAN.R-project.org/package=SparseM">http://CRAN.R-project.org/</a></text>
<text top="467" left="164" width="103" height="11" font="7"><a href="http://CRAN.R-project.org/package=SparseM">package=SparseM</a></text>
<text top="466" left="267" width="165" height="13" font="4"><a href="http://CRAN.R-project.org/package=SparseM">. </a>R package version 0.99. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="466" left="431" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="466" left="451" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="495" left="149" width="468" height="13" font="4">J. LeSage and R. K. Pace. Introduction to Spatial Econometrics. CRC Press, 2009. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="495" left="617" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="495" left="637" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">,</a></text>
<text top="495" left="643" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="495" left="663" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">,</a></text>
<text top="495" left="670" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">132</a></text>
<text top="495" left="690" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">,</a></text>
<text top="495" left="696" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#4">133</a></text>
<text top="495" left="716" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#4">,</a></text>
<text top="495" left="723" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="495" left="742" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">,</a></text>
<text top="511" left="163" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#6">135</a></text>
<text top="511" left="183" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#6">,</a></text>
<text top="511" left="190" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">139</a></text>
<text top="511" left="210" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#10">]</a></text>
<text top="540" left="149" width="598" height="13" font="4">J. P. LeSage. Bayesian estimation of limited dependent variable spatial autoregressive models. Geo-</text>
<text top="556" left="164" width="229" height="14" font="4">graphical Analysis, 32(1):19–35, 2000. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="556" left="392" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="556" left="413" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="584" left="149" width="463" height="13" font="4">J. P. LeSage. Spatial econometrics toolbox for MATLAB, March 2010. URL</text>
<text top="585" left="616" width="130" height="11" font="7"><a href="http://www.spatial-econometrics.com/">http://www.spatial-</a></text>
<text top="601" left="164" width="117" height="11" font="7"><a href="http://www.spatial-econometrics.com/">econometrics.com/</a></text>
<text top="601" left="280" width="21" height="13" font="4"><a href="http://www.spatial-econometrics.com/">. </a><a href="2013-1-wilhelm-matos.html#5">[p</a></text>
<text top="601" left="301" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="601" left="321" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">,</a></text>
<text top="601" left="328" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#10">139</a></text>
<text top="601" left="348" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#10">]</a></text>
<text top="629" left="149" width="595" height="13" font="4">J. P. LeSage, R. K. Pace, N. Lam, R. Campanella, and X. Liu. New Orleans business recovery in the</text>
<text top="646" left="164" width="582" height="13" font="4">aftermath of hurricane Katrina. Journal of the Royal Statistical Society: Series A (Statistics in Society),</text>
<text top="662" left="163" width="138" height="13" font="4">174:1007–1027, 2011. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="662" left="302" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="662" left="322" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="690" left="149" width="597" height="13" font="4">J. J. Majure and A. Gebhardt. sgeostat: An Object-oriented Framework for Geostatistical Modeling in S+,</text>
<text top="707" left="164" width="64" height="13" font="4">2013. URL</text>
<text top="707" left="232" width="289" height="11" font="7"><a href="http://CRAN.R-project.org/package=sgeostat">http://CRAN.R-project.org/package=sgeostat</a></text>
<text top="707" left="520" width="224" height="13" font="4"><a href="http://CRAN.R-project.org/package=sgeostat">. </a>R package version 1.0-25; S original</text>
<text top="723" left="164" width="540" height="13" font="4">by James J. Majure Iowa State University and R port + extensions by Albrecht Gebhardt. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="723" left="704" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="723" left="724" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="752" left="149" width="597" height="13" font="4">T. L. Marsh, R. C. Mittelhammer, and R. G. Huffaker. Probit with spatial correlation by field plot:</text>
<text top="768" left="164" width="580" height="13" font="4">Potato leafroll virus net necrosis in potatoes. Journal of Agricultural, Biological, and Environmental</text>
<text top="784" left="163" width="170" height="14" font="4">Statistics, 5:22–36, 2000. URL</text>
<text top="785" left="337" width="240" height="11" font="7"><a href="http://www.jstor.org/stable/1400629">http://www.jstor.org/stable/1400629</a></text>
<text top="785" left="577" width="21" height="13" font="4"><a href="http://www.jstor.org/stable/1400629">. </a><a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="785" left="598" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="785" left="618" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="813" left="149" width="414" height="13" font="4">D. McMillen. McSpatial: Nonparametric spatial data analysis, 2013. URL</text>
<text top="814" left="566" width="179" height="11" font="7"><a href="http://CRAN.R-project.org/package=McSpatial">http://CRAN.R-project.org/</a></text>
<text top="830" left="164" width="117" height="11" font="7"><a href="http://CRAN.R-project.org/package=McSpatial">package=McSpatial</a></text>
<text top="829" left="280" width="158" height="13" font="4"><a href="http://CRAN.R-project.org/package=McSpatial">. </a>R package version 2.0. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="829" left="438" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="829" left="458" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">,</a></text>
<text top="829" left="465" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="829" left="485" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="858" left="149" width="597" height="13" font="4">R. K. Pace and R. Barry. Quick computation of spatial autoregressive estimators. Geographical Analysis,</text>
<text top="874" left="164" width="118" height="13" font="4">29:232–247, 1997. <a href="2013-1-wilhelm-matos.html#5">[p</a></text>
<text top="874" left="282" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="874" left="302" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">]</a></text>
<text top="903" left="149" width="598" height="13" font="4">R. K. Pace and J. LeSage. Chebyshev approximation of log-determinants of spatial weight matrices.</text>
<text top="919" left="163" width="371" height="14" font="4">Computational Statistics &amp; Data Analysis, 45(2):179–196, 2004. <a href="2013-1-wilhelm-matos.html#5">[p</a></text>
<text top="919" left="534" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="919" left="555" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">]</a></text>
<text top="947" left="149" width="595" height="13" font="4">G. Piras. sphet: Spatial models with heteroskedastic innovations in R. Journal of Statistical Software, 35</text>
<text top="964" left="163" width="115" height="13" font="4">(1):1–21, 2010. URL</text>
<text top="964" left="282" width="226" height="11" font="7"><a href="http://www.jstatsoft.org/v35/i01/">http://www.jstatsoft.org/v35/i01/</a></text>
<text top="964" left="508" width="21" height="13" font="4"><a href="http://www.jstatsoft.org/v35/i01/">. </a><a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="964" left="529" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="964" left="549" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="992" left="149" width="491" height="13" font="4">W. N. Venables and B. D. Ripley. Modern Applied Statistics with S. Springer, 2002. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="992" left="640" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="992" left="660" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">]</a></text>
<text top="1021" left="149" width="497" height="13" font="4">S. Wilhelm and M. G. de Matos. spatialprobit: Spatial Probit Models, 2013. URL</text>
<text top="1021" left="651" width="96" height="11" font="7"><a href="http://CRAN.R-project.org/package=spatialprobit">http://CRAN.R-</a></text>
<text top="1038" left="164" width="226" height="11" font="7"><a href="http://CRAN.R-project.org/package=spatialprobit">project.org/package=spatialprobit</a></text>
<text top="1037" left="390" width="169" height="13" font="4"><a href="http://CRAN.R-project.org/package=spatialprobit">. </a>R package version 0.9-9. <a href="2013-1-wilhelm-matos.html#1">[p</a></text>
<text top="1037" left="559" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#1">130</a></text>
<text top="1037" left="579" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#1">,</a></text>
<text top="1037" left="586" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#5">134</a></text>
<text top="1037" left="606" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#5">,</a></text>
<text top="1037" left="613" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#12">141</a></text>
<text top="1037" left="633" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#12">]</a></text>
<text top="1066" left="149" width="595" height="13" font="4">S. Wilhelm and B. G. Manjunath. tmvtnorm: A package for the truncated multivariate normal</text>
<text top="1082" left="164" width="324" height="13" font="4">distribution. The R Journal, 2(1):25–29, June 2010. URL</text>
<text top="1083" left="491" width="255" height="11" font="7"><a href="http://journal.r-project.org/archive/2010-1/RJournal_2010-1_Wilhelm+Manjunath.pdf">http://journal.r-project.org/archive/</a></text>
<text top="1099" left="164" width="303" height="11" font="7"><a href="http://journal.r-project.org/archive/2010-1/RJournal_2010-1_Wilhelm+Manjunath.pdf">2010-1/RJournal_2010-1_Wilhelm+Manjunath.pdf</a></text>
<text top="1098" left="467" width="21" height="13" font="4"><a href="http://journal.r-project.org/archive/2010-1/RJournal_2010-1_Wilhelm+Manjunath.pdf">. </a><a href="2013-1-wilhelm-matos.html#3">[p</a></text>
<text top="1098" left="488" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">132</a></text>
<text top="1098" left="508" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">]</a></text>
<text top="1127" left="149" width="597" height="13" font="4">S. Wilhelm and B. G. Manjunath. tmvtnorm: Truncated Multivariate Normal and Student t Distribution,</text>
<text top="1143" left="164" width="63" height="13" font="4">2013. URL</text>
<text top="1144" left="230" width="289" height="11" font="7"><a href="http://CRAN.R-project.org/package=tmvtnorm">http://CRAN.R-project.org/package=tmvtnorm</a></text>
<text top="1143" left="519" width="169" height="13" font="4"><a href="http://CRAN.R-project.org/package=tmvtnorm">. </a>R package version 1.4-8. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="1143" left="688" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="1143" left="708" width="3" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">,</a></text>
<text top="1143" left="715" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#3">132</a></text>
<text top="1143" left="735" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#3">]</a></text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
<page number="14" position="absolute" top="0" left="0" height="1262" width="892">
<text top="44" left="64" width="11" height="15" font="0">C</text>
<text top="47" left="75" width="86" height="12" font="1">ONTRIBUTED</text>
<text top="44" left="166" width="10" height="15" font="0">R</text>
<text top="47" left="177" width="61" height="12" font="1">ESEARCH</text>
<text top="44" left="242" width="12" height="15" font="0">A</text>
<text top="47" left="254" width="53" height="12" font="1">RTICLES</text>
<text top="44" left="807" width="22" height="15" font="0">143</text>
<text top="103" left="149" width="597" height="13" font="4">J. M. Wooldridge. Introductory Econometrics - A Modern Approach. South Western College Publishing,</text>
<text top="120" left="164" width="48" height="13" font="4">2002. <a href="2013-1-wilhelm-matos.html#2">[p</a></text>
<text top="120" left="211" width="20" height="13" font="7"><a href="2013-1-wilhelm-matos.html#2">131</a></text>
<text top="120" left="232" width="4" height="13" font="4"><a href="2013-1-wilhelm-matos.html#2">]</a></text>
<text top="166" left="148" width="84" height="13" font="4">Stefan Wilhelm</text>
<text top="182" left="148" width="392" height="13" font="4">Department of Finance, WWZ (Wirtschaftswissenschaftliches Zentrum)</text>
<text top="199" left="148" width="104" height="13" font="4">University of Basel</text>
<text top="215" left="148" width="66" height="13" font="4">Switzerland</text>
<text top="232" left="148" width="144" height="11" font="7"><a href="mailto:wilhelm@financial.com">wilhelm@financial.com</a></text>
<text top="269" left="149" width="142" height="13" font="4">Miguel Godinho de Matos</text>
<text top="285" left="148" width="239" height="13" font="4">Department of Engineering &amp; Public Policy</text>
<text top="302" left="148" width="153" height="13" font="4">Carnegie Mellon University</text>
<text top="318" left="148" width="74" height="13" font="4">United States</text>
<text top="335" left="149" width="178" height="11" font="7"><a href="mailto:miguelgodinhomatos@cmu.edu">miguelgodinhomatos@cmu.edu</a></text>
<text top="1210" left="148" width="186" height="15" font="0">The R Journal Vol. 5/1, June</text>
<text top="1210" left="642" width="102" height="15" font="0">ISSN 2073-4859</text>
</page>
</pdf2xml>
